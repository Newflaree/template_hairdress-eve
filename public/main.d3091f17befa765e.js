(self.webpackChunkhairdress=self.webpackChunkhairdress||[]).push([[179],{287:(Nf,fu,Hl)=>{"use strict";function _i(e){return"function"==typeof e}function Fd(e){const n=e(r=>{Error.call(r),r.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const jf=Fd(e=>function(n){e(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((r,l)=>`${l+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function p(e,t){if(e){const n=e.indexOf(t);0<=n&&e.splice(n,1)}}class ot{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const u of n)u.remove(this);else n.remove(this);const{initialTeardown:r}=this;if(_i(r))try{r()}catch(u){t=u instanceof jf?u.errors:[u]}const{_finalizers:l}=this;if(l){this._finalizers=null;for(const u of l)try{dt(u)}catch(_){t=null!=t?t:[],_ instanceof jf?t=[...t,..._.errors]:t.push(_)}}if(t)throw new jf(t)}}add(t){var n;if(t&&t!==this)if(this.closed)dt(t);else{if(t instanceof ot){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}}_hasParent(t){const{_parentage:n}=this;return n===t||Array.isArray(n)&&n.includes(t)}_addParent(t){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t}_removeParent(t){const{_parentage:n}=this;n===t?this._parentage=null:Array.isArray(n)&&p(n,t)}remove(t){const{_finalizers:n}=this;n&&p(n,t),t instanceof ot&&t._removeParent(this)}}ot.EMPTY=(()=>{const e=new ot;return e.closed=!0,e})();const Ws=ot.EMPTY;function kr(e){return e instanceof ot||e&&"closed"in e&&_i(e.remove)&&_i(e.add)&&_i(e.unsubscribe)}function dt(e){_i(e)?e():e.unsubscribe()}const Qt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Cr={setTimeout(e,t,...n){const{delegate:r}=Cr;return(null==r?void 0:r.setTimeout)?r.setTimeout(e,t,...n):setTimeout(e,t,...n)},clearTimeout(e){const{delegate:t}=Cr;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function Oo(e){Cr.setTimeout(()=>{const{onUnhandledError:t}=Qt;if(!t)throw e;t(e)})}function ln(){}const cr=bs("C",void 0,void 0);function bs(e,t,n){return{kind:e,value:t,error:n}}let _o=null;function Zt(e){if(Qt.useDeprecatedSynchronousErrorHandling){const t=!_o;if(t&&(_o={errorThrown:!1,error:null}),e(),t){const{errorThrown:n,error:r}=_o;if(_o=null,n)throw r}}else e()}class ts extends ot{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,kr(t)&&t.add(this)):this.destination=gu}static create(t,n,r){return new Ma(t,n,r)}next(t){this.isStopped?hl(function ql(e){return bs("N",e,void 0)}(t),this):this._next(t)}error(t){this.isStopped?hl(function mu(e){return bs("E",void 0,e)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?hl(cr,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Ys=Function.prototype.bind;function Xs(e,t){return Ys.call(e,t)}class ji{constructor(t){this.partialObserver=t}next(t){const{partialObserver:n}=this;if(n.next)try{n.next(t)}catch(r){ws(r)}}error(t){const{partialObserver:n}=this;if(n.error)try{n.error(t)}catch(r){ws(r)}else ws(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(n){ws(n)}}}class Ma extends ts{constructor(t,n,r){let l;if(super(),_i(t)||!t)l={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0};else{let u;this&&Qt.useDeprecatedNextContext?(u=Object.create(t),u.unsubscribe=()=>this.unsubscribe(),l={next:t.next&&Xs(t.next,u),error:t.error&&Xs(t.error,u),complete:t.complete&&Xs(t.complete,u)}):l=t}this.destination=new ji(l)}}function ws(e){Qt.useDeprecatedSynchronousErrorHandling?function es(e){Qt.useDeprecatedSynchronousErrorHandling&&_o&&(_o.errorThrown=!0,_o.error=e)}(e):Oo(e)}function hl(e,t){const{onStoppedNotification:n}=Qt;n&&Cr.setTimeout(()=>n(e,t))}const gu={closed:!0,next:ln,error:function dl(e){throw e},complete:ln},ns="function"==typeof Symbol&&Symbol.observable||"@@observable";function yo(e){return e}let Hn=(()=>{class e{constructor(n){n&&(this._subscribe=n)}lift(n){const r=new e;return r.source=this,r.operator=n,r}subscribe(n,r,l){const u=function ur(e){return e&&e instanceof ts||function vi(e){return e&&_i(e.next)&&_i(e.error)&&_i(e.complete)}(e)&&kr(e)}(n)?n:new Ma(n,r,l);return Zt(()=>{const{operator:_,source:v}=this;u.add(_?_.call(u,v):v?this._subscribe(u):this._trySubscribe(u))}),u}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return new(r=pl(r))((l,u)=>{const _=new Ma({next:v=>{try{n(v)}catch(w){u(w),_.unsubscribe()}},error:u,complete:l});this.subscribe(_)})}_subscribe(n){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(n)}[ns](){return this}pipe(...n){return function Qs(e){return 0===e.length?yo:1===e.length?e[0]:function(n){return e.reduce((r,l)=>l(r),n)}}(n)(this)}toPromise(n){return new(n=pl(n))((r,l)=>{let u;this.subscribe(_=>u=_,_=>l(_),()=>r(u))})}}return e.create=t=>new e(t),e})();function pl(e){var t;return null!==(t=null!=e?e:Qt.Promise)&&void 0!==t?t:Promise}const As=Fd(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let bi=(()=>{class e extends Hn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const r=new is(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new As}next(n){Zt(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(n)}})}error(n){Zt(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){Zt(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:r,isStopped:l,observers:u}=this;return r||l?Ws:(this.currentObservers=null,u.push(n),new ot(()=>{this.currentObservers=null,p(u,n)}))}_checkFinalizedStatuses(n){const{hasError:r,thrownError:l,isStopped:u}=this;r?n.error(l):u&&n.complete()}asObservable(){const n=new Hn;return n.source=this,n}}return e.create=(t,n)=>new is(t,n),e})();class is extends bi{constructor(t,n){super(),this.destination=t,this.source=n}next(t){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===r||r.call(n,t)}error(t){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===r||r.call(n,t)}complete(){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===n||n.call(t)}_subscribe(t){var n,r;return null!==(r=null===(n=this.source)||void 0===n?void 0:n.subscribe(t))&&void 0!==r?r:Ws}}function rs(e){return _i(null==e?void 0:e.lift)}function wi(e){return t=>{if(rs(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Mi(e,t,n,r,l){return new Es(e,t,n,r,l)}class Es extends ts{constructor(t,n,r,l,u,_){super(t),this.onFinalize=u,this.shouldUnsubscribe=_,this._next=n?function(v){try{n(v)}catch(w){t.error(w)}}:super._next,this._error=l?function(v){try{l(v)}catch(w){t.error(w)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(v){t.error(v)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function Qn(e,t){return wi((n,r)=>{let l=0;n.subscribe(Mi(r,u=>{r.next(e.call(t,u,l++))}))})}function Vi(e){return this instanceof Vi?(this.v=e,this):new Vi(e)}function ss(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l,r=n.apply(e,t||[]),u=[];return l={},_("next"),_("throw"),_("return"),l[Symbol.asyncIterator]=function(){return this},l;function _(L){r[L]&&(l[L]=function(j){return new Promise(function(Z,G){u.push([L,j,Z,G])>1||v(L,j)})})}function v(L,j){try{!function w(L){L.value instanceof Vi?Promise.resolve(L.value.v).then(T,S):I(u[0][2],L)}(r[L](j))}catch(Z){I(u[0][3],Z)}}function T(L){v("next",L)}function S(L){v("throw",L)}function I(L,j){L(j),u.shift(),u.length&&v(u[0][0],u[0][1])}}function vu(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,t=e[Symbol.asyncIterator];return t?t.call(e):(e=function os(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(u){n[u]=e[u]&&function(_){return new Promise(function(v,w){!function l(u,_,v,w){Promise.resolve(w).then(function(T){u({value:T,done:v})},_)}(v,w,(_=e[u](_)).done,_.value)})}}}const Wl=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function Yl(e){return _i(null==e?void 0:e.then)}function Au(e){return _i(e[ns])}function Is(e){return Symbol.asyncIterator&&_i(null==e?void 0:e[Symbol.asyncIterator])}function as(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Xl=function yl(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Ar(e){return _i(null==e?void 0:e[Xl])}function vl(e){return ss(this,arguments,function*(){const n=e.getReader();try{for(;;){const{value:r,done:l}=yield Vi(n.read());if(l)return yield Vi(void 0);yield yield Vi(r)}}finally{n.releaseLock()}})}function le(e){return _i(null==e?void 0:e.getReader)}function V(e){if(e instanceof Hn)return e;if(null!=e){if(Au(e))return function H(e){return new Hn(t=>{const n=e[ns]();if(_i(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(Wl(e))return function oe(e){return new Hn(t=>{for(let n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(Yl(e))return function ue(e){return new Hn(t=>{e.then(n=>{t.closed||(t.next(n),t.complete())},n=>t.error(n)).then(null,Oo)})}(e);if(Is(e))return Te(e);if(Ar(e))return function be(e){return new Hn(t=>{for(const n of e)if(t.next(n),t.closed)return;t.complete()})}(e);if(le(e))return function Ae(e){return Te(vl(e))}(e)}throw as(e)}function Te(e){return new Hn(t=>{(function we(e,t){var n,r,l,u;return function gl(e,t,n,r){return new(n||(n=Promise))(function(u,_){function v(S){try{T(r.next(S))}catch(I){_(I)}}function w(S){try{T(r.throw(S))}catch(I){_(I)}}function T(S){S.done?u(S.value):function l(u){return u instanceof n?u:new n(function(_){_(u)})}(S.value).then(v,w)}T((r=r.apply(e,t||[])).next())})}(this,void 0,void 0,function*(){try{for(n=vu(e);!(r=yield n.next()).done;)if(t.next(r.value),t.closed)return}catch(_){l={error:_}}finally{try{r&&!r.done&&(u=n.return)&&(yield u.call(n))}finally{if(l)throw l.error}}t.complete()})})(e,t).catch(n=>t.error(n))})}function Me(e,t,n,r=0,l=!1){const u=t.schedule(function(){n(),l?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(u),!l)return u}function st(e,t,n=1/0){return _i(t)?st((r,l)=>Qn((u,_)=>t(r,u,l,_))(V(e(r,l))),n):("number"==typeof t&&(n=t),wi((r,l)=>function Ye(e,t,n,r,l,u,_,v){const w=[];let T=0,S=0,I=!1;const L=()=>{I&&!w.length&&!T&&t.complete()},j=G=>T<r?Z(G):w.push(G),Z=G=>{u&&t.next(G),T++;let Y=!1;V(n(G,S++)).subscribe(Mi(t,ce=>{null==l||l(ce),u?j(ce):t.next(ce)},()=>{Y=!0},void 0,()=>{if(Y)try{for(T--;w.length&&T<r;){const ce=w.shift();_?Me(t,_,()=>Z(ce)):Z(ce)}L()}catch(ce){t.error(ce)}}))};return e.subscribe(Mi(t,j,()=>{I=!0,L()})),()=>{null==v||v()}}(r,l,e,n)))}function Xe(e=1/0){return st(yo,e)}const St=new Hn(e=>e.complete());function tn(e){return e[e.length-1]}function Mn(e){return function Nt(e){return e&&_i(e.schedule)}(tn(e))?e.pop():void 0}function Rt(e,t=0){return wi((n,r)=>{n.subscribe(Mi(r,l=>Me(r,e,()=>r.next(l),t),()=>Me(r,e,()=>r.complete(),t),l=>Me(r,e,()=>r.error(l),t)))})}function Re(e,t=0){return wi((n,r)=>{r.add(e.schedule(()=>n.subscribe(r),t))})}function xo(e,t){if(!e)throw new Error("Iterable cannot be null");return new Hn(n=>{Me(n,t,()=>{const r=e[Symbol.asyncIterator]();Me(n,t,()=>{r.next().then(l=>{l.done?n.complete():n.next(l.value)})},0,!0)})})}function Si(e,t){return t?function Vf(e,t){if(null!=e){if(Au(e))return function Xr(e,t){return V(e).pipe(Re(t),Rt(t))}(e,t);if(Wl(e))return function ea(e,t){return new Hn(n=>{let r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(Yl(e))return function yi(e,t){return V(e).pipe(Re(t),Rt(t))}(e,t);if(Is(e))return xo(e,t);if(Ar(e))return function Eu(e,t){return new Hn(n=>{let r;return Me(n,t,()=>{r=e[Xl](),Me(n,t,()=>{let l,u;try{({value:l,done:u}=r.next())}catch(_){return void n.error(_)}u?n.complete():n.next(l)},0,!0)}),()=>_i(null==r?void 0:r.return)&&r.return()})}(e,t);if(le(e))return function Tu(e,t){return xo(vl(e),t)}(e,t)}throw as(e)}(e,t):V(e)}function rn(e,t,...n){if(!0===t)return void e();if(!1===t)return;const r=new Ma({next:()=>{r.unsubscribe(),e()}});return t(...n).subscribe(r)}function wn(e){for(let t in e)if(e[t]===wn)return t;throw Error("Could not find renamed property on target object.")}function Ct(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(Ct).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function Da(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const Ql=wn({__forward_ref__:wn});function Ia(e){return e.__forward_ref__=Ia,e.toString=function(){return Ct(this())},e}function Ut(e){return function ci(e){return"function"==typeof e&&e.hasOwnProperty(Ql)&&e.__forward_ref__===Ia}(e)?e():e}class En extends Error{constructor(t,n){super(function xl(e,t){return`NG0${Math.abs(e)}${t?": "+t:""}`}(t,n)),this.code=t}}function qt(e){return"string"==typeof e?e:null==e?"":String(e)}function Ui(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():qt(e)}function bl(e,t){const n=t?` in ${t}`:"";throw new En(-201,`No provider for ${Ui(e)} found${n}`)}function tr(e,t){null==e&&function Zn(e,t,n,r){throw new Error(`ASSERTION ERROR: ${e}`+(null==r?"":` [Expected=> ${n} ${r} ${t} <=Actual]`))}(t,e,null,"!=")}function Sn(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Li(e){return{providers:e.providers||[],imports:e.imports||[]}}function Jr(e){return Jl(e,Iu)||Jl(e,tc)}function Jl(e,t){return e.hasOwnProperty(t)?e[t]:null}function ec(e){return e&&(e.hasOwnProperty(Vd)||e.hasOwnProperty(Pu))?e[Vd]:null}const Iu=wn({\u0275prov:wn}),Vd=wn({\u0275inj:wn}),tc=wn({ngInjectableDef:wn}),Pu=wn({ngInjectorDef:wn});var nn=(()=>((nn=nn||{})[nn.Default=0]="Default",nn[nn.Host=1]="Host",nn[nn.Self=2]="Self",nn[nn.SkipSelf=4]="SkipSelf",nn[nn.Optional=8]="Optional",nn))();let Ud;function ia(e){const t=Ud;return Ud=e,t}function eo(e,t,n){const r=Jr(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&nn.Optional?null:void 0!==t?t:void bl(Ct(e),"Injector")}function ls(e){return{toString:e}.toString()}var to=(()=>((to=to||{})[to.OnPush=0]="OnPush",to[to.Default=1]="Default",to))(),no=(()=>{return(e=no||(no={}))[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",no;var e})();const Pa="undefined"!=typeof globalThis&&globalThis,ra="undefined"!=typeof window&&window,ic="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Vn=Pa||"undefined"!=typeof global&&global||ra||ic,fn={},Wn=[],Cl=wn({\u0275cmp:wn}),rc=wn({\u0275dir:wn}),_n=wn({\u0275pipe:wn}),Oa=wn({\u0275mod:wn}),io=wn({\u0275fac:wn}),ka=wn({__NG_ELEMENT_ID__:wn});let Hd=0;function ti(e){return ls(()=>{const n={},r={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===to.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||Wn,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||no.Emulated,id:"c",styles:e.styles||Wn,_:null,setInput:null,schemas:e.schemas||null,tView:null},l=e.directives,u=e.features,_=e.pipes;return r.id+=Hd++,r.inputs=ku(e.inputs,n),r.outputs=ku(e.outputs),u&&u.forEach(v=>v(r)),r.directiveDefs=l?()=>("function"==typeof l?l():l).map(Al):null,r.pipeDefs=_?()=>("function"==typeof _?_():_).map(Qh):null,r})}function Al(e){return Wi(e)||function Ps(e){return e[rc]||null}(e)}function Qh(e){return function Lo(e){return e[_n]||null}(e)}const Ou={};function hr(e){return ls(()=>{const t={type:e.type,bootstrap:e.bootstrap||Wn,declarations:e.declarations||Wn,imports:e.imports||Wn,exports:e.exports||Wn,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(Ou[e.id]=e.type),t})}function ku(e,t){if(null==e)return fn;const n={};for(const r in e)if(e.hasOwnProperty(r)){let l=e[r],u=l;Array.isArray(l)&&(u=l[1],l=l[0]),n[l]=r,t&&(t[l]=u)}return n}const zi=ti;function Er(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function Wi(e){return e[Cl]||null}function nr(e,t){const n=e[Oa]||null;if(!n&&!0===t)throw new Error(`Type ${Ct(e)} does not have '\u0275mod' property.`);return n}function bo(e){return Array.isArray(e)&&"object"==typeof e[1]}function wo(e){return Array.isArray(e)&&!0===e[1]}function cc(e){return 0!=(8&e.flags)}function Ml(e){return 2==(2&e.flags)}function La(e){return 1==(1&e.flags)}function $i(e){return null!==e.template}function uc(e){return 0!=(512&e[2])}function mt(e,t){return e.hasOwnProperty(io)?e[io]:null}class ao{constructor(t,n,r){this.previousValue=t,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function ds(){return Bu}function Bu(e){return e.type.prototype.ngOnChanges&&(e.setInput=Fo),mc}function mc(){const e=Il(this),t=null==e?void 0:e.current;if(t){const n=e.previous;if(n===fn)e.previous=t;else for(let r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function Fo(e,t,n,r){const l=Il(e)||function gc(e,t){return e[Nu]=t}(e,{previous:fn,current:null}),u=l.current||(l.current={}),_=l.previous,v=this.declaredInputs[n],w=_[v];u[v]=new ao(w&&w.currentValue,t,_===fn),e[r]=t}ds.ngInherit=!0;const Nu="__ngSimpleChanges__";function Il(e){return e[Nu]||null}let _c;function oi(e){return!!e.listen}const Qd={createRenderer:(e,t)=>function Na(){return void 0!==_c?_c:"undefined"!=typeof document?document:void 0}()};function Ii(e){for(;Array.isArray(e);)e=e[0];return e}function ks(e,t){return Ii(t[e])}function Mr(e,t){return Ii(t[e.index])}function Vu(e,t){return e.data[t]}function Rs(e,t){return e[t]}function Nr(e,t){const n=t[e];return bo(n)?n:n[0]}function Uu(e){return 4==(4&e[2])}function Gi(e){return 128==(128&e[2])}function No(e,t){return null==t?null:e[t]}function vc(e){e[18]=0}function $u(e,t){e[5]+=t;let n=e,r=e[3];for(;null!==r&&(1===t&&1===n[5]||-1===t&&0===n[5]);)r[5]+=t,n=r,r=r[3]}const Gt={lFrame:fp(null),bindingsEnabled:!0};function Jd(){return Gt.bindingsEnabled}function it(){return Gt.lFrame.lView}function Tn(){return Gt.lFrame.tView}function Fi(){let e=eh();for(;null!==e&&64===e.type;)e=e.parent;return e}function eh(){return Gt.lFrame.currentTNode}function jo(e,t){const n=Gt.lFrame;n.currentTNode=e,n.isParent=t}function ja(){return Gt.lFrame.isParent}function kl(){Gt.lFrame.isParent=!1}function pr(){const e=Gt.lFrame;let t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function ca(){return Gt.lFrame.bindingIndex++}function dp(e,t){const n=Gt.lFrame;n.bindingIndex=n.bindingRootIndex=e,Zu(t)}function Zu(e){Gt.lFrame.currentDirectiveIndex=e}function th(){return Gt.lFrame.currentQueryIndex}function Cc(e){Gt.lFrame.currentQueryIndex=e}function pp(e){const t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function Wu(e,t,n){if(n&nn.SkipSelf){let l=t,u=e;for(;!(l=l.parent,null!==l||n&nn.Host||(l=pp(u),null===l||(u=u[15],10&l.type))););if(null===l)return!1;t=l,e=u}const r=Gt.lFrame=Ac();return r.currentTNode=t,r.lView=e,!0}function Ll(e){const t=Ac(),n=e[1];Gt.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function Ac(){const e=Gt.lFrame,t=null===e?null:e.child;return null===t?fp(e):t}function fp(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function mp(){const e=Gt.lFrame;return Gt.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const Ec=mp;function ua(){const e=mp();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function d(){return Gt.lFrame.selectedIndex}function g(e){Gt.lFrame.selectedIndex=e}function x(){const e=Gt.lFrame;return Vu(e.tView,e.selectedIndex)}function U(e,t){for(let n=t.directiveStart,r=t.directiveEnd;n<r;n++){const u=e.data[n].type.prototype,{ngAfterContentInit:_,ngAfterContentChecked:v,ngAfterViewInit:w,ngAfterViewChecked:T,ngOnDestroy:S}=u;_&&(e.contentHooks||(e.contentHooks=[])).push(-n,_),v&&((e.contentHooks||(e.contentHooks=[])).push(n,v),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,v)),w&&(e.viewHooks||(e.viewHooks=[])).push(-n,w),T&&((e.viewHooks||(e.viewHooks=[])).push(n,T),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,T)),null!=S&&(e.destroyHooks||(e.destroyHooks=[])).push(n,S)}}function W(e,t,n){J(e,t,3,n)}function ne(e,t,n,r){(3&e[2])===n&&J(e,t,n,r)}function K(e,t){let n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function J(e,t,n,r){const u=null!=r?r:-1,_=t.length-1;let v=0;for(let w=void 0!==r?65535&e[18]:0;w<_;w++)if("number"==typeof t[w+1]){if(v=t[w],null!=r&&v>=r)break}else t[w]<0&&(e[18]+=65536),(v<u||-1==u)&&(te(e,n,t,w),e[18]=(4294901760&e[18])+w+2),w++}function te(e,t,n,r){const l=n[r]<0,u=n[r+1],v=e[l?-n[r]:n[r]];if(l){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{u.call(v)}finally{}}}else try{u.call(v)}finally{}}const X=-1;class re{constructor(t,n,r){this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}}function Je(e,t,n){const r=oi(e);let l=0;for(;l<n.length;){const u=n[l];if("number"==typeof u){if(0!==u)break;l++;const _=n[l++],v=n[l++],w=n[l++];r?e.setAttribute(t,v,w,_):t.setAttributeNS(_,v,w)}else{const _=u,v=n[++l];je(_)?r&&e.setProperty(t,_,v):r?e.setAttribute(t,_,v):t.setAttribute(_,v),l++}}return l}function Ee(e){return 3===e||4===e||6===e}function je(e){return 64===e.charCodeAt(0)}function Ge(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else{let n=-1;for(let r=0;r<t.length;r++){const l=t[r];"number"==typeof l?n=l:0===n||at(e,n,l,null,-1===n||2===n?t[++r]:null)}}return e}function at(e,t,n,r,l){let u=0,_=e.length;if(-1===t)_=-1;else for(;u<e.length;){const v=e[u++];if("number"==typeof v){if(v===t){_=-1;break}if(v>t){_=u-1;break}}}for(;u<e.length;){const v=e[u];if("number"==typeof v)break;if(v===n){if(null===r)return void(null!==l&&(e[u+1]=l));if(r===e[u+1])return void(e[u+2]=l)}u++,null!==r&&u++,null!==l&&u++}-1!==_&&(e.splice(_,0,t),u=_+1),e.splice(u++,0,n),null!==r&&e.splice(u++,0,r),null!==l&&e.splice(u++,0,l)}function ke(e){return e!==X}function et(e){return 32767&e}function ht(e,t){let n=function He(e){return e>>16}(e),r=t;for(;n>0;)r=r[15],n--;return r}let lt=!0;function wt(e){const t=lt;return lt=e,t}let Et=0;function pn(e,t){const n=di(e,t);if(-1!==n)return n;const r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,Kn(r.data,e),Kn(t,null),Kn(r.blueprint,null));const l=Dn(e,t),u=e.injectorIndex;if(ke(l)){const _=et(l),v=ht(l,t),w=v[1].data;for(let T=0;T<8;T++)t[u+T]=v[_+T]|w[_+T]}return t[u+8]=l,u}function Kn(e,t){e.push(0,0,0,0,0,0,0,0,t)}function di(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function Dn(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,r=null,l=t;for(;null!==l;){const u=l[1],_=u.type;if(r=2===_?u.declTNode:1===_?l[6]:null,null===r)return X;if(n++,l=l[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return X}function Bi(e,t,n){!function Wt(e,t,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(ka)&&(r=n[ka]),null==r&&(r=n[ka]=Et++);const l=255&r;t.data[e+(l>>5)]|=1<<l}(e,t,n)}function hs(e,t,n){if(n&nn.Optional)return e;bl(t,"NodeInjector")}function ni(e,t,n,r){if(n&nn.Optional&&void 0===r&&(r=null),0==(n&(nn.Self|nn.Host))){const l=e[9],u=ia(void 0);try{return l?l.get(t,r,n&nn.Optional):eo(t,r,n&nn.Optional)}finally{ia(u)}}return hs(r,t,n)}function si(e,t,n,r=nn.Default,l){if(null!==e){const u=function $a(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(ka)?e[ka]:void 0;return"number"==typeof t?t>=0?255&t:Pi:t}(n);if("function"==typeof u){if(!Wu(t,e,r))return r&nn.Host?hs(l,n,r):ni(t,n,r,l);try{const _=u(r);if(null!=_||r&nn.Optional)return _;bl(n)}finally{Ec()}}else if("number"==typeof u){let _=null,v=di(e,t),w=X,T=r&nn.Host?t[16][6]:null;for((-1===v||r&nn.SkipSelf)&&(w=-1===v?Dn(e,t):t[v+8],w!==X&&da(r,!1)?(_=t[1],v=et(w),t=ht(w,t)):v=-1);-1!==v;){const S=t[1];if(mr(u,v,S.data)){const I=fr(v,t,n,_,r,T);if(I!==on)return I}w=t[v+8],w!==X&&da(r,t[1].data[v+8]===T)&&mr(u,v,t)?(_=S,v=et(w),t=ht(w,t)):v=-1}}}return ni(t,n,r,l)}const on={};function Pi(){return new Ao(Fi(),it())}function fr(e,t,n,r,l,u){const _=t[1],v=_.data[e+8],S=Fn(v,_,n,null==r?Ml(v)&&lt:r!=_&&0!=(3&v.type),l&nn.Host&&u===v);return null!==S?Ni(t,_,S,v):on}function Fn(e,t,n,r,l){const u=e.providerIndexes,_=t.data,v=1048575&u,w=e.directiveStart,S=u>>20,L=l?v+S:e.directiveEnd;for(let j=r?v:v+S;j<L;j++){const Z=_[j];if(j<w&&n===Z||j>=w&&Z.type===n)return j}if(l){const j=_[w];if(j&&$i(j)&&j.type===n)return w}return null}function Ni(e,t,n,r){let l=e[n];const u=t.data;if(function ie(e){return e instanceof re}(l)){const _=l;_.resolving&&function ta(e,t){const n=t?`. Dependency path: ${t.join(" > ")} > ${e}`:"";throw new En(-200,`Circular dependency in DI detected for ${e}${n}`)}(Ui(u[n]));const v=wt(_.canSeeViewProviders);_.resolving=!0;const w=_.injectImpl?ia(_.injectImpl):null;Wu(e,r,nn.Default);try{l=e[n]=_.factory(void 0,u,e,r),t.firstCreatePass&&n>=r.directiveStart&&function F(e,t,n){const{ngOnChanges:r,ngOnInit:l,ngDoCheck:u}=t.type.prototype;if(r){const _=Bu(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,_),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,_)}l&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,l),u&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,u),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,u))}(n,u[n],t)}finally{null!==w&&ia(w),wt(v),_.resolving=!1,Ec()}}return l}function mr(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function da(e,t){return!(e&nn.Self||e&nn.Host&&t)}class Ao{constructor(t,n){this._tNode=t,this._lView=n}get(t,n,r){return si(this._tNode,this._lView,t,r,n)}}function Go(e){return function $o(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;const n=e.attrs;if(n){const r=n.length;let l=0;for(;l<r;){const u=n[l];if(Ee(u))break;if(0===u)l+=2;else if("number"==typeof u)for(l++;l<r&&"string"==typeof n[l];)l++;else{if(u===t)return n[l+1];l+=2}}}return null}(Fi(),e)}const ps="__parameters__";function Mc(e,t,n){return ls(()=>{const r=function gp(e){return function(...n){if(e){const r=e(...n);for(const l in r)this[l]=r[l]}}}(t);function l(...u){if(this instanceof l)return r.apply(this,u),this;const _=new l(...u);return v.annotation=_,v;function v(w,T,S){const I=w.hasOwnProperty(ps)?w[ps]:Object.defineProperty(w,ps,{value:[]})[ps];for(;I.length<=S;)I.push(null);return(I[S]=I[S]||[]).push(_),w}}return n&&(l.prototype=Object.create(n.prototype)),l.prototype.ngMetadataName=e,l.annotationCls=l,l})}class Bn{constructor(t,n){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Sn({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Kg=new Bn("AnalyzeForEntryComponents");function Xi(e,t){void 0===t&&(t=e);for(let n=0;n<e.length;n++){let r=e[n];Array.isArray(r)?(t===e&&(t=e.slice(0,n)),Xi(r,t)):t!==e&&t.push(r)}return t}function Ho(e,t){e.forEach(n=>Array.isArray(n)?Ho(n,t):t(n))}function Qf(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function ih(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function rh(e,t){const n=[];for(let r=0;r<e;r++)n.push(t);return n}function Oi(e,t,n){let r=qo(e,t);return r>=0?e[1|r]=n:(r=~r,function Kf(e,t,n,r){let l=e.length;if(l==t)e.push(n,r);else if(1===l)e.push(r,e[0]),e[0]=n;else{for(l--,e.push(e[l-1],e[l]);l>t;)e[l]=e[l-2],l--;e[t]=n,e[t+1]=r}}(e,r,t,n)),r}function pa(e,t){const n=qo(e,t);if(n>=0)return e[1|n]}function qo(e,t){return function t_(e,t,n){let r=0,l=e.length>>n;for(;l!==r;){const u=r+(l-r>>1),_=e[u<<n];if(t===_)return u<<n;_>t?l=u:r=u+1}return~(l<<n)}(e,t,1)}const zt={},fa="__NG_DI_FLAG__",Ku="ngTempTokenPath",i_=/\n/gm,Ls="__source",Ha=wn({provide:String,useValue:wn});let jr;function Zo(e){const t=jr;return jr=e,t}function gr(e,t=nn.Default){if(void 0===jr)throw new En(203,"");return null===jr?eo(e,void 0,t):jr.get(e,t&nn.Optional?null:void 0,t)}function Jt(e,t=nn.Default){return(function Wh(){return Ud}()||gr)(Ut(e),t)}const r_=Jt;function zl(e){const t=[];for(let n=0;n<e.length;n++){const r=Ut(e[n]);if(Array.isArray(r)){if(0===r.length)throw new En(900,"");let l,u=nn.Default;for(let _=0;_<r.length;_++){const v=r[_],w=o_(v);"number"==typeof w?-1===w?l=v.token:u|=w:l=v}t.push(Jt(l,u))}else t.push(Jt(r))}return t}function Sc(e,t){return e[fa]=t,e.prototype[fa]=t,e}function o_(e){return e[fa]}const Ju=Sc(Mc("Inject",e=>({token:e})),-1),qa=Sc(Mc("Optional"),8),Wo=Sc(Mc("SkipSelf"),4);class od{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function Fl(e){return e instanceof od?e.changingThisBreaksApplicationSecurity:e}const Vr=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,am=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var hi=(()=>((hi=hi||{})[hi.NONE=0]="NONE",hi[hi.HTML=1]="HTML",hi[hi.STYLE=2]="STYLE",hi[hi.SCRIPT=3]="SCRIPT",hi[hi.URL=4]="URL",hi[hi.RESOURCE_URL=5]="RESOURCE_URL",hi))();function ad(e){const t=function Za(){const e=it();return e&&e[12]}();return t?t.sanitize(hi.URL,e)||"":function Lc(e,t){const n=function p_(e){return e instanceof od&&e.getTypeName()||null}(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===t}(e,"URL")?Fl(e):function Ai(e){return(e=String(e)).match(Vr)||e.match(am)?e:"unsafe:"+e}(qt(e))}const E_="__ngContext__";function $r(e,t){e[E_]=t}function hm(e){const t=function uh(e){return e[E_]||null}(e);return t?Array.isArray(t)?t:t.lView:null}function Nc(e){return e.ngOriginalError}function gm(e,...t){e.error(...t)}class dh{constructor(){this._console=console}handleError(t){const n=this._findOriginalError(t),r=function mm(e){return e&&e.ngErrorLogger||gm}(t);r(this._console,"ERROR",t),n&&r(this._console,"ORIGINAL ERROR",n)}_findOriginalError(t){let n=t&&Nc(t);for(;n&&Nc(n);)n=Nc(n);return n||null}}const b0=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Vn))();function ho(e){return e instanceof Function?e():e}var Yo=(()=>((Yo=Yo||{})[Yo.Important=1]="Important",Yo[Yo.DashCase=2]="DashCase",Yo))();function Wa(e,t){return undefined(e,t)}function ph(e){const t=e[3];return wo(t)?t[3]:t}function jp(e){return bm(e[13])}function Vc(e){return bm(e[4])}function bm(e){for(;null!==e&&!wo(e);)e=e[4];return e}function Uc(e,t,n,r,l){if(null!=r){let u,_=!1;wo(r)?u=r:bo(r)&&(_=!0,r=r[0]);const v=Ii(r);0===e&&null!==n?null==l?F_(t,n,v):Gc(t,n,v,l||null,!0):1===e&&null!==n?Gc(t,n,v,l||null,!0):2===e?function V_(e,t,n){const r=Hc(e,t);r&&function S0(e,t,n,r){oi(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}(t,v,_):3===e&&t.destroyNode(v),null!=u&&function hd(e,t,n,r,l){const u=n[7];u!==Ii(n)&&Uc(t,e,r,u,l);for(let v=10;v<n.length;v++){const w=n[v];Mo(w[1],w,e,t,r,u)}}(t,e,u,n,l)}}function Up(e,t,n){if(oi(e))return e.createElement(t,n);{const r=null!==n?function ju(e){const t=e.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(n):null;return null===r?e.createElement(t):e.createElementNS(r,t)}}function Dr(e,t){const n=e[9],r=n.indexOf(t),l=t[3];1024&t[2]&&(t[2]&=-1025,$u(l,-1)),n.splice(r,1)}function $c(e,t){if(e.length<=10)return;const n=10+t,r=e[n];if(r){const l=r[17];null!==l&&l!==e&&Dr(l,r),t>0&&(e[n-1][4]=r[4]);const u=ih(e,10+t);!function P_(e,t){Mo(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);const _=u[19];null!==_&&_.detachView(u[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function dd(e,t){if(!(256&t[2])){const n=t[11];oi(n)&&n.destroyNode&&Mo(e,t,n,3,null,null),function O_(e){let t=e[13];if(!t)return Gp(e[1],e);for(;t;){let n=null;if(bo(t))n=t[13];else{const r=t[10];r&&(n=r)}if(!n){for(;t&&!t[4]&&t!==e;)bo(t)&&Gp(t[1],t),t=t[3];null===t&&(t=e),bo(t)&&Gp(t[1],t),n=t&&t[4]}t=n}}(t)}}function Gp(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function R_(e,t){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let r=0;r<n.length;r+=2){const l=t[n[r]];if(!(l instanceof re)){const u=n[r+1];if(Array.isArray(u))for(let _=0;_<u.length;_+=2){const v=l[u[_]],w=u[_+1];try{w.call(v)}finally{}}else try{u.call(l)}finally{}}}}(e,t),function Hp(e,t){const n=e.cleanup,r=t[7];let l=-1;if(null!==n)for(let u=0;u<n.length-1;u+=2)if("string"==typeof n[u]){const _=n[u+1],v="function"==typeof _?_(t):Ii(t[_]),w=r[l=n[u+2]],T=n[u+3];"boolean"==typeof T?v.removeEventListener(n[u],w,T):T>=0?r[l=T]():r[l=-T].unsubscribe(),u+=2}else{const _=r[l=n[u+1]];n[u].call(_)}if(null!==r){for(let u=l+1;u<r.length;u++)r[u]();t[7]=null}}(e,t),1===t[1].type&&oi(t[11])&&t[11].destroy();const n=t[17];if(null!==n&&wo(t[3])){n!==t[3]&&Dr(n,t);const r=t[19];null!==r&&r.detachView(e)}}}function L_(e,t,n){return function z_(e,t,n){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[0];if(2&r.flags){const l=e.data[r.directiveStart].encapsulation;if(l===no.None||l===no.Emulated)return null}return Mr(r,n)}(e,t.parent,n)}function Gc(e,t,n,r,l){oi(e)?e.insertBefore(t,n,r,l):t.insertBefore(n,r,l)}function F_(e,t,n){oi(e)?e.appendChild(t,n):t.appendChild(n)}function B_(e,t,n,r,l){null!==r?Gc(e,t,n,r,l):F_(e,t,n)}function Hc(e,t){return oi(e)?e.parentNode(t):t.parentNode}function Cm(e,t,n){return Em(e,t,n)}let Em=function Am(e,t,n){return 40&e.type?Mr(e,n):null};function qp(e,t,n,r){const l=L_(e,r,t),u=t[11],v=Cm(r.parent||t[6],r,t);if(null!=l)if(Array.isArray(n))for(let w=0;w<n.length;w++)B_(u,l,n[w],v,!1);else B_(u,l,n,v,!1)}function Zp(e,t){if(null!==t){const n=t.type;if(3&n)return Mr(t,e);if(4&n)return Wp(-1,e[t.index]);if(8&n){const r=t.child;if(null!==r)return Zp(e,r);{const l=e[t.index];return wo(l)?Wp(-1,l):Ii(l)}}if(32&n)return Wa(t,e)()||Ii(e[t.index]);{const r=j_(e,t);return null!==r?Array.isArray(r)?r[0]:Zp(ph(e[16]),r):Zp(e,t.next)}}return null}function j_(e,t){return null!==t?e[16][6].projection[t.projection]:null}function Wp(e,t){const n=10+e+1;if(n<t.length){const r=t[n],l=r[1].firstChild;if(null!==l)return Zp(r,l)}return t[7]}function Qi(e,t,n,r,l,u,_){for(;null!=n;){const v=r[n.index],w=n.type;if(_&&0===t&&(v&&$r(Ii(v),r),n.flags|=4),64!=(64&n.flags))if(8&w)Qi(e,t,n.child,r,l,u,!1),Uc(t,e,l,v,u);else if(32&w){const T=Wa(n,r);let S;for(;S=T();)Uc(t,e,l,S,u);Uc(t,e,l,v,u)}else 16&w?fh(e,t,r,n,l,u):Uc(t,e,l,v,u);n=_?n.projectionNext:n.next}}function Mo(e,t,n,r,l,u){Qi(n,r,e.firstChild,t,l,u,!1)}function fh(e,t,n,r,l,u){const _=n[16],w=_[6].projection[r.projection];if(Array.isArray(w))for(let T=0;T<w.length;T++)Uc(t,e,l,w[T],u);else Qi(e,t,w,_[3],l,u,!0)}function U_(e,t,n){oi(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function qc(e,t,n){oi(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function $_(e,t,n){let r=e.length;for(;;){const l=e.indexOf(t,n);if(-1===l)return l;if(0===l||e.charCodeAt(l-1)<=32){const u=t.length;if(l+u===r||e.charCodeAt(l+u)<=32)return l}n=l+1}}const Sm="ng-template";function G_(e,t,n){let r=0;for(;r<e.length;){let l=e[r++];if(n&&"class"===l){if(l=e[r],-1!==$_(l.toLowerCase(),t,0))return!0}else if(1===l){for(;r<e.length&&"string"==typeof(l=e[r++]);)if(l.toLowerCase()===t)return!0;return!1}}return!1}function pd(e){return 4===e.type&&e.value!==Sm}function Jn(e,t,n){return t===(4!==e.type||n?e.value:Sm)}function Dm(e,t,n){let r=4;const l=e.attrs||[],u=function q_(e){for(let t=0;t<e.length;t++)if(Ee(e[t]))return t;return e.length}(l);let _=!1;for(let v=0;v<t.length;v++){const w=t[v];if("number"!=typeof w){if(!_)if(4&r){if(r=2|1&r,""!==w&&!Jn(e,w,n)||""===w&&1===t.length){if(ms(r))return!1;_=!0}}else{const T=8&r?w:t[++v];if(8&r&&null!==e.attrs){if(!G_(e.attrs,T,n)){if(ms(r))return!1;_=!0}continue}const I=H_(8&r?"class":w,l,pd(e),n);if(-1===I){if(ms(r))return!1;_=!0;continue}if(""!==T){let L;L=I>u?"":l[I+1].toLowerCase();const j=8&r?L:null;if(j&&-1!==$_(j,T,0)||2&r&&T!==L){if(ms(r))return!1;_=!0}}}}else{if(!_&&!ms(r)&&!ms(w))return!1;if(_&&ms(w))continue;_=!1,r=w|1&r}}return ms(r)||_}function ms(e){return 0==(1&e)}function H_(e,t,n,r){if(null===t)return-1;let l=0;if(r||!n){let u=!1;for(;l<t.length;){const _=t[l];if(_===e)return l;if(3===_||6===_)u=!0;else{if(1===_||2===_){let v=t[++l];for(;"string"==typeof v;)v=t[++l];continue}if(4===_)break;if(0===_){l+=4;continue}}l+=u?1:2}return-1}return function P0(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function ma(e,t,n=!1){for(let r=0;r<t.length;r++)if(Dm(e,t[r],n))return!0;return!1}function O0(e,t){e:for(let n=0;n<t.length;n++){const r=t[n];if(e.length===r.length){for(let l=0;l<e.length;l++)if(e[l]!==r[l])continue e;return!0}}return!1}function Z_(e,t){return e?":not("+t.trim()+")":t}function k0(e){let t=e[0],n=1,r=2,l="",u=!1;for(;n<e.length;){let _=e[n];if("string"==typeof _)if(2&r){const v=e[++n];l+="["+_+(v.length>0?'="'+v+'"':"")+"]"}else 8&r?l+="."+_:4&r&&(l+=" "+_);else""!==l&&!ms(_)&&(t+=Z_(u,l),l=""),r=_,u=u||!ms(r);n++}return""!==l&&(t+=Z_(u,l)),t}const hn={};function Bt(e){W_(Tn(),it(),d()+e,!1)}function W_(e,t,n,r){if(!r)if(3==(3&t[2])){const u=e.preOrderCheckHooks;null!==u&&W(t,u,n)}else{const u=e.preOrderHooks;null!==u&&ne(t,u,0,n)}g(n)}function Ya(e,t){return e<<17|t<<2}function gs(e){return e>>17&32767}function Im(e){return 2|e}function js(e){return(131068&e)>>2}function gh(e,t){return-131069&e|t<<2}function po(e){return 1|e}function rf(e,t){const n=e.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const l=n[r],u=n[r+1];if(-1!==u){const _=e.data[u];Cc(l),_.contentQueries(2,t[u],u)}}}function gd(e,t,n,r,l,u,_,v,w,T){const S=t.blueprint.slice();return S[0]=l,S[2]=140|r,vc(S),S[3]=S[15]=e,S[8]=n,S[10]=_||e&&e[10],S[11]=v||e&&e[11],S[12]=w||e&&e[12]||null,S[9]=T||e&&e[9]||null,S[6]=u,S[16]=2==t.type?e[16]:S,S}function Yc(e,t,n,r,l){let u=e.data[t];if(null===u)u=function _d(e,t,n,r,l){const u=eh(),_=ja(),w=e.data[t]=function ga(e,t,n,r,l,u){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:l,attrs:u,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,_?u:u&&u.parent,n,t,r,l);return null===e.firstChild&&(e.firstChild=w),null!==u&&(_?null==u.child&&null!==w.parent&&(u.child=w):null===u.next&&(u.next=w)),w}(e,t,n,r,l),function bc(){return Gt.lFrame.inI18n}()&&(u.flags|=64);else if(64&u.type){u.type=n,u.value=r,u.attrs=l;const _=function Ol(){const e=Gt.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();u.injectorIndex=null===_?-1:_.injectorIndex}return jo(u,!0),u}function Nl(e,t,n,r){if(0===n)return-1;const l=t.length;for(let u=0;u<n;u++)t.push(r),e.blueprint.push(r),e.data.push(null);return l}function yh(e,t,n){Ll(t);try{const r=e.viewQuery;null!==r&&wd(1,r,n);const l=e.template;null!==l&&Vm(e,t,l,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&rf(e,t),e.staticViewQueries&&wd(2,e.viewQuery,n);const u=e.components;null!==u&&function Bl(e,t){for(let n=0;n<t.length;n++)py(e,t[n])}(t,u)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[2]&=-5,ua()}}function yd(e,t,n,r){const l=t[2];if(256!=(256&l)){Ll(t);try{vc(t),function qu(e){return Gt.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&Vm(e,t,n,2,r);const _=3==(3&l);if(_){const T=e.preOrderCheckHooks;null!==T&&W(t,T,null)}else{const T=e.preOrderHooks;null!==T&&ne(t,T,0,null),K(t,0)}if(function lf(e){for(let t=jp(e);null!==t;t=Vc(t)){if(!t[2])continue;const n=t[9];for(let r=0;r<n.length;r++){const l=n[r],u=l[3];0==(1024&l[2])&&$u(u,1),l[2]|=1024}}}(t),function bd(e){for(let t=jp(e);null!==t;t=Vc(t))for(let n=10;n<t.length;n++){const r=t[n],l=r[1];Gi(r)&&yd(l,r,l.template,r[8])}}(t),null!==e.contentQueries&&rf(e,t),_){const T=e.contentCheckHooks;null!==T&&W(t,T)}else{const T=e.contentHooks;null!==T&&ne(t,T,1),K(t,1)}!function Z0(e,t){const n=e.hostBindingOpCodes;if(null!==n)try{for(let r=0;r<n.length;r++){const l=n[r];if(l<0)g(~l);else{const u=l,_=n[++r],v=n[++r];dp(_,u),v(2,t[u])}}}finally{g(-1)}}(e,t);const v=e.components;null!==v&&function W0(e,t){for(let n=0;n<t.length;n++)ex(e,t[n])}(t,v);const w=e.viewQuery;if(null!==w&&wd(2,w,r),_){const T=e.viewCheckHooks;null!==T&&W(t,T)}else{const T=e.viewHooks;null!==T&&ne(t,T,2),K(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),t[2]&=-73,1024&t[2]&&(t[2]&=-1025,$u(t[3],-1))}finally{ua()}}}function ry(e,t,n,r){const l=t[10],_=Uu(t);try{!_&&l.begin&&l.begin(),_&&yh(e,t,r),yd(e,t,n,r)}finally{!_&&l.end&&l.end()}}function Vm(e,t,n,r,l){const u=d(),_=2&r;try{g(-1),_&&t.length>20&&W_(e,t,20,!1),n(r,l)}finally{g(u)}}function vd(e,t,n){if(cc(t)){const l=t.directiveEnd;for(let u=t.directiveStart;u<l;u++){const _=e.data[u];_.contentQueries&&_.contentQueries(1,n[u],u)}}}function Vs(e,t,n){!Jd()||(function ly(e,t,n,r){const l=n.directiveStart,u=n.directiveEnd;e.firstCreatePass||pn(n,t),$r(r,t);const _=n.initialInputs;for(let v=l;v<u;v++){const w=e.data[v],T=$i(w);T&&Ah(t,n,w);const S=Ni(t,e,v,n);$r(S,t),null!==_&&Eh(0,v-l,S,w,0,_),T&&(Nr(n.index,t)[8]=S)}}(e,t,n,Mr(n,t)),128==(128&n.flags)&&function cy(e,t,n){const r=n.directiveStart,l=n.directiveEnd,_=n.index,v=function hp(){return Gt.lFrame.currentDirectiveIndex}();try{g(_);for(let w=r;w<l;w++){const T=e.data[w],S=t[w];Zu(w),(null!==T.hostBindings||0!==T.hostVars||null!==T.hostAttrs)&&uy(T,S)}}finally{g(-1),Zu(v)}}(e,t,n))}function vh(e,t,n=Mr){const r=t.localNames;if(null!==r){let l=t.index+1;for(let u=0;u<r.length;u+=2){const _=r[u+1],v=-1===_?n(t,e):e[_];e[l++]=v}}}function Xc(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=So(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function So(e,t,n,r,l,u,_,v,w,T){const S=20+r,I=S+l,L=function Us(e,t){const n=[];for(let r=0;r<t;r++)n.push(r<e?null:hn);return n}(S,I),j="function"==typeof T?T():T;return L[1]={type:e,blueprint:L,template:n,queries:null,viewQuery:v,declTNode:t,data:L.slice().fill(null,S),bindingStartIndex:S,expandoStartIndex:I,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof u?u():u,pipeRegistry:"function"==typeof _?_():_,firstChild:null,schemas:w,consts:j,incompleteFirstPass:!1}}function of(e,t,n,r){const l=df(t);null===n?l.push(r):(l.push(n),e.firstCreatePass&&hf(e).push(r,l.length-1))}function Um(e,t,n){for(let r in e)if(e.hasOwnProperty(r)){const l=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,l):n[r]=[t,l]}return n}function wh(e,t,n,r){let l=!1;if(Jd()){const u=function K0(e,t,n){const r=e.directiveRegistry;let l=null;if(r)for(let u=0;u<r.length;u++){const _=r[u];ma(n,_.selectors,!1)&&(l||(l=[]),Bi(pn(n,t),e,_.type),$i(_)?(qm(e,n),l.unshift(_)):l.push(_))}return l}(e,t,n),_=null===r?null:{"":-1};if(null!==u){l=!0,Ka(n,e.data.length,u.length);for(let S=0;S<u.length;S++){const I=u[S];I.providersResolver&&I.providersResolver(I)}let v=!1,w=!1,T=Nl(e,t,u.length,null);for(let S=0;S<u.length;S++){const I=u[S];n.mergedAttrs=Ge(n.mergedAttrs,I.hostAttrs),dy(e,n,t,T,I),J0(T,I,_),null!==I.contentQueries&&(n.flags|=8),(null!==I.hostBindings||null!==I.hostAttrs||0!==I.hostVars)&&(n.flags|=128);const L=I.type.prototype;!v&&(L.ngOnChanges||L.ngOnInit||L.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),v=!0),!w&&(L.ngOnChanges||L.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),w=!0),T++}!function ay(e,t){const r=t.directiveEnd,l=e.data,u=t.attrs,_=[];let v=null,w=null;for(let T=t.directiveStart;T<r;T++){const S=l[T],I=S.inputs,L=null===u||pd(t)?null:af(I,u);_.push(L),v=Um(I,T,v),w=Um(S.outputs,T,w)}null!==v&&(v.hasOwnProperty("class")&&(t.flags|=16),v.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=_,t.inputs=v,t.outputs=w}(e,n)}_&&function Qc(e,t,n){if(t){const r=e.localNames=[];for(let l=0;l<t.length;l+=2){const u=n[t[l+1]];if(null==u)throw new En(-301,!1);r.push(t[l],u)}}}(n,r,_)}return n.mergedAttrs=Ge(n.mergedAttrs,n.attrs),l}function Hm(e,t,n,r,l,u){const _=u.hostBindings;if(_){let v=e.hostBindingOpCodes;null===v&&(v=e.hostBindingOpCodes=[]);const w=~t.index;(function Ch(e){let t=e.length;for(;t>0;){const n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(v)!=w&&v.push(w),v.push(r,l,_)}}function uy(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function qm(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function J0(e,t,n){if(n){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;$i(t)&&(n[""]=e)}}function Ka(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function dy(e,t,n,r,l){e.data[r]=l;const u=l.factory||(l.factory=mt(l.type)),_=new re(u,$i(l),null);e.blueprint[r]=_,n[r]=_,Hm(e,t,0,r,Nl(e,n,l.hostVars,hn),l)}function Ah(e,t,n){const r=Mr(t,e),l=Xc(n),u=e[10],_=Th(e,gd(e,l,null,n.onPush?64:16,r,t,u,u.createRenderer(r,n),null,null));e[t.index]=_}function Do(e,t,n,r,l,u){const _=Mr(e,t);!function Kc(e,t,n,r,l,u,_){if(null==u)oi(e)?e.removeAttribute(t,l,n):t.removeAttribute(l);else{const v=null==_?qt(u):_(u,r||"",l);oi(e)?e.setAttribute(t,l,v,n):n?t.setAttributeNS(n,l,v):t.setAttribute(l,v)}}(t[11],_,u,e.value,n,r,l)}function Eh(e,t,n,r,l,u){const _=u[t];if(null!==_){const v=r.setInput;for(let w=0;w<_.length;){const T=_[w++],S=_[w++],I=_[w++];null!==v?r.setInput(n,I,T,S):n[S]=I}}}function af(e,t){let n=null,r=0;for(;r<t.length;){const l=t[r];if(0!==l)if(5!==l){if("number"==typeof l)break;e.hasOwnProperty(l)&&(null===n&&(n=[]),n.push(l,e[l],t[r+1])),r+=2}else r+=2;else r+=4}return n}function hy(e,t,n,r){return new Array(e,!0,!1,t,null,0,r,n,null,null)}function ex(e,t){const n=Nr(t,e);if(Gi(n)){const r=n[1];80&n[2]?yd(r,n,r.template,n[8]):n[5]>0&&cf(n)}}function cf(e){for(let r=jp(e);null!==r;r=Vc(r))for(let l=10;l<r.length;l++){const u=r[l];if(1024&u[2]){const _=u[1];yd(_,u,_.template,u[8])}else u[5]>0&&cf(u)}const n=e[1].components;if(null!==n)for(let r=0;r<n.length;r++){const l=Nr(n[r],e);Gi(l)&&l[5]>0&&cf(l)}}function py(e,t){const n=Nr(t,e),r=n[1];(function tx(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])})(r,n),yh(r,n,n[8])}function Th(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function Zm(e){for(;e;){e[2]|=64;const t=ph(e);if(uc(e)&&!t)return e;e=t}return null}function my(e){!function Wm(e){for(let t=0;t<e.components.length;t++){const n=e.components[t],r=hm(n),l=r[1];ry(l,r,l.template,n)}}(e[8])}function wd(e,t,n){Cc(0),t(e,n)}const nx=(()=>Promise.resolve(null))();function df(e){return e[7]||(e[7]=[])}function hf(e){return e.cleanup||(e.cleanup=[])}function gy(e,t){const n=e[9],r=n?n.get(dh,null):null;r&&r.handleError(t)}function pf(e,t,n,r,l){for(let u=0;u<n.length;){const _=n[u++],v=n[u++],w=t[_],T=e.data[_];null!==T.setInput?T.setInput(w,l,r,v):w[v]=l}}function _a(e,t,n){const r=ks(t,e);!function wm(e,t,n){oi(e)?e.setValue(t,n):t.textContent=n}(e[11],r,n)}function Jc(e,t,n){let r=n?e.styles:null,l=n?e.classes:null,u=0;if(null!==t)for(let _=0;_<t.length;_++){const v=t[_];"number"==typeof v?u=v:1==u?l=Da(l,v):2==u&&(r=Da(r,v+": "+t[++_]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=l:e.classesWithoutHost=l}const Qm=new Bn("INJECTOR",-1);class ff{get(t,n=zt){if(n===zt){const r=new Error(`NullInjectorError: No provider for ${Ct(t)}!`);throw r.name="NullInjectorError",r}return n}}const Km=new Bn("Set Injector scope."),el={},Jm={};let eg;function _y(){return void 0===eg&&(eg=new ff),eg}function tg(e,t=null,n=null,r){const l=yy(e,t,n,r);return l._resolveInjectorDefTypes(),l}function yy(e,t=null,n=null,r){return new vy(e,n,t||_y(),r)}class vy{constructor(t,n,r,l=null){this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const u=[];n&&Ho(n,v=>this.processProvider(v,t,n)),Ho([t],v=>this.processInjectorType(v,[],u)),this.records.set(Qm,Qo(void 0,this));const _=this.records.get(Km);this.scope=null!=_?_.value:null,this.source=l||("object"==typeof t?null:Ct(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,n=zt,r=nn.Default){this.assertNotDestroyed();const l=Zo(this),u=ia(void 0);try{if(!(r&nn.SkipSelf)){let v=this.records.get(t);if(void 0===v){const w=function Cy(e){return"function"==typeof e||"object"==typeof e&&e instanceof Bn}(t)&&Jr(t);v=w&&this.injectableDefInScope(w)?Qo(Io(t),el):null,this.records.set(t,v)}if(null!=v)return this.hydrate(t,v)}return(r&nn.Self?_y():this.parent).get(t,n=r&nn.Optional&&n===zt?null:n)}catch(_){if("NullInjectorError"===_.name){if((_[Ku]=_[Ku]||[]).unshift(Ct(t)),l)throw _;return function tm(e,t,n,r){const l=e[Ku];throw t[Ls]&&l.unshift(t[Ls]),e.message=function Kv(e,t,n,r=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;let l=Ct(t);if(Array.isArray(t))l=t.map(Ct).join(" -> ");else if("object"==typeof t){let u=[];for(let _ in t)if(t.hasOwnProperty(_)){let v=t[_];u.push(_+":"+("string"==typeof v?JSON.stringify(v):Ct(v)))}l=`{${u.join(", ")}}`}return`${n}${r?"("+r+")":""}[${l}]: ${e.replace(i_,"\n  ")}`}("\n"+e.message,l,n,r),e.ngTokenPath=l,e[Ku]=null,e}(_,t,"R3InjectorError",this.source)}throw _}finally{ia(u),Zo(l)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((r,l)=>t.push(Ct(l))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new En(205,!1)}processInjectorType(t,n,r){if(!(t=Ut(t)))return!1;let l=ec(t);const u=null==l&&t.ngModule||void 0,_=void 0===u?t:u,v=-1!==r.indexOf(_);if(void 0!==u&&(l=ec(u)),null==l)return!1;if(null!=l.imports&&!v){let S;r.push(_);try{Ho(l.imports,I=>{this.processInjectorType(I,n,r)&&(void 0===S&&(S=[]),S.push(I))})}finally{}if(void 0!==S)for(let I=0;I<S.length;I++){const{ngModule:L,providers:j}=S[I];Ho(j,Z=>this.processProvider(Z,L,j||Wn))}}this.injectorDefTypes.add(_);const w=mt(_)||(()=>new _);this.records.set(_,Qo(w,el));const T=l.providers;if(null!=T&&!v){const S=t;Ho(T,I=>this.processProvider(I,S,T))}return void 0!==u&&void 0!==t.providers}processProvider(t,n,r){let l=eu(t=Ut(t))?t:Ut(t&&t.provide);const u=function jl(e,t,n){return Mh(e)?Qo(void 0,e.useValue):Qo(function $s(e,t,n){let r;if(eu(e)){const l=Ut(e);return mt(l)||Io(l)}if(Mh(e))r=()=>Ut(e.useValue);else if(function by(e){return!(!e||!e.useFactory)}(e))r=()=>e.useFactory(...zl(e.deps||[]));else if(function xy(e){return!(!e||!e.useExisting)}(e))r=()=>Jt(Ut(e.useExisting));else{const l=Ut(e&&(e.useClass||e.provide));if(!function ox(e){return!!e.deps}(e))return mt(l)||Io(l);r=()=>new l(...zl(e.deps))}return r}(e),el)}(t);if(eu(t)||!0!==t.multi)this.records.get(l);else{let _=this.records.get(l);_||(_=Qo(void 0,el,!0),_.factory=()=>zl(_.multi),this.records.set(l,_)),l=t,_.multi.push(t)}this.records.set(l,u)}hydrate(t,n){return n.value===el&&(n.value=Jm,n.value=n.factory()),"object"==typeof n.value&&n.value&&function wy(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(n.value)&&this.onDestroy.add(n.value),n.value}injectableDefInScope(t){if(!t.providedIn)return!1;const n=Ut(t.providedIn);return"string"==typeof n?"any"===n||n===this.scope:this.injectorDefTypes.has(n)}}function Io(e){const t=Jr(e),n=null!==t?t.factory:mt(e);if(null!==n)return n;if(e instanceof Bn)throw new En(204,!1);if(e instanceof Function)return function ya(e){const t=e.length;if(t>0)throw rh(t,"?"),new En(204,!1);const n=function na(e){const t=e&&(e[Iu]||e[tc]);if(t){const n=function jd(e){if(e.hasOwnProperty("name"))return e.name;const t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),t}return null}(e);return null!==n?()=>n.factory(e):()=>new e}(e);throw new En(204,!1)}function Qo(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function Mh(e){return null!==e&&"object"==typeof e&&Ha in e}function eu(e){return"function"==typeof e}let Po=(()=>{class e{static create(n,r){var l;if(Array.isArray(n))return tg({name:""},r,n,"");{const u=null!==(l=n.name)&&void 0!==l?l:"";return tg({name:u},n.parent,n.providers,u)}}}return e.THROW_IF_NOT_FOUND=zt,e.NULL=new ff,e.\u0275prov=Sn({token:e,providedIn:"any",factory:()=>Jt(Qm)}),e.__NG_ELEMENT_ID__=-1,e})();function Sy(e,t){U(hm(e)[1],Fi())}let k=null;function R(){if(!k){const e=Vn.Symbol;if(e&&e.iterator)k=e.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let n=0;n<t.length;++n){const r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(k=r)}}}return k}function N(e){return!!se(e)&&(Array.isArray(e)||!(e instanceof Map)&&R()in e)}function se(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function he(e,t,n){return e[t]=n}function de(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function me(e,t,n,r,l){const u=function ye(e,t,n,r){const l=de(e,t,n);return de(e,t+1,r)||l}(e,t,n,r);return de(e,t+2,l)||u}function Pe(e,t,n,r){const l=it();return de(l,ca(),t)&&(Tn(),Do(x(),l,e,t,n,r)),Pe}function tt(e,t,n,r){return de(e,ca(),n)?t+qt(n)+r:hn}function Tt(e,t,n,r,l,u,_,v){const w=it(),T=Tn(),S=e+20,I=T.firstCreatePass?function pi(e,t,n,r,l,u,_,v,w){const T=t.consts,S=Yc(t,e,4,_||null,No(T,v));wh(t,n,S,No(T,w)),U(t,S);const I=S.tViews=So(2,S,r,l,u,t.directiveRegistry,t.pipeRegistry,null,t.schemas,T);return null!==t.queries&&(t.queries.template(t,S),I.queries=t.queries.embeddedTView(S)),S}(S,T,w,t,n,r,l,u,_):T.data[S];jo(I,!1);const L=w[11].createComment("");qp(T,w,L,I),$r(L,w),Th(w,w[S]=hy(L,w,L,I)),La(I)&&Vs(T,w,I),null!=_&&vh(w,I,v)}function Vt(e,t=nn.Default){const n=it();return null===n?Jt(e,t):si(Fi(),n,Ut(e),t)}function cx(){throw new Error("invalid")}function ei(e,t,n){const r=it();return de(r,ca(),t)&&function Gr(e,t,n,r,l,u,_,v){const w=Mr(t,n);let S,T=t.inputs;!v&&null!=T&&(S=T[r])?(pf(e,n,S,r,l),Ml(t)&&function $m(e,t){const n=Nr(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(r=function X0(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(r),l=null!=_?_(l,t.value||"",r):l,oi(u)?u.setProperty(w,r,l):je(r)||(w.setProperty?w.setProperty(r,l):w[r]=l))}(Tn(),x(),r,e,t,r[11],n,!1),ei}function ux(e,t,n,r,l){const _=l?"class":"style";pf(e,n,t.inputs[_],_,r)}function We(e,t,n,r){const l=it(),u=Tn(),_=20+e,v=l[11],w=l[_]=Up(v,t,function z(){return Gt.lFrame.currentNamespace}()),T=u.firstCreatePass?function hT(e,t,n,r,l,u,_){const v=t.consts,T=Yc(t,e,2,l,No(v,u));return wh(t,n,T,No(v,_)),null!==T.attrs&&Jc(T,T.attrs,!1),null!==T.mergedAttrs&&Jc(T,T.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,T),T}(_,u,l,0,t,n,r):u.data[_];jo(T,!0);const S=T.mergedAttrs;null!==S&&Je(v,w,S);const I=T.classes;null!==I&&qc(v,w,I);const L=T.styles;return null!==L&&U_(v,w,L),64!=(64&T.flags)&&qp(u,l,w,T),0===function Co(){return Gt.lFrame.elementDepthCount}()&&$r(w,l),function Hu(){Gt.lFrame.elementDepthCount++}(),La(T)&&(Vs(u,l,T),vd(u,T,l)),null!==r&&vh(l,T),We}function rt(){let e=Fi();ja()?kl():(e=e.parent,jo(e,!1));const t=e;!function vt(){Gt.lFrame.elementDepthCount--}();const n=Tn();return n.firstCreatePass&&(U(n,e),cc(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function ve(e){return 0!=(16&e.flags)}(t)&&ux(n,t,it(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function _e(e){return 0!=(32&e.flags)}(t)&&ux(n,t,it(),t.stylesWithoutHost,!1),rt}function Yt(e,t,n,r){return We(e,t,n,r),rt(),Yt}function fg(e,t,n){const r=it(),l=Tn(),u=e+20,_=l.firstCreatePass?function pT(e,t,n,r,l){const u=t.consts,_=No(u,r),v=Yc(t,e,8,"ng-container",_);return null!==_&&Jc(v,_,!0),wh(t,n,v,No(u,l)),null!==t.queries&&t.queries.elementStart(t,v),v}(u,l,r,t,n):l.data[u];jo(_,!0);const v=r[u]=r[11].createComment("");return qp(l,r,v,_),$r(v,r),La(_)&&(Vs(l,r,_),vd(l,_,r)),null!=n&&vh(r,_),fg}function mg(){let e=Fi();const t=Tn();return ja()?kl():(e=e.parent,jo(e,!1)),t.firstCreatePass&&(U(t,e),cc(e)&&t.queries.elementEnd(e)),mg}function ky(e){return!!e&&"function"==typeof e.then}function fw(e){return!!e&&"function"==typeof e.subscribe}const mw=fw;function Ry(e,t,n,r){const l=it(),u=Tn(),_=Fi();return function _w(e,t,n,r,l,u,_,v){const w=La(r),S=e.firstCreatePass&&hf(e),I=t[8],L=df(t);let j=!0;if(3&r.type||v){const Y=Mr(r,t),ce=v?v(Y):Y,ee=L.length,fe=v?ze=>v(Ii(ze[r.index])):r.index;if(oi(n)){let ze=null;if(!v&&w&&(ze=function mT(e,t,n,r){const l=e.cleanup;if(null!=l)for(let u=0;u<l.length-1;u+=2){const _=l[u];if(_===n&&l[u+1]===r){const v=t[7],w=l[u+2];return v.length>w?v[w]:null}"string"==typeof _&&(u+=2)}return null}(e,t,l,r.index)),null!==ze)(ze.__ngLastListenerFn__||ze).__ngNextListenerFn__=u,ze.__ngLastListenerFn__=u,j=!1;else{u=dx(r,t,I,u,!1);const Be=n.listen(ce,l,u);L.push(u,Be),S&&S.push(l,fe,ee,ee+1)}}else u=dx(r,t,I,u,!0),ce.addEventListener(l,u,_),L.push(u),S&&S.push(l,fe,ee,_)}else u=dx(r,t,I,u,!1);const Z=r.outputs;let G;if(j&&null!==Z&&(G=Z[l])){const Y=G.length;if(Y)for(let ce=0;ce<Y;ce+=2){const Ke=t[G[ce]][G[ce+1]].subscribe(u),nt=L.length;L.push(u,Ke),S&&S.push(l,r.index,nt,-(nt+1))}}}(u,l,l[11],_,e,t,!!n,r),Ry}function yw(e,t,n,r){try{return!1!==n(r)}catch(l){return gy(e,l),!1}}function dx(e,t,n,r,l){return function u(_){if(_===Function)return r;const v=2&e.flags?Nr(e.index,t):t;0==(32&t[2])&&Zm(v);let w=yw(t,0,r,_),T=u.__ngNextListenerFn__;for(;T;)w=yw(t,0,T,_)&&w,T=T.__ngNextListenerFn__;return l&&!1===w&&(_.preventDefault(),_.returnValue=!1),w}}function Sd(e=1){return function f(e){return(Gt.lFrame.contextLView=function a(e,t){for(;e>0;)t=t[15],e--;return t}(e,Gt.lFrame.contextLView))[8]}(e)}function gT(e,t){let n=null;const r=function fd(e){const t=e.attrs;if(null!=t){const n=t.indexOf(5);if(0==(1&n))return t[n+1]}return null}(e);for(let l=0;l<t.length;l++){const u=t[l];if("*"!==u){if(null===r?ma(e,u,!0):O0(r,u))return l}else n=l}return n}function gg(e,t=0,n){const r=it(),l=Tn(),u=Yc(l,20+e,16,null,n||null);null===u.projection&&(u.projection=t),kl(),64!=(64&u.flags)&&function Mm(e,t,n){fh(t[11],0,t,n,L_(e,n,t),Cm(n.parent||t[6],n,t))}(l,r,u)}function Dw(e,t,n,r,l){const u=e[n+1],_=null===t;let v=r?gs(u):js(u),w=!1;for(;0!==v&&(!1===w||_);){const S=e[v+1];vT(e[v],t)&&(w=!0,e[v+1]=r?po(S):Im(S)),v=r?gs(S):js(S)}w&&(e[n+1]=r?Im(u):po(u))}function vT(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&qo(e,t)>=0}const Pr={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Iw(e){return e.substring(Pr.key,Pr.keyEnd)}function xT(e){return e.substring(Pr.value,Pr.valueEnd)}function Pw(e,t){const n=Pr.textEnd;return n===t?-1:(t=Pr.keyEnd=function CT(e,t,n){for(;t<n&&e.charCodeAt(t)>32;)t++;return t}(e,Pr.key=t,n),wf(e,t,n))}function Ow(e,t){const n=Pr.textEnd;let r=Pr.key=wf(e,t,n);return n===r?-1:(r=Pr.keyEnd=function AT(e,t,n){let r;for(;t<n&&(45===(r=e.charCodeAt(t))||95===r||(-33&r)>=65&&(-33&r)<=90||r>=48&&r<=57);)t++;return t}(e,r,n),r=Rw(e,r,n),r=Pr.value=wf(e,r,n),r=Pr.valueEnd=function ET(e,t,n){let r=-1,l=-1,u=-1,_=t,v=_;for(;_<n;){const w=e.charCodeAt(_++);if(59===w)return v;34===w||39===w?v=_=Lw(e,w,_,n):t===_-4&&85===u&&82===l&&76===r&&40===w?v=_=Lw(e,41,_,n):w>32&&(v=_),u=l,l=r,r=-33&w}return v}(e,r,n),Rw(e,r,n))}function kw(e){Pr.key=0,Pr.keyEnd=0,Pr.value=0,Pr.valueEnd=0,Pr.textEnd=e.length}function wf(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function Rw(e,t,n,r){return(t=wf(e,t,n))<n&&t++,t}function Lw(e,t,n,r){let l=-1,u=n;for(;u<r;){const _=e.charCodeAt(u++);if(_==t&&92!==l)return u;l=92==_&&92===l?0:_}throw new Error}function rl(e){sl(Vw,TT,e,!1)}function TT(e,t){for(let n=function wT(e){return kw(e),Ow(e,wf(e,0,Pr.textEnd))}(t);n>=0;n=Ow(t,n))Vw(e,Iw(t),xT(t))}function Vl(e,t){for(let n=function bT(e){return kw(e),Pw(e,wf(e,0,Pr.textEnd))}(t);n>=0;n=Pw(t,n))Oi(e,Iw(t),!0)}function sl(e,t,n,r){const l=Tn(),u=function Uo(e){const t=Gt.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}(2);l.firstUpdatePass&&function jw(e,t,n,r){const l=e.data;if(null===l[n+1]){const u=l[d()],_=Nw(e,n);Gw(u,r)&&null===t&&!_&&(t=!1),t=function MT(e,t,n,r){const l=function Ua(e){const t=Gt.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e);let u=r?t.residualClasses:t.residualStyles;if(null===l)0===(r?t.classBindings:t.styleBindings)&&(n=_g(n=px(null,e,t,n,r),t.attrs,r),u=null);else{const _=t.directiveStylingLast;if(-1===_||e[_]!==l)if(n=px(l,e,t,n,r),null===u){let w=function ST(e,t,n){const r=n?t.classBindings:t.styleBindings;if(0!==js(r))return e[gs(r)]}(e,t,r);void 0!==w&&Array.isArray(w)&&(w=px(null,e,t,w[1],r),w=_g(w,t.attrs,r),function DT(e,t,n,r){e[gs(n?t.classBindings:t.styleBindings)]=r}(e,t,r,w))}else u=function IT(e,t,n){let r;const l=t.directiveEnd;for(let u=1+t.directiveStylingLast;u<l;u++)r=_g(r,e[u].hostAttrs,n);return _g(r,t.attrs,n)}(e,t,r)}return void 0!==u&&(r?t.residualClasses=u:t.residualStyles=u),n}(l,u,t,r),function _T(e,t,n,r,l,u){let _=u?t.classBindings:t.styleBindings,v=gs(_),w=js(_);e[r]=n;let S,T=!1;if(Array.isArray(n)){const I=n;S=I[1],(null===S||qo(I,S)>0)&&(T=!0)}else S=n;if(l)if(0!==w){const L=gs(e[v+1]);e[r+1]=Ya(L,v),0!==L&&(e[L+1]=gh(e[L+1],r)),e[v+1]=function z0(e,t){return 131071&e|t<<17}(e[v+1],r)}else e[r+1]=Ya(v,0),0!==v&&(e[v+1]=gh(e[v+1],r)),v=r;else e[r+1]=Ya(w,0),0===v?v=r:e[w+1]=gh(e[w+1],r),w=r;T&&(e[r+1]=Im(e[r+1])),Dw(e,S,r,!0),Dw(e,S,r,!1),function yT(e,t,n,r,l){const u=l?e.residualClasses:e.residualStyles;null!=u&&"string"==typeof t&&qo(u,t)>=0&&(n[r+1]=po(n[r+1]))}(t,S,e,r,u),_=Ya(v,w),u?t.classBindings=_:t.styleBindings=_}(l,u,t,n,_,r)}}(l,null,u,r);const _=it();if(n!==hn&&de(_,u,n)){const v=l.data[d()];if(Gw(v,r)&&!Nw(l,u)){let w=r?v.classesWithoutHost:v.stylesWithoutHost;null!==w&&(n=Da(w,n||"")),ux(l,v,_,n,r)}else!function OT(e,t,n,r,l,u,_,v){l===hn&&(l=Wn);let w=0,T=0,S=0<l.length?l[0]:null,I=0<u.length?u[0]:null;for(;null!==S||null!==I;){const L=w<l.length?l[w+1]:void 0,j=T<u.length?u[T+1]:void 0;let G,Z=null;S===I?(w+=2,T+=2,L!==j&&(Z=I,G=j)):null===I||null!==S&&S<I?(w+=2,Z=S):(T+=2,Z=I,G=j),null!==Z&&Uw(e,t,n,r,Z,G,_,v),S=w<l.length?l[w]:null,I=T<u.length?u[T]:null}}(l,v,_,_[11],_[u+1],_[u+1]=function PT(e,t,n){if(null==n||""===n)return Wn;const r=[],l=Fl(n);if(Array.isArray(l))for(let u=0;u<l.length;u++)e(r,l[u],!0);else if("object"==typeof l)for(const u in l)l.hasOwnProperty(u)&&e(r,u,l[u]);else"string"==typeof l&&t(r,l);return r}(e,t,n),r,u)}}function Nw(e,t){return t>=e.expandoStartIndex}function px(e,t,n,r,l){let u=null;const _=n.directiveEnd;let v=n.directiveStylingLast;for(-1===v?v=n.directiveStart:v++;v<_&&(u=t[v],r=_g(r,u.hostAttrs,l),u!==e);)v++;return null!==e&&(n.directiveStylingLast=v),r}function _g(e,t,n){const r=n?1:2;let l=-1;if(null!==t)for(let u=0;u<t.length;u++){const _=t[u];"number"==typeof _?l=_:l===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),Oi(e,_,!!n||t[++u]))}return void 0===e?null:e}function Vw(e,t,n){Oi(e,t,Fl(n))}function Uw(e,t,n,r,l,u,_,v){if(!(3&t.type))return;const w=e.data,T=w[v+1];Ly(function Pm(e){return 1==(1&e)}(T)?$w(w,t,n,l,js(T),_):void 0)||(Ly(u)||function Y_(e){return 2==(2&e)}(T)&&(u=$w(w,null,n,l,v,_)),function I0(e,t,n,r,l){const u=oi(e);if(t)l?u?e.addClass(n,r):n.classList.add(r):u?e.removeClass(n,r):n.classList.remove(r);else{let _=-1===r.indexOf("-")?void 0:Yo.DashCase;if(null==l)u?e.removeStyle(n,r,_):n.style.removeProperty(r);else{const v="string"==typeof l&&l.endsWith("!important");v&&(l=l.slice(0,-10),_|=Yo.Important),u?e.setStyle(n,r,l,_):n.style.setProperty(r,l,v?"important":"")}}}(r,_,ks(d(),n),l,u))}function $w(e,t,n,r,l,u){const _=null===t;let v;for(;l>0;){const w=e[l],T=Array.isArray(w),S=T?w[1]:w,I=null===S;let L=n[l+1];L===hn&&(L=I?Wn:void 0);let j=I?pa(L,r):S===r?L:void 0;if(T&&!Ly(j)&&(j=pa(w,r)),Ly(j)&&(v=j,_))return v;const Z=e[l+1];l=_?gs(Z):js(Z)}if(null!==t){let w=u?t.residualClasses:t.residualStyles;null!=w&&(v=pa(w,r))}return v}function Ly(e){return void 0!==e}function Gw(e,t){return 0!=(e.flags&(t?16:32))}function xt(e,t=""){const n=it(),r=Tn(),l=e+20,u=r.firstCreatePass?Yc(r,l,1,t,null):r.data[l],_=n[l]=function Vp(e,t){return oi(e)?e.createText(t):e.createTextNode(t)}(n[11],t);qp(r,n,_,u),jo(u,!1)}function ba(e){return Ri("",e,""),ba}function Ri(e,t,n){const r=it(),l=tt(r,e,t,n);return l!==hn&&_a(r,d(),l),Ri}const zy="en-US";let p1=zy;class B1{}class tS{resolveComponentFactory(t){throw function eS(e){const t=Error(`No component factory found for ${Ct(e)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=e,t}(t)}}let wg=(()=>{class e{}return e.NULL=new tS,e})();function nS(){return Ef(Fi(),it())}function Ef(e,t){return new nu(Mr(e,t))}let nu=(()=>{class e{constructor(n){this.nativeElement=n}}return e.__NG_ELEMENT_ID__=nS,e})();function iS(e){return e instanceof nu?e.nativeElement:e}class j1{}let Vy=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>function oS(){const e=it(),n=Nr(Fi().index,e);return function rS(e){return e[11]}(bo(n)?n:e)}(),e})(),sS=(()=>{class e{}return e.\u0275prov=Sn({token:e,providedIn:"root",factory:()=>null}),e})();class Uy{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const aS=new Uy("13.3.11"),xx={};function $y(e,t,n,r,l=!1){for(;null!==n;){const u=t[n.index];if(null!==u&&r.push(Ii(u)),wo(u))for(let v=10;v<u.length;v++){const w=u[v],T=w[1].firstChild;null!==T&&$y(w[1],w,T,r)}const _=n.type;if(8&_)$y(e,t,n.child,r);else if(32&_){const v=Wa(n,t);let w;for(;w=v();)r.push(w)}else if(16&_){const v=j_(t,n);if(Array.isArray(v))r.push(...v);else{const w=ph(t[16]);$y(w[1],w,v,r,!0)}}n=l?n.projectionNext:n.next}return r}class Cg{constructor(t,n){this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,n=t[1];return $y(n,t,n.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(wo(t)){const n=t[8],r=n?n.indexOf(this):-1;r>-1&&($c(t,r),ih(n,r))}this._attachedToViewContainer=!1}dd(this._lView[1],this._lView)}onDestroy(t){of(this._lView[1],this._lView,null,t)}markForCheck(){Zm(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){!function uf(e,t,n){const r=t[10];r.begin&&r.begin();try{yd(e,t,e.template,n)}catch(l){throw gy(t,l),l}finally{r.end&&r.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new En(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function M0(e,t){Mo(e,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new En(902,"");this._appRef=t}}class lS extends Cg{constructor(t){super(t),this._view=t}detectChanges(){my(this._view)}checkNoChanges(){}get context(){return null}}class V1 extends wg{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const n=Wi(t);return new bx(n,this.ngModule)}}function U1(e){const t=[];for(let n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}class bx extends B1{constructor(t,n){super(),this.componentDef=t,this.ngModule=n,this.componentType=t.type,this.selector=function R0(e){return e.map(k0).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!n}get inputs(){return U1(this.componentDef.inputs)}get outputs(){return U1(this.componentDef.outputs)}create(t,n,r,l){const u=(l=l||this.ngModule)?function uS(e,t){return{get:(n,r,l)=>{const u=e.get(n,xx,l);return u!==xx||r===xx?u:t.get(n,r,l)}}}(t,l.injector):t,_=u.get(j1,Qd),v=u.get(sS,null),w=_.createRenderer(null,this.componentDef),T=this.componentDef.selectors[0][0]||"div",S=r?function sy(e,t,n){if(oi(e))return e.selectRootElement(t,n===no.ShadowDom);let r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(w,r,this.componentDef.encapsulation):Up(_.createRenderer(null,this.componentDef),T,function cS(e){const t=e.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(T)),I=this.componentDef.onPush?576:528,L=function lg(e,t){return{components:[],scheduler:e||b0,clean:nx,playerHandler:t||null,flags:0}}(),j=So(0,null,null,1,0,null,null,null,null,null),Z=gd(null,j,L,I,null,null,_,w,v,u);let G,Y;Ll(Z);try{const ce=function My(e,t,n,r,l,u){const _=n[1];n[20]=e;const w=Yc(_,20,2,"#host",null),T=w.mergedAttrs=t.hostAttrs;null!==T&&(Jc(w,T,!0),null!==e&&(Je(l,e,T),null!==w.classes&&qc(l,e,w.classes),null!==w.styles&&U_(l,e,w.styles)));const S=r.createRenderer(e,t),I=gd(n,Xc(t),null,t.onPush?64:16,n[20],w,r,S,u||null,null);return _.firstCreatePass&&(Bi(pn(w,n),_,t.type),qm(_,w),Ka(w,n.length,1)),Th(n,I),n[20]=I}(S,this.componentDef,Z,_,w);if(S)if(r)Je(w,S,["ng-version",aS.full]);else{const{attrs:ee,classes:fe}=function L0(e){const t=[],n=[];let r=1,l=2;for(;r<e.length;){let u=e[r];if("string"==typeof u)2===l?""!==u&&t.push(u,e[++r]):8===l&&n.push(u);else{if(!ms(l))break;l=u}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]);ee&&Je(w,S,ee),fe&&fe.length>0&&qc(w,S,fe.join(" "))}if(Y=Vu(j,20),void 0!==n){const ee=Y.projection=[];for(let fe=0;fe<this.ngContentSelectors.length;fe++){const ze=n[fe];ee.push(null!=ze?Array.from(ze):null)}}G=function vf(e,t,n,r,l){const u=n[1],_=function bh(e,t,n){const r=Fi();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),dy(e,r,t,Nl(e,t,1,null),n));const l=Ni(t,e,r.directiveStart,r);$r(l,t);const u=Mr(r,t);return u&&$r(u,t),l}(u,n,t);if(r.components.push(_),e[8]=_,l&&l.forEach(w=>w(_,t)),t.contentQueries){const w=Fi();t.contentQueries(1,_,w.directiveStart)}const v=Fi();return!u.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(g(v.index),Hm(n[1],v,0,v.directiveStart,v.directiveEnd,t),uy(t,_)),_}(ce,this.componentDef,Z,L,[Sy]),yh(j,Z,null)}finally{ua()}return new hS(this.componentType,G,Ef(Y,Z),Z,Y)}}class hS extends class JM{}{constructor(t,n,r,l,u){super(),this.location=r,this._rootLView=l,this._tNode=u,this.instance=n,this.hostView=this.changeDetectorRef=new lS(l),this.componentType=t}get injector(){return new Ao(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}class iu{}class $1{}const Tf=new Map;class q1 extends iu{constructor(t,n){super(),this._parent=n,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new V1(this);const r=nr(t);this._bootstrapComponents=ho(r.bootstrap),this._r3Injector=yy(t,n,[{provide:iu,useValue:this},{provide:wg,useValue:this.componentFactoryResolver}],Ct(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,n=Po.THROW_IF_NOT_FOUND,r=nn.Default){return t===Po||t===iu||t===Qm?this:this._r3Injector.get(t,n,r)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class wx extends $1{constructor(t){super(),this.moduleType=t,null!==nr(t)&&function fS(e){const t=new Set;!function n(r){const l=nr(r,!0),u=l.id;null!==u&&(function G1(e,t,n){if(t&&t!==n)throw new Error(`Duplicate module registered for ${e} - ${Ct(t)} vs ${Ct(t.name)}`)}(u,Tf.get(u),r),Tf.set(u,r));const _=ho(l.imports);for(const v of _)t.has(v)||(t.add(v),n(v))}(e)}(t)}create(t){return new q1(this.moduleType,t)}}function ru(e,t,n){const r=pr()+e,l=it();return l[r]===hn?he(l,r,n?t.call(n):t()):function ae(e,t){return e[t]}(l,r)}function Mf(e,t,n,r){return W1(it(),pr(),e,t,n,r)}function Ag(e,t){const n=e[t];return n===hn?void 0:n}function W1(e,t,n,r,l,u){const _=t+n;return de(e,_,l)?he(e,_+1,u?r.call(u,l):r(l)):Ag(e,_+1)}function X1(e,t,n,r,l,u,_,v){const w=t+n;return me(e,w,l,u,_)?he(e,w+3,v?r.call(v,l,u,_):r(l,u,_)):Ag(e,w+3)}function kh(e,t){const n=Tn();let r;const l=e+20;n.firstCreatePass?(r=function wS(e,t){if(t)for(let n=t.length-1;n>=0;n--){const r=t[n];if(e===r.name)return r}}(t,n.pipeRegistry),n.data[l]=r,r.onDestroy&&(n.destroyHooks||(n.destroyHooks=[])).push(l,r.onDestroy)):r=n.data[l];const u=r.factory||(r.factory=mt(r.type)),_=ia(Vt);try{const v=wt(!1),w=u();return wt(v),function Cn(e,t,n,r){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=r}(n,it(),l,w),w}finally{ia(_)}}function Sf(e,t,n){const r=e+20,l=it(),u=Rs(l,r);return Eg(l,r)?W1(l,pr(),t,u.transform,n,u):u.transform(n)}function Eg(e,t){return e[1].data[t].pure}function Cx(e){return t=>{setTimeout(e,void 0,t)}}const ft=class TS extends bi{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,n,r){var l,u,_;let v=t,w=n||(()=>null),T=r;if(t&&"object"==typeof t){const I=t;v=null===(l=I.next)||void 0===l?void 0:l.bind(I),w=null===(u=I.error)||void 0===u?void 0:u.bind(I),T=null===(_=I.complete)||void 0===_?void 0:_.bind(I)}this.__isAsync&&(w=Cx(w),v&&(v=Cx(v)),T&&(T=Cx(T)));const S=super.subscribe({next:v,error:w,complete:T});return t instanceof ot&&t.add(S),S}};function MS(){return this._results[R()]()}class Ax{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const n=R(),r=Ax.prototype;r[n]||(r[n]=MS)}get changes(){return this._changes||(this._changes=new ft)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,n){return this._results.reduce(t,n)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,n){const r=this;r.dirty=!1;const l=Xi(t);(this._changesDetected=!function yp(e,t,n){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++){let l=e[r],u=t[r];if(n&&(l=n(l),u=n(u)),u!==l)return!1}return!0}(r._results,l,n))&&(r._results=l,r.length=l.length,r.last=l[this.length-1],r.first=l[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Ul=(()=>{class e{}return e.__NG_ELEMENT_ID__=IS,e})();const SS=Ul,DS=class extends SS{constructor(t,n,r){super(),this._declarationLView=t,this._declarationTContainer=n,this.elementRef=r}createEmbeddedView(t){const n=this._declarationTContainer.tViews,r=gd(this._declarationLView,n,t,16,null,n.declTNode,null,null,null,null);r[17]=this._declarationLView[this._declarationTContainer.index];const u=this._declarationLView[19];return null!==u&&(r[19]=u.createEmbeddedView(n)),yh(n,r,t),new Cg(r)}};function IS(){return Gy(Fi(),it())}function Gy(e,t){return 4&e.type?new DS(t,e,Ef(e,t)):null}let al=(()=>{class e{}return e.__NG_ELEMENT_ID__=PS,e})();function PS(){return nC(Fi(),it())}const OS=al,eC=class extends OS{constructor(t,n,r){super(),this._lContainer=t,this._hostTNode=n,this._hostLView=r}get element(){return Ef(this._hostTNode,this._hostLView)}get injector(){return new Ao(this._hostTNode,this._hostLView)}get parentInjector(){const t=Dn(this._hostTNode,this._hostLView);if(ke(t)){const n=ht(t,this._hostLView),r=et(t);return new Ao(n[1].data[r+8],n)}return new Ao(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const n=tC(this._lContainer);return null!==n&&n[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,n,r){const l=t.createEmbeddedView(n||{});return this.insert(l,r),l}createComponent(t,n,r,l,u){const _=t&&!function Xu(e){return"function"==typeof e}(t);let v;if(_)v=n;else{const I=n||{};v=I.index,r=I.injector,l=I.projectableNodes,u=I.ngModuleRef}const w=_?t:new bx(Wi(t)),T=r||this.parentInjector;if(!u&&null==w.ngModule){const L=(_?T:this.parentInjector).get(iu,null);L&&(u=L)}const S=w.create(T,l,void 0,u);return this.insert(S.hostView,v),S}insert(t,n){const r=t._lView,l=r[1];if(function Wf(e){return wo(e[3])}(r)){const S=this.indexOf(t);if(-1!==S)this.detach(S);else{const I=r[3],L=new eC(I,I[6],I[3]);L.detach(L.indexOf(t))}}const u=this._adjustIndex(n),_=this._lContainer;!function $p(e,t,n,r){const l=10+r,u=n.length;r>0&&(n[l-1][4]=t),r<u-10?(t[4]=n[l],Qf(n,10+r,t)):(n.push(t),t[4]=null),t[3]=n;const _=t[17];null!==_&&n!==_&&function k_(e,t){const n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(_,t);const v=t[19];null!==v&&v.insertView(e),t[2]|=128}(l,r,_,u);const v=Wp(u,_),w=r[11],T=Hc(w,_[7]);return null!==T&&function T0(e,t,n,r,l,u){r[0]=l,r[6]=t,Mo(e,r,n,1,l,u)}(l,_[6],w,r,T,v),t.attachToViewContainerRef(),Qf(Ex(_),u,t),t}move(t,n){return this.insert(t,n)}indexOf(t){const n=tC(this._lContainer);return null!==n?n.indexOf(t):-1}remove(t){const n=this._adjustIndex(t,-1),r=$c(this._lContainer,n);r&&(ih(Ex(this._lContainer),n),dd(r[1],r))}detach(t){const n=this._adjustIndex(t,-1),r=$c(this._lContainer,n);return r&&null!=ih(Ex(this._lContainer),n)?new Cg(r):null}_adjustIndex(t,n=0){return null==t?this.length+n:t}};function tC(e){return e[8]}function Ex(e){return e[8]||(e[8]=[])}function nC(e,t){let n;const r=t[e.index];if(wo(r))n=r;else{let l;if(8&e.type)l=Ii(r);else{const u=t[11];l=u.createComment("");const _=Mr(e,t);Gc(u,Hc(u,_),l,function D0(e,t){return oi(e)?e.nextSibling(t):t.nextSibling}(u,_),!1)}t[e.index]=n=hy(r,t,l,e),Th(t,n)}return new eC(n,e,t)}class Tx{constructor(t){this.queryList=t,this.matches=null}clone(){return new Tx(this.queryList)}setDirty(){this.queryList.setDirty()}}class Mx{constructor(t=[]){this.queries=t}createEmbeddedView(t){const n=t.queries;if(null!==n){const r=null!==t.contentQueries?t.contentQueries[0]:n.length,l=[];for(let u=0;u<r;u++){const _=n.getByIndex(u);l.push(this.queries[_.indexInDeclarationView].clone())}return new Mx(l)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let n=0;n<this.queries.length;n++)null!==aC(t,n).matches&&this.queries[n].setDirty()}}class iC{constructor(t,n,r=null){this.predicate=t,this.flags=n,this.read=r}}class Sx{constructor(t=[]){this.queries=t}elementStart(t,n){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(t,n)}elementEnd(t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(t)}embeddedTView(t){let n=null;for(let r=0;r<this.length;r++){const l=null!==n?n.length:0,u=this.getByIndex(r).embeddedTView(t,l);u&&(u.indexInDeclarationView=r,null!==n?n.push(u):n=[u])}return null!==n?new Sx(n):null}template(t,n){for(let r=0;r<this.queries.length;r++)this.queries[r].template(t,n)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class Dx{constructor(t,n=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(t,n){this.isApplyingToNode(n)&&this.matchTNode(t,n)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,n){this.elementStart(t,n)}embeddedTView(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new Dx(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const n=this._declarationNodeIndex;let r=t.parent;for(;null!==r&&8&r.type&&r.index!==n;)r=r.parent;return n===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(t,n){const r=this.metadata.predicate;if(Array.isArray(r))for(let l=0;l<r.length;l++){const u=r[l];this.matchTNodeWithReadOption(t,n,LS(n,u)),this.matchTNodeWithReadOption(t,n,Fn(n,t,u,!1,!1))}else r===Ul?4&n.type&&this.matchTNodeWithReadOption(t,n,-1):this.matchTNodeWithReadOption(t,n,Fn(n,t,r,!1,!1))}matchTNodeWithReadOption(t,n,r){if(null!==r){const l=this.metadata.read;if(null!==l)if(l===nu||l===al||l===Ul&&4&n.type)this.addMatch(n.index,-2);else{const u=Fn(n,t,l,!1,!1);null!==u&&this.addMatch(n.index,u)}else this.addMatch(n.index,r)}}addMatch(t,n){null===this.matches?this.matches=[t,n]:this.matches.push(t,n)}}function LS(e,t){const n=e.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function FS(e,t,n,r){return-1===n?function zS(e,t){return 11&e.type?Ef(e,t):4&e.type?Gy(e,t):null}(t,e):-2===n?function BS(e,t,n){return n===nu?Ef(t,e):n===Ul?Gy(t,e):n===al?nC(t,e):void 0}(e,t,r):Ni(e,e[1],n,t)}function rC(e,t,n,r){const l=t[19].queries[r];if(null===l.matches){const u=e.data,_=n.matches,v=[];for(let w=0;w<_.length;w+=2){const T=_[w];v.push(T<0?null:FS(t,u[T],_[w+1],n.metadata.read))}l.matches=v}return l.matches}function Ix(e,t,n,r){const l=e.queries.getByIndex(n),u=l.matches;if(null!==u){const _=rC(e,t,l,n);for(let v=0;v<u.length;v+=2){const w=u[v];if(w>0)r.push(_[v/2]);else{const T=u[v+1],S=t[-w];for(let I=10;I<S.length;I++){const L=S[I];L[17]===L[3]&&Ix(L[1],L,T,r)}if(null!==S[9]){const I=S[9];for(let L=0;L<I.length;L++){const j=I[L];Ix(j[1],j,T,r)}}}}}return r}function ou(e){const t=it(),n=Tn(),r=th();Cc(r+1);const l=aC(n,r);if(e.dirty&&Uu(t)===(2==(2&l.metadata.flags))){if(null===l.matches)e.reset([]);else{const u=l.crossesNgTemplate?Ix(n,t,r,[]):rC(n,t,l,r);e.reset(u,iS),e.notifyOnChanges()}return!0}return!1}function Df(e,t,n){const r=Tn();r.firstCreatePass&&(sC(r,new iC(e,t,n),-1),2==(2&t)&&(r.staticViewQueries=!0)),oC(r,it(),t)}function Hy(e,t,n,r){const l=Tn();if(l.firstCreatePass){const u=Fi();sC(l,new iC(t,n,r),u.index),function jS(e,t){const n=e.contentQueries||(e.contentQueries=[]);t!==(n.length?n[n.length-1]:-1)&&n.push(e.queries.length-1,t)}(l,e),2==(2&n)&&(l.staticContentQueries=!0)}oC(l,it(),n)}function su(){return function NS(e,t){return e[19].queries[t].queryList}(it(),th())}function oC(e,t,n){const r=new Ax(4==(4&n));of(e,t,r,r.destroy),null===t[19]&&(t[19]=new Mx),t[19].queries.push(new Tx(r))}function sC(e,t,n){null===e.queries&&(e.queries=new Sx),e.queries.track(new Dx(t,n))}function aC(e,t){return e.queries.getByIndex(t)}function lC(e,t){return Gy(e,t)}function Wy(...e){}const zx=new Bn("Application Initializer");let Fx=(()=>{class e{constructor(n){this.appInits=n,this.resolve=Wy,this.reject=Wy,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,l)=>{this.resolve=r,this.reject=l})}runInitializers(){if(this.initialized)return;const n=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let l=0;l<this.appInits.length;l++){const u=this.appInits[l]();if(ky(u))n.push(u);else if(mw(u)){const _=new Promise((v,w)=>{u.subscribe({complete:v,error:w})});n.push(_)}}Promise.all(n).then(()=>{r()}).catch(l=>{this.reject(l)}),0===n.length&&r(),this.initialized=!0}}return e.\u0275fac=function(n){return new(n||e)(Jt(zx,8))},e.\u0275prov=Sn({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const Mg=new Bn("AppId",{providedIn:"root",factory:function EC(){return`${Bx()}${Bx()}${Bx()}`}});function Bx(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const TC=new Bn("Platform Initializer"),Nx=new Bn("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),MC=new Bn("appBootstrapListener");let iD=(()=>{class e{log(n){console.log(n)}warn(n){console.warn(n)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Sn({token:e,factory:e.\u0275fac,providedIn:"platform"}),e})();const Dd=new Bn("LocaleId",{providedIn:"root",factory:()=>r_(Dd,nn.Optional|nn.SkipSelf)||function rD(){return"undefined"!=typeof $localize&&$localize.locale||zy}()});class sD{constructor(t,n){this.ngModuleFactory=t,this.componentFactories=n}}let SC=(()=>{class e{compileModuleSync(n){return new wx(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const r=this.compileModuleSync(n),u=ho(nr(n).declarations).reduce((_,v)=>{const w=Wi(v);return w&&_.push(new bx(w)),_},[]);return new sD(r,u)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Sn({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const lD=(()=>Promise.resolve(0))();function jx(e){"undefined"==typeof Zone?lD.then(()=>{e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}class Wr{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ft(!1),this.onMicrotaskEmpty=new ft(!1),this.onStable=new ft(!1),this.onError=new ft(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const l=this;l._nesting=0,l._outer=l._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(l._inner=l._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(l._inner=l._inner.fork(Zone.longStackTraceZoneSpec)),l.shouldCoalesceEventChangeDetection=!r&&n,l.shouldCoalesceRunChangeDetection=r,l.lastRequestAnimationFrameId=-1,l.nativeRequestAnimationFrame=function cD(){let e=Vn.requestAnimationFrame,t=Vn.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function hD(e){const t=()=>{!function dD(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Vn,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,Ux(e),e.isCheckStableRunning=!0,Vx(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),Ux(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,l,u,_,v)=>{try{return DC(e),n.invokeTask(l,u,_,v)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===u.type||e.shouldCoalesceRunChangeDetection)&&t(),IC(e)}},onInvoke:(n,r,l,u,_,v,w)=>{try{return DC(e),n.invoke(l,u,_,v,w)}finally{e.shouldCoalesceRunChangeDetection&&t(),IC(e)}},onHasTask:(n,r,l,u)=>{n.hasTask(l,u),r===l&&("microTask"==u.change?(e._hasPendingMicrotasks=u.microTask,Ux(e),Vx(e)):"macroTask"==u.change&&(e.hasPendingMacrotasks=u.macroTask))},onHandleError:(n,r,l,u)=>(n.handleError(l,u),e.runOutsideAngular(()=>e.onError.emit(u)),!1)})}(l)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Wr.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Wr.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,n,r){return this._inner.run(t,n,r)}runTask(t,n,r,l){const u=this._inner,_=u.scheduleEventTask("NgZoneEvent: "+l,t,uD,Wy,Wy);try{return u.runTask(_,n,r)}finally{u.cancelTask(_)}}runGuarded(t,n,r){return this._inner.runGuarded(t,n,r)}runOutsideAngular(t){return this._outer.run(t)}}const uD={};function Vx(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Ux(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function DC(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function IC(e){e._nesting--,Vx(e)}class pD{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ft,this.onMicrotaskEmpty=new ft,this.onStable=new ft,this.onError=new ft}run(t,n,r){return t.apply(n,r)}runGuarded(t,n,r){return t.apply(n,r)}runOutsideAngular(t){return t()}runTask(t,n,r,l){return t.apply(n,r)}}let $x=(()=>{class e{constructor(n){this._ngZone=n,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Wr.assertNotInAngularZone(),jx(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())jx(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(n)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,r,l){let u=-1;r&&r>0&&(u=setTimeout(()=>{this._callbacks=this._callbacks.filter(_=>_.timeoutId!==u),n(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:n,timeoutId:u,updateCb:l})}whenStable(n,r,l){if(l&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,r,l),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(n,r,l){return[]}}return e.\u0275fac=function(n){return new(n||e)(Jt(Wr))},e.\u0275prov=Sn({token:e,factory:e.\u0275fac}),e})(),fD=(()=>{class e{constructor(){this._applications=new Map,Gx.addToWindow(this)}registerApplication(n,r){this._applications.set(n,r)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,r=!0){return Gx.findTestabilityInTree(this,n,r)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Sn({token:e,factory:e.\u0275fac,providedIn:"platform"}),e})();class mD{addToWindow(t){}findTestabilityInTree(t,n,r){return null}}let Gx=new mD,Rh=null;const PC=new Bn("AllowMultipleToken"),OC=new Bn("PlatformOnDestroy");class kC{constructor(t,n){this.name=t,this.token=n}}function RC(e,t,n=[]){const r=`Platform: ${t}`,l=new Bn(r);return(u=[])=>{let _=Hx();if(!_||_.injector.get(PC,!1)){const v=[...n,...u,{provide:l,useValue:!0}];e?e(v):function vD(e){if(Rh&&!Rh.get(PC,!1))throw new En(400,"");Rh=e;const t=e.get(LC),n=e.get(TC,null);n&&n.forEach(r=>r())}(function bD(e=[],t){return Po.create({name:t,providers:[{provide:Km,useValue:"platform"},{provide:OC,useValue:()=>Rh=null},...e]})}(v,r))}return function xD(e){const t=Hx();if(!t)throw new En(401,"");return t}()}}function Hx(){var e;return null!==(e=null==Rh?void 0:Rh.get(LC))&&void 0!==e?e:null}let LC=(()=>{class e{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,r){const v=function wD(e,t){let n;return n="noop"===e?new pD:("zone.js"===e?void 0:e)||new Wr({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),n}(r?r.ngZone:void 0,{ngZoneEventCoalescing:r&&r.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:r&&r.ngZoneRunCoalescing||!1}),w=[{provide:Wr,useValue:v}];return v.run(()=>{const T=Po.create({providers:w,parent:this.injector,name:n.moduleType.name}),S=n.create(T),I=S.injector.get(dh,null);if(!I)throw new En(402,"");return v.runOutsideAngular(()=>{const L=v.onError.subscribe({next:j=>{I.handleError(j)}});S.onDestroy(()=>{Zx(this._modules,S),L.unsubscribe()})}),function CD(e,t,n){try{const r=n();return ky(r)?r.catch(l=>{throw t.runOutsideAngular(()=>e.handleError(l)),l}):r}catch(r){throw t.runOutsideAngular(()=>e.handleError(r)),r}}(I,v,()=>{const L=S.injector.get(Fx);return L.runInitializers(),L.donePromise.then(()=>(function iM(e){tr(e,"Expected localeId to be defined"),"string"==typeof e&&(p1=e.toLowerCase().replace(/_/g,"-"))}(S.injector.get(Dd,zy)||zy),this._moduleDoBootstrap(S),S))})})}bootstrapModule(n,r=[]){const l=zC({},r);return function _D(e,t,n){const r=new wx(n);return Promise.resolve(r)}(0,0,n).then(u=>this.bootstrapModuleFactory(u,l))}_moduleDoBootstrap(n){const r=n.injector.get(qx);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(l=>r.bootstrap(l));else{if(!n.instance.ngDoBootstrap)throw new En(403,"");n.instance.ngDoBootstrap(r)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new En(404,"");this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const n=this._injector.get(OC,null);null==n||n(),this._destroyed=!0}get destroyed(){return this._destroyed}}return e.\u0275fac=function(n){return new(n||e)(Jt(Po))},e.\u0275prov=Sn({token:e,factory:e.\u0275fac,providedIn:"platform"}),e})();function zC(e,t){return Array.isArray(t)?t.reduce(zC,e):Object.assign(Object.assign({},e),t)}let qx=(()=>{class e{constructor(n,r,l,u){this._zone=n,this._injector=r,this._exceptionHandler=l,this._initStatus=u,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const _=new Hn(w=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{w.next(this._stable),w.complete()})}),v=new Hn(w=>{let T;this._zone.runOutsideAngular(()=>{T=this._zone.onStable.subscribe(()=>{Wr.assertNotInAngularZone(),jx(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,w.next(!0))})})});const S=this._zone.onUnstable.subscribe(()=>{Wr.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{w.next(!1)}))});return()=>{T.unsubscribe(),S.unsubscribe()}});this.isStable=function gt(...e){const t=Mn(e),n=function zn(e,t){return"number"==typeof tn(e)?e.pop():t}(e,1/0),r=e;return r.length?1===r.length?V(r[0]):Xe(n)(Si(r,t)):St}(_,v.pipe(function cn(e={}){const{connector:t=(()=>new bi),resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:l=!0}=e;return u=>{let _,v,w,T=0,S=!1,I=!1;const L=()=>{null==v||v.unsubscribe(),v=void 0},j=()=>{L(),_=w=void 0,S=I=!1},Z=()=>{const G=_;j(),null==G||G.unsubscribe()};return wi((G,Y)=>{T++,!I&&!S&&L();const ce=w=null!=w?w:t();Y.add(()=>{T--,0===T&&!I&&!S&&(v=rn(Z,l))}),ce.subscribe(Y),!_&&T>0&&(_=new Ma({next:ee=>ce.next(ee),error:ee=>{I=!0,L(),v=rn(j,n,ee),ce.error(ee)},complete:()=>{S=!0,L(),v=rn(j,r),ce.complete()}}),V(G).subscribe(_))})(u)}}()))}bootstrap(n,r){if(!this._initStatus.done)throw new En(405,"");let l;l=n instanceof B1?n:this._injector.get(wg).resolveComponentFactory(n),this.componentTypes.push(l.componentType);const u=function yD(e){return e.isBoundToModule}(l)?void 0:this._injector.get(iu),v=l.create(Po.NULL,[],r||l.selector,u),w=v.location.nativeElement,T=v.injector.get($x,null),S=T&&v.injector.get(fD);return T&&S&&S.registerApplication(w,T),v.onDestroy(()=>{this.detachView(v.hostView),Zx(this.components,v),S&&S.unregisterApplication(w)}),this._loadComponent(v),v}tick(){if(this._runningTick)throw new En(101,"");try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(n))}finally{this._runningTick=!1}}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;Zx(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(MC,[]).concat(this._bootstrapListeners).forEach(l=>l(n))}ngOnDestroy(){this._views.slice().forEach(n=>n.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return e.\u0275fac=function(n){return new(n||e)(Jt(Wr),Jt(Po),Jt(dh),Jt(Fx))},e.\u0275prov=Sn({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Zx(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}let BC=!0,Yy=(()=>{class e{}return e.__NG_ELEMENT_ID__=TD,e})();function TD(e){return function MD(e,t,n){if(Ml(e)&&!n){const r=Nr(e.index,t);return new Cg(r,r)}return 47&e.type?new Cg(t[16],t):null}(Fi(),it(),16==(16&e))}class $C{constructor(){}supports(t){return N(t)}create(t){return new kD(t)}}const OD=(e,t)=>t;class kD{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||OD}forEachItem(t){let n;for(n=this._itHead;null!==n;n=n._next)t(n)}forEachOperation(t){let n=this._itHead,r=this._removalsHead,l=0,u=null;for(;n||r;){const _=!r||n&&n.currentIndex<HC(r,l,u)?n:r,v=HC(_,l,u),w=_.currentIndex;if(_===r)l--,r=r._nextRemoved;else if(n=n._next,null==_.previousIndex)l++;else{u||(u=[]);const T=v-l,S=w-l;if(T!=S){for(let L=0;L<T;L++){const j=L<u.length?u[L]:u[L]=0,Z=j+L;S<=Z&&Z<T&&(u[L]=j+1)}u[_.previousIndex]=S-T}}v!==w&&t(_,v,w)}}forEachPreviousItem(t){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachMovedItem(t){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}forEachIdentityChange(t){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)t(n)}diff(t){if(null==t&&(t=[]),!N(t))throw new En(900,"");return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let l,u,_,n=this._itHead,r=!1;if(Array.isArray(t)){this.length=t.length;for(let v=0;v<this.length;v++)u=t[v],_=this._trackByFn(v,u),null!==n&&Object.is(n.trackById,_)?(r&&(n=this._verifyReinsertion(n,u,_,v)),Object.is(n.item,u)||this._addIdentityChange(n,u)):(n=this._mismatch(n,u,_,v),r=!0),n=n._next}else l=0,function Q(e,t){if(Array.isArray(e))for(let n=0;n<e.length;n++)t(e[n]);else{const n=e[R()]();let r;for(;!(r=n.next()).done;)t(r.value)}}(t,v=>{_=this._trackByFn(l,v),null!==n&&Object.is(n.trackById,_)?(r&&(n=this._verifyReinsertion(n,v,_,l)),Object.is(n.item,v)||this._addIdentityChange(n,v)):(n=this._mismatch(n,v,_,l),r=!0),n=n._next,l++}),this.length=l;return this._truncate(n),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,n,r,l){let u;return null===t?u=this._itTail:(u=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._reinsertAfter(t,u,l)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(r,l))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._moveAfter(t,u,l)):t=this._addAfter(new RD(n,r),u,l),t}_verifyReinsertion(t,n,r,l){let u=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==u?t=this._reinsertAfter(u,t._prev,l):t.currentIndex!=l&&(t.currentIndex=l,this._addToMoves(t,l)),t}_truncate(t){for(;null!==t;){const n=t._next;this._addToRemovals(this._unlink(t)),t=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,n,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const l=t._prevRemoved,u=t._nextRemoved;return null===l?this._removalsHead=u:l._nextRemoved=u,null===u?this._removalsTail=l:u._prevRemoved=l,this._insertAfter(t,n,r),this._addToMoves(t,r),t}_moveAfter(t,n,r){return this._unlink(t),this._insertAfter(t,n,r),this._addToMoves(t,r),t}_addAfter(t,n,r){return this._insertAfter(t,n,r),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,n,r){const l=null===n?this._itHead:n._next;return t._next=l,t._prev=n,null===l?this._itTail=t:l._prev=t,null===n?this._itHead=t:n._next=t,null===this._linkedRecords&&(this._linkedRecords=new GC),this._linkedRecords.put(t),t.currentIndex=r,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const n=t._prev,r=t._next;return null===n?this._itHead=r:n._next=r,null===r?this._itTail=n:r._prev=n,t}_addToMoves(t,n){return t.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new GC),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,n){return t.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class RD{constructor(t,n){this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class LD{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,n){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===n||n<=r.currentIndex)&&Object.is(r.trackById,t))return r;return null}remove(t){const n=t._prevDup,r=t._nextDup;return null===n?this._head=r:n._nextDup=r,null===r?this._tail=n:r._prevDup=n,null===this._head}}class GC{constructor(){this.map=new Map}put(t){const n=t.trackById;let r=this.map.get(n);r||(r=new LD,this.map.set(n,r)),r.add(t)}get(t,n){const l=this.map.get(t);return l?l.get(t,n):null}remove(t){const n=t.trackById;return this.map.get(n).remove(t)&&this.map.delete(n),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function HC(e,t,n){const r=e.previousIndex;if(null===r)return r;let l=0;return n&&r<n.length&&(l=n[r]),r+t+l}class qC{constructor(){}supports(t){return t instanceof Map||se(t)}create(){return new zD}}class zD{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let n;for(n=this._mapHead;null!==n;n=n._next)t(n)}forEachPreviousItem(t){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)t(n)}forEachChangedItem(t){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}diff(t){if(t){if(!(t instanceof Map||se(t)))throw new En(900,"")}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(t,(r,l)=>{if(n&&n.key===l)this._maybeAddToChanges(n,r),this._appendAfter=n,n=n._next;else{const u=this._getOrCreateRecordForKey(l,r);n=this._insertBeforeOrAppend(n,u)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,n){if(t){const r=t._prev;return n._next=t,n._prev=r,t._prev=n,r&&(r._next=n),t===this._mapHead&&(this._mapHead=n),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(t,n){if(this._records.has(t)){const l=this._records.get(t);this._maybeAddToChanges(l,n);const u=l._prev,_=l._next;return u&&(u._next=_),_&&(_._prev=u),l._next=null,l._prev=null,l}const r=new FD(t);return this._records.set(t,r),r.currentValue=n,this._addToAdditions(r),r}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,n){Object.is(n,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=n,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,n){t instanceof Map?t.forEach(n):Object.keys(t).forEach(r=>n(t[r],r))}}class FD{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function ZC(){return new Ky([new $C])}let Ky=(()=>{class e{constructor(n){this.factories=n}static create(n,r){if(null!=r){const l=r.factories.slice();n=n.concat(l)}return new e(n)}static extend(n){return{provide:e,useFactory:r=>e.create(n,r||ZC()),deps:[[e,new Wo,new qa]]}}find(n){const r=this.factories.find(l=>l.supports(n));if(null!=r)return r;throw new En(901,"")}}return e.\u0275prov=Sn({token:e,providedIn:"root",factory:ZC}),e})();function WC(){return new Sg([new qC])}let Sg=(()=>{class e{constructor(n){this.factories=n}static create(n,r){if(r){const l=r.factories.slice();n=n.concat(l)}return new e(n)}static extend(n){return{provide:e,useFactory:r=>e.create(n,r||WC()),deps:[[e,new Wo,new qa]]}}find(n){const r=this.factories.find(u=>u.supports(n));if(r)return r;throw new En(901,"")}}return e.\u0275prov=Sn({token:e,providedIn:"root",factory:WC}),e})();const jD=RC(null,"core",[]);let VD=(()=>{class e{constructor(n){}}return e.\u0275fac=function(n){return new(n||e)(Jt(qx))},e.\u0275mod=hr({type:e}),e.\u0275inj=Li({}),e})(),Jy=null;function Id(){return Jy}const wa=new Bn("DocumentToken");let zh=(()=>{class e{historyGo(n){throw new Error("Not implemented")}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Sn({token:e,factory:function(){return function HD(){return Jt(YC)}()},providedIn:"platform"}),e})();const qD=new Bn("Location Initialized");let YC=(()=>{class e extends zh{constructor(n){super(),this._doc=n,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Id().getBaseHref(this._doc)}onPopState(n){const r=Id().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){const r=Id().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(n){this.location.pathname=n}pushState(n,r,l){XC()?this._history.pushState(n,r,l):this.location.hash=l}replaceState(n,r,l){XC()?this._history.replaceState(n,r,l):this.location.hash=l}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return e.\u0275fac=function(n){return new(n||e)(Jt(wa))},e.\u0275prov=Sn({token:e,factory:function(){return function ZD(){return new YC(Jt(wa))}()},providedIn:"platform"}),e})();function XC(){return!!window.history.pushState}function Kx(e,t){if(0==e.length)return t;if(0==t.length)return e;let n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function QC(e){const t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function au(e){return e&&"?"!==e[0]?"?"+e:e}let Pf=(()=>{class e{historyGo(n){throw new Error("Not implemented")}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Sn({token:e,factory:function(){return function WD(e){const t=Jt(wa).location;return new KC(Jt(zh),t&&t.origin||"")}()},providedIn:"root"}),e})();const Jx=new Bn("appBaseHref");let KC=(()=>{class e extends Pf{constructor(n,r){if(super(),this._platformLocation=n,this._removeListenerFns=[],null==r&&(r=this._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=r}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return Kx(this._baseHref,n)}path(n=!1){const r=this._platformLocation.pathname+au(this._platformLocation.search),l=this._platformLocation.hash;return l&&n?`${r}${l}`:r}pushState(n,r,l,u){const _=this.prepareExternalUrl(l+au(u));this._platformLocation.pushState(n,r,_)}replaceState(n,r,l,u){const _=this.prepareExternalUrl(l+au(u));this._platformLocation.replaceState(n,r,_)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var r,l;null===(l=(r=this._platformLocation).historyGo)||void 0===l||l.call(r,n)}}return e.\u0275fac=function(n){return new(n||e)(Jt(zh),Jt(Jx,8))},e.\u0275prov=Sn({token:e,factory:e.\u0275fac}),e})(),YD=(()=>{class e extends Pf{constructor(n,r){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(n){const r=Kx(this._baseHref,n);return r.length>0?"#"+r:r}pushState(n,r,l,u){let _=this.prepareExternalUrl(l+au(u));0==_.length&&(_=this._platformLocation.pathname),this._platformLocation.pushState(n,r,_)}replaceState(n,r,l,u){let _=this.prepareExternalUrl(l+au(u));0==_.length&&(_=this._platformLocation.pathname),this._platformLocation.replaceState(n,r,_)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var r,l;null===(l=(r=this._platformLocation).historyGo)||void 0===l||l.call(r,n)}}return e.\u0275fac=function(n){return new(n||e)(Jt(zh),Jt(Jx,8))},e.\u0275prov=Sn({token:e,factory:e.\u0275fac}),e})(),eb=(()=>{class e{constructor(n,r){this._subject=new ft,this._urlChangeListeners=[],this._platformStrategy=n;const l=this._platformStrategy.getBaseHref();this._platformLocation=r,this._baseHref=QC(JC(l)),this._platformStrategy.onPopState(u=>{this._subject.emit({url:this.path(!0),pop:!0,state:u.state,type:u.type})})}path(n=!1){return this.normalize(this._platformStrategy.path(n))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+au(r))}normalize(n){return e.stripTrailingSlash(function QD(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,JC(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._platformStrategy.prepareExternalUrl(n)}go(n,r="",l=null){this._platformStrategy.pushState(l,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+au(r)),l)}replaceState(n,r="",l=null){this._platformStrategy.replaceState(l,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+au(r)),l)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(n=0){var r,l;null===(l=(r=this._platformStrategy).historyGo)||void 0===l||l.call(r,n)}onUrlChange(n){this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}))}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(l=>l(n,r))}subscribe(n,r,l){return this._subject.subscribe({next:n,error:r,complete:l})}}return e.normalizeQueryParams=au,e.joinWithSlash=Kx,e.stripTrailingSlash=QC,e.\u0275fac=function(n){return new(n||e)(Jt(Pf),Jt(zh))},e.\u0275prov=Sn({token:e,factory:function(){return function XD(){return new eb(Jt(Pf),Jt(zh))}()},providedIn:"root"}),e})();function JC(e){return e.replace(/\/index.html$/,"")}let lA=(()=>{class e{constructor(n,r,l,u){this._iterableDiffers=n,this._keyValueDiffers=r,this._ngEl=l,this._renderer=u,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(n){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof n?n.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(n){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof n?n.split(/\s+/):n,this._rawClass&&(N(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const n=this._iterableDiffer.diff(this._rawClass);n&&this._applyIterableChanges(n)}else if(this._keyValueDiffer){const n=this._keyValueDiffer.diff(this._rawClass);n&&this._applyKeyValueChanges(n)}}_applyKeyValueChanges(n){n.forEachAddedItem(r=>this._toggleClass(r.key,r.currentValue)),n.forEachChangedItem(r=>this._toggleClass(r.key,r.currentValue)),n.forEachRemovedItem(r=>{r.previousValue&&this._toggleClass(r.key,!1)})}_applyIterableChanges(n){n.forEachAddedItem(r=>{if("string"!=typeof r.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Ct(r.item)}`);this._toggleClass(r.item,!0)}),n.forEachRemovedItem(r=>this._toggleClass(r.item,!1))}_applyClasses(n){n&&(Array.isArray(n)||n instanceof Set?n.forEach(r=>this._toggleClass(r,!0)):Object.keys(n).forEach(r=>this._toggleClass(r,!!n[r])))}_removeClasses(n){n&&(Array.isArray(n)||n instanceof Set?n.forEach(r=>this._toggleClass(r,!1)):Object.keys(n).forEach(r=>this._toggleClass(r,!1)))}_toggleClass(n,r){(n=n.trim())&&n.split(/\s+/g).forEach(l=>{r?this._renderer.addClass(this._ngEl.nativeElement,l):this._renderer.removeClass(this._ngEl.nativeElement,l)})}}return e.\u0275fac=function(n){return new(n||e)(Vt(Ky),Vt(Sg),Vt(nu),Vt(Vy))},e.\u0275dir=zi({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e})();class zI{constructor(t,n,r,l){this.$implicit=t,this.ngForOf=n,this.index=r,this.count=l}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let cu=(()=>{class e{constructor(n,r,l){this._viewContainer=n,this._template=r,this._differs=l,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const r=this._viewContainer;n.forEachOperation((l,u,_)=>{if(null==l.previousIndex)r.createEmbeddedView(this._template,new zI(l.item,this._ngForOf,-1,-1),null===_?void 0:_);else if(null==_)r.remove(null===u?void 0:u);else if(null!==u){const v=r.get(u);r.move(v,_),cA(v,l)}});for(let l=0,u=r.length;l<u;l++){const v=r.get(l).context;v.index=l,v.count=u,v.ngForOf=this._ngForOf}n.forEachIdentityChange(l=>{cA(r.get(l.currentIndex),l)})}static ngTemplateContextGuard(n,r){return!0}}return e.\u0275fac=function(n){return new(n||e)(Vt(al),Vt(Ul),Vt(Ky))},e.\u0275dir=zi({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e})();function cA(e,t){e.context.$implicit=t.item}let uA=(()=>{class e{constructor(n,r){this._viewContainer=n,this._context=new FI,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){dA("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){dA("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,r){return!0}}return e.\u0275fac=function(n){return new(n||e)(Vt(al),Vt(Ul))},e.\u0275dir=zi({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e})();class FI{constructor(){this.$implicit=null,this.ngIf=null}}function dA(e,t){if(t&&!t.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${Ct(t)}'.`)}class ub{constructor(t,n){this._viewContainerRef=t,this._templateRef=n,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let cv=(()=>{class e{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(n){this._ngSwitch=n,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(n){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(n)}_matchCase(n){const r=n==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||r,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),r}_updateDefaultCases(n){if(this._defaultViews&&n!==this._defaultUsed){this._defaultUsed=n;for(let r=0;r<this._defaultViews.length;r++)this._defaultViews[r].enforceState(n)}}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275dir=zi({type:e,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),e})(),hA=(()=>{class e{constructor(n,r,l){this.ngSwitch=l,l._addCase(),this._view=new ub(n,r)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return e.\u0275fac=function(n){return new(n||e)(Vt(al),Vt(Ul),Vt(cv,9))},e.\u0275dir=zi({type:e,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),e})(),pA=(()=>{class e{constructor(n,r,l){l._addDefault(new ub(n,r))}}return e.\u0275fac=function(n){return new(n||e)(Vt(al),Vt(Ul),Vt(cv,9))},e.\u0275dir=zi({type:e,selectors:[["","ngSwitchDefault",""]]}),e})(),mA=(()=>{class e{constructor(n){this._viewContainerRef=n,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(n){if(n.ngTemplateOutlet){const r=this._viewContainerRef;this._viewRef&&r.remove(r.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?r.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&n.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return e.\u0275fac=function(n){return new(n||e)(Vt(al))},e.\u0275dir=zi({type:e,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[ds]}),e})();function cl(e,t){return new En(2100,"")}class jI{createSubscription(t,n){return t.subscribe({next:n,error:r=>{throw r}})}dispose(t){t.unsubscribe()}onDestroy(t){t.unsubscribe()}}class VI{createSubscription(t,n){return t.then(n,r=>{throw r})}dispose(t){}onDestroy(t){}}const UI=new VI,$I=new jI;let gA=(()=>{class e{constructor(n){this._ref=n,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(n){return this._obj?n!==this._obj?(this._dispose(),this.transform(n)):this._latestValue:(n&&this._subscribe(n),this._latestValue)}_subscribe(n){this._obj=n,this._strategy=this._selectStrategy(n),this._subscription=this._strategy.createSubscription(n,r=>this._updateLatestValue(n,r))}_selectStrategy(n){if(ky(n))return UI;if(fw(n))return $I;throw cl()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(n,r){n===this._obj&&(this._latestValue=r,this._ref.markForCheck())}}return e.\u0275fac=function(n){return new(n||e)(Vt(Yy,16))},e.\u0275pipe=Er({name:"async",type:e,pure:!1}),e})(),_A=(()=>{class e{transform(n){if(null==n)return null;if("string"!=typeof n)throw cl();return n.toUpperCase()}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275pipe=Er({name:"uppercase",type:e,pure:!0}),e})(),vA=(()=>{class e{transform(n,r,l){if(null==n)return null;if(!this.supports(n))throw cl();return n.slice(r,l)}supports(n){return"string"==typeof n||Array.isArray(n)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275pipe=Er({name:"slice",type:e,pure:!1}),e})(),Pg=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=hr({type:e}),e.\u0275inj=Li({}),e})();const xA="browser";let lP=(()=>{class e{}return e.\u0275prov=Sn({token:e,providedIn:"root",factory:()=>new cP(Jt(wa),window)}),e})();class cP{constructor(t,n){this.document=t,this.window=n,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const n=function uP(e,t){const n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow)){const r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let l=r.currentNode;for(;l;){const u=l.shadowRoot;if(u){const _=u.getElementById(t)||u.querySelector(`[name="${t}"]`);if(_)return _}l=r.nextNode()}}return null}(this.document,t);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const n=this.window.history;n&&n.scrollRestoration&&(n.scrollRestoration=t)}}scrollToElement(t){const n=t.getBoundingClientRect(),r=n.left+this.window.pageXOffset,l=n.top+this.window.pageYOffset,u=this.offset();this.window.scrollTo(r-u[0],l-u[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=bA(this.window.history)||bA(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch(t){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(t){return!1}}}function bA(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}class pb extends class hP extends class GD{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function $D(e){Jy||(Jy=e)}(new pb)}onAndCancel(t,n,r){return t.addEventListener(n,r,!1),()=>{t.removeEventListener(n,r,!1)}}dispatchEvent(t,n){t.dispatchEvent(n)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,n){return(n=n||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,n){return"window"===n?window:"document"===n?t:"body"===n?t.body:null}getBaseHref(t){const n=function pP(){return Og=Og||document.querySelector("base"),Og?Og.getAttribute("href"):null}();return null==n?null:function fP(e){uv=uv||document.createElement("a"),uv.setAttribute("href",e);const t=uv.pathname;return"/"===t.charAt(0)?t:`/${t}`}(n)}resetBaseElement(){Og=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return function RI(e,t){t=encodeURIComponent(t);for(const n of e.split(";")){const r=n.indexOf("="),[l,u]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(l.trim()===t)return decodeURIComponent(u)}return null}(document.cookie,t)}}let uv,Og=null;const wA=new Bn("TRANSITION_ID"),gP=[{provide:zx,useFactory:function mP(e,t,n){return()=>{n.get(Fx).donePromise.then(()=>{const r=Id(),l=t.querySelectorAll(`style[ng-transition="${e}"]`);for(let u=0;u<l.length;u++)r.remove(l[u])})}},deps:[wA,wa,Po],multi:!0}];class fb{static init(){!function gD(e){Gx=e}(new fb)}addToWindow(t){Vn.getAngularTestability=(r,l=!0)=>{const u=t.findTestabilityInTree(r,l);if(null==u)throw new Error("Could not find testability for element.");return u},Vn.getAllAngularTestabilities=()=>t.getAllTestabilities(),Vn.getAllAngularRootElements=()=>t.getAllRootElements(),Vn.frameworkStabilizers||(Vn.frameworkStabilizers=[]),Vn.frameworkStabilizers.push(r=>{const l=Vn.getAllAngularTestabilities();let u=l.length,_=!1;const v=function(w){_=_||w,u--,0==u&&r(_)};l.forEach(function(w){w.whenStable(v)})})}findTestabilityInTree(t,n,r){if(null==n)return null;const l=t.getTestability(n);return null!=l?l:r?Id().isShadowRoot(n)?this.findTestabilityInTree(t,n.host,!0):this.findTestabilityInTree(t,n.parentElement,!0):null}}let _P=(()=>{class e{build(){return new XMLHttpRequest}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Sn({token:e,factory:e.\u0275fac}),e})();const dv=new Bn("EventManagerPlugins");let hv=(()=>{class e{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(l=>l.manager=this),this._plugins=n.slice().reverse()}addEventListener(n,r,l){return this._findPluginFor(r).addEventListener(n,r,l)}addGlobalEventListener(n,r,l){return this._findPluginFor(r).addGlobalEventListener(n,r,l)}getZone(){return this._zone}_findPluginFor(n){const r=this._eventNameToPlugin.get(n);if(r)return r;const l=this._plugins;for(let u=0;u<l.length;u++){const _=l[u];if(_.supports(n))return this._eventNameToPlugin.set(n,_),_}throw new Error(`No event manager plugin found for event ${n}`)}}return e.\u0275fac=function(n){return new(n||e)(Jt(dv),Jt(Wr))},e.\u0275prov=Sn({token:e,factory:e.\u0275fac}),e})();class CA{constructor(t){this._doc=t}addGlobalEventListener(t,n,r){const l=Id().getGlobalEventTarget(this._doc,t);if(!l)throw new Error(`Unsupported event target ${l} for event ${n}`);return this.addEventListener(l,n,r)}}let AA=(()=>{class e{constructor(){this._stylesSet=new Set}addStyles(n){const r=new Set;n.forEach(l=>{this._stylesSet.has(l)||(this._stylesSet.add(l),r.add(l))}),this.onStylesAdded(r)}onStylesAdded(n){}getAllStyles(){return Array.from(this._stylesSet)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Sn({token:e,factory:e.\u0275fac}),e})(),kg=(()=>{class e extends AA{constructor(n){super(),this._doc=n,this._hostNodes=new Map,this._hostNodes.set(n.head,[])}_addStylesToHost(n,r,l){n.forEach(u=>{const _=this._doc.createElement("style");_.textContent=u,l.push(r.appendChild(_))})}addHost(n){const r=[];this._addStylesToHost(this._stylesSet,n,r),this._hostNodes.set(n,r)}removeHost(n){const r=this._hostNodes.get(n);r&&r.forEach(EA),this._hostNodes.delete(n)}onStylesAdded(n){this._hostNodes.forEach((r,l)=>{this._addStylesToHost(n,l,r)})}ngOnDestroy(){this._hostNodes.forEach(n=>n.forEach(EA))}}return e.\u0275fac=function(n){return new(n||e)(Jt(wa))},e.\u0275prov=Sn({token:e,factory:e.\u0275fac}),e})();function EA(e){Id().remove(e)}const mb={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},gb=/%COMP%/g;function pv(e,t,n){for(let r=0;r<t.length;r++){let l=t[r];Array.isArray(l)?pv(e,l,n):(l=l.replace(gb,e),n.push(l))}return n}function SA(e){return t=>{if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}let _b=(()=>{class e{constructor(n,r,l){this.eventManager=n,this.sharedStylesHost=r,this.appId=l,this.rendererByCompId=new Map,this.defaultRenderer=new yb(n)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;switch(r.encapsulation){case no.Emulated:{let l=this.rendererByCompId.get(r.id);return l||(l=new CP(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,l)),l.applyToHost(n),l}case 1:case no.ShadowDom:return new AP(this.eventManager,this.sharedStylesHost,n,r);default:if(!this.rendererByCompId.has(r.id)){const l=pv(r.id,r.styles,[]);this.sharedStylesHost.addStyles(l),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return e.\u0275fac=function(n){return new(n||e)(Jt(hv),Jt(kg),Jt(Mg))},e.\u0275prov=Sn({token:e,factory:e.\u0275fac}),e})();class yb{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,n){return n?document.createElementNS(mb[n]||n,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,n){t.appendChild(n)}insertBefore(t,n,r){t&&t.insertBefore(n,r)}removeChild(t,n){t&&t.removeChild(n)}selectRootElement(t,n){let r="string"==typeof t?document.querySelector(t):t;if(!r)throw new Error(`The selector "${t}" did not match any elements`);return n||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,n,r,l){if(l){n=l+":"+n;const u=mb[l];u?t.setAttributeNS(u,n,r):t.setAttribute(n,r)}else t.setAttribute(n,r)}removeAttribute(t,n,r){if(r){const l=mb[r];l?t.removeAttributeNS(l,n):t.removeAttribute(`${r}:${n}`)}else t.removeAttribute(n)}addClass(t,n){t.classList.add(n)}removeClass(t,n){t.classList.remove(n)}setStyle(t,n,r,l){l&(Yo.DashCase|Yo.Important)?t.style.setProperty(n,r,l&Yo.Important?"important":""):t.style[n]=r}removeStyle(t,n,r){r&Yo.DashCase?t.style.removeProperty(n):t.style[n]=""}setProperty(t,n,r){t[n]=r}setValue(t,n){t.nodeValue=n}listen(t,n,r){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,n,SA(r)):this.eventManager.addEventListener(t,n,SA(r))}}class CP extends yb{constructor(t,n,r,l){super(t),this.component=r;const u=pv(l+"-"+r.id,r.styles,[]);n.addStyles(u),this.contentAttr=function xP(e){return"_ngcontent-%COMP%".replace(gb,e)}(l+"-"+r.id),this.hostAttr=function bP(e){return"_nghost-%COMP%".replace(gb,e)}(l+"-"+r.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,n){const r=super.createElement(t,n);return super.setAttribute(r,this.contentAttr,""),r}}class AP extends yb{constructor(t,n,r,l){super(t),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const u=pv(l.id,l.styles,[]);for(let _=0;_<u.length;_++){const v=document.createElement("style");v.textContent=u[_],this.shadowRoot.appendChild(v)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,n){return super.appendChild(this.nodeOrShadowRoot(t),n)}insertBefore(t,n,r){return super.insertBefore(this.nodeOrShadowRoot(t),n,r)}removeChild(t,n){return super.removeChild(this.nodeOrShadowRoot(t),n)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let EP=(()=>{class e extends CA{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,l){return n.addEventListener(r,l,!1),()=>this.removeEventListener(n,r,l)}removeEventListener(n,r,l){return n.removeEventListener(r,l)}}return e.\u0275fac=function(n){return new(n||e)(Jt(wa))},e.\u0275prov=Sn({token:e,factory:e.\u0275fac}),e})();const IA=["alt","control","meta","shift"],MP={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},PA={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},SP={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let DP=(()=>{class e extends CA{constructor(n){super(n)}supports(n){return null!=e.parseEventName(n)}addEventListener(n,r,l){const u=e.parseEventName(r),_=e.eventCallback(u.fullKey,l,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Id().onAndCancel(n,u.domEventName,_))}static parseEventName(n){const r=n.toLowerCase().split("."),l=r.shift();if(0===r.length||"keydown"!==l&&"keyup"!==l)return null;const u=e._normalizeKey(r.pop());let _="";if(IA.forEach(w=>{const T=r.indexOf(w);T>-1&&(r.splice(T,1),_+=w+".")}),_+=u,0!=r.length||0===u.length)return null;const v={};return v.domEventName=l,v.fullKey=_,v}static getEventFullKey(n){let r="",l=function IP(e){let t=e.key;if(null==t){if(t=e.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&PA.hasOwnProperty(t)&&(t=PA[t]))}return MP[t]||t}(n);return l=l.toLowerCase()," "===l?l="space":"."===l&&(l="dot"),IA.forEach(u=>{u!=l&&SP[u](n)&&(r+=u+".")}),r+=l,r}static eventCallback(n,r,l){return u=>{e.getEventFullKey(u)===n&&l.runGuarded(()=>r(u))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return e.\u0275fac=function(n){return new(n||e)(Jt(wa))},e.\u0275prov=Sn({token:e,factory:e.\u0275fac}),e})();const RP=RC(jD,"browser",[{provide:Nx,useValue:xA},{provide:TC,useValue:function PP(){pb.makeCurrent(),fb.init()},multi:!0},{provide:wa,useFactory:function kP(){return function yc(e){_c=e}(document),document},deps:[]}]),LP=[{provide:Km,useValue:"root"},{provide:dh,useFactory:function OP(){return new dh},deps:[]},{provide:dv,useClass:EP,multi:!0,deps:[wa,Wr,Nx]},{provide:dv,useClass:DP,multi:!0,deps:[wa]},{provide:_b,useClass:_b,deps:[hv,kg,Mg]},{provide:j1,useExisting:_b},{provide:AA,useExisting:kg},{provide:kg,useClass:kg,deps:[wa]},{provide:$x,useClass:$x,deps:[Wr]},{provide:hv,useClass:hv,deps:[dv,Wr]},{provide:class dP{},useClass:_P,deps:[]}];let zP=(()=>{class e{constructor(n){if(n)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(n){return{ngModule:e,providers:[{provide:Mg,useValue:n.appId},{provide:wA,useExisting:Mg},gP]}}}return e.\u0275fac=function(n){return new(n||e)(Jt(e,12))},e.\u0275mod=hr({type:e}),e.\u0275inj=Li({providers:LP,imports:[Pg,VD]}),e})();function mn(...e){return Si(e,Mn(e))}"undefined"!=typeof window&&window;class ul extends bi{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const n=super._subscribe(t);return!n.closed&&t.next(this._value),n}getValue(){const{hasError:t,thrownError:n,_value:r}=this;if(t)throw n;return this._throwIfClosed(),r}next(t){super.next(this._value=t)}}const{isArray:ZP}=Array,{getPrototypeOf:WP,prototype:YP,keys:XP}=Object;const{isArray:JP}=Array;function i2(...e){const t=Mn(e),n=function Ln(e){return _i(tn(e))?e.pop():void 0}(e),{args:r,keys:l}=function QP(e){if(1===e.length){const t=e[0];if(ZP(t))return{args:t,keys:null};if(function KP(e){return e&&"object"==typeof e&&WP(e)===YP}(t)){const n=XP(t);return{args:n.map(r=>t[r]),keys:n}}}return{args:e,keys:null}}(e);if(0===r.length)return Si([],t);const u=new Hn(function r2(e,t,n=yo){return r=>{RA(t,()=>{const{length:l}=e,u=new Array(l);let _=l,v=l;for(let w=0;w<l;w++)RA(t,()=>{const T=Si(e[w],t);let S=!1;T.subscribe(Mi(r,I=>{u[w]=I,S||(S=!0,v--),v||r.next(n(u.slice()))},()=>{--_||r.complete()}))},r)},r)}}(r,t,l?_=>function n2(e,t){return e.reduce((n,r,l)=>(n[r]=t[l],n),{})}(l,_):yo));return n?u.pipe(function t2(e){return Qn(t=>function e2(e,t){return JP(t)?e(...t):e(t)}(e,t))}(n)):u}function RA(e,t,n){e?Me(n,e,t):t()}function fv(e,t){const n=_i(e)?e:()=>e,r=l=>l.error(n());return new Hn(t?l=>t.schedule(r,0,l):r)}const mv=Fd(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function xb(...e){return function o2(){return Xe(1)}()(Si(e,Mn(e)))}function LA(e){return new Hn(t=>{V(e()).subscribe(t)})}function zA(){return wi((e,t)=>{let n=null;e._refCount++;const r=Mi(t,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(n=null);const l=e._connection,u=n;n=null,l&&(!u||l===u)&&l.unsubscribe(),t.unsubscribe()});e.subscribe(r),r.closed||(n=e.connect())})}class s2 extends Hn{constructor(t,n){super(),this.source=t,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,rs(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,null==t||t.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new ot;const n=this.getSubject();t.add(this.source.subscribe(Mi(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),t.closed&&(this._connection=null,t=ot.EMPTY)}return t}refCount(){return zA()(this)}}function Fh(e,t){return wi((n,r)=>{let l=null,u=0,_=!1;const v=()=>_&&!l&&r.complete();n.subscribe(Mi(r,w=>{null==l||l.unsubscribe();let T=0;const S=u++;V(e(w,S)).subscribe(l=Mi(r,I=>r.next(t?t(w,I,S,T++):I),()=>{l=null,v()}))},()=>{_=!0,v()}))})}function bb(e){return e<=0?()=>St:wi((t,n)=>{let r=0;t.subscribe(Mi(n,l=>{++r<=e&&(n.next(l),e<=r&&n.complete())}))})}function l2(e,t,n,r,l){return(u,_)=>{let v=n,w=t,T=0;u.subscribe(Mi(_,S=>{const I=T++;w=v?e(w,S,I):(v=!0,S),r&&_.next(w)},l&&(()=>{v&&_.next(w),_.complete()})))}}function FA(e,t){return wi(l2(e,t,arguments.length>=2,!0))}function Od(e,t){return wi((n,r)=>{let l=0;n.subscribe(Mi(r,u=>e.call(t,u,l++)&&r.next(u)))})}function kd(e){return wi((t,n)=>{let u,r=null,l=!1;r=t.subscribe(Mi(n,void 0,void 0,_=>{u=V(e(_,kd(e)(t))),r?(r.unsubscribe(),r=null,u.subscribe(n)):l=!0})),l&&(r.unsubscribe(),r=null,u.subscribe(n))})}function Rg(e,t){return _i(t)?st(e,t,1):st(e,1)}function wb(e){return e<=0?()=>St:wi((t,n)=>{let r=[];t.subscribe(Mi(n,l=>{r.push(l),e<r.length&&r.shift()},()=>{for(const l of r)n.next(l);n.complete()},void 0,()=>{r=null}))})}function BA(e=c2){return wi((t,n)=>{let r=!1;t.subscribe(Mi(n,l=>{r=!0,n.next(l)},()=>r?n.complete():n.error(e())))})}function c2(){return new mv}function NA(e){return wi((t,n)=>{let r=!1;t.subscribe(Mi(n,l=>{r=!0,n.next(l)},()=>{r||n.next(e),n.complete()}))})}function Of(e,t){const n=arguments.length>=2;return r=>r.pipe(e?Od((l,u)=>e(l,u,r)):yo,bb(1),n?NA(t):BA(()=>new mv))}function qs(e,t,n){const r=_i(e)||t||n?{next:e,error:t,complete:n}:e;return r?wi((l,u)=>{var _;null===(_=r.subscribe)||void 0===_||_.call(r);let v=!0;l.subscribe(Mi(u,w=>{var T;null===(T=r.next)||void 0===T||T.call(r,w),u.next(w)},()=>{var w;v=!1,null===(w=r.complete)||void 0===w||w.call(r),u.complete()},w=>{var T;v=!1,null===(T=r.error)||void 0===T||T.call(r,w),u.error(w)},()=>{var w,T;v&&(null===(w=r.unsubscribe)||void 0===w||w.call(r)),null===(T=r.finalize)||void 0===T||T.call(r)}))}):yo}class uu{constructor(t,n){this.id=t,this.url=n}}class Cb extends uu{constructor(t,n,r="imperative",l=null){super(t,n),this.navigationTrigger=r,this.restoredState=l}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Lg extends uu{constructor(t,n,r){super(t,n),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class jA extends uu{constructor(t,n,r){super(t,n),this.reason=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class h2 extends uu{constructor(t,n,r){super(t,n),this.error=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class p2 extends uu{constructor(t,n,r,l){super(t,n),this.urlAfterRedirects=r,this.state=l}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class f2 extends uu{constructor(t,n,r,l){super(t,n),this.urlAfterRedirects=r,this.state=l}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class m2 extends uu{constructor(t,n,r,l,u){super(t,n),this.urlAfterRedirects=r,this.state=l,this.shouldActivate=u}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class g2 extends uu{constructor(t,n,r,l){super(t,n),this.urlAfterRedirects=r,this.state=l}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class _2 extends uu{constructor(t,n,r,l){super(t,n),this.urlAfterRedirects=r,this.state=l}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class VA{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class UA{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class y2{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class v2{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class x2{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $A{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class GA{constructor(t,n,r){this.routerEvent=t,this.position=n,this.anchor=r}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Pn="primary";class b2{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n[0]:n}return null}getAll(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function kf(e){return new b2(e)}const HA="ngNavigationCancelingError";function Ab(e){const t=Error("NavigationCancelingError: "+e);return t[HA]=!0,t}function C2(e,t,n){const r=n.path.split("/");if(r.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;const l={};for(let u=0;u<r.length;u++){const _=r[u],v=e[u];if(_.startsWith(":"))l[_.substring(1)]=v;else if(_!==v.path)return null}return{consumed:e.slice(0,r.length),posParams:l}}function $l(e,t){const n=e?Object.keys(e):void 0,r=t?Object.keys(t):void 0;if(!n||!r||n.length!=r.length)return!1;let l;for(let u=0;u<n.length;u++)if(l=n[u],!qA(e[l],t[l]))return!1;return!0}function qA(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;const n=[...e].sort(),r=[...t].sort();return n.every((l,u)=>r[u]===l)}return e===t}function ZA(e){return Array.prototype.concat.apply([],e)}function WA(e){return e.length>0?e[e.length-1]:null}function mo(e,t){for(const n in e)e.hasOwnProperty(n)&&t(e[n],n)}function Gl(e){return mw(e)?e:ky(e)?Si(Promise.resolve(e)):mn(e)}const T2={exact:function QA(e,t,n){if(!Nh(e.segments,t.segments)||!gv(e.segments,t.segments,n)||e.numberOfChildren!==t.numberOfChildren)return!1;for(const r in t.children)if(!e.children[r]||!QA(e.children[r],t.children[r],n))return!1;return!0},subset:KA},YA={exact:function M2(e,t){return $l(e,t)},subset:function S2(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(n=>qA(e[n],t[n]))},ignored:()=>!0};function XA(e,t,n){return T2[n.paths](e.root,t.root,n.matrixParams)&&YA[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function KA(e,t,n){return JA(e,t,t.segments,n)}function JA(e,t,n,r){if(e.segments.length>n.length){const l=e.segments.slice(0,n.length);return!(!Nh(l,n)||t.hasChildren()||!gv(l,n,r))}if(e.segments.length===n.length){if(!Nh(e.segments,n)||!gv(e.segments,n,r))return!1;for(const l in t.children)if(!e.children[l]||!KA(e.children[l],t.children[l],r))return!1;return!0}{const l=n.slice(0,e.segments.length),u=n.slice(e.segments.length);return!!(Nh(e.segments,l)&&gv(e.segments,l,r)&&e.children[Pn])&&JA(e.children[Pn],t,u,r)}}function gv(e,t,n){return t.every((r,l)=>YA[n](e[l].parameters,r.parameters))}class Bh{constructor(t,n,r){this.root=t,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=kf(this.queryParams)),this._queryParamMap}toString(){return P2.serialize(this)}}class Nn{constructor(t,n){this.segments=t,this.children=n,this.parent=null,mo(n,(r,l)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return _v(this)}}class zg{constructor(t,n){this.path=t,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=kf(this.parameters)),this._parameterMap}toString(){return rE(this)}}function Nh(e,t){return e.length===t.length&&e.every((n,r)=>n.path===t[r].path)}class eE{}class tE{parse(t){const n=new j2(t);return new Bh(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(t){const n=`/${Fg(t.root,!0)}`,r=function R2(e){const t=Object.keys(e).map(n=>{const r=e[n];return Array.isArray(r)?r.map(l=>`${yv(n)}=${yv(l)}`).join("&"):`${yv(n)}=${yv(r)}`}).filter(n=>!!n);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${n}${r}${"string"==typeof t.fragment?`#${function O2(e){return encodeURI(e)}(t.fragment)}`:""}`}}const P2=new tE;function _v(e){return e.segments.map(t=>rE(t)).join("/")}function Fg(e,t){if(!e.hasChildren())return _v(e);if(t){const n=e.children[Pn]?Fg(e.children[Pn],!1):"",r=[];return mo(e.children,(l,u)=>{u!==Pn&&r.push(`${u}:${Fg(l,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=function I2(e,t){let n=[];return mo(e.children,(r,l)=>{l===Pn&&(n=n.concat(t(r,l)))}),mo(e.children,(r,l)=>{l!==Pn&&(n=n.concat(t(r,l)))}),n}(e,(r,l)=>l===Pn?[Fg(e.children[Pn],!1)]:[`${l}:${Fg(r,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[Pn]?`${_v(e)}/${n[0]}`:`${_v(e)}/(${n.join("//")})`}}function nE(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function yv(e){return nE(e).replace(/%3B/gi,";")}function Eb(e){return nE(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function vv(e){return decodeURIComponent(e)}function iE(e){return vv(e.replace(/\+/g,"%20"))}function rE(e){return`${Eb(e.path)}${function k2(e){return Object.keys(e).map(t=>`;${Eb(t)}=${Eb(e[t])}`).join("")}(e.parameters)}`}const L2=/^[^\/()?;=#]+/;function xv(e){const t=e.match(L2);return t?t[0]:""}const z2=/^[^=?&#]+/,B2=/^[^&#]+/;class j2{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Nn([],{}):new Nn([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(n).length>0)&&(r[Pn]=new Nn(t,n)),r}parseSegment(){const t=xv(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new zg(vv(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const n=xv(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const l=xv(this.remaining);l&&(r=l,this.capture(r))}t[vv(n)]=vv(r)}parseQueryParam(t){const n=function F2(e){const t=e.match(z2);return t?t[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const _=function N2(e){const t=e.match(B2);return t?t[0]:""}(this.remaining);_&&(r=_,this.capture(r))}const l=iE(n),u=iE(r);if(t.hasOwnProperty(l)){let _=t[l];Array.isArray(_)||(_=[_],t[l]=_),_.push(u)}else t[l]=u}parseParens(t){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=xv(this.remaining),l=this.remaining[r.length];if("/"!==l&&")"!==l&&";"!==l)throw new Error(`Cannot parse url '${this.url}'`);let u;r.indexOf(":")>-1?(u=r.substr(0,r.indexOf(":")),this.capture(u),this.capture(":")):t&&(u=Pn);const _=this.parseChildren();n[u]=1===Object.keys(_).length?_[Pn]:new Nn([],_),this.consumeOptional("//")}return n}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class oE{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const n=this.pathFromRoot(t);return n.length>1?n[n.length-2]:null}children(t){const n=Tb(t,this._root);return n?n.children.map(r=>r.value):[]}firstChild(t){const n=Tb(t,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(t){const n=Mb(t,this._root);return n.length<2?[]:n[n.length-2].children.map(l=>l.value).filter(l=>l!==t)}pathFromRoot(t){return Mb(t,this._root).map(n=>n.value)}}function Tb(e,t){if(e===t.value)return t;for(const n of t.children){const r=Tb(e,n);if(r)return r}return null}function Mb(e,t){if(e===t.value)return[t];for(const n of t.children){const r=Mb(e,n);if(r.length)return r.unshift(t),r}return[]}class du{constructor(t,n){this.value=t,this.children=n}toString(){return`TreeNode(${this.value})`}}function Rf(e){const t={};return e&&e.children.forEach(n=>t[n.value.outlet]=n),t}class sE extends oE{constructor(t,n){super(t),this.snapshot=n,Sb(this,t)}toString(){return this.snapshot.toString()}}function aE(e,t){const n=function V2(e,t){const _=new bv([],{},{},"",{},Pn,t,null,e.root,-1,{});return new cE("",new du(_,[]))}(e,t),r=new ul([new zg("",{})]),l=new ul({}),u=new ul({}),_=new ul({}),v=new ul(""),w=new Lf(r,l,_,v,u,Pn,t,n.root);return w.snapshot=n.root,new sE(new du(w,[]),n)}class Lf{constructor(t,n,r,l,u,_,v,w){this.url=t,this.params=n,this.queryParams=r,this.fragment=l,this.data=u,this.outlet=_,this.component=v,this._futureSnapshot=w}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Qn(t=>kf(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Qn(t=>kf(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function lE(e,t="emptyOnly"){const n=e.pathFromRoot;let r=0;if("always"!==t)for(r=n.length-1;r>=1;){const l=n[r],u=n[r-1];if(l.routeConfig&&""===l.routeConfig.path)r--;else{if(u.component)break;r--}}return function U2(e){return e.reduce((t,n)=>({params:Object.assign(Object.assign({},t.params),n.params),data:Object.assign(Object.assign({},t.data),n.data),resolve:Object.assign(Object.assign({},t.resolve),n._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(r))}class bv{constructor(t,n,r,l,u,_,v,w,T,S,I){this.url=t,this.params=n,this.queryParams=r,this.fragment=l,this.data=u,this.outlet=_,this.component=v,this.routeConfig=w,this._urlSegment=T,this._lastPathIndex=S,this._resolve=I}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=kf(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=kf(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class cE extends oE{constructor(t,n){super(n),this.url=t,Sb(this,n)}toString(){return uE(this._root)}}function Sb(e,t){t.value._routerState=e,t.children.forEach(n=>Sb(e,n))}function uE(e){const t=e.children.length>0?` { ${e.children.map(uE).join(", ")} } `:"";return`${e.value}${t}`}function Db(e){if(e.snapshot){const t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,$l(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),$l(t.params,n.params)||e.params.next(n.params),function A2(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!$l(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),$l(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function Ib(e,t){const n=$l(e.params,t.params)&&function D2(e,t){return Nh(e,t)&&e.every((n,r)=>$l(n.parameters,t[r].parameters))}(e.url,t.url);return n&&!(!e.parent!=!t.parent)&&(!e.parent||Ib(e.parent,t.parent))}function Bg(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=t.value;const l=function G2(e,t,n){return t.children.map(r=>{for(const l of n.children)if(e.shouldReuseRoute(r.value,l.value.snapshot))return Bg(e,r,l);return Bg(e,r)})}(e,t,n);return new du(r,l)}{if(e.shouldAttach(t.value)){const u=e.retrieve(t.value);if(null!==u){const _=u.route;return _.value._futureSnapshot=t.value,_.children=t.children.map(v=>Bg(e,v)),_}}const r=function H2(e){return new Lf(new ul(e.url),new ul(e.params),new ul(e.queryParams),new ul(e.fragment),new ul(e.data),e.outlet,e.component,e)}(t.value),l=t.children.map(u=>Bg(e,u));return new du(r,l)}}function wv(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function Ng(e){return"object"==typeof e&&null!=e&&e.outlets}function Pb(e,t,n,r,l){let u={};if(r&&mo(r,(v,w)=>{u[w]=Array.isArray(v)?v.map(T=>`${T}`):`${v}`}),e===t)return new Bh(n,u,l);const _=dE(e,t,n);return new Bh(_,u,l)}function dE(e,t,n){const r={};return mo(e.children,(l,u)=>{r[u]=l===t?n:dE(l,t,n)}),new Nn(e.segments,r)}class hE{constructor(t,n,r){if(this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&wv(r[0]))throw new Error("Root segment cannot have matrix parameters");const l=r.find(Ng);if(l&&l!==WA(r))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Ob{constructor(t,n,r){this.segmentGroup=t,this.processChildren=n,this.index=r}}function pE(e,t,n){if(e||(e=new Nn([],{})),0===e.segments.length&&e.hasChildren())return Cv(e,t,n);const r=function Q2(e,t,n){let r=0,l=t;const u={match:!1,pathIndex:0,commandIndex:0};for(;l<e.segments.length;){if(r>=n.length)return u;const _=e.segments[l],v=n[r];if(Ng(v))break;const w=`${v}`,T=r<n.length-1?n[r+1]:null;if(l>0&&void 0===w)break;if(w&&T&&"object"==typeof T&&void 0===T.outlets){if(!mE(w,T,_))return u;r+=2}else{if(!mE(w,{},_))return u;r++}l++}return{match:!0,pathIndex:l,commandIndex:r}}(e,t,n),l=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){const u=new Nn(e.segments.slice(0,r.pathIndex),{});return u.children[Pn]=new Nn(e.segments.slice(r.pathIndex),e.children),Cv(u,0,l)}return r.match&&0===l.length?new Nn(e.segments,{}):r.match&&!e.hasChildren()?kb(e,t,n):r.match?Cv(e,0,l):kb(e,t,n)}function Cv(e,t,n){if(0===n.length)return new Nn(e.segments,{});{const r=function X2(e){return Ng(e[0])?e[0].outlets:{[Pn]:e}}(n),l={};return mo(r,(u,_)=>{"string"==typeof u&&(u=[u]),null!==u&&(l[_]=pE(e.children[_],t,u))}),mo(e.children,(u,_)=>{void 0===r[_]&&(l[_]=u)}),new Nn(e.segments,l)}}function kb(e,t,n){const r=e.segments.slice(0,t);let l=0;for(;l<n.length;){const u=n[l];if(Ng(u)){const w=K2(u.outlets);return new Nn(r,w)}if(0===l&&wv(n[0])){r.push(new zg(e.segments[t].path,fE(n[0]))),l++;continue}const _=Ng(u)?u.outlets[Pn]:`${u}`,v=l<n.length-1?n[l+1]:null;_&&v&&wv(v)?(r.push(new zg(_,fE(v))),l+=2):(r.push(new zg(_,{})),l++)}return new Nn(r,{})}function K2(e){const t={};return mo(e,(n,r)=>{"string"==typeof n&&(n=[n]),null!==n&&(t[r]=kb(new Nn([],{}),0,n))}),t}function fE(e){const t={};return mo(e,(n,r)=>t[r]=`${n}`),t}function mE(e,t,n){return e==n.path&&$l(t,n.parameters)}class eO{constructor(t,n,r,l){this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=l}activate(t){const n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,t),Db(this.futureState.root),this.activateChildRoutes(n,r,t)}deactivateChildRoutes(t,n,r){const l=Rf(n);t.children.forEach(u=>{const _=u.value.outlet;this.deactivateRoutes(u,l[_],r),delete l[_]}),mo(l,(u,_)=>{this.deactivateRouteAndItsChildren(u,r)})}deactivateRoutes(t,n,r){const l=t.value,u=n?n.value:null;if(l===u)if(l.component){const _=r.getContext(l.outlet);_&&this.deactivateChildRoutes(t,n,_.children)}else this.deactivateChildRoutes(t,n,r);else u&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(t,n){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,n):this.deactivateRouteAndOutlet(t,n)}detachAndStoreRouteSubtree(t,n){const r=n.getContext(t.value.outlet),l=r&&t.value.component?r.children:n,u=Rf(t);for(const _ of Object.keys(u))this.deactivateRouteAndItsChildren(u[_],l);if(r&&r.outlet){const _=r.outlet.detach(),v=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:_,route:t,contexts:v})}}deactivateRouteAndOutlet(t,n){const r=n.getContext(t.value.outlet),l=r&&t.value.component?r.children:n,u=Rf(t);for(const _ of Object.keys(u))this.deactivateRouteAndItsChildren(u[_],l);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(t,n,r){const l=Rf(n);t.children.forEach(u=>{this.activateRoutes(u,l[u.value.outlet],r),this.forwardEvent(new $A(u.value.snapshot))}),t.children.length&&this.forwardEvent(new v2(t.value.snapshot))}activateRoutes(t,n,r){const l=t.value,u=n?n.value:null;if(Db(l),l===u)if(l.component){const _=r.getOrCreateContext(l.outlet);this.activateChildRoutes(t,n,_.children)}else this.activateChildRoutes(t,n,r);else if(l.component){const _=r.getOrCreateContext(l.outlet);if(this.routeReuseStrategy.shouldAttach(l.snapshot)){const v=this.routeReuseStrategy.retrieve(l.snapshot);this.routeReuseStrategy.store(l.snapshot,null),_.children.onOutletReAttached(v.contexts),_.attachRef=v.componentRef,_.route=v.route.value,_.outlet&&_.outlet.attach(v.componentRef,v.route.value),Db(v.route.value),this.activateChildRoutes(t,null,_.children)}else{const v=function tO(e){for(let t=e.parent;t;t=t.parent){const n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(l.snapshot),w=v?v.module.componentFactoryResolver:null;_.attachRef=null,_.route=l,_.resolver=w,_.outlet&&_.outlet.activateWith(l,w),this.activateChildRoutes(t,null,_.children)}}else this.activateChildRoutes(t,null,r)}}class Rb{constructor(t,n){this.routes=t,this.module=n}}function Rd(e){return"function"==typeof e}function jh(e){return e instanceof Bh}const jg=Symbol("INITIAL_VALUE");function Vg(){return Fh(e=>i2(e.map(t=>t.pipe(bb(1),function a2(...e){const t=Mn(e);return wi((n,r)=>{(t?xb(e,n,t):xb(e,n)).subscribe(r)})}(jg)))).pipe(FA((t,n)=>{let r=!1;return n.reduce((l,u,_)=>l!==jg?l:(u===jg&&(r=!0),r||!1!==u&&_!==n.length-1&&!jh(u)?l:u),t)},jg),Od(t=>t!==jg),Qn(t=>jh(t)?t:!0===t),bb(1)))}class aO{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Ug,this.attachRef=null}}class Ug{constructor(){this.contexts=new Map}onChildOutletCreated(t,n){const r=this.getOrCreateContext(t);r.outlet=n,this.contexts.set(t,r)}onChildOutletDestroyed(t){const n=this.getContext(t);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let n=this.getContext(t);return n||(n=new aO,this.contexts.set(t,n)),n}getContext(t){return this.contexts.get(t)||null}}let Av=(()=>{class e{constructor(n,r,l,u,_){this.parentContexts=n,this.location=r,this.resolver=l,this.changeDetector=_,this.activated=null,this._activatedRoute=null,this.activateEvents=new ft,this.deactivateEvents=new ft,this.attachEvents=new ft,this.detachEvents=new ft,this.name=u||Pn,n.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const n=this.parentContexts.getContext(this.name);n&&n.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=n;const _=(r=r||this.resolver).resolveComponentFactory(n._futureSnapshot.routeConfig.component),v=this.parentContexts.getOrCreateContext(this.name).children,w=new lO(n,v,this.location.injector);this.activated=this.location.createComponent(_,this.location.length,w),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return e.\u0275fac=function(n){return new(n||e)(Vt(Ug),Vt(al),Vt(wg),Go("name"),Vt(Yy))},e.\u0275dir=zi({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),e})();class lO{constructor(t,n,r){this.route=t,this.childContexts=n,this.parent=r}get(t,n){return t===Lf?this.route:t===Ug?this.childContexts:this.parent.get(t,n)}}let gE=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(n,r){1&n&&Yt(0,"router-outlet")},directives:[Av],encapsulation:2}),e})();function _E(e,t=""){for(let n=0;n<e.length;n++){const r=e[n];cO(r,uO(t,r))}}function cO(e,t){e.children&&_E(e.children,t)}function uO(e,t){return t?e||t.path?e&&!t.path?`${e}/`:!e&&t.path?t.path:`${e}/${t.path}`:"":e}function Lb(e){const t=e.children&&e.children.map(Lb),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==Pn&&(n.component=gE),n}function Ea(e){return e.outlet||Pn}function yE(e,t){const n=e.filter(r=>Ea(r)===t);return n.push(...e.filter(r=>Ea(r)!==t)),n}const vE={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Ev(e,t,n){var r;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?Object.assign({},vE):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};const u=(t.matcher||C2)(n,e,t);if(!u)return Object.assign({},vE);const _={};mo(u.posParams,(w,T)=>{_[T]=w.path});const v=u.consumed.length>0?Object.assign(Object.assign({},_),u.consumed[u.consumed.length-1].parameters):_;return{matched:!0,consumedSegments:u.consumed,remainingSegments:n.slice(u.consumed.length),parameters:v,positionalParamSegments:null!==(r=u.posParams)&&void 0!==r?r:{}}}function Tv(e,t,n,r,l="corrected"){if(n.length>0&&function pO(e,t,n){return n.some(r=>Mv(e,t,r)&&Ea(r)!==Pn)}(e,n,r)){const _=new Nn(t,function hO(e,t,n,r){const l={};l[Pn]=r,r._sourceSegment=e,r._segmentIndexShift=t.length;for(const u of n)if(""===u.path&&Ea(u)!==Pn){const _=new Nn([],{});_._sourceSegment=e,_._segmentIndexShift=t.length,l[Ea(u)]=_}return l}(e,t,r,new Nn(n,e.children)));return _._sourceSegment=e,_._segmentIndexShift=t.length,{segmentGroup:_,slicedSegments:[]}}if(0===n.length&&function fO(e,t,n){return n.some(r=>Mv(e,t,r))}(e,n,r)){const _=new Nn(e.segments,function dO(e,t,n,r,l,u){const _={};for(const v of r)if(Mv(e,n,v)&&!l[Ea(v)]){const w=new Nn([],{});w._sourceSegment=e,w._segmentIndexShift="legacy"===u?e.segments.length:t.length,_[Ea(v)]=w}return Object.assign(Object.assign({},l),_)}(e,t,n,r,e.children,l));return _._sourceSegment=e,_._segmentIndexShift=t.length,{segmentGroup:_,slicedSegments:n}}const u=new Nn(e.segments,e.children);return u._sourceSegment=e,u._segmentIndexShift=t.length,{segmentGroup:u,slicedSegments:n}}function Mv(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function xE(e,t,n,r){return!!(Ea(e)===r||r!==Pn&&Mv(t,n,e))&&("**"===e.path||Ev(t,e,n).matched)}function bE(e,t,n){return 0===t.length&&!e.children[n]}class Sv{constructor(t){this.segmentGroup=t||null}}class wE{constructor(t){this.urlTree=t}}function $g(e){return fv(new Sv(e))}function CE(e){return fv(new wE(e))}class yO{constructor(t,n,r,l,u){this.configLoader=n,this.urlSerializer=r,this.urlTree=l,this.config=u,this.allowRedirects=!0,this.ngModule=t.get(iu)}apply(){const t=Tv(this.urlTree.root,[],[],this.config).segmentGroup,n=new Nn(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,n,Pn).pipe(Qn(u=>this.createUrlTree(zb(u),this.urlTree.queryParams,this.urlTree.fragment))).pipe(kd(u=>{if(u instanceof wE)return this.allowRedirects=!1,this.match(u.urlTree);throw u instanceof Sv?this.noMatchError(u):u}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,Pn).pipe(Qn(l=>this.createUrlTree(zb(l),t.queryParams,t.fragment))).pipe(kd(l=>{throw l instanceof Sv?this.noMatchError(l):l}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,n,r){const l=t.segments.length>0?new Nn([],{[Pn]:t}):t;return new Bh(l,n,r)}expandSegmentGroup(t,n,r,l){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(t,n,r).pipe(Qn(u=>new Nn([],u))):this.expandSegment(t,r,n,r.segments,l,!0)}expandChildren(t,n,r){const l=[];for(const u of Object.keys(r.children))"primary"===u?l.unshift(u):l.push(u);return Si(l).pipe(Rg(u=>{const _=r.children[u],v=yE(n,u);return this.expandSegmentGroup(t,v,_,u).pipe(Qn(w=>({segment:w,outlet:u})))}),FA((u,_)=>(u[_.outlet]=_.segment,u),{}),function u2(e,t){const n=arguments.length>=2;return r=>r.pipe(e?Od((l,u)=>e(l,u,r)):yo,wb(1),n?NA(t):BA(()=>new mv))}())}expandSegment(t,n,r,l,u,_){return Si(r).pipe(Rg(v=>this.expandSegmentAgainstRoute(t,n,r,v,l,u,_).pipe(kd(T=>{if(T instanceof Sv)return mn(null);throw T}))),Of(v=>!!v),kd((v,w)=>{if(v instanceof mv||"EmptyError"===v.name)return bE(n,l,u)?mn(new Nn([],{})):$g(n);throw v}))}expandSegmentAgainstRoute(t,n,r,l,u,_,v){return xE(l,n,u,_)?void 0===l.redirectTo?this.matchSegmentAgainstRoute(t,n,l,u,_):v&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,n,r,l,u,_):$g(n):$g(n)}expandSegmentAgainstRouteUsingRedirect(t,n,r,l,u,_){return"**"===l.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,r,l,_):this.expandRegularSegmentAgainstRouteUsingRedirect(t,n,r,l,u,_)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,r,l){const u=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?CE(u):this.lineralizeSegments(r,u).pipe(st(_=>{const v=new Nn(_,{});return this.expandSegment(t,v,n,_,l,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,n,r,l,u,_){const{matched:v,consumedSegments:w,remainingSegments:T,positionalParamSegments:S}=Ev(n,l,u);if(!v)return $g(n);const I=this.applyRedirectCommands(w,l.redirectTo,S);return l.redirectTo.startsWith("/")?CE(I):this.lineralizeSegments(l,I).pipe(st(L=>this.expandSegment(t,n,r,L.concat(T),_,!1)))}matchSegmentAgainstRoute(t,n,r,l,u){if("**"===r.path)return r.loadChildren?(r._loadedConfig?mn(r._loadedConfig):this.configLoader.load(t.injector,r)).pipe(Qn(I=>(r._loadedConfig=I,new Nn(l,{})))):mn(new Nn(l,{}));const{matched:_,consumedSegments:v,remainingSegments:w}=Ev(n,r,l);return _?this.getChildConfig(t,r,l).pipe(st(S=>{const I=S.module,L=S.routes,{segmentGroup:j,slicedSegments:Z}=Tv(n,v,w,L),G=new Nn(j.segments,j.children);if(0===Z.length&&G.hasChildren())return this.expandChildren(I,L,G).pipe(Qn(fe=>new Nn(v,fe)));if(0===L.length&&0===Z.length)return mn(new Nn(v,{}));const Y=Ea(r)===u;return this.expandSegment(I,G,L,Z,Y?Pn:u,!0).pipe(Qn(ee=>new Nn(v.concat(ee.segments),ee.children)))})):$g(n)}getChildConfig(t,n,r){return n.children?mn(new Rb(n.children,t)):n.loadChildren?void 0!==n._loadedConfig?mn(n._loadedConfig):this.runCanLoadGuards(t.injector,n,r).pipe(st(l=>l?this.configLoader.load(t.injector,n).pipe(Qn(u=>(n._loadedConfig=u,u))):function gO(e){return fv(Ab(`Cannot load children because the guard of the route "path: '${e.path}'" returned false`))}(n))):mn(new Rb([],t))}runCanLoadGuards(t,n,r){const l=n.canLoad;return l&&0!==l.length?mn(l.map(_=>{const v=t.get(_);let w;if(function iO(e){return e&&Rd(e.canLoad)}(v))w=v.canLoad(n,r);else{if(!Rd(v))throw new Error("Invalid CanLoad guard");w=v(n,r)}return Gl(w)})).pipe(Vg(),qs(_=>{if(!jh(_))return;const v=Ab(`Redirecting to "${this.urlSerializer.serialize(_)}"`);throw v.url=_,v}),Qn(_=>!0===_)):mn(!0)}lineralizeSegments(t,n){let r=[],l=n.root;for(;;){if(r=r.concat(l.segments),0===l.numberOfChildren)return mn(r);if(l.numberOfChildren>1||!l.children[Pn])return fv(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t.redirectTo}'`));l=l.children[Pn]}}applyRedirectCommands(t,n,r){return this.applyRedirectCreatreUrlTree(n,this.urlSerializer.parse(n),t,r)}applyRedirectCreatreUrlTree(t,n,r,l){const u=this.createSegmentGroup(t,n.root,r,l);return new Bh(u,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(t,n){const r={};return mo(t,(l,u)=>{if("string"==typeof l&&l.startsWith(":")){const v=l.substring(1);r[u]=n[v]}else r[u]=l}),r}createSegmentGroup(t,n,r,l){const u=this.createSegments(t,n.segments,r,l);let _={};return mo(n.children,(v,w)=>{_[w]=this.createSegmentGroup(t,v,r,l)}),new Nn(u,_)}createSegments(t,n,r,l){return n.map(u=>u.path.startsWith(":")?this.findPosParam(t,u,l):this.findOrReturn(u,r))}findPosParam(t,n,r){const l=r[n.path.substring(1)];if(!l)throw new Error(`Cannot redirect to '${t}'. Cannot find '${n.path}'.`);return l}findOrReturn(t,n){let r=0;for(const l of n){if(l.path===t.path)return n.splice(r),l;r++}return t}}function zb(e){const t={};for(const r of Object.keys(e.children)){const u=zb(e.children[r]);(u.segments.length>0||u.hasChildren())&&(t[r]=u)}return function vO(e){if(1===e.numberOfChildren&&e.children[Pn]){const t=e.children[Pn];return new Nn(e.segments.concat(t.segments),t.children)}return e}(new Nn(e.segments,t))}class AE{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Dv{constructor(t,n){this.component=t,this.route=n}}function bO(e,t,n){const r=e._root;return Gg(r,t?t._root:null,n,[r.value])}function Iv(e,t,n){const r=function CO(e){if(!e)return null;for(let t=e.parent;t;t=t.parent){const n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function Gg(e,t,n,r,l={canDeactivateChecks:[],canActivateChecks:[]}){const u=Rf(t);return e.children.forEach(_=>{(function AO(e,t,n,r,l={canDeactivateChecks:[],canActivateChecks:[]}){const u=e.value,_=t?t.value:null,v=n?n.getContext(e.value.outlet):null;if(_&&u.routeConfig===_.routeConfig){const w=function EO(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!Nh(e.url,t.url);case"pathParamsOrQueryParamsChange":return!Nh(e.url,t.url)||!$l(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Ib(e,t)||!$l(e.queryParams,t.queryParams);default:return!Ib(e,t)}}(_,u,u.routeConfig.runGuardsAndResolvers);w?l.canActivateChecks.push(new AE(r)):(u.data=_.data,u._resolvedData=_._resolvedData),Gg(e,t,u.component?v?v.children:null:n,r,l),w&&v&&v.outlet&&v.outlet.isActivated&&l.canDeactivateChecks.push(new Dv(v.outlet.component,_))}else _&&Hg(t,v,l),l.canActivateChecks.push(new AE(r)),Gg(e,null,u.component?v?v.children:null:n,r,l)})(_,u[_.value.outlet],n,r.concat([_.value]),l),delete u[_.value.outlet]}),mo(u,(_,v)=>Hg(_,n.getContext(v),l)),l}function Hg(e,t,n){const r=Rf(e),l=e.value;mo(r,(u,_)=>{Hg(u,l.component?t?t.children.getContext(_):null:t,n)}),n.canDeactivateChecks.push(new Dv(l.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,l))}class RO{}function EE(e){return new Hn(t=>t.error(e))}class zO{constructor(t,n,r,l,u,_){this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=l,this.paramsInheritanceStrategy=u,this.relativeLinkResolution=_}recognize(){const t=Tv(this.urlTree.root,[],[],this.config.filter(_=>void 0===_.redirectTo),this.relativeLinkResolution).segmentGroup,n=this.processSegmentGroup(this.config,t,Pn);if(null===n)return null;const r=new bv([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Pn,this.rootComponentType,null,this.urlTree.root,-1,{}),l=new du(r,n),u=new cE(this.url,l);return this.inheritParamsAndData(u._root),u}inheritParamsAndData(t){const n=t.value,r=lE(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),t.children.forEach(l=>this.inheritParamsAndData(l))}processSegmentGroup(t,n,r){return 0===n.segments.length&&n.hasChildren()?this.processChildren(t,n):this.processSegment(t,n,n.segments,r)}processChildren(t,n){const r=[];for(const u of Object.keys(n.children)){const _=n.children[u],v=yE(t,u),w=this.processSegmentGroup(v,_,u);if(null===w)return null;r.push(...w)}const l=TE(r);return function FO(e){e.sort((t,n)=>t.value.outlet===Pn?-1:n.value.outlet===Pn?1:t.value.outlet.localeCompare(n.value.outlet))}(l),l}processSegment(t,n,r,l){for(const u of t){const _=this.processSegmentAgainstRoute(u,n,r,l);if(null!==_)return _}return bE(n,r,l)?[]:null}processSegmentAgainstRoute(t,n,r,l){if(t.redirectTo||!xE(t,n,r,l))return null;let u,_=[],v=[];if("**"===t.path){const j=r.length>0?WA(r).parameters:{};u=new bv(r,j,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,DE(t),Ea(t),t.component,t,ME(n),SE(n)+r.length,IE(t))}else{const j=Ev(n,t,r);if(!j.matched)return null;_=j.consumedSegments,v=j.remainingSegments,u=new bv(_,j.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,DE(t),Ea(t),t.component,t,ME(n),SE(n)+_.length,IE(t))}const w=function BO(e){return e.children?e.children:e.loadChildren?e._loadedConfig.routes:[]}(t),{segmentGroup:T,slicedSegments:S}=Tv(n,_,v,w.filter(j=>void 0===j.redirectTo),this.relativeLinkResolution);if(0===S.length&&T.hasChildren()){const j=this.processChildren(w,T);return null===j?null:[new du(u,j)]}if(0===w.length&&0===S.length)return[new du(u,[])];const I=Ea(t)===l,L=this.processSegment(w,T,S,I?Pn:l);return null===L?null:[new du(u,L)]}}function NO(e){const t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function TE(e){const t=[],n=new Set;for(const r of e){if(!NO(r)){t.push(r);continue}const l=t.find(u=>r.value.routeConfig===u.value.routeConfig);void 0!==l?(l.children.push(...r.children),n.add(l)):t.push(r)}for(const r of n){const l=TE(r.children);t.push(new du(r.value,l))}return t.filter(r=>!n.has(r))}function ME(e){let t=e;for(;t._sourceSegment;)t=t._sourceSegment;return t}function SE(e){let t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;for(;t._sourceSegment;)t=t._sourceSegment,n+=t._segmentIndexShift?t._segmentIndexShift:0;return n-1}function DE(e){return e.data||{}}function IE(e){return e.resolve||{}}function PE(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}function Fb(e){return Fh(t=>{const n=e(t);return n?Si(n).pipe(Qn(()=>t)):mn(t)})}class ZO extends class qO{shouldDetach(t){return!1}store(t,n){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,n){return t.routeConfig===n.routeConfig}}{}const Bb=new Bn("ROUTES");class OE{constructor(t,n,r,l){this.injector=t,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=l}load(t,n){if(n._loader$)return n._loader$;this.onLoadStartListener&&this.onLoadStartListener(n);const l=this.loadModuleFactory(n.loadChildren).pipe(Qn(u=>{this.onLoadEndListener&&this.onLoadEndListener(n);const _=u.create(t);return new Rb(ZA(_.injector.get(Bb,void 0,nn.Self|nn.Optional)).map(Lb),_)}),kd(u=>{throw n._loader$=void 0,u}));return n._loader$=new s2(l,()=>new bi).pipe(zA()),n._loader$}loadModuleFactory(t){return Gl(t()).pipe(st(n=>n instanceof $1?mn(n):Si(this.compiler.compileModuleAsync(n))))}}class YO{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,n){return t}}function XO(e){throw e}function QO(e,t,n){return t.parse("/")}function kE(e,t){return mn(null)}const KO={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},JO={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let vs=(()=>{class e{constructor(n,r,l,u,_,v,w){this.rootComponentType=n,this.urlSerializer=r,this.rootContexts=l,this.location=u,this.config=w,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new bi,this.errorHandler=XO,this.malformedUriErrorHandler=QO,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:kE,afterPreactivation:kE},this.urlHandlingStrategy=new YO,this.routeReuseStrategy=new ZO,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=_.get(iu),this.console=_.get(iD);const I=_.get(Wr);this.isNgZoneEnabled=I instanceof Wr&&Wr.isInAngularZone(),this.resetConfig(w),this.currentUrlTree=function E2(){return new Bh(new Nn([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new OE(_,v,L=>this.triggerEvent(new VA(L)),L=>this.triggerEvent(new UA(L))),this.routerState=aE(this.currentUrlTree,this.rootComponentType),this.transitions=new ul({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var n;return null===(n=this.location.getState())||void 0===n?void 0:n.\u0275routerPageId}setupNavigations(n){const r=this.events;return n.pipe(Od(l=>0!==l.id),Qn(l=>Object.assign(Object.assign({},l),{extractedUrl:this.urlHandlingStrategy.extract(l.rawUrl)})),Fh(l=>{let u=!1,_=!1;return mn(l).pipe(qs(v=>{this.currentNavigation={id:v.id,initialUrl:v.currentRawUrl,extractedUrl:v.extractedUrl,trigger:v.source,extras:v.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Fh(v=>{const w=this.browserUrlTree.toString(),T=!this.navigated||v.extractedUrl.toString()!==w||w!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||T)&&this.urlHandlingStrategy.shouldProcessUrl(v.rawUrl))return RE(v.source)&&(this.browserUrlTree=v.extractedUrl),mn(v).pipe(Fh(I=>{const L=this.transitions.getValue();return r.next(new Cb(I.id,this.serializeUrl(I.extractedUrl),I.source,I.restoredState)),L!==this.transitions.getValue()?St:Promise.resolve(I)}),function xO(e,t,n,r){return Fh(l=>function _O(e,t,n,r,l){return new yO(e,t,n,r,l).apply()}(e,t,n,l.extractedUrl,r).pipe(Qn(u=>Object.assign(Object.assign({},l),{urlAfterRedirects:u}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),qs(I=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:I.urlAfterRedirects})}),function jO(e,t,n,r,l){return st(u=>function LO(e,t,n,r,l="emptyOnly",u="legacy"){try{const _=new zO(e,t,n,r,l,u).recognize();return null===_?EE(new RO):mn(_)}catch(_){return EE(_)}}(e,t,u.urlAfterRedirects,n(u.urlAfterRedirects),r,l).pipe(Qn(_=>Object.assign(Object.assign({},u),{targetSnapshot:_}))))}(this.rootComponentType,this.config,I=>this.serializeUrl(I),this.paramsInheritanceStrategy,this.relativeLinkResolution),qs(I=>{if("eager"===this.urlUpdateStrategy){if(!I.extras.skipLocationChange){const j=this.urlHandlingStrategy.merge(I.urlAfterRedirects,I.rawUrl);this.setBrowserUrl(j,I)}this.browserUrlTree=I.urlAfterRedirects}const L=new p2(I.id,this.serializeUrl(I.extractedUrl),this.serializeUrl(I.urlAfterRedirects),I.targetSnapshot);r.next(L)}));if(T&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:L,extractedUrl:j,source:Z,restoredState:G,extras:Y}=v,ce=new Cb(L,this.serializeUrl(j),Z,G);r.next(ce);const ee=aE(j,this.rootComponentType).snapshot;return mn(Object.assign(Object.assign({},v),{targetSnapshot:ee,urlAfterRedirects:j,extras:Object.assign(Object.assign({},Y),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=v.rawUrl,v.resolve(null),St}),Fb(v=>{const{targetSnapshot:w,id:T,extractedUrl:S,rawUrl:I,extras:{skipLocationChange:L,replaceUrl:j}}=v;return this.hooks.beforePreactivation(w,{navigationId:T,appliedUrlTree:S,rawUrlTree:I,skipLocationChange:!!L,replaceUrl:!!j})}),qs(v=>{const w=new f2(v.id,this.serializeUrl(v.extractedUrl),this.serializeUrl(v.urlAfterRedirects),v.targetSnapshot);this.triggerEvent(w)}),Qn(v=>Object.assign(Object.assign({},v),{guards:bO(v.targetSnapshot,v.currentSnapshot,this.rootContexts)})),function TO(e,t){return st(n=>{const{targetSnapshot:r,currentSnapshot:l,guards:{canActivateChecks:u,canDeactivateChecks:_}}=n;return 0===_.length&&0===u.length?mn(Object.assign(Object.assign({},n),{guardsResult:!0})):function MO(e,t,n,r){return Si(e).pipe(st(l=>function kO(e,t,n,r,l){const u=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return u&&0!==u.length?mn(u.map(v=>{const w=Iv(v,t,l);let T;if(function sO(e){return e&&Rd(e.canDeactivate)}(w))T=Gl(w.canDeactivate(e,t,n,r));else{if(!Rd(w))throw new Error("Invalid CanDeactivate guard");T=Gl(w(e,t,n,r))}return T.pipe(Of())})).pipe(Vg()):mn(!0)}(l.component,l.route,n,t,r)),Of(l=>!0!==l,!0))}(_,r,l,e).pipe(st(v=>v&&function nO(e){return"boolean"==typeof e}(v)?function SO(e,t,n,r){return Si(t).pipe(Rg(l=>xb(function IO(e,t){return null!==e&&t&&t(new y2(e)),mn(!0)}(l.route.parent,r),function DO(e,t){return null!==e&&t&&t(new x2(e)),mn(!0)}(l.route,r),function OO(e,t,n){const r=t[t.length-1],u=t.slice(0,t.length-1).reverse().map(_=>function wO(e){const t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(_)).filter(_=>null!==_).map(_=>LA(()=>mn(_.guards.map(w=>{const T=Iv(w,_.node,n);let S;if(function oO(e){return e&&Rd(e.canActivateChild)}(T))S=Gl(T.canActivateChild(r,e));else{if(!Rd(T))throw new Error("Invalid CanActivateChild guard");S=Gl(T(r,e))}return S.pipe(Of())})).pipe(Vg())));return mn(u).pipe(Vg())}(e,l.path,n),function PO(e,t,n){const r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return mn(!0);const l=r.map(u=>LA(()=>{const _=Iv(u,t,n);let v;if(function rO(e){return e&&Rd(e.canActivate)}(_))v=Gl(_.canActivate(t,e));else{if(!Rd(_))throw new Error("Invalid CanActivate guard");v=Gl(_(t,e))}return v.pipe(Of())}));return mn(l).pipe(Vg())}(e,l.route,n))),Of(l=>!0!==l,!0))}(r,u,e,t):mn(v)),Qn(v=>Object.assign(Object.assign({},n),{guardsResult:v})))})}(this.ngModule.injector,v=>this.triggerEvent(v)),qs(v=>{if(jh(v.guardsResult)){const T=Ab(`Redirecting to "${this.serializeUrl(v.guardsResult)}"`);throw T.url=v.guardsResult,T}const w=new m2(v.id,this.serializeUrl(v.extractedUrl),this.serializeUrl(v.urlAfterRedirects),v.targetSnapshot,!!v.guardsResult);this.triggerEvent(w)}),Od(v=>!!v.guardsResult||(this.restoreHistory(v),this.cancelNavigationTransition(v,""),!1)),Fb(v=>{if(v.guards.canActivateChecks.length)return mn(v).pipe(qs(w=>{const T=new g2(w.id,this.serializeUrl(w.extractedUrl),this.serializeUrl(w.urlAfterRedirects),w.targetSnapshot);this.triggerEvent(T)}),Fh(w=>{let T=!1;return mn(w).pipe(function VO(e,t){return st(n=>{const{targetSnapshot:r,guards:{canActivateChecks:l}}=n;if(!l.length)return mn(n);let u=0;return Si(l).pipe(Rg(_=>function UO(e,t,n,r){return function $O(e,t,n,r){const l=PE(e);if(0===l.length)return mn({});const u={};return Si(l).pipe(st(_=>function GO(e,t,n,r){const l=Iv(e,t,r);return Gl(l.resolve?l.resolve(t,n):l(t,n))}(e[_],t,n,r).pipe(qs(v=>{u[_]=v}))),wb(1),st(()=>PE(u).length===l.length?mn(u):St))}(e._resolve,e,t,r).pipe(Qn(u=>(e._resolvedData=u,e.data=Object.assign(Object.assign({},e.data),lE(e,n).resolve),null)))}(_.route,r,e,t)),qs(()=>u++),wb(1),st(_=>u===l.length?mn(n):St))})}(this.paramsInheritanceStrategy,this.ngModule.injector),qs({next:()=>T=!0,complete:()=>{T||(this.restoreHistory(w),this.cancelNavigationTransition(w,"At least one route resolver didn't emit any value."))}}))}),qs(w=>{const T=new _2(w.id,this.serializeUrl(w.extractedUrl),this.serializeUrl(w.urlAfterRedirects),w.targetSnapshot);this.triggerEvent(T)}))}),Fb(v=>{const{targetSnapshot:w,id:T,extractedUrl:S,rawUrl:I,extras:{skipLocationChange:L,replaceUrl:j}}=v;return this.hooks.afterPreactivation(w,{navigationId:T,appliedUrlTree:S,rawUrlTree:I,skipLocationChange:!!L,replaceUrl:!!j})}),Qn(v=>{const w=function $2(e,t,n){const r=Bg(e,t._root,n?n._root:void 0);return new sE(r,t)}(this.routeReuseStrategy,v.targetSnapshot,v.currentRouterState);return Object.assign(Object.assign({},v),{targetRouterState:w})}),qs(v=>{this.currentUrlTree=v.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(v.urlAfterRedirects,v.rawUrl),this.routerState=v.targetRouterState,"deferred"===this.urlUpdateStrategy&&(v.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,v),this.browserUrlTree=v.urlAfterRedirects)}),((e,t,n)=>Qn(r=>(new eO(t,r.targetRouterState,r.currentRouterState,n).activate(e),r)))(this.rootContexts,this.routeReuseStrategy,v=>this.triggerEvent(v)),qs({next(){u=!0},complete(){u=!0}}),function d2(e){return wi((t,n)=>{try{t.subscribe(n)}finally{n.add(e)}})}(()=>{var v;u||_||this.cancelNavigationTransition(l,`Navigation ID ${l.id} is not equal to the current navigation id ${this.navigationId}`),(null===(v=this.currentNavigation)||void 0===v?void 0:v.id)===l.id&&(this.currentNavigation=null)}),kd(v=>{if(_=!0,function w2(e){return e&&e[HA]}(v)){const w=jh(v.url);w||(this.navigated=!0,this.restoreHistory(l,!0));const T=new jA(l.id,this.serializeUrl(l.extractedUrl),v.message);r.next(T),w?setTimeout(()=>{const S=this.urlHandlingStrategy.merge(v.url,this.rawUrlTree),I={skipLocationChange:l.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||RE(l.source)};this.scheduleNavigation(S,"imperative",null,I,{resolve:l.resolve,reject:l.reject,promise:l.promise})},0):l.resolve(!1)}else{this.restoreHistory(l,!0);const w=new h2(l.id,this.serializeUrl(l.extractedUrl),v);r.next(w);try{l.resolve(this.errorHandler(v))}catch(T){l.reject(T)}}return St}))}))}resetRootComponentType(n){this.rootComponentType=n,this.routerState.root.component=this.rootComponentType}setTransition(n){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),n))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const r="popstate"===n.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{var l;const u={replaceUrl:!0},_=(null===(l=n.state)||void 0===l?void 0:l.navigationId)?n.state:null;if(_){const w=Object.assign({},_);delete w.navigationId,delete w.\u0275routerPageId,0!==Object.keys(w).length&&(u.state=w)}const v=this.parseUrl(n.url);this.scheduleNavigation(v,r,_,u)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(n){this.events.next(n)}resetConfig(n){_E(n),this.config=n.map(Lb),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(n,r={}){const{relativeTo:l,queryParams:u,fragment:_,queryParamsHandling:v,preserveFragment:w}=r,T=l||this.routerState.root,S=w?this.currentUrlTree.fragment:_;let I=null;switch(v){case"merge":I=Object.assign(Object.assign({},this.currentUrlTree.queryParams),u);break;case"preserve":I=this.currentUrlTree.queryParams;break;default:I=u||null}return null!==I&&(I=this.removeEmptyProps(I)),function q2(e,t,n,r,l){if(0===n.length)return Pb(t.root,t.root,t.root,r,l);const u=function Z2(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new hE(!0,0,e);let t=0,n=!1;const r=e.reduce((l,u,_)=>{if("object"==typeof u&&null!=u){if(u.outlets){const v={};return mo(u.outlets,(w,T)=>{v[T]="string"==typeof w?w.split("/"):w}),[...l,{outlets:v}]}if(u.segmentPath)return[...l,u.segmentPath]}return"string"!=typeof u?[...l,u]:0===_?(u.split("/").forEach((v,w)=>{0==w&&"."===v||(0==w&&""===v?n=!0:".."===v?t++:""!=v&&l.push(v))}),l):[...l,u]},[]);return new hE(n,t,r)}(n);if(u.toRoot())return Pb(t.root,t.root,new Nn([],{}),r,l);const _=function W2(e,t,n){if(e.isAbsolute)return new Ob(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){const u=n.snapshot._urlSegment;return new Ob(u,u===t.root,0)}const r=wv(e.commands[0])?0:1;return function Y2(e,t,n){let r=e,l=t,u=n;for(;u>l;){if(u-=l,r=r.parent,!r)throw new Error("Invalid number of '../'");l=r.segments.length}return new Ob(r,!1,l-u)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+r,e.numberOfDoubleDots)}(u,t,e),v=_.processChildren?Cv(_.segmentGroup,_.index,u.commands):pE(_.segmentGroup,_.index,u.commands);return Pb(t.root,_.segmentGroup,v,r,l)}(T,this.currentUrlTree,n,I,null!=S?S:null)}navigateByUrl(n,r={skipLocationChange:!1}){const l=jh(n)?n:this.parseUrl(n),u=this.urlHandlingStrategy.merge(l,this.rawUrlTree);return this.scheduleNavigation(u,"imperative",null,r)}navigate(n,r={skipLocationChange:!1}){return function ek(e){for(let t=0;t<e.length;t++){const n=e[t];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${t}`)}}(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let r;try{r=this.urlSerializer.parse(n)}catch(l){r=this.malformedUriErrorHandler(l,this.urlSerializer,n)}return r}isActive(n,r){let l;if(l=!0===r?Object.assign({},KO):!1===r?Object.assign({},JO):r,jh(n))return XA(this.currentUrlTree,n,l);const u=this.parseUrl(n);return XA(this.currentUrlTree,u,l)}removeEmptyProps(n){return Object.keys(n).reduce((r,l)=>{const u=n[l];return null!=u&&(r[l]=u),r},{})}processNavigations(){this.navigations.subscribe(n=>{this.navigated=!0,this.lastSuccessfulId=n.id,this.currentPageId=n.targetPageId,this.events.next(new Lg(n.id,this.serializeUrl(n.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,n.resolve(!0)},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)})}scheduleNavigation(n,r,l,u,_){var v,w;if(this.disposed)return Promise.resolve(!1);let T,S,I;_?(T=_.resolve,S=_.reject,I=_.promise):I=new Promise((Z,G)=>{T=Z,S=G});const L=++this.navigationId;let j;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(l=this.location.getState()),j=l&&l.\u0275routerPageId?l.\u0275routerPageId:u.replaceUrl||u.skipLocationChange?null!==(v=this.browserPageId)&&void 0!==v?v:0:(null!==(w=this.browserPageId)&&void 0!==w?w:0)+1):j=0,this.setTransition({id:L,targetPageId:j,source:r,restoredState:l,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:n,extras:u,resolve:T,reject:S,promise:I,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),I.catch(Z=>Promise.reject(Z))}setBrowserUrl(n,r){const l=this.urlSerializer.serialize(n),u=Object.assign(Object.assign({},r.extras.state),this.generateNgRouterState(r.id,r.targetPageId));this.location.isCurrentPathEqualTo(l)||r.extras.replaceUrl?this.location.replaceState(l,"",u):this.location.go(l,"",u)}restoreHistory(n,r=!1){var l,u;if("computed"===this.canceledNavigationResolution){const _=this.currentPageId-n.targetPageId;"popstate"!==n.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(l=this.currentNavigation)||void 0===l?void 0:l.finalUrl)||0===_?this.currentUrlTree===(null===(u=this.currentNavigation)||void 0===u?void 0:u.finalUrl)&&0===_&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(_)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(n,r){const l=new jA(n.id,this.serializeUrl(n.extractedUrl),r);this.triggerEvent(l),n.resolve(!1)}generateNgRouterState(n,r){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}}return e.\u0275fac=function(n){cx()},e.\u0275prov=Sn({token:e,factory:e.\u0275fac}),e})();function RE(e){return"imperative"!==e}let qg=(()=>{class e{constructor(n,r,l,u,_){this.router=n,this.route=r,this.tabIndexAttribute=l,this.renderer=u,this.el=_,this.commands=null,this.onChanges=new bi,this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){if(null!=this.tabIndexAttribute)return;const r=this.renderer,l=this.el.nativeElement;null!==n?r.setAttribute(l,"tabindex",n):r.removeAttribute(l,"tabindex")}ngOnChanges(n){this.onChanges.next(this)}set routerLink(n){null!=n?(this.commands=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){if(null===this.urlTree)return!0;const n={skipLocationChange:zf(this.skipLocationChange),replaceUrl:zf(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,n),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:zf(this.preserveFragment)})}}return e.\u0275fac=function(n){return new(n||e)(Vt(vs),Vt(Lf),Go("tabindex"),Vt(Vy),Vt(nu))},e.\u0275dir=zi({type:e,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(n,r){1&n&&Ry("click",function(){return r.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[ds]}),e})(),Pv=(()=>{class e{constructor(n,r,l){this.router=n,this.route=r,this.locationStrategy=l,this.commands=null,this.href=null,this.onChanges=new bi,this.subscription=n.events.subscribe(u=>{u instanceof Lg&&this.updateTargetUrlAndHref()})}set routerLink(n){this.commands=null!=n?Array.isArray(n)?n:[n]:null}ngOnChanges(n){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(n,r,l,u,_){if(0!==n||r||l||u||_||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const v={skipLocationChange:zf(this.skipLocationChange),replaceUrl:zf(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,v),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:zf(this.preserveFragment)})}}return e.\u0275fac=function(n){return new(n||e)(Vt(vs),Vt(Lf),Vt(Pf))},e.\u0275dir=zi({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(n,r){1&n&&Ry("click",function(u){return r.onClick(u.button,u.ctrlKey,u.shiftKey,u.altKey,u.metaKey)}),2&n&&Pe("target",r.target)("href",r.href,ad)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[ds]}),e})();function zf(e){return""===e||!!e}let LE=(()=>{class e{constructor(n,r,l,u,_,v){this.router=n,this.element=r,this.renderer=l,this.cdr=u,this.link=_,this.linkWithHref=v,this.classes=[],this.isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new ft,this.routerEventsSubscription=n.events.subscribe(w=>{w instanceof Lg&&this.update()})}ngAfterContentInit(){mn(this.links.changes,this.linksWithHrefs.changes,mn(null)).pipe(Xe()).subscribe(n=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){var n;null===(n=this.linkInputChangesSubscription)||void 0===n||n.unsubscribe();const r=[...this.links.toArray(),...this.linksWithHrefs.toArray(),this.link,this.linkWithHref].filter(l=>!!l).map(l=>l.onChanges);this.linkInputChangesSubscription=Si(r).pipe(Xe()).subscribe(l=>{this.isActive!==this.isLinkActive(this.router)(l)&&this.update()})}set routerLinkActive(n){const r=Array.isArray(n)?n:n.split(" ");this.classes=r.filter(l=>!!l)}ngOnChanges(n){this.update()}ngOnDestroy(){var n;this.routerEventsSubscription.unsubscribe(),null===(n=this.linkInputChangesSubscription)||void 0===n||n.unsubscribe()}update(){!this.links||!this.linksWithHrefs||!this.router.navigated||Promise.resolve().then(()=>{const n=this.hasActiveLinks();this.isActive!==n&&(this.isActive=n,this.cdr.markForCheck(),this.classes.forEach(r=>{n?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}),this.isActiveChange.emit(n))})}isLinkActive(n){const r=function tk(e){return!!e.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return l=>!!l.urlTree&&n.isActive(l.urlTree,r)}hasActiveLinks(){const n=this.isLinkActive(this.router);return this.link&&n(this.link)||this.linkWithHref&&n(this.linkWithHref)||this.links.some(n)||this.linksWithHrefs.some(n)}}return e.\u0275fac=function(n){return new(n||e)(Vt(vs),Vt(nu),Vt(Vy),Vt(Yy),Vt(qg,8),Vt(Pv,8))},e.\u0275dir=zi({type:e,selectors:[["","routerLinkActive",""]],contentQueries:function(n,r,l){if(1&n&&(Hy(l,qg,5),Hy(l,Pv,5)),2&n){let u;ou(u=su())&&(r.links=u),ou(u=su())&&(r.linksWithHrefs=u)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[ds]}),e})();class zE{}class FE{preload(t,n){return mn(null)}}let BE=(()=>{class e{constructor(n,r,l,u){this.router=n,this.injector=l,this.preloadingStrategy=u,this.loader=new OE(l,r,w=>n.triggerEvent(new VA(w)),w=>n.triggerEvent(new UA(w)))}setUpPreloading(){this.subscription=this.router.events.pipe(Od(n=>n instanceof Lg),Rg(()=>this.preload())).subscribe(()=>{})}preload(){const n=this.injector.get(iu);return this.processRoutes(n,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,r){const l=[];for(const u of r)if(u.loadChildren&&!u.canLoad&&u._loadedConfig){const _=u._loadedConfig;l.push(this.processRoutes(_.module,_.routes))}else u.loadChildren&&!u.canLoad?l.push(this.preloadConfig(n,u)):u.children&&l.push(this.processRoutes(n,u.children));return Si(l).pipe(Xe(),Qn(u=>{}))}preloadConfig(n,r){return this.preloadingStrategy.preload(r,()=>(r._loadedConfig?mn(r._loadedConfig):this.loader.load(n.injector,r)).pipe(st(u=>(r._loadedConfig=u,this.processRoutes(u.module,u.routes)))))}}return e.\u0275fac=function(n){return new(n||e)(Jt(vs),Jt(SC),Jt(Po),Jt(zE))},e.\u0275prov=Sn({token:e,factory:e.\u0275fac}),e})(),Nb=(()=>{class e{constructor(n,r,l={}){this.router=n,this.viewportScroller=r,this.options=l,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},l.scrollPositionRestoration=l.scrollPositionRestoration||"disabled",l.anchorScrolling=l.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(n=>{n instanceof Cb?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof Lg&&(this.lastId=n.id,this.scheduleScrollEvent(n,this.router.parseUrl(n.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(n=>{n instanceof GA&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,r){this.router.triggerEvent(new GA(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return e.\u0275fac=function(n){cx()},e.\u0275prov=Sn({token:e,factory:e.\u0275fac}),e})();const Vh=new Bn("ROUTER_CONFIGURATION"),NE=new Bn("ROUTER_FORROOT_GUARD"),ik=[eb,{provide:eE,useClass:tE},{provide:vs,useFactory:function lk(e,t,n,r,l,u,_={},v,w){const T=new vs(null,e,t,n,r,l,ZA(u));return v&&(T.urlHandlingStrategy=v),w&&(T.routeReuseStrategy=w),function ck(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy),e.canceledNavigationResolution&&(t.canceledNavigationResolution=e.canceledNavigationResolution)}(_,T),_.enableTracing&&T.events.subscribe(S=>{var I,L;null===(I=console.group)||void 0===I||I.call(console,`Router Event: ${S.constructor.name}`),console.log(S.toString()),console.log(S),null===(L=console.groupEnd)||void 0===L||L.call(console)}),T},deps:[eE,Ug,eb,Po,SC,Bb,Vh,[class WO{},new qa],[class HO{},new qa]]},Ug,{provide:Lf,useFactory:function uk(e){return e.routerState.root},deps:[vs]},BE,FE,class nk{preload(t,n){return n().pipe(kd(()=>mn(null)))}},{provide:Vh,useValue:{enableTracing:!1}}];function rk(){return new kC("Router",vs)}let hu=(()=>{class e{constructor(n,r){}static forRoot(n,r){return{ngModule:e,providers:[ik,jE(n),{provide:NE,useFactory:ak,deps:[[vs,new qa,new Wo]]},{provide:Vh,useValue:r||{}},{provide:Pf,useFactory:sk,deps:[zh,[new Ju(Jx),new qa],Vh]},{provide:Nb,useFactory:ok,deps:[vs,lP,Vh]},{provide:zE,useExisting:r&&r.preloadingStrategy?r.preloadingStrategy:FE},{provide:kC,multi:!0,useFactory:rk},[jb,{provide:zx,multi:!0,useFactory:dk,deps:[jb]},{provide:VE,useFactory:hk,deps:[jb]},{provide:MC,multi:!0,useExisting:VE}]]}}static forChild(n){return{ngModule:e,providers:[jE(n)]}}}return e.\u0275fac=function(n){return new(n||e)(Jt(NE,8),Jt(vs,8))},e.\u0275mod=hr({type:e}),e.\u0275inj=Li({}),e})();function ok(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new Nb(e,t,n)}function sk(e,t,n={}){return n.useHash?new YD(e,t):new KC(e,t)}function ak(e){return"guarded"}function jE(e){return[{provide:Kg,multi:!0,useValue:e},{provide:Bb,multi:!0,useValue:e}]}let jb=(()=>{class e{constructor(n){this.injector=n,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new bi}appInitializer(){return this.injector.get(qD,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let r=null;const l=new Promise(v=>r=v),u=this.injector.get(vs),_=this.injector.get(Vh);return"disabled"===_.initialNavigation?(u.setUpLocationChangeListener(),r(!0)):"enabled"===_.initialNavigation||"enabledBlocking"===_.initialNavigation?(u.hooks.afterPreactivation=()=>this.initNavigation?mn(null):(this.initNavigation=!0,r(!0),this.resultOfPreactivationDone),u.initialNavigation()):r(!0),l})}bootstrapListener(n){const r=this.injector.get(Vh),l=this.injector.get(BE),u=this.injector.get(Nb),_=this.injector.get(vs),v=this.injector.get(qx);n===v.components[0]&&(("enabledNonBlocking"===r.initialNavigation||void 0===r.initialNavigation)&&_.initialNavigation(),l.setUpPreloading(),u.init(),_.resetRootComponentType(v.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return e.\u0275fac=function(n){return new(n||e)(Jt(Po))},e.\u0275prov=Sn({token:e,factory:e.\u0275fac}),e})();function dk(e){return e.appInitializer.bind(e)}function hk(e){return e.bootstrapListener.bind(e)}const VE=new Bn("Router Initializer");let fk=(()=>{class e{constructor(){this.title="hairdress"}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(n,r){1&n&&Yt(0,"router-outlet")},directives:[Av],styles:[".custom-text-pink[_ngcontent-%COMP%]{color:#e0698d}.custom-bg-pink[_ngcontent-%COMP%]{background:#E0698D}"]}),e})();function UE(e){return null!==e&&"object"==typeof e&&"constructor"in e&&e.constructor===Object}function Vb(e={},t={}){Object.keys(t).forEach(n=>{void 0===e[n]?e[n]=t[n]:UE(t[n])&&UE(e[n])&&Object.keys(t[n]).length>0&&Vb(e[n],t[n])})}const $E={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector:()=>null,querySelectorAll:()=>[],getElementById:()=>null,createEvent:()=>({initEvent(){}}),createElement:()=>({children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName:()=>[]}),createElementNS:()=>({}),importNode:()=>null,location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function go(){const e="undefined"!=typeof document?document:{};return Vb(e,$E),e}const mk={document:$E,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle:()=>({getPropertyValue:()=>""}),Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia:()=>({}),requestAnimationFrame:e=>"undefined"==typeof setTimeout?(e(),null):setTimeout(e,0),cancelAnimationFrame(e){"undefined"!=typeof setTimeout&&clearTimeout(e)}};function Yr(){const e="undefined"!=typeof window?window:{};return Vb(e,mk),e}class Ld extends Array{constructor(t){"number"==typeof t?super(t):(super(...t||[]),function gk(e){const t=e.__proto__;Object.defineProperty(e,"__proto__",{get:()=>t,set(n){t.__proto__=n}})}(this))}}function Zg(e=[]){const t=[];return e.forEach(n=>{Array.isArray(n)?t.push(...Zg(n)):t.push(n)}),t}function GE(e,t){return Array.prototype.filter.call(e,t)}function gn(e,t){const n=Yr(),r=go();let l=[];if(!t&&e instanceof Ld)return e;if(!e)return new Ld(l);if("string"==typeof e){const u=e.trim();if(u.indexOf("<")>=0&&u.indexOf(">")>=0){let _="div";0===u.indexOf("<li")&&(_="ul"),0===u.indexOf("<tr")&&(_="tbody"),(0===u.indexOf("<td")||0===u.indexOf("<th"))&&(_="tr"),0===u.indexOf("<tbody")&&(_="table"),0===u.indexOf("<option")&&(_="select");const v=r.createElement(_);v.innerHTML=u;for(let w=0;w<v.childNodes.length;w+=1)l.push(v.childNodes[w])}else l=function vk(e,t){if("string"!=typeof e)return[e];const n=[],r=t.querySelectorAll(e);for(let l=0;l<r.length;l+=1)n.push(r[l]);return n}(e.trim(),t||r)}else if(e.nodeType||e===n||e===r)l.push(e);else if(Array.isArray(e)){if(e instanceof Ld)return e;l=e}return new Ld(function _k(e){const t=[];for(let n=0;n<e.length;n+=1)-1===t.indexOf(e[n])&&t.push(e[n]);return t}(l))}gn.fn=Ld.prototype;const nR="resize scroll".split(" ");function Ji(e){return function t(...n){if(void 0===n[0]){for(let r=0;r<this.length;r+=1)nR.indexOf(e)<0&&(e in this[r]?this[r][e]():gn(this[r]).trigger(e));return this}return this.on(e,...n)}}Ji("click"),Ji("blur"),Ji("focus"),Ji("focusin"),Ji("focusout"),Ji("keyup"),Ji("keydown"),Ji("keypress"),Ji("submit"),Ji("change"),Ji("mousedown"),Ji("mousemove"),Ji("mouseup"),Ji("mouseenter"),Ji("mouseleave"),Ji("mouseout"),Ji("mouseover"),Ji("touchstart"),Ji("touchend"),Ji("touchmove"),Ji("resize"),Ji("scroll");const HE={addClass:function xk(...e){const t=Zg(e.map(n=>n.split(" ")));return this.forEach(n=>{n.classList.add(...t)}),this},removeClass:function bk(...e){const t=Zg(e.map(n=>n.split(" ")));return this.forEach(n=>{n.classList.remove(...t)}),this},hasClass:function Ck(...e){const t=Zg(e.map(n=>n.split(" ")));return GE(this,n=>t.filter(r=>n.classList.contains(r)).length>0).length>0},toggleClass:function wk(...e){const t=Zg(e.map(n=>n.split(" ")));this.forEach(n=>{t.forEach(r=>{n.classList.toggle(r)})})},attr:function Ak(e,t){if(1===arguments.length&&"string"==typeof e)return this[0]?this[0].getAttribute(e):void 0;for(let n=0;n<this.length;n+=1)if(2===arguments.length)this[n].setAttribute(e,t);else for(const r in e)this[n][r]=e[r],this[n].setAttribute(r,e[r]);return this},removeAttr:function Ek(e){for(let t=0;t<this.length;t+=1)this[t].removeAttribute(e);return this},transform:function Tk(e){for(let t=0;t<this.length;t+=1)this[t].style.transform=e;return this},transition:function Mk(e){for(let t=0;t<this.length;t+=1)this[t].style.transitionDuration="string"!=typeof e?`${e}ms`:e;return this},on:function Sk(...e){let[t,n,r,l]=e;function u(T){const S=T.target;if(!S)return;const I=T.target.dom7EventData||[];if(I.indexOf(T)<0&&I.unshift(T),gn(S).is(n))r.apply(S,I);else{const L=gn(S).parents();for(let j=0;j<L.length;j+=1)gn(L[j]).is(n)&&r.apply(L[j],I)}}function _(T){const S=T&&T.target&&T.target.dom7EventData||[];S.indexOf(T)<0&&S.unshift(T),r.apply(this,S)}"function"==typeof e[1]&&([t,r,l]=e,n=void 0),l||(l=!1);const v=t.split(" ");let w;for(let T=0;T<this.length;T+=1){const S=this[T];if(n)for(w=0;w<v.length;w+=1){const I=v[w];S.dom7LiveListeners||(S.dom7LiveListeners={}),S.dom7LiveListeners[I]||(S.dom7LiveListeners[I]=[]),S.dom7LiveListeners[I].push({listener:r,proxyListener:u}),S.addEventListener(I,u,l)}else for(w=0;w<v.length;w+=1){const I=v[w];S.dom7Listeners||(S.dom7Listeners={}),S.dom7Listeners[I]||(S.dom7Listeners[I]=[]),S.dom7Listeners[I].push({listener:r,proxyListener:_}),S.addEventListener(I,_,l)}}return this},off:function Dk(...e){let[t,n,r,l]=e;"function"==typeof e[1]&&([t,r,l]=e,n=void 0),l||(l=!1);const u=t.split(" ");for(let _=0;_<u.length;_+=1){const v=u[_];for(let w=0;w<this.length;w+=1){const T=this[w];let S;if(!n&&T.dom7Listeners?S=T.dom7Listeners[v]:n&&T.dom7LiveListeners&&(S=T.dom7LiveListeners[v]),S&&S.length)for(let I=S.length-1;I>=0;I-=1){const L=S[I];r&&L.listener===r||r&&L.listener&&L.listener.dom7proxy&&L.listener.dom7proxy===r?(T.removeEventListener(v,L.proxyListener,l),S.splice(I,1)):r||(T.removeEventListener(v,L.proxyListener,l),S.splice(I,1))}}}return this},trigger:function Ik(...e){const t=Yr(),n=e[0].split(" "),r=e[1];for(let l=0;l<n.length;l+=1){const u=n[l];for(let _=0;_<this.length;_+=1){const v=this[_];if(t.CustomEvent){const w=new t.CustomEvent(u,{detail:r,bubbles:!0,cancelable:!0});v.dom7EventData=e.filter((T,S)=>S>0),v.dispatchEvent(w),v.dom7EventData=[],delete v.dom7EventData}}}return this},transitionEnd:function Pk(e){const t=this;return e&&t.on("transitionend",function n(r){r.target===this&&(e.call(this,r),t.off("transitionend",n))}),this},outerWidth:function Ok(e){if(this.length>0){if(e){const t=this.styles();return this[0].offsetWidth+parseFloat(t.getPropertyValue("margin-right"))+parseFloat(t.getPropertyValue("margin-left"))}return this[0].offsetWidth}return null},outerHeight:function kk(e){if(this.length>0){if(e){const t=this.styles();return this[0].offsetHeight+parseFloat(t.getPropertyValue("margin-top"))+parseFloat(t.getPropertyValue("margin-bottom"))}return this[0].offsetHeight}return null},styles:function Lk(){const e=Yr();return this[0]?e.getComputedStyle(this[0],null):{}},offset:function Rk(){if(this.length>0){const e=Yr(),t=go(),n=this[0],r=n.getBoundingClientRect(),l=t.body;return{top:r.top+(n===e?e.scrollY:n.scrollTop)-(n.clientTop||l.clientTop||0),left:r.left+(n===e?e.scrollX:n.scrollLeft)-(n.clientLeft||l.clientLeft||0)}}return null},css:function zk(e,t){const n=Yr();let r;if(1===arguments.length){if("string"!=typeof e){for(r=0;r<this.length;r+=1)for(const l in e)this[r].style[l]=e[l];return this}if(this[0])return n.getComputedStyle(this[0],null).getPropertyValue(e)}if(2===arguments.length&&"string"==typeof e){for(r=0;r<this.length;r+=1)this[r].style[e]=t;return this}return this},each:function Fk(e){return e?(this.forEach((t,n)=>{e.apply(t,[t,n])}),this):this},html:function Nk(e){if(void 0===e)return this[0]?this[0].innerHTML:null;for(let t=0;t<this.length;t+=1)this[t].innerHTML=e;return this},text:function jk(e){if(void 0===e)return this[0]?this[0].textContent.trim():null;for(let t=0;t<this.length;t+=1)this[t].textContent=e;return this},is:function Vk(e){const t=Yr(),n=go(),r=this[0];let l,u;if(!r||void 0===e)return!1;if("string"==typeof e){if(r.matches)return r.matches(e);if(r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(r.msMatchesSelector)return r.msMatchesSelector(e);for(l=gn(e),u=0;u<l.length;u+=1)if(l[u]===r)return!0;return!1}if(e===n)return r===n;if(e===t)return r===t;if(e.nodeType||e instanceof Ld){for(l=e.nodeType?[e]:e,u=0;u<l.length;u+=1)if(l[u]===r)return!0;return!1}return!1},index:function Uk(){let t,e=this[0];if(e){for(t=0;null!==(e=e.previousSibling);)1===e.nodeType&&(t+=1);return t}},eq:function $k(e){if(void 0===e)return this;const t=this.length;if(e>t-1)return gn([]);if(e<0){const n=t+e;return gn(n<0?[]:[this[n]])}return gn([this[e]])},append:function Gk(...e){let t;const n=go();for(let r=0;r<e.length;r+=1){t=e[r];for(let l=0;l<this.length;l+=1)if("string"==typeof t){const u=n.createElement("div");for(u.innerHTML=t;u.firstChild;)this[l].appendChild(u.firstChild)}else if(t instanceof Ld)for(let u=0;u<t.length;u+=1)this[l].appendChild(t[u]);else this[l].appendChild(t)}return this},prepend:function Hk(e){const t=go();let n,r;for(n=0;n<this.length;n+=1)if("string"==typeof e){const l=t.createElement("div");for(l.innerHTML=e,r=l.childNodes.length-1;r>=0;r-=1)this[n].insertBefore(l.childNodes[r],this[n].childNodes[0])}else if(e instanceof Ld)for(r=0;r<e.length;r+=1)this[n].insertBefore(e[r],this[n].childNodes[0]);else this[n].insertBefore(e,this[n].childNodes[0]);return this},next:function qk(e){return this.length>0?e?this[0].nextElementSibling&&gn(this[0].nextElementSibling).is(e)?gn([this[0].nextElementSibling]):gn([]):gn(this[0].nextElementSibling?[this[0].nextElementSibling]:[]):gn([])},nextAll:function Zk(e){const t=[];let n=this[0];if(!n)return gn([]);for(;n.nextElementSibling;){const r=n.nextElementSibling;e?gn(r).is(e)&&t.push(r):t.push(r),n=r}return gn(t)},prev:function Wk(e){if(this.length>0){const t=this[0];return e?t.previousElementSibling&&gn(t.previousElementSibling).is(e)?gn([t.previousElementSibling]):gn([]):gn(t.previousElementSibling?[t.previousElementSibling]:[])}return gn([])},prevAll:function Yk(e){const t=[];let n=this[0];if(!n)return gn([]);for(;n.previousElementSibling;){const r=n.previousElementSibling;e?gn(r).is(e)&&t.push(r):t.push(r),n=r}return gn(t)},parent:function Xk(e){const t=[];for(let n=0;n<this.length;n+=1)null!==this[n].parentNode&&(e?gn(this[n].parentNode).is(e)&&t.push(this[n].parentNode):t.push(this[n].parentNode));return gn(t)},parents:function Qk(e){const t=[];for(let n=0;n<this.length;n+=1){let r=this[n].parentNode;for(;r;)e?gn(r).is(e)&&t.push(r):t.push(r),r=r.parentNode}return gn(t)},closest:function Kk(e){let t=this;return void 0===e?gn([]):(t.is(e)||(t=t.parents(e).eq(0)),t)},find:function Jk(e){const t=[];for(let n=0;n<this.length;n+=1){const r=this[n].querySelectorAll(e);for(let l=0;l<r.length;l+=1)t.push(r[l])}return gn(t)},children:function eR(e){const t=[];for(let n=0;n<this.length;n+=1){const r=this[n].children;for(let l=0;l<r.length;l+=1)(!e||gn(r[l]).is(e))&&t.push(r[l])}return gn(t)},filter:function Bk(e){return gn(GE(this,e))},remove:function tR(){for(let e=0;e<this.length;e+=1)this[e].parentNode&&this[e].parentNode.removeChild(this[e]);return this}};Object.keys(HE).forEach(e=>{Object.defineProperty(gn.fn,e,{value:HE[e],writable:!0})});const ii=gn;function Ov(e,t=0){return setTimeout(e,t)}function Wg(){return Date.now()}function kv(e){return"object"==typeof e&&null!==e&&e.constructor&&"Object"===Object.prototype.toString.call(e).slice(8,-1)}function sR(e){return"undefined"!=typeof window&&void 0!==window.HTMLElement?e instanceof HTMLElement:e&&(1===e.nodeType||11===e.nodeType)}function Zs(...e){const t=Object(e[0]),n=["__proto__","constructor","prototype"];for(let r=1;r<e.length;r+=1){const l=e[r];if(null!=l&&!sR(l)){const u=Object.keys(Object(l)).filter(_=>n.indexOf(_)<0);for(let _=0,v=u.length;_<v;_+=1){const w=u[_],T=Object.getOwnPropertyDescriptor(l,w);void 0!==T&&T.enumerable&&(kv(t[w])&&kv(l[w])?l[w].__swiper__?t[w]=l[w]:Zs(t[w],l[w]):!kv(t[w])&&kv(l[w])?(t[w]={},l[w].__swiper__?t[w]=l[w]:Zs(t[w],l[w])):t[w]=l[w])}}}return t}function Rv(e,t,n){e.style.setProperty(t,n)}function qE({swiper:e,targetPosition:t,side:n}){const r=Yr(),l=-e.translate;let _,u=null;const v=e.params.speed;e.wrapperEl.style.scrollSnapType="none",r.cancelAnimationFrame(e.cssModeFrameID);const w=t>l?"next":"prev",T=(I,L)=>"next"===w&&I>=L||"prev"===w&&I<=L,S=()=>{_=(new Date).getTime(),null===u&&(u=_);const I=Math.max(Math.min((_-u)/v,1),0),L=.5-Math.cos(I*Math.PI)/2;let j=l+L*(t-l);if(T(j,t)&&(j=t),e.wrapperEl.scrollTo({[n]:j}),T(j,t))return e.wrapperEl.style.overflow="hidden",e.wrapperEl.style.scrollSnapType="",setTimeout(()=>{e.wrapperEl.style.overflow="",e.wrapperEl.scrollTo({[n]:j})}),void r.cancelAnimationFrame(e.cssModeFrameID);e.cssModeFrameID=r.requestAnimationFrame(S)};S()}let Ub,$b,Gb;function ZE(){return Ub||(Ub=function aR(){const e=Yr(),t=go();return{smoothScroll:t.documentElement&&"scrollBehavior"in t.documentElement.style,touch:!!("ontouchstart"in e||e.DocumentTouch&&t instanceof e.DocumentTouch),passiveListener:function(){let r=!1;try{const l=Object.defineProperty({},"passive",{get(){r=!0}});e.addEventListener("testPassiveListener",null,l)}catch(l){}return r}(),gestures:"ongesturestart"in e}}()),Ub}function WE({swiper:e,runCallbacks:t,direction:n,step:r}){const{activeIndex:l,previousIndex:u}=e;let _=n;if(_||(_=l>u?"next":l<u?"prev":"reset"),e.emit(`transition${r}`),t&&l!==u){if("reset"===_)return void e.emit(`slideResetTransition${r}`);e.emit(`slideChangeTransition${r}`),e.emit("next"===_?`slideNextTransition${r}`:`slidePrevTransition${r}`)}}function QR(e){const t=this,n=go(),r=Yr(),l=t.touchEventsData,{params:u,touches:_,enabled:v}=t;if(!v||t.animating&&u.preventInteractionOnTransition)return;!t.animating&&u.cssMode&&u.loop&&t.loopFix();let w=e;w.originalEvent&&(w=w.originalEvent);let T=ii(w.target);if("wrapper"===u.touchEventsTarget&&!T.closest(t.wrapperEl).length||(l.isTouchEvent="touchstart"===w.type,!l.isTouchEvent&&"which"in w&&3===w.which)||!l.isTouchEvent&&"button"in w&&w.button>0||l.isTouched&&l.isMoved)return;const S=!!u.noSwipingClass&&""!==u.noSwipingClass,I=e.composedPath?e.composedPath():e.path;S&&w.target&&w.target.shadowRoot&&I&&(T=ii(I[0]));const L=u.noSwipingSelector?u.noSwipingSelector:`.${u.noSwipingClass}`;if(u.noSwiping&&(w.target&&w.target.shadowRoot?function XR(e,t=this){return function n(r){if(!r||r===go()||r===Yr())return null;r.assignedSlot&&(r=r.assignedSlot);const l=r.closest(e);return l||r.getRootNode?l||n(r.getRootNode().host):null}(t)}(L,T[0]):T.closest(L)[0]))return void(t.allowClick=!0);if(u.swipeHandler&&!T.closest(u.swipeHandler)[0])return;_.currentX="touchstart"===w.type?w.targetTouches[0].pageX:w.pageX,_.currentY="touchstart"===w.type?w.targetTouches[0].pageY:w.pageY;const Z=_.currentX,G=_.currentY,Y=u.edgeSwipeDetection||u.iOSEdgeSwipeDetection,ce=u.edgeSwipeThreshold||u.iOSEdgeSwipeThreshold;if(Y&&(Z<=ce||Z>=r.innerWidth-ce)){if("prevent"!==Y)return;e.preventDefault()}if(Object.assign(l,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),_.startX=Z,_.startY=G,l.touchStartTime=Wg(),t.allowClick=!0,t.updateSize(),t.swipeDirection=void 0,u.threshold>0&&(l.allowThresholdMove=!1),"touchstart"!==w.type){let ee=!0;T.is(l.focusableElements)&&(ee=!1,"SELECT"===T[0].nodeName&&(l.isTouched=!1)),n.activeElement&&ii(n.activeElement).is(l.focusableElements)&&n.activeElement!==T[0]&&n.activeElement.blur();const fe=ee&&t.allowTouchMove&&u.touchStartPreventDefault;(u.touchStartForcePreventDefault||fe)&&!T[0].isContentEditable&&w.preventDefault()}t.params.freeMode&&t.params.freeMode.enabled&&t.freeMode&&t.animating&&!u.cssMode&&t.freeMode.onTouchStart(),t.emit("touchStart",w)}function KR(e){const t=go(),n=this,r=n.touchEventsData,{params:l,touches:u,rtlTranslate:_,enabled:v}=n;if(!v)return;let w=e;if(w.originalEvent&&(w=w.originalEvent),!r.isTouched)return void(r.startMoving&&r.isScrolling&&n.emit("touchMoveOpposite",w));if(r.isTouchEvent&&"touchmove"!==w.type)return;const T="touchmove"===w.type&&w.targetTouches&&(w.targetTouches[0]||w.changedTouches[0]),S="touchmove"===w.type?T.pageX:w.pageX,I="touchmove"===w.type?T.pageY:w.pageY;if(w.preventedByNestedSwiper)return u.startX=S,void(u.startY=I);if(!n.allowTouchMove)return ii(w.target).is(r.focusableElements)||(n.allowClick=!1),void(r.isTouched&&(Object.assign(u,{startX:S,startY:I,currentX:S,currentY:I}),r.touchStartTime=Wg()));if(r.isTouchEvent&&l.touchReleaseOnEdges&&!l.loop)if(n.isVertical()){if(I<u.startY&&n.translate<=n.maxTranslate()||I>u.startY&&n.translate>=n.minTranslate())return r.isTouched=!1,void(r.isMoved=!1)}else if(S<u.startX&&n.translate<=n.maxTranslate()||S>u.startX&&n.translate>=n.minTranslate())return;if(r.isTouchEvent&&t.activeElement&&w.target===t.activeElement&&ii(w.target).is(r.focusableElements))return r.isMoved=!0,void(n.allowClick=!1);if(r.allowTouchCallbacks&&n.emit("touchMove",w),w.targetTouches&&w.targetTouches.length>1)return;u.currentX=S,u.currentY=I;const L=u.currentX-u.startX,j=u.currentY-u.startY;if(n.params.threshold&&Math.sqrt(L**2+j**2)<n.params.threshold)return;if(void 0===r.isScrolling){let ce;n.isHorizontal()&&u.currentY===u.startY||n.isVertical()&&u.currentX===u.startX?r.isScrolling=!1:L*L+j*j>=25&&(ce=180*Math.atan2(Math.abs(j),Math.abs(L))/Math.PI,r.isScrolling=n.isHorizontal()?ce>l.touchAngle:90-ce>l.touchAngle)}if(r.isScrolling&&n.emit("touchMoveOpposite",w),void 0===r.startMoving&&(u.currentX!==u.startX||u.currentY!==u.startY)&&(r.startMoving=!0),r.isScrolling)return void(r.isTouched=!1);if(!r.startMoving)return;n.allowClick=!1,!l.cssMode&&w.cancelable&&w.preventDefault(),l.touchMoveStopPropagation&&!l.nested&&w.stopPropagation(),r.isMoved||(l.loop&&!l.cssMode&&n.loopFix(),r.startTranslate=n.getTranslate(),n.setTransition(0),n.animating&&n.$wrapperEl.trigger("webkitTransitionEnd transitionend"),r.allowMomentumBounce=!1,l.grabCursor&&(!0===n.allowSlideNext||!0===n.allowSlidePrev)&&n.setGrabCursor(!0),n.emit("sliderFirstMove",w)),n.emit("sliderMove",w),r.isMoved=!0;let Z=n.isHorizontal()?L:j;u.diff=Z,Z*=l.touchRatio,_&&(Z=-Z),n.swipeDirection=Z>0?"prev":"next",r.currentTranslate=Z+r.startTranslate;let G=!0,Y=l.resistanceRatio;if(l.touchReleaseOnEdges&&(Y=0),Z>0&&r.currentTranslate>n.minTranslate()?(G=!1,l.resistance&&(r.currentTranslate=n.minTranslate()-1+(-n.minTranslate()+r.startTranslate+Z)**Y)):Z<0&&r.currentTranslate<n.maxTranslate()&&(G=!1,l.resistance&&(r.currentTranslate=n.maxTranslate()+1-(n.maxTranslate()-r.startTranslate-Z)**Y)),G&&(w.preventedByNestedSwiper=!0),!n.allowSlideNext&&"next"===n.swipeDirection&&r.currentTranslate<r.startTranslate&&(r.currentTranslate=r.startTranslate),!n.allowSlidePrev&&"prev"===n.swipeDirection&&r.currentTranslate>r.startTranslate&&(r.currentTranslate=r.startTranslate),!n.allowSlidePrev&&!n.allowSlideNext&&(r.currentTranslate=r.startTranslate),l.threshold>0){if(!(Math.abs(Z)>l.threshold||r.allowThresholdMove))return void(r.currentTranslate=r.startTranslate);if(!r.allowThresholdMove)return r.allowThresholdMove=!0,u.startX=u.currentX,u.startY=u.currentY,r.currentTranslate=r.startTranslate,void(u.diff=n.isHorizontal()?u.currentX-u.startX:u.currentY-u.startY)}!l.followFinger||l.cssMode||((l.freeMode&&l.freeMode.enabled&&n.freeMode||l.watchSlidesProgress)&&(n.updateActiveIndex(),n.updateSlidesClasses()),n.params.freeMode&&l.freeMode.enabled&&n.freeMode&&n.freeMode.onTouchMove(),n.updateProgress(r.currentTranslate),n.setTranslate(r.currentTranslate))}function JR(e){const t=this,n=t.touchEventsData,{params:r,touches:l,rtlTranslate:u,slidesGrid:_,enabled:v}=t;if(!v)return;let w=e;if(w.originalEvent&&(w=w.originalEvent),n.allowTouchCallbacks&&t.emit("touchEnd",w),n.allowTouchCallbacks=!1,!n.isTouched)return n.isMoved&&r.grabCursor&&t.setGrabCursor(!1),n.isMoved=!1,void(n.startMoving=!1);r.grabCursor&&n.isMoved&&n.isTouched&&(!0===t.allowSlideNext||!0===t.allowSlidePrev)&&t.setGrabCursor(!1);const T=Wg(),S=T-n.touchStartTime;if(t.allowClick){const ee=w.path||w.composedPath&&w.composedPath();t.updateClickedSlide(ee&&ee[0]||w.target),t.emit("tap click",w),S<300&&T-n.lastClickTime<300&&t.emit("doubleTap doubleClick",w)}if(n.lastClickTime=Wg(),Ov(()=>{t.destroyed||(t.allowClick=!0)}),!n.isTouched||!n.isMoved||!t.swipeDirection||0===l.diff||n.currentTranslate===n.startTranslate)return n.isTouched=!1,n.isMoved=!1,void(n.startMoving=!1);let I;if(n.isTouched=!1,n.isMoved=!1,n.startMoving=!1,I=r.followFinger?u?t.translate:-t.translate:-n.currentTranslate,r.cssMode)return;if(t.params.freeMode&&r.freeMode.enabled)return void t.freeMode.onTouchEnd({currentPos:I});let L=0,j=t.slidesSizesGrid[0];for(let ee=0;ee<_.length;ee+=ee<r.slidesPerGroupSkip?1:r.slidesPerGroup){const fe=ee<r.slidesPerGroupSkip-1?1:r.slidesPerGroup;void 0!==_[ee+fe]?I>=_[ee]&&I<_[ee+fe]&&(L=ee,j=_[ee+fe]-_[ee]):I>=_[ee]&&(L=ee,j=_[_.length-1]-_[_.length-2])}let Z=null,G=null;r.rewind&&(t.isBeginning?G=t.params.virtual&&t.params.virtual.enabled&&t.virtual?t.virtual.slides.length-1:t.slides.length-1:t.isEnd&&(Z=0));const Y=(I-_[L])/j,ce=L<r.slidesPerGroupSkip-1?1:r.slidesPerGroup;if(S>r.longSwipesMs){if(!r.longSwipes)return void t.slideTo(t.activeIndex);"next"===t.swipeDirection&&t.slideTo(Y>=r.longSwipesRatio?r.rewind&&t.isEnd?Z:L+ce:L),"prev"===t.swipeDirection&&(Y>1-r.longSwipesRatio?t.slideTo(L+ce):null!==G&&Y<0&&Math.abs(Y)>r.longSwipesRatio?t.slideTo(G):t.slideTo(L))}else{if(!r.shortSwipes)return void t.slideTo(t.activeIndex);!t.navigation||w.target!==t.navigation.nextEl&&w.target!==t.navigation.prevEl?("next"===t.swipeDirection&&t.slideTo(null!==Z?Z:L+ce),"prev"===t.swipeDirection&&t.slideTo(null!==G?G:L)):t.slideTo(w.target===t.navigation.nextEl?L+ce:L)}}function YE(){const e=this,{params:t,el:n}=e;if(n&&0===n.offsetWidth)return;t.breakpoints&&e.setBreakpoint();const{allowSlideNext:r,allowSlidePrev:l,snapGrid:u}=e;e.allowSlideNext=!0,e.allowSlidePrev=!0,e.updateSize(),e.updateSlides(),e.updateSlidesClasses(),e.slideTo(("auto"===t.slidesPerView||t.slidesPerView>1)&&e.isEnd&&!e.isBeginning&&!e.params.centeredSlides?e.slides.length-1:e.activeIndex,0,!1,!0),e.autoplay&&e.autoplay.running&&e.autoplay.paused&&e.autoplay.run(),e.allowSlidePrev=l,e.allowSlideNext=r,e.params.watchOverflow&&u!==e.snapGrid&&e.checkOverflow()}function eL(e){const t=this;!t.enabled||t.allowClick||(t.params.preventClicks&&e.preventDefault(),t.params.preventClicksPropagation&&t.animating&&(e.stopPropagation(),e.stopImmediatePropagation()))}function tL(){const e=this,{wrapperEl:t,rtlTranslate:n,enabled:r}=e;if(!r)return;let l;e.previousTranslate=e.translate,e.translate=e.isHorizontal()?-t.scrollLeft:-t.scrollTop,0===e.translate&&(e.translate=0),e.updateActiveIndex(),e.updateSlidesClasses();const u=e.maxTranslate()-e.minTranslate();l=0===u?0:(e.translate-e.minTranslate())/u,l!==e.progress&&e.updateProgress(n?-e.translate:e.translate),e.emit("setTranslate",e.translate,!1)}let XE=!1;function nL(){}const QE=(e,t)=>{const n=go(),{params:r,touchEvents:l,el:u,wrapperEl:_,device:v,support:w}=e,T=!!r.nested,S="on"===t?"addEventListener":"removeEventListener",I=t;if(w.touch){const L=!("touchstart"!==l.start||!w.passiveListener||!r.passiveListeners)&&{passive:!0,capture:!1};u[S](l.start,e.onTouchStart,L),u[S](l.move,e.onTouchMove,w.passiveListener?{passive:!1,capture:T}:T),u[S](l.end,e.onTouchEnd,L),l.cancel&&u[S](l.cancel,e.onTouchEnd,L)}else u[S](l.start,e.onTouchStart,!1),n[S](l.move,e.onTouchMove,T),n[S](l.end,e.onTouchEnd,!1);(r.preventClicks||r.preventClicksPropagation)&&u[S]("click",e.onClick,!0),r.cssMode&&_[S]("scroll",e.onScroll),e[I](r.updateOnWindowResize?v.ios||v.android?"resize orientationchange observerUpdate":"resize observerUpdate":"observerUpdate",YE,!0)},KE=(e,t)=>e.grid&&t.grid&&t.grid.rows>1,JE={init:!0,direction:"horizontal",touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:0,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,preloadImages:!0,updateOnImagesReady:!0,loop:!1,loopAdditionalSlides:0,loopedSlides:null,loopedSlidesLimit:!0,loopFillGroupWithBlank:!1,loopPreventsSlide:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-invisible-blank",slideActiveClass:"swiper-slide-active",slideDuplicateActiveClass:"swiper-slide-duplicate-active",slideVisibleClass:"swiper-slide-visible",slideDuplicateClass:"swiper-slide-duplicate",slideNextClass:"swiper-slide-next",slideDuplicateNextClass:"swiper-slide-duplicate-next",slidePrevClass:"swiper-slide-prev",slideDuplicatePrevClass:"swiper-slide-duplicate-prev",wrapperClass:"swiper-wrapper",runCallbacksOnInit:!0,_emitClasses:!1};function yL(e,t){return function(r={}){const l=Object.keys(r)[0],u=r[l];"object"==typeof u&&null!==u?(["navigation","pagination","scrollbar"].indexOf(l)>=0&&!0===e[l]&&(e[l]={auto:!0}),l in e&&"enabled"in u?(!0===e[l]&&(e[l]={enabled:!0}),"object"==typeof e[l]&&!("enabled"in e[l])&&(e[l].enabled=!0),e[l]||(e[l]={enabled:!1}),Zs(t,r)):Zs(t,r)):Zs(t,r)}}const Hb={eventsEmitter:{on(e,t,n){const r=this;if(!r.eventsListeners||r.destroyed||"function"!=typeof t)return r;const l=n?"unshift":"push";return e.split(" ").forEach(u=>{r.eventsListeners[u]||(r.eventsListeners[u]=[]),r.eventsListeners[u][l](t)}),r},once(e,t,n){const r=this;if(!r.eventsListeners||r.destroyed||"function"!=typeof t)return r;function l(...u){r.off(e,l),l.__emitterProxy&&delete l.__emitterProxy,t.apply(r,u)}return l.__emitterProxy=t,r.on(e,l,n)},onAny(e,t){const n=this;if(!n.eventsListeners||n.destroyed||"function"!=typeof e)return n;const r=t?"unshift":"push";return n.eventsAnyListeners.indexOf(e)<0&&n.eventsAnyListeners[r](e),n},offAny(e){const t=this;if(!t.eventsListeners||t.destroyed||!t.eventsAnyListeners)return t;const n=t.eventsAnyListeners.indexOf(e);return n>=0&&t.eventsAnyListeners.splice(n,1),t},off(e,t){const n=this;return!n.eventsListeners||n.destroyed||!n.eventsListeners||e.split(" ").forEach(r=>{void 0===t?n.eventsListeners[r]=[]:n.eventsListeners[r]&&n.eventsListeners[r].forEach((l,u)=>{(l===t||l.__emitterProxy&&l.__emitterProxy===t)&&n.eventsListeners[r].splice(u,1)})}),n},emit(...e){const t=this;if(!t.eventsListeners||t.destroyed||!t.eventsListeners)return t;let n,r,l;return"string"==typeof e[0]||Array.isArray(e[0])?(n=e[0],r=e.slice(1,e.length),l=t):(n=e[0].events,r=e[0].data,l=e[0].context||t),r.unshift(l),(Array.isArray(n)?n:n.split(" ")).forEach(_=>{t.eventsAnyListeners&&t.eventsAnyListeners.length&&t.eventsAnyListeners.forEach(v=>{v.apply(l,[_,...r])}),t.eventsListeners&&t.eventsListeners[_]&&t.eventsListeners[_].forEach(v=>{v.apply(l,r)})}),t}},update:{updateSize:function mR(){const e=this;let t,n;const r=e.$el;t=null!=e.params.width?e.params.width:r[0].clientWidth,n=null!=e.params.height?e.params.height:r[0].clientHeight,!(0===t&&e.isHorizontal()||0===n&&e.isVertical())&&(t=t-parseInt(r.css("padding-left")||0,10)-parseInt(r.css("padding-right")||0,10),n=n-parseInt(r.css("padding-top")||0,10)-parseInt(r.css("padding-bottom")||0,10),Number.isNaN(t)&&(t=0),Number.isNaN(n)&&(n=0),Object.assign(e,{width:t,height:n,size:e.isHorizontal()?t:n}))},updateSlides:function gR(){const e=this;function t(ut){return e.isHorizontal()?ut:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[ut]}function n(ut,Le){return parseFloat(ut.getPropertyValue(t(Le))||0)}const r=e.params,{$wrapperEl:l,size:u,rtlTranslate:_,wrongRTL:v}=e,w=e.virtual&&r.virtual.enabled,T=w?e.virtual.slides.length:e.slides.length,S=l.children(`.${e.params.slideClass}`),I=w?e.virtual.slides.length:S.length;let L=[];const j=[],Z=[];let G=r.slidesOffsetBefore;"function"==typeof G&&(G=r.slidesOffsetBefore.call(e));let Y=r.slidesOffsetAfter;"function"==typeof Y&&(Y=r.slidesOffsetAfter.call(e));const ce=e.snapGrid.length,ee=e.slidesGrid.length;let fe=r.spaceBetween,ze=-G,Be=0,Ke=0;if(void 0===u)return;"string"==typeof fe&&fe.indexOf("%")>=0&&(fe=parseFloat(fe.replace("%",""))/100*u),e.virtualSize=-fe,S.css(_?{marginLeft:"",marginBottom:"",marginTop:""}:{marginRight:"",marginBottom:"",marginTop:""}),r.centeredSlides&&r.cssMode&&(Rv(e.wrapperEl,"--swiper-centered-offset-before",""),Rv(e.wrapperEl,"--swiper-centered-offset-after",""));const nt=r.grid&&r.grid.rows>1&&e.grid;let yt;nt&&e.grid.initSlides(I);const It="auto"===r.slidesPerView&&r.breakpoints&&Object.keys(r.breakpoints).filter(ut=>void 0!==r.breakpoints[ut].slidesPerView).length>0;for(let ut=0;ut<I;ut+=1){yt=0;const Le=S.eq(ut);if(nt&&e.grid.updateSlide(ut,Le,I,t),"none"!==Le.css("display")){if("auto"===r.slidesPerView){It&&(S[ut].style[t("width")]="");const Ie=getComputedStyle(Le[0]),$e=Le[0].style.transform,kt=Le[0].style.webkitTransform;if($e&&(Le[0].style.transform="none"),kt&&(Le[0].style.webkitTransform="none"),r.roundLengths)yt=e.isHorizontal()?Le.outerWidth(!0):Le.outerHeight(!0);else{const Ht=n(Ie,"width"),Ne=n(Ie,"padding-left"),Mt=n(Ie,"padding-right"),bt=n(Ie,"margin-left"),jn=n(Ie,"margin-right"),gi=Ie.getPropertyValue("box-sizing");if(gi&&"border-box"===gi)yt=Ht+bt+jn;else{const{clientWidth:xs,offsetWidth:$h}=Le[0];yt=Ht+Ne+Mt+bt+jn+($h-xs)}}$e&&(Le[0].style.transform=$e),kt&&(Le[0].style.webkitTransform=kt),r.roundLengths&&(yt=Math.floor(yt))}else yt=(u-(r.slidesPerView-1)*fe)/r.slidesPerView,r.roundLengths&&(yt=Math.floor(yt)),S[ut]&&(S[ut].style[t("width")]=`${yt}px`);S[ut]&&(S[ut].swiperSlideSize=yt),Z.push(yt),r.centeredSlides?(ze=ze+yt/2+Be/2+fe,0===Be&&0!==ut&&(ze=ze-u/2-fe),0===ut&&(ze=ze-u/2-fe),Math.abs(ze)<.001&&(ze=0),r.roundLengths&&(ze=Math.floor(ze)),Ke%r.slidesPerGroup==0&&L.push(ze),j.push(ze)):(r.roundLengths&&(ze=Math.floor(ze)),(Ke-Math.min(e.params.slidesPerGroupSkip,Ke))%e.params.slidesPerGroup==0&&L.push(ze),j.push(ze),ze=ze+yt+fe),e.virtualSize+=yt+fe,Be=yt,Ke+=1}}if(e.virtualSize=Math.max(e.virtualSize,u)+Y,_&&v&&("slide"===r.effect||"coverflow"===r.effect)&&l.css({width:`${e.virtualSize+r.spaceBetween}px`}),r.setWrapperSize&&l.css({[t("width")]:`${e.virtualSize+r.spaceBetween}px`}),nt&&e.grid.updateWrapperSize(yt,L,t),!r.centeredSlides){const ut=[];for(let Le=0;Le<L.length;Le+=1){let Ie=L[Le];r.roundLengths&&(Ie=Math.floor(Ie)),L[Le]<=e.virtualSize-u&&ut.push(Ie)}L=ut,Math.floor(e.virtualSize-u)-Math.floor(L[L.length-1])>1&&L.push(e.virtualSize-u)}if(0===L.length&&(L=[0]),0!==r.spaceBetween){const ut=e.isHorizontal()&&_?"marginLeft":t("marginRight");S.filter((Le,Ie)=>!r.cssMode||Ie!==S.length-1).css({[ut]:`${fe}px`})}if(r.centeredSlides&&r.centeredSlidesBounds){let ut=0;Z.forEach(Ie=>{ut+=Ie+(r.spaceBetween?r.spaceBetween:0)}),ut-=r.spaceBetween;const Le=ut-u;L=L.map(Ie=>Ie<0?-G:Ie>Le?Le+Y:Ie)}if(r.centerInsufficientSlides){let ut=0;if(Z.forEach(Le=>{ut+=Le+(r.spaceBetween?r.spaceBetween:0)}),ut-=r.spaceBetween,ut<u){const Le=(u-ut)/2;L.forEach((Ie,$e)=>{L[$e]=Ie-Le}),j.forEach((Ie,$e)=>{j[$e]=Ie+Le})}}if(Object.assign(e,{slides:S,snapGrid:L,slidesGrid:j,slidesSizesGrid:Z}),r.centeredSlides&&r.cssMode&&!r.centeredSlidesBounds){Rv(e.wrapperEl,"--swiper-centered-offset-before",-L[0]+"px"),Rv(e.wrapperEl,"--swiper-centered-offset-after",e.size/2-Z[Z.length-1]/2+"px");const ut=-e.snapGrid[0],Le=-e.slidesGrid[0];e.snapGrid=e.snapGrid.map(Ie=>Ie+ut),e.slidesGrid=e.slidesGrid.map(Ie=>Ie+Le)}if(I!==T&&e.emit("slidesLengthChange"),L.length!==ce&&(e.params.watchOverflow&&e.checkOverflow(),e.emit("snapGridLengthChange")),j.length!==ee&&e.emit("slidesGridLengthChange"),r.watchSlidesProgress&&e.updateSlidesOffset(),!(w||r.cssMode||"slide"!==r.effect&&"fade"!==r.effect)){const ut=`${r.containerModifierClass}backface-hidden`,Le=e.$el.hasClass(ut);I<=r.maxBackfaceHiddenSlides?Le||e.$el.addClass(ut):Le&&e.$el.removeClass(ut)}},updateAutoHeight:function _R(e){const t=this,n=[],r=t.virtual&&t.params.virtual.enabled;let u,l=0;"number"==typeof e?t.setTransition(e):!0===e&&t.setTransition(t.params.speed);const _=v=>r?t.slides.filter(w=>parseInt(w.getAttribute("data-swiper-slide-index"),10)===v)[0]:t.slides.eq(v)[0];if("auto"!==t.params.slidesPerView&&t.params.slidesPerView>1)if(t.params.centeredSlides)(t.visibleSlides||ii([])).each(v=>{n.push(v)});else for(u=0;u<Math.ceil(t.params.slidesPerView);u+=1){const v=t.activeIndex+u;if(v>t.slides.length&&!r)break;n.push(_(v))}else n.push(_(t.activeIndex));for(u=0;u<n.length;u+=1)if(void 0!==n[u]){const v=n[u].offsetHeight;l=v>l?v:l}(l||0===l)&&t.$wrapperEl.css("height",`${l}px`)},updateSlidesOffset:function yR(){const e=this,t=e.slides;for(let n=0;n<t.length;n+=1)t[n].swiperSlideOffset=e.isHorizontal()?t[n].offsetLeft:t[n].offsetTop},updateSlidesProgress:function vR(e=this&&this.translate||0){const t=this,n=t.params,{slides:r,rtlTranslate:l,snapGrid:u}=t;if(0===r.length)return;void 0===r[0].swiperSlideOffset&&t.updateSlidesOffset();let _=-e;l&&(_=e),r.removeClass(n.slideVisibleClass),t.visibleSlidesIndexes=[],t.visibleSlides=[];for(let v=0;v<r.length;v+=1){const w=r[v];let T=w.swiperSlideOffset;n.cssMode&&n.centeredSlides&&(T-=r[0].swiperSlideOffset);const S=(_+(n.centeredSlides?t.minTranslate():0)-T)/(w.swiperSlideSize+n.spaceBetween),I=(_-u[0]+(n.centeredSlides?t.minTranslate():0)-T)/(w.swiperSlideSize+n.spaceBetween),L=-(_-T),j=L+t.slidesSizesGrid[v];(L>=0&&L<t.size-1||j>1&&j<=t.size||L<=0&&j>=t.size)&&(t.visibleSlides.push(w),t.visibleSlidesIndexes.push(v),r.eq(v).addClass(n.slideVisibleClass)),w.progress=l?-S:S,w.originalProgress=l?-I:I}t.visibleSlides=ii(t.visibleSlides)},updateProgress:function xR(e){const t=this;if(void 0===e){const T=t.rtlTranslate?-1:1;e=t&&t.translate&&t.translate*T||0}const n=t.params,r=t.maxTranslate()-t.minTranslate();let{progress:l,isBeginning:u,isEnd:_}=t;const v=u,w=_;0===r?(l=0,u=!0,_=!0):(l=(e-t.minTranslate())/r,u=l<=0,_=l>=1),Object.assign(t,{progress:l,isBeginning:u,isEnd:_}),(n.watchSlidesProgress||n.centeredSlides&&n.autoHeight)&&t.updateSlidesProgress(e),u&&!v&&t.emit("reachBeginning toEdge"),_&&!w&&t.emit("reachEnd toEdge"),(v&&!u||w&&!_)&&t.emit("fromEdge"),t.emit("progress",l)},updateSlidesClasses:function bR(){const e=this,{slides:t,params:n,$wrapperEl:r,activeIndex:l,realIndex:u}=e,_=e.virtual&&n.virtual.enabled;let v;t.removeClass(`${n.slideActiveClass} ${n.slideNextClass} ${n.slidePrevClass} ${n.slideDuplicateActiveClass} ${n.slideDuplicateNextClass} ${n.slideDuplicatePrevClass}`),v=_?e.$wrapperEl.find(`.${n.slideClass}[data-swiper-slide-index="${l}"]`):t.eq(l),v.addClass(n.slideActiveClass),n.loop&&(v.hasClass(n.slideDuplicateClass)?r.children(`.${n.slideClass}:not(.${n.slideDuplicateClass})[data-swiper-slide-index="${u}"]`).addClass(n.slideDuplicateActiveClass):r.children(`.${n.slideClass}.${n.slideDuplicateClass}[data-swiper-slide-index="${u}"]`).addClass(n.slideDuplicateActiveClass));let w=v.nextAll(`.${n.slideClass}`).eq(0).addClass(n.slideNextClass);n.loop&&0===w.length&&(w=t.eq(0),w.addClass(n.slideNextClass));let T=v.prevAll(`.${n.slideClass}`).eq(0).addClass(n.slidePrevClass);n.loop&&0===T.length&&(T=t.eq(-1),T.addClass(n.slidePrevClass)),n.loop&&(w.hasClass(n.slideDuplicateClass)?r.children(`.${n.slideClass}:not(.${n.slideDuplicateClass})[data-swiper-slide-index="${w.attr("data-swiper-slide-index")}"]`).addClass(n.slideDuplicateNextClass):r.children(`.${n.slideClass}.${n.slideDuplicateClass}[data-swiper-slide-index="${w.attr("data-swiper-slide-index")}"]`).addClass(n.slideDuplicateNextClass),T.hasClass(n.slideDuplicateClass)?r.children(`.${n.slideClass}:not(.${n.slideDuplicateClass})[data-swiper-slide-index="${T.attr("data-swiper-slide-index")}"]`).addClass(n.slideDuplicatePrevClass):r.children(`.${n.slideClass}.${n.slideDuplicateClass}[data-swiper-slide-index="${T.attr("data-swiper-slide-index")}"]`).addClass(n.slideDuplicatePrevClass)),e.emitSlidesClasses()},updateActiveIndex:function wR(e){const t=this,n=t.rtlTranslate?t.translate:-t.translate,{slidesGrid:r,snapGrid:l,params:u,activeIndex:_,realIndex:v,snapIndex:w}=t;let S,T=e;if(void 0===T){for(let L=0;L<r.length;L+=1)void 0!==r[L+1]?n>=r[L]&&n<r[L+1]-(r[L+1]-r[L])/2?T=L:n>=r[L]&&n<r[L+1]&&(T=L+1):n>=r[L]&&(T=L);u.normalizeSlideIndex&&(T<0||void 0===T)&&(T=0)}if(l.indexOf(n)>=0)S=l.indexOf(n);else{const L=Math.min(u.slidesPerGroupSkip,T);S=L+Math.floor((T-L)/u.slidesPerGroup)}if(S>=l.length&&(S=l.length-1),T===_)return void(S!==w&&(t.snapIndex=S,t.emit("snapIndexChange")));const I=parseInt(t.slides.eq(T).attr("data-swiper-slide-index")||T,10);Object.assign(t,{snapIndex:S,realIndex:I,previousIndex:_,activeIndex:T}),t.emit("activeIndexChange"),t.emit("snapIndexChange"),v!==I&&t.emit("realIndexChange"),(t.initialized||t.params.runCallbacksOnInit)&&t.emit("slideChange")},updateClickedSlide:function CR(e){const t=this,n=t.params,r=ii(e).closest(`.${n.slideClass}`)[0];let u,l=!1;if(r)for(let _=0;_<t.slides.length;_+=1)if(t.slides[_]===r){l=!0,u=_;break}if(!r||!l)return t.clickedSlide=void 0,void(t.clickedIndex=void 0);t.clickedSlide=r,t.clickedIndex=t.virtual&&t.params.virtual.enabled?parseInt(ii(r).attr("data-swiper-slide-index"),10):u,n.slideToClickedSlide&&void 0!==t.clickedIndex&&t.clickedIndex!==t.activeIndex&&t.slideToClickedSlide()}},translate:{getTranslate:function ER(e=(this.isHorizontal()?"x":"y")){const{params:n,rtlTranslate:r,translate:l,$wrapperEl:u}=this;if(n.virtualTranslate)return r?-l:l;if(n.cssMode)return l;let _=function oR(e,t="x"){const n=Yr();let r,l,u;const _=function rR(e){const t=Yr();let n;return t.getComputedStyle&&(n=t.getComputedStyle(e,null)),!n&&e.currentStyle&&(n=e.currentStyle),n||(n=e.style),n}(e);return n.WebKitCSSMatrix?(l=_.transform||_.webkitTransform,l.split(",").length>6&&(l=l.split(", ").map(v=>v.replace(",",".")).join(", ")),u=new n.WebKitCSSMatrix("none"===l?"":l)):(u=_.MozTransform||_.OTransform||_.MsTransform||_.msTransform||_.transform||_.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),r=u.toString().split(",")),"x"===t&&(l=n.WebKitCSSMatrix?u.m41:16===r.length?parseFloat(r[12]):parseFloat(r[4])),"y"===t&&(l=n.WebKitCSSMatrix?u.m42:16===r.length?parseFloat(r[13]):parseFloat(r[5])),l||0}(u[0],e);return r&&(_=-_),_||0},setTranslate:function TR(e,t){const n=this,{rtlTranslate:r,params:l,$wrapperEl:u,wrapperEl:_,progress:v}=n;let I,w=0,T=0;n.isHorizontal()?w=r?-e:e:T=e,l.roundLengths&&(w=Math.floor(w),T=Math.floor(T)),l.cssMode?_[n.isHorizontal()?"scrollLeft":"scrollTop"]=n.isHorizontal()?-w:-T:l.virtualTranslate||u.transform(`translate3d(${w}px, ${T}px, 0px)`),n.previousTranslate=n.translate,n.translate=n.isHorizontal()?w:T;const L=n.maxTranslate()-n.minTranslate();I=0===L?0:(e-n.minTranslate())/L,I!==v&&n.updateProgress(e),n.emit("setTranslate",n.translate,t)},minTranslate:function MR(){return-this.snapGrid[0]},maxTranslate:function SR(){return-this.snapGrid[this.snapGrid.length-1]},translateTo:function DR(e=0,t=this.params.speed,n=!0,r=!0,l){const u=this,{params:_,wrapperEl:v}=u;if(u.animating&&_.preventInteractionOnTransition)return!1;const w=u.minTranslate(),T=u.maxTranslate();let S;if(S=r&&e>w?w:r&&e<T?T:e,u.updateProgress(S),_.cssMode){const I=u.isHorizontal();if(0===t)v[I?"scrollLeft":"scrollTop"]=-S;else{if(!u.support.smoothScroll)return qE({swiper:u,targetPosition:-S,side:I?"left":"top"}),!0;v.scrollTo({[I?"left":"top"]:-S,behavior:"smooth"})}return!0}return 0===t?(u.setTransition(0),u.setTranslate(S),n&&(u.emit("beforeTransitionStart",t,l),u.emit("transitionEnd"))):(u.setTransition(t),u.setTranslate(S),n&&(u.emit("beforeTransitionStart",t,l),u.emit("transitionStart")),u.animating||(u.animating=!0,u.onTranslateToWrapperTransitionEnd||(u.onTranslateToWrapperTransitionEnd=function(L){!u||u.destroyed||L.target===this&&(u.$wrapperEl[0].removeEventListener("transitionend",u.onTranslateToWrapperTransitionEnd),u.$wrapperEl[0].removeEventListener("webkitTransitionEnd",u.onTranslateToWrapperTransitionEnd),u.onTranslateToWrapperTransitionEnd=null,delete u.onTranslateToWrapperTransitionEnd,n&&u.emit("transitionEnd"))}),u.$wrapperEl[0].addEventListener("transitionend",u.onTranslateToWrapperTransitionEnd),u.$wrapperEl[0].addEventListener("webkitTransitionEnd",u.onTranslateToWrapperTransitionEnd))),!0}},transition:{setTransition:function PR(e,t){const n=this;n.params.cssMode||n.$wrapperEl.transition(e),n.emit("setTransition",e,t)},transitionStart:function OR(e=!0,t){const n=this,{params:r}=n;r.cssMode||(r.autoHeight&&n.updateAutoHeight(),WE({swiper:n,runCallbacks:e,direction:t,step:"Start"}))},transitionEnd:function kR(e=!0,t){const n=this,{params:r}=n;n.animating=!1,!r.cssMode&&(n.setTransition(0),WE({swiper:n,runCallbacks:e,direction:t,step:"End"}))}},slide:{slideTo:function LR(e=0,t=this.params.speed,n=!0,r,l){if("number"!=typeof e&&"string"!=typeof e)throw new Error(`The 'index' argument cannot have type other than 'number' or 'string'. [${typeof e}] given.`);if("string"==typeof e){const fe=parseInt(e,10);if(!isFinite(fe))throw new Error(`The passed-in 'index' (string) couldn't be converted to 'number'. [${e}] given.`);e=fe}const u=this;let _=e;_<0&&(_=0);const{params:v,snapGrid:w,slidesGrid:T,previousIndex:S,activeIndex:I,rtlTranslate:L,wrapperEl:j,enabled:Z}=u;if(u.animating&&v.preventInteractionOnTransition||!Z&&!r&&!l)return!1;const G=Math.min(u.params.slidesPerGroupSkip,_);let Y=G+Math.floor((_-G)/u.params.slidesPerGroup);Y>=w.length&&(Y=w.length-1);const ce=-w[Y];if(v.normalizeSlideIndex)for(let fe=0;fe<T.length;fe+=1){const ze=-Math.floor(100*ce),Be=Math.floor(100*T[fe]),Ke=Math.floor(100*T[fe+1]);void 0!==T[fe+1]?ze>=Be&&ze<Ke-(Ke-Be)/2?_=fe:ze>=Be&&ze<Ke&&(_=fe+1):ze>=Be&&(_=fe)}if(u.initialized&&_!==I&&(!u.allowSlideNext&&ce<u.translate&&ce<u.minTranslate()||!u.allowSlidePrev&&ce>u.translate&&ce>u.maxTranslate()&&(I||0)!==_))return!1;let ee;if(_!==(S||0)&&n&&u.emit("beforeSlideChangeStart"),u.updateProgress(ce),ee=_>I?"next":_<I?"prev":"reset",L&&-ce===u.translate||!L&&ce===u.translate)return u.updateActiveIndex(_),v.autoHeight&&u.updateAutoHeight(),u.updateSlidesClasses(),"slide"!==v.effect&&u.setTranslate(ce),"reset"!==ee&&(u.transitionStart(n,ee),u.transitionEnd(n,ee)),!1;if(v.cssMode){const fe=u.isHorizontal(),ze=L?ce:-ce;if(0===t){const Be=u.virtual&&u.params.virtual.enabled;Be&&(u.wrapperEl.style.scrollSnapType="none",u._immediateVirtual=!0),j[fe?"scrollLeft":"scrollTop"]=ze,Be&&requestAnimationFrame(()=>{u.wrapperEl.style.scrollSnapType="",u._swiperImmediateVirtual=!1})}else{if(!u.support.smoothScroll)return qE({swiper:u,targetPosition:ze,side:fe?"left":"top"}),!0;j.scrollTo({[fe?"left":"top"]:ze,behavior:"smooth"})}return!0}return u.setTransition(t),u.setTranslate(ce),u.updateActiveIndex(_),u.updateSlidesClasses(),u.emit("beforeTransitionStart",t,r),u.transitionStart(n,ee),0===t?u.transitionEnd(n,ee):u.animating||(u.animating=!0,u.onSlideToWrapperTransitionEnd||(u.onSlideToWrapperTransitionEnd=function(ze){!u||u.destroyed||ze.target===this&&(u.$wrapperEl[0].removeEventListener("transitionend",u.onSlideToWrapperTransitionEnd),u.$wrapperEl[0].removeEventListener("webkitTransitionEnd",u.onSlideToWrapperTransitionEnd),u.onSlideToWrapperTransitionEnd=null,delete u.onSlideToWrapperTransitionEnd,u.transitionEnd(n,ee))}),u.$wrapperEl[0].addEventListener("transitionend",u.onSlideToWrapperTransitionEnd),u.$wrapperEl[0].addEventListener("webkitTransitionEnd",u.onSlideToWrapperTransitionEnd)),!0},slideToLoop:function zR(e=0,t=this.params.speed,n=!0,r){if("string"==typeof e){const _=parseInt(e,10);if(!isFinite(_))throw new Error(`The passed-in 'index' (string) couldn't be converted to 'number'. [${e}] given.`);e=_}const l=this;let u=e;return l.params.loop&&(u+=l.loopedSlides),l.slideTo(u,t,n,r)},slideNext:function FR(e=this.params.speed,t=!0,n){const r=this,{animating:l,enabled:u,params:_}=r;if(!u)return r;let v=_.slidesPerGroup;"auto"===_.slidesPerView&&1===_.slidesPerGroup&&_.slidesPerGroupAuto&&(v=Math.max(r.slidesPerViewDynamic("current",!0),1));const w=r.activeIndex<_.slidesPerGroupSkip?1:v;if(_.loop){if(l&&_.loopPreventsSlide)return!1;r.loopFix(),r._clientLeft=r.$wrapperEl[0].clientLeft}return r.slideTo(_.rewind&&r.isEnd?0:r.activeIndex+w,e,t,n)},slidePrev:function BR(e=this.params.speed,t=!0,n){const r=this,{params:l,animating:u,snapGrid:_,slidesGrid:v,rtlTranslate:w,enabled:T}=r;if(!T)return r;if(l.loop){if(u&&l.loopPreventsSlide)return!1;r.loopFix(),r._clientLeft=r.$wrapperEl[0].clientLeft}function I(Y){return Y<0?-Math.floor(Math.abs(Y)):Math.floor(Y)}const L=I(w?r.translate:-r.translate),j=_.map(Y=>I(Y));let Z=_[j.indexOf(L)-1];if(void 0===Z&&l.cssMode){let Y;_.forEach((ce,ee)=>{L>=ce&&(Y=ee)}),void 0!==Y&&(Z=_[Y>0?Y-1:Y])}let G=0;return void 0!==Z&&(G=v.indexOf(Z),G<0&&(G=r.activeIndex-1),"auto"===l.slidesPerView&&1===l.slidesPerGroup&&l.slidesPerGroupAuto&&(G=G-r.slidesPerViewDynamic("previous",!0)+1,G=Math.max(G,0))),r.slideTo(l.rewind&&r.isBeginning?r.params.virtual&&r.params.virtual.enabled&&r.virtual?r.virtual.slides.length-1:r.slides.length-1:G,e,t,n)},slideReset:function NR(e=this.params.speed,t=!0,n){return this.slideTo(this.activeIndex,e,t,n)},slideToClosest:function jR(e=this.params.speed,t=!0,n,r=.5){const l=this;let u=l.activeIndex;const _=Math.min(l.params.slidesPerGroupSkip,u),v=_+Math.floor((u-_)/l.params.slidesPerGroup),w=l.rtlTranslate?l.translate:-l.translate;if(w>=l.snapGrid[v]){const T=l.snapGrid[v];w-T>(l.snapGrid[v+1]-T)*r&&(u+=l.params.slidesPerGroup)}else{const T=l.snapGrid[v-1];w-T<=(l.snapGrid[v]-T)*r&&(u-=l.params.slidesPerGroup)}return u=Math.max(u,0),u=Math.min(u,l.slidesGrid.length-1),l.slideTo(u,e,t,n)},slideToClickedSlide:function VR(){const e=this,{params:t,$wrapperEl:n}=e,r="auto"===t.slidesPerView?e.slidesPerViewDynamic():t.slidesPerView;let u,l=e.clickedIndex;if(t.loop){if(e.animating)return;u=parseInt(ii(e.clickedSlide).attr("data-swiper-slide-index"),10),t.centeredSlides?l<e.loopedSlides-r/2||l>e.slides.length-e.loopedSlides+r/2?(e.loopFix(),l=n.children(`.${t.slideClass}[data-swiper-slide-index="${u}"]:not(.${t.slideDuplicateClass})`).eq(0).index(),Ov(()=>{e.slideTo(l)})):e.slideTo(l):l>e.slides.length-r?(e.loopFix(),l=n.children(`.${t.slideClass}[data-swiper-slide-index="${u}"]:not(.${t.slideDuplicateClass})`).eq(0).index(),Ov(()=>{e.slideTo(l)})):e.slideTo(l)}else e.slideTo(l)}},loop:{loopCreate:function $R(){const e=this,t=go(),{params:n,$wrapperEl:r}=e,l=r.children().length>0?ii(r.children()[0].parentNode):r;l.children(`.${n.slideClass}.${n.slideDuplicateClass}`).remove();let u=l.children(`.${n.slideClass}`);if(n.loopFillGroupWithBlank){const w=n.slidesPerGroup-u.length%n.slidesPerGroup;if(w!==n.slidesPerGroup){for(let T=0;T<w;T+=1){const S=ii(t.createElement("div")).addClass(`${n.slideClass} ${n.slideBlankClass}`);l.append(S)}u=l.children(`.${n.slideClass}`)}}"auto"===n.slidesPerView&&!n.loopedSlides&&(n.loopedSlides=u.length),e.loopedSlides=Math.ceil(parseFloat(n.loopedSlides||n.slidesPerView,10)),e.loopedSlides+=n.loopAdditionalSlides,e.loopedSlides>u.length&&e.params.loopedSlidesLimit&&(e.loopedSlides=u.length);const _=[],v=[];u.each((w,T)=>{ii(w).attr("data-swiper-slide-index",T)});for(let w=0;w<e.loopedSlides;w+=1){const T=w-Math.floor(w/u.length)*u.length;v.push(u.eq(T)[0]),_.unshift(u.eq(u.length-T-1)[0])}for(let w=0;w<v.length;w+=1)l.append(ii(v[w].cloneNode(!0)).addClass(n.slideDuplicateClass));for(let w=_.length-1;w>=0;w-=1)l.prepend(ii(_[w].cloneNode(!0)).addClass(n.slideDuplicateClass))},loopFix:function GR(){const e=this;e.emit("beforeLoopFix");const{activeIndex:t,slides:n,loopedSlides:r,allowSlidePrev:l,allowSlideNext:u,snapGrid:_,rtlTranslate:v}=e;let w;e.allowSlidePrev=!0,e.allowSlideNext=!0;const S=-_[t]-e.getTranslate();t<r?(w=n.length-3*r+t,w+=r,e.slideTo(w,0,!1,!0)&&0!==S&&e.setTranslate((v?-e.translate:e.translate)-S)):t>=n.length-r&&(w=-n.length+t+r,w+=r,e.slideTo(w,0,!1,!0)&&0!==S&&e.setTranslate((v?-e.translate:e.translate)-S)),e.allowSlidePrev=l,e.allowSlideNext=u,e.emit("loopFix")},loopDestroy:function HR(){const{$wrapperEl:t,params:n,slides:r}=this;t.children(`.${n.slideClass}.${n.slideDuplicateClass},.${n.slideClass}.${n.slideBlankClass}`).remove(),r.removeAttr("data-swiper-slide-index")}},grabCursor:{setGrabCursor:function ZR(e){const t=this;if(t.support.touch||!t.params.simulateTouch||t.params.watchOverflow&&t.isLocked||t.params.cssMode)return;const n="container"===t.params.touchEventsTarget?t.el:t.wrapperEl;n.style.cursor="move",n.style.cursor=e?"grabbing":"grab"},unsetGrabCursor:function WR(){const e=this;e.support.touch||e.params.watchOverflow&&e.isLocked||e.params.cssMode||(e["container"===e.params.touchEventsTarget?"el":"wrapperEl"].style.cursor="")}},events:{attachEvents:function iL(){const e=this,t=go(),{params:n,support:r}=e;e.onTouchStart=QR.bind(e),e.onTouchMove=KR.bind(e),e.onTouchEnd=JR.bind(e),n.cssMode&&(e.onScroll=tL.bind(e)),e.onClick=eL.bind(e),r.touch&&!XE&&(t.addEventListener("touchstart",nL),XE=!0),QE(e,"on")},detachEvents:function rL(){QE(this,"off")}},breakpoints:{setBreakpoint:function sL(){const e=this,{activeIndex:t,initialized:n,loopedSlides:r=0,params:l,$el:u}=e,_=l.breakpoints;if(!_||_&&0===Object.keys(_).length)return;const v=e.getBreakpoint(_,e.params.breakpointsBase,e.el);if(!v||e.currentBreakpoint===v)return;const T=(v in _?_[v]:void 0)||e.originalParams,S=KE(e,l),I=KE(e,T),L=l.enabled;S&&!I?(u.removeClass(`${l.containerModifierClass}grid ${l.containerModifierClass}grid-column`),e.emitContainerClasses()):!S&&I&&(u.addClass(`${l.containerModifierClass}grid`),(T.grid.fill&&"column"===T.grid.fill||!T.grid.fill&&"column"===l.grid.fill)&&u.addClass(`${l.containerModifierClass}grid-column`),e.emitContainerClasses()),["navigation","pagination","scrollbar"].forEach(Y=>{const ce=l[Y]&&l[Y].enabled,ee=T[Y]&&T[Y].enabled;ce&&!ee&&e[Y].disable(),!ce&&ee&&e[Y].enable()});const j=T.direction&&T.direction!==l.direction,Z=l.loop&&(T.slidesPerView!==l.slidesPerView||j);j&&n&&e.changeDirection(),Zs(e.params,T);const G=e.params.enabled;Object.assign(e,{allowTouchMove:e.params.allowTouchMove,allowSlideNext:e.params.allowSlideNext,allowSlidePrev:e.params.allowSlidePrev}),L&&!G?e.disable():!L&&G&&e.enable(),e.currentBreakpoint=v,e.emit("_beforeBreakpoint",T),Z&&n&&(e.loopDestroy(),e.loopCreate(),e.updateSlides(),e.slideTo(t-r+e.loopedSlides,0,!1)),e.emit("breakpoint",T)},getBreakpoint:function aL(e,t="window",n){if(!e||"container"===t&&!n)return;let r=!1;const l=Yr(),u="window"===t?l.innerHeight:n.clientHeight,_=Object.keys(e).map(v=>{if("string"==typeof v&&0===v.indexOf("@")){const w=parseFloat(v.substr(1));return{value:u*w,point:v}}return{value:v,point:v}});_.sort((v,w)=>parseInt(v.value,10)-parseInt(w.value,10));for(let v=0;v<_.length;v+=1){const{point:w,value:T}=_[v];"window"===t?l.matchMedia(`(min-width: ${T}px)`).matches&&(r=w):T<=n.clientWidth&&(r=w)}return r||"max"}},checkOverflow:{checkOverflow:function gL(){const e=this,{isLocked:t,params:n}=e,{slidesOffsetBefore:r}=n;if(r){const l=e.slides.length-1;e.isLocked=e.size>e.slidesGrid[l]+e.slidesSizesGrid[l]+2*r}else e.isLocked=1===e.snapGrid.length;!0===n.allowSlideNext&&(e.allowSlideNext=!e.isLocked),!0===n.allowSlidePrev&&(e.allowSlidePrev=!e.isLocked),t&&t!==e.isLocked&&(e.isEnd=!1),t!==e.isLocked&&e.emit(e.isLocked?"lock":"unlock")}},classes:{addClasses:function uL(){const e=this,{classNames:t,params:n,rtl:r,$el:l,device:u,support:_}=e,v=function cL(e,t){const n=[];return e.forEach(r=>{"object"==typeof r?Object.keys(r).forEach(l=>{r[l]&&n.push(t+l)}):"string"==typeof r&&n.push(t+r)}),n}(["initialized",n.direction,{"pointer-events":!_.touch},{"free-mode":e.params.freeMode&&n.freeMode.enabled},{autoheight:n.autoHeight},{rtl:r},{grid:n.grid&&n.grid.rows>1},{"grid-column":n.grid&&n.grid.rows>1&&"column"===n.grid.fill},{android:u.android},{ios:u.ios},{"css-mode":n.cssMode},{centered:n.cssMode&&n.centeredSlides},{"watch-progress":n.watchSlidesProgress}],n.containerModifierClass);t.push(...v),l.addClass([...t].join(" ")),e.emitContainerClasses()},removeClasses:function dL(){const{$el:t,classNames:n}=this;t.removeClass(n.join(" ")),this.emitContainerClasses()}},images:{loadImage:function pL(e,t,n,r,l,u){const _=Yr();let v;function w(){u&&u()}ii(e).parent("picture")[0]||e.complete&&l||!t?w():(v=new _.Image,v.onload=w,v.onerror=w,r&&(v.sizes=r),n&&(v.srcset=n),t&&(v.src=t))},preloadImages:function fL(){const e=this;function t(){null==e||!e||e.destroyed||(void 0!==e.imagesLoaded&&(e.imagesLoaded+=1),e.imagesLoaded===e.imagesToLoad.length&&(e.params.updateOnImagesReady&&e.update(),e.emit("imagesReady")))}e.imagesToLoad=e.$el.find("img");for(let n=0;n<e.imagesToLoad.length;n+=1){const r=e.imagesToLoad[n];e.loadImage(r,r.currentSrc||r.getAttribute("src"),r.srcset||r.getAttribute("srcset"),r.sizes||r.getAttribute("sizes"),!0,t)}}}},qb={};class Ta{constructor(...t){let n,r;if(1===t.length&&t[0].constructor&&"Object"===Object.prototype.toString.call(t[0]).slice(8,-1)?r=t[0]:[n,r]=t,r||(r={}),r=Zs({},r),n&&!r.el&&(r.el=n),r.el&&ii(r.el).length>1){const v=[];return ii(r.el).each(w=>{const T=Zs({},r,{el:w});v.push(new Ta(T))}),v}const l=this;l.__swiper__=!0,l.support=ZE(),l.device=function cR(e={}){return $b||($b=function lR({userAgent:e}={}){const t=ZE(),n=Yr(),r=n.navigator.platform,l=e||n.navigator.userAgent,u={ios:!1,android:!1},_=n.screen.width,v=n.screen.height,w=l.match(/(Android);?[\s\/]+([\d.]+)?/);let T=l.match(/(iPad).*OS\s([\d_]+)/);const S=l.match(/(iPod)(.*OS\s([\d_]+))?/),I=!T&&l.match(/(iPhone\sOS|iOS)\s([\d_]+)/),L="Win32"===r;let j="MacIntel"===r;return!T&&j&&t.touch&&["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"].indexOf(`${_}x${v}`)>=0&&(T=l.match(/(Version)\/([\d.]+)/),T||(T=[0,1,"13_0_0"]),j=!1),w&&!L&&(u.os="android",u.android=!0),(T||I||S)&&(u.os="ios",u.ios=!0),u}(e)),$b}({userAgent:r.userAgent}),l.browser=function dR(){return Gb||(Gb=function uR(){const e=Yr();return{isSafari:function t(){const n=e.navigator.userAgent.toLowerCase();return n.indexOf("safari")>=0&&n.indexOf("chrome")<0&&n.indexOf("android")<0}(),isWebView:/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(e.navigator.userAgent)}}()),Gb}(),l.eventsListeners={},l.eventsAnyListeners=[],l.modules=[...l.__modules__],r.modules&&Array.isArray(r.modules)&&l.modules.push(...r.modules);const u={};l.modules.forEach(v=>{v({swiper:l,extendParams:yL(r,u),on:l.on.bind(l),once:l.once.bind(l),off:l.off.bind(l),emit:l.emit.bind(l)})});const _=Zs({},JE,u);return l.params=Zs({},_,qb,r),l.originalParams=Zs({},l.params),l.passedParams=Zs({},r),l.params&&l.params.on&&Object.keys(l.params.on).forEach(v=>{l.on(v,l.params.on[v])}),l.params&&l.params.onAny&&l.onAny(l.params.onAny),l.$=ii,Object.assign(l,{enabled:l.params.enabled,el:n,classNames:[],slides:ii(),slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal:()=>"horizontal"===l.params.direction,isVertical:()=>"vertical"===l.params.direction,activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,allowSlideNext:l.params.allowSlideNext,allowSlidePrev:l.params.allowSlidePrev,touchEvents:function(){const w=["touchstart","touchmove","touchend","touchcancel"],T=["pointerdown","pointermove","pointerup"];return l.touchEventsTouch={start:w[0],move:w[1],end:w[2],cancel:w[3]},l.touchEventsDesktop={start:T[0],move:T[1],end:T[2]},l.support.touch||!l.params.simulateTouch?l.touchEventsTouch:l.touchEventsDesktop}(),touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:l.params.focusableElements,lastClickTime:Wg(),clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,isTouchEvent:void 0,startMoving:void 0},allowClick:!0,allowTouchMove:l.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),l.emit("_swiper"),l.params.init&&l.init(),l}enable(){const t=this;t.enabled||(t.enabled=!0,t.params.grabCursor&&t.setGrabCursor(),t.emit("enable"))}disable(){const t=this;!t.enabled||(t.enabled=!1,t.params.grabCursor&&t.unsetGrabCursor(),t.emit("disable"))}setProgress(t,n){const r=this;t=Math.min(Math.max(t,0),1);const l=r.minTranslate(),_=(r.maxTranslate()-l)*t+l;r.translateTo(_,void 0===n?0:n),r.updateActiveIndex(),r.updateSlidesClasses()}emitContainerClasses(){const t=this;if(!t.params._emitClasses||!t.el)return;const n=t.el.className.split(" ").filter(r=>0===r.indexOf("swiper")||0===r.indexOf(t.params.containerModifierClass));t.emit("_containerClasses",n.join(" "))}getSlideClasses(t){const n=this;return n.destroyed?"":t.className.split(" ").filter(r=>0===r.indexOf("swiper-slide")||0===r.indexOf(n.params.slideClass)).join(" ")}emitSlidesClasses(){const t=this;if(!t.params._emitClasses||!t.el)return;const n=[];t.slides.each(r=>{const l=t.getSlideClasses(r);n.push({slideEl:r,classNames:l}),t.emit("_slideClass",r,l)}),t.emit("_slideClasses",n)}slidesPerViewDynamic(t="current",n=!1){const{params:l,slides:u,slidesGrid:_,slidesSizesGrid:v,size:w,activeIndex:T}=this;let S=1;if(l.centeredSlides){let L,I=u[T].swiperSlideSize;for(let j=T+1;j<u.length;j+=1)u[j]&&!L&&(I+=u[j].swiperSlideSize,S+=1,I>w&&(L=!0));for(let j=T-1;j>=0;j-=1)u[j]&&!L&&(I+=u[j].swiperSlideSize,S+=1,I>w&&(L=!0))}else if("current"===t)for(let I=T+1;I<u.length;I+=1)(n?_[I]+v[I]-_[T]<w:_[I]-_[T]<w)&&(S+=1);else for(let I=T-1;I>=0;I-=1)_[T]-_[I]<w&&(S+=1);return S}update(){const t=this;if(!t||t.destroyed)return;const{snapGrid:n,params:r}=t;function l(){const v=Math.min(Math.max(t.rtlTranslate?-1*t.translate:t.translate,t.maxTranslate()),t.minTranslate());t.setTranslate(v),t.updateActiveIndex(),t.updateSlidesClasses()}let u;r.breakpoints&&t.setBreakpoint(),t.updateSize(),t.updateSlides(),t.updateProgress(),t.updateSlidesClasses(),t.params.freeMode&&t.params.freeMode.enabled?(l(),t.params.autoHeight&&t.updateAutoHeight()):(u=t.slideTo(("auto"===t.params.slidesPerView||t.params.slidesPerView>1)&&t.isEnd&&!t.params.centeredSlides?t.slides.length-1:t.activeIndex,0,!1,!0),u||l()),r.watchOverflow&&n!==t.snapGrid&&t.checkOverflow(),t.emit("update")}changeDirection(t,n=!0){const r=this,l=r.params.direction;return t||(t="horizontal"===l?"vertical":"horizontal"),t===l||"horizontal"!==t&&"vertical"!==t||(r.$el.removeClass(`${r.params.containerModifierClass}${l}`).addClass(`${r.params.containerModifierClass}${t}`),r.emitContainerClasses(),r.params.direction=t,r.slides.each(u=>{"vertical"===t?u.style.width="":u.style.height=""}),r.emit("changeDirection"),n&&r.update()),r}changeLanguageDirection(t){const n=this;n.rtl&&"rtl"===t||!n.rtl&&"ltr"===t||(n.rtl="rtl"===t,n.rtlTranslate="horizontal"===n.params.direction&&n.rtl,n.rtl?(n.$el.addClass(`${n.params.containerModifierClass}rtl`),n.el.dir="rtl"):(n.$el.removeClass(`${n.params.containerModifierClass}rtl`),n.el.dir="ltr"),n.update())}mount(t){const n=this;if(n.mounted)return!0;const r=ii(t||n.params.el);if(!(t=r[0]))return!1;t.swiper=n;const l=()=>`.${(n.params.wrapperClass||"").trim().split(" ").join(".")}`;let _=(()=>{if(t&&t.shadowRoot&&t.shadowRoot.querySelector){const v=ii(t.shadowRoot.querySelector(l()));return v.children=w=>r.children(w),v}return r.children?r.children(l()):ii(r).children(l())})();if(0===_.length&&n.params.createElements){const w=go().createElement("div");_=ii(w),w.className=n.params.wrapperClass,r.append(w),r.children(`.${n.params.slideClass}`).each(T=>{_.append(T)})}return Object.assign(n,{$el:r,el:t,$wrapperEl:_,wrapperEl:_[0],mounted:!0,rtl:"rtl"===t.dir.toLowerCase()||"rtl"===r.css("direction"),rtlTranslate:"horizontal"===n.params.direction&&("rtl"===t.dir.toLowerCase()||"rtl"===r.css("direction")),wrongRTL:"-webkit-box"===_.css("display")}),!0}init(t){const n=this;return n.initialized||!1===n.mount(t)||(n.emit("beforeInit"),n.params.breakpoints&&n.setBreakpoint(),n.addClasses(),n.params.loop&&n.loopCreate(),n.updateSize(),n.updateSlides(),n.params.watchOverflow&&n.checkOverflow(),n.params.grabCursor&&n.enabled&&n.setGrabCursor(),n.params.preloadImages&&n.preloadImages(),n.slideTo(n.params.loop?n.params.initialSlide+n.loopedSlides:n.params.initialSlide,0,n.params.runCallbacksOnInit,!1,!0),n.attachEvents(),n.initialized=!0,n.emit("init"),n.emit("afterInit")),n}destroy(t=!0,n=!0){const r=this,{params:l,$el:u,$wrapperEl:_,slides:v}=r;return void 0===r.params||r.destroyed||(r.emit("beforeDestroy"),r.initialized=!1,r.detachEvents(),l.loop&&r.loopDestroy(),n&&(r.removeClasses(),u.removeAttr("style"),_.removeAttr("style"),v&&v.length&&v.removeClass([l.slideVisibleClass,l.slideActiveClass,l.slideNextClass,l.slidePrevClass].join(" ")).removeAttr("style").removeAttr("data-swiper-slide-index")),r.emit("destroy"),Object.keys(r.eventsListeners).forEach(w=>{r.off(w)}),!1!==t&&(r.$el[0].swiper=null,function iR(e){const t=e;Object.keys(t).forEach(n=>{try{t[n]=null}catch(r){}try{delete t[n]}catch(r){}})}(r)),r.destroyed=!0),null}static extendDefaults(t){Zs(qb,t)}static get extendedDefaults(){return qb}static get defaults(){return JE}static installModule(t){Ta.prototype.__modules__||(Ta.prototype.__modules__=[]);const n=Ta.prototype.__modules__;"function"==typeof t&&n.indexOf(t)<0&&n.push(t)}static use(t){return Array.isArray(t)?(t.forEach(n=>Ta.installModule(n)),Ta):(Ta.installModule(t),Ta)}}Object.keys(Hb).forEach(e=>{Object.keys(Hb[e]).forEach(t=>{Ta.prototype[t]=Hb[e][t]})}),Ta.use([function hR({swiper:e,on:t,emit:n}){const r=Yr();let l=null,u=null;const _=()=>{!e||e.destroyed||!e.initialized||(n("beforeResize"),n("resize"))},T=()=>{!e||e.destroyed||!e.initialized||n("orientationchange")};t("init",()=>{e.params.resizeObserver&&void 0!==r.ResizeObserver?!e||e.destroyed||!e.initialized||(l=new ResizeObserver(S=>{u=r.requestAnimationFrame(()=>{const{width:I,height:L}=e;let j=I,Z=L;S.forEach(({contentBoxSize:G,contentRect:Y,target:ce})=>{ce&&ce!==e.el||(j=Y?Y.width:(G[0]||G).inlineSize,Z=Y?Y.height:(G[0]||G).blockSize)}),(j!==I||Z!==L)&&_()})}),l.observe(e.el)):(r.addEventListener("resize",_),r.addEventListener("orientationchange",T))}),t("destroy",()=>{u&&r.cancelAnimationFrame(u),l&&l.unobserve&&e.el&&(l.unobserve(e.el),l=null),r.removeEventListener("resize",_),r.removeEventListener("orientationchange",T)})},function pR({swiper:e,extendParams:t,on:n,emit:r}){const l=[],u=Yr(),_=(T,S={})=>{const L=new(u.MutationObserver||u.WebkitMutationObserver)(j=>{if(1===j.length)return void r("observerUpdate",j[0]);const Z=function(){r("observerUpdate",j[0])};u.requestAnimationFrame?u.requestAnimationFrame(Z):u.setTimeout(Z,0)});L.observe(T,{attributes:void 0===S.attributes||S.attributes,childList:void 0===S.childList||S.childList,characterData:void 0===S.characterData||S.characterData}),l.push(L)};t({observer:!1,observeParents:!1,observeSlideChildren:!1}),n("init",()=>{if(e.params.observer){if(e.params.observeParents){const T=e.$el.parents();for(let S=0;S<T.length;S+=1)_(T[S])}_(e.$el[0],{childList:e.params.observeSlideChildren}),_(e.$wrapperEl[0],{attributes:!1})}}),n("destroy",()=>{l.forEach(T=>{T.disconnect()}),l.splice(0,l.length)})}]);const Uh=Ta;function eT(e,t,n,r){const l=go();return e.params.createElements&&Object.keys(r).forEach(u=>{if(!n[u]&&!0===n.auto){let _=e.$el.children(`.${r[u]}`)[0];_||(_=l.createElement("div"),_.className=r[u],e.$el.append(_)),n[u]=_,t[u]=_}}),n}function Zb({swiper:e,extendParams:t,on:n,emit:r}){function l(j){let Z;return j&&(Z=ii(j),e.params.uniqueNavElements&&"string"==typeof j&&Z.length>1&&1===e.$el.find(j).length&&(Z=e.$el.find(j))),Z}function u(j,Z){const G=e.params.navigation;j&&j.length>0&&(j[Z?"addClass":"removeClass"](G.disabledClass),j[0]&&"BUTTON"===j[0].tagName&&(j[0].disabled=Z),e.params.watchOverflow&&e.enabled&&j[e.isLocked?"addClass":"removeClass"](G.lockClass))}function _(){if(e.params.loop)return;const{$nextEl:j,$prevEl:Z}=e.navigation;u(Z,e.isBeginning&&!e.params.rewind),u(j,e.isEnd&&!e.params.rewind)}function v(j){j.preventDefault(),(!e.isBeginning||e.params.loop||e.params.rewind)&&(e.slidePrev(),r("navigationPrev"))}function w(j){j.preventDefault(),(!e.isEnd||e.params.loop||e.params.rewind)&&(e.slideNext(),r("navigationNext"))}function T(){const j=e.params.navigation;if(e.params.navigation=eT(e,e.originalParams.navigation,e.params.navigation,{nextEl:"swiper-button-next",prevEl:"swiper-button-prev"}),!j.nextEl&&!j.prevEl)return;const Z=l(j.nextEl),G=l(j.prevEl);Z&&Z.length>0&&Z.on("click",w),G&&G.length>0&&G.on("click",v),Object.assign(e.navigation,{$nextEl:Z,nextEl:Z&&Z[0],$prevEl:G,prevEl:G&&G[0]}),e.enabled||(Z&&Z.addClass(j.lockClass),G&&G.addClass(j.lockClass))}function S(){const{$nextEl:j,$prevEl:Z}=e.navigation;j&&j.length&&(j.off("click",w),j.removeClass(e.params.navigation.disabledClass)),Z&&Z.length&&(Z.off("click",v),Z.removeClass(e.params.navigation.disabledClass))}t({navigation:{nextEl:null,prevEl:null,hideOnClick:!1,disabledClass:"swiper-button-disabled",hiddenClass:"swiper-button-hidden",lockClass:"swiper-button-lock",navigationDisabledClass:"swiper-navigation-disabled"}}),e.navigation={nextEl:null,$nextEl:null,prevEl:null,$prevEl:null},n("init",()=>{!1===e.params.navigation.enabled?L():(T(),_())}),n("toEdge fromEdge lock unlock",()=>{_()}),n("destroy",()=>{S()}),n("enable disable",()=>{const{$nextEl:j,$prevEl:Z}=e.navigation;j&&j[e.enabled?"removeClass":"addClass"](e.params.navigation.lockClass),Z&&Z[e.enabled?"removeClass":"addClass"](e.params.navigation.lockClass)}),n("click",(j,Z)=>{const{$nextEl:G,$prevEl:Y}=e.navigation,ce=Z.target;if(e.params.navigation.hideOnClick&&!ii(ce).is(Y)&&!ii(ce).is(G)){if(e.pagination&&e.params.pagination&&e.params.pagination.clickable&&(e.pagination.el===ce||e.pagination.el.contains(ce)))return;let ee;G?ee=G.hasClass(e.params.navigation.hiddenClass):Y&&(ee=Y.hasClass(e.params.navigation.hiddenClass)),r(!0===ee?"navigationShow":"navigationHide"),G&&G.toggleClass(e.params.navigation.hiddenClass),Y&&Y.toggleClass(e.params.navigation.hiddenClass)}});const L=()=>{e.$el.addClass(e.params.navigation.navigationDisabledClass),S()};Object.assign(e.navigation,{enable:()=>{e.$el.removeClass(e.params.navigation.navigationDisabledClass),T(),_()},disable:L,update:_,init:T,destroy:S})}function Ff(e=""){return`.${e.trim().replace(/([\.:!\/])/g,"\\$1").replace(/ /g,".")}`}function Wb({swiper:e,extendParams:t,on:n,emit:r}){const l="swiper-pagination";t({pagination:{el:null,bulletElement:"span",clickable:!1,hideOnClick:!1,renderBullet:null,renderProgressbar:null,renderFraction:null,renderCustom:null,progressbarOpposite:!1,type:"bullets",dynamicBullets:!1,dynamicMainBullets:1,formatFractionCurrent:G=>G,formatFractionTotal:G=>G,bulletClass:`${l}-bullet`,bulletActiveClass:`${l}-bullet-active`,modifierClass:`${l}-`,currentClass:`${l}-current`,totalClass:`${l}-total`,hiddenClass:`${l}-hidden`,progressbarFillClass:`${l}-progressbar-fill`,progressbarOppositeClass:`${l}-progressbar-opposite`,clickableClass:`${l}-clickable`,lockClass:`${l}-lock`,horizontalClass:`${l}-horizontal`,verticalClass:`${l}-vertical`,paginationDisabledClass:`${l}-disabled`}}),e.pagination={el:null,$el:null,bullets:[]};let u,_=0;function v(){return!e.params.pagination.el||!e.pagination.el||!e.pagination.$el||0===e.pagination.$el.length}function w(G,Y){const{bulletActiveClass:ce}=e.params.pagination;G[Y]().addClass(`${ce}-${Y}`)[Y]().addClass(`${ce}-${Y}-${Y}`)}function T(){const G=e.rtl,Y=e.params.pagination;if(v())return;const ce=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.slides.length,ee=e.pagination.$el;let fe;const ze=e.params.loop?Math.ceil((ce-2*e.loopedSlides)/e.params.slidesPerGroup):e.snapGrid.length;if(e.params.loop?(fe=Math.ceil((e.activeIndex-e.loopedSlides)/e.params.slidesPerGroup),fe>ce-1-2*e.loopedSlides&&(fe-=ce-2*e.loopedSlides),fe>ze-1&&(fe-=ze),fe<0&&"bullets"!==e.params.paginationType&&(fe=ze+fe)):fe=void 0!==e.snapIndex?e.snapIndex:e.activeIndex||0,"bullets"===Y.type&&e.pagination.bullets&&e.pagination.bullets.length>0){const Be=e.pagination.bullets;let Ke,nt,yt;if(Y.dynamicBullets&&(u=Be.eq(0)[e.isHorizontal()?"outerWidth":"outerHeight"](!0),ee.css(e.isHorizontal()?"width":"height",u*(Y.dynamicMainBullets+4)+"px"),Y.dynamicMainBullets>1&&void 0!==e.previousIndex&&(_+=fe-(e.previousIndex-e.loopedSlides||0),_>Y.dynamicMainBullets-1?_=Y.dynamicMainBullets-1:_<0&&(_=0)),Ke=Math.max(fe-_,0),nt=Ke+(Math.min(Be.length,Y.dynamicMainBullets)-1),yt=(nt+Ke)/2),Be.removeClass(["","-next","-next-next","-prev","-prev-prev","-main"].map(It=>`${Y.bulletActiveClass}${It}`).join(" ")),ee.length>1)Be.each(It=>{const ut=ii(It),Le=ut.index();Le===fe&&ut.addClass(Y.bulletActiveClass),Y.dynamicBullets&&(Le>=Ke&&Le<=nt&&ut.addClass(`${Y.bulletActiveClass}-main`),Le===Ke&&w(ut,"prev"),Le===nt&&w(ut,"next"))});else{const It=Be.eq(fe),ut=It.index();if(It.addClass(Y.bulletActiveClass),Y.dynamicBullets){const Le=Be.eq(Ke),Ie=Be.eq(nt);for(let $e=Ke;$e<=nt;$e+=1)Be.eq($e).addClass(`${Y.bulletActiveClass}-main`);if(e.params.loop)if(ut>=Be.length){for(let $e=Y.dynamicMainBullets;$e>=0;$e-=1)Be.eq(Be.length-$e).addClass(`${Y.bulletActiveClass}-main`);Be.eq(Be.length-Y.dynamicMainBullets-1).addClass(`${Y.bulletActiveClass}-prev`)}else w(Le,"prev"),w(Ie,"next");else w(Le,"prev"),w(Ie,"next")}}if(Y.dynamicBullets){const It=Math.min(Be.length,Y.dynamicMainBullets+4),ut=(u*It-u)/2-yt*u,Le=G?"right":"left";Be.css(e.isHorizontal()?Le:"top",`${ut}px`)}}if("fraction"===Y.type&&(ee.find(Ff(Y.currentClass)).text(Y.formatFractionCurrent(fe+1)),ee.find(Ff(Y.totalClass)).text(Y.formatFractionTotal(ze))),"progressbar"===Y.type){let Be;Be=Y.progressbarOpposite?e.isHorizontal()?"vertical":"horizontal":e.isHorizontal()?"horizontal":"vertical";const Ke=(fe+1)/ze;let nt=1,yt=1;"horizontal"===Be?nt=Ke:yt=Ke,ee.find(Ff(Y.progressbarFillClass)).transform(`translate3d(0,0,0) scaleX(${nt}) scaleY(${yt})`).transition(e.params.speed)}"custom"===Y.type&&Y.renderCustom?(ee.html(Y.renderCustom(e,fe+1,ze)),r("paginationRender",ee[0])):r("paginationUpdate",ee[0]),e.params.watchOverflow&&e.enabled&&ee[e.isLocked?"addClass":"removeClass"](Y.lockClass)}function S(){const G=e.params.pagination;if(v())return;const Y=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.slides.length,ce=e.pagination.$el;let ee="";if("bullets"===G.type){let fe=e.params.loop?Math.ceil((Y-2*e.loopedSlides)/e.params.slidesPerGroup):e.snapGrid.length;e.params.freeMode&&e.params.freeMode.enabled&&!e.params.loop&&fe>Y&&(fe=Y);for(let ze=0;ze<fe;ze+=1)ee+=G.renderBullet?G.renderBullet.call(e,ze,G.bulletClass):`<${G.bulletElement} class="${G.bulletClass}"></${G.bulletElement}>`;ce.html(ee),e.pagination.bullets=ce.find(Ff(G.bulletClass))}"fraction"===G.type&&(ee=G.renderFraction?G.renderFraction.call(e,G.currentClass,G.totalClass):`<span class="${G.currentClass}"></span> / <span class="${G.totalClass}"></span>`,ce.html(ee)),"progressbar"===G.type&&(ee=G.renderProgressbar?G.renderProgressbar.call(e,G.progressbarFillClass):`<span class="${G.progressbarFillClass}"></span>`,ce.html(ee)),"custom"!==G.type&&r("paginationRender",e.pagination.$el[0])}function I(){e.params.pagination=eT(e,e.originalParams.pagination,e.params.pagination,{el:"swiper-pagination"});const G=e.params.pagination;if(!G.el)return;let Y=ii(G.el);0!==Y.length&&(e.params.uniqueNavElements&&"string"==typeof G.el&&Y.length>1&&(Y=e.$el.find(G.el),Y.length>1&&(Y=Y.filter(ce=>ii(ce).parents(".swiper")[0]===e.el))),"bullets"===G.type&&G.clickable&&Y.addClass(G.clickableClass),Y.addClass(G.modifierClass+G.type),Y.addClass(e.isHorizontal()?G.horizontalClass:G.verticalClass),"bullets"===G.type&&G.dynamicBullets&&(Y.addClass(`${G.modifierClass}${G.type}-dynamic`),_=0,G.dynamicMainBullets<1&&(G.dynamicMainBullets=1)),"progressbar"===G.type&&G.progressbarOpposite&&Y.addClass(G.progressbarOppositeClass),G.clickable&&Y.on("click",Ff(G.bulletClass),function(ee){ee.preventDefault();let fe=ii(this).index()*e.params.slidesPerGroup;e.params.loop&&(fe+=e.loopedSlides),e.slideTo(fe)}),Object.assign(e.pagination,{$el:Y,el:Y[0]}),e.enabled||Y.addClass(G.lockClass))}function L(){const G=e.params.pagination;if(v())return;const Y=e.pagination.$el;Y.removeClass(G.hiddenClass),Y.removeClass(G.modifierClass+G.type),Y.removeClass(e.isHorizontal()?G.horizontalClass:G.verticalClass),e.pagination.bullets&&e.pagination.bullets.removeClass&&e.pagination.bullets.removeClass(G.bulletActiveClass),G.clickable&&Y.off("click",Ff(G.bulletClass))}n("init",()=>{!1===e.params.pagination.enabled?Z():(I(),S(),T())}),n("activeIndexChange",()=>{(e.params.loop||void 0===e.snapIndex)&&T()}),n("snapIndexChange",()=>{e.params.loop||T()}),n("slidesLengthChange",()=>{e.params.loop&&(S(),T())}),n("snapGridLengthChange",()=>{e.params.loop||(S(),T())}),n("destroy",()=>{L()}),n("enable disable",()=>{const{$el:G}=e.pagination;G&&G[e.enabled?"removeClass":"addClass"](e.params.pagination.lockClass)}),n("lock unlock",()=>{T()}),n("click",(G,Y)=>{const ce=Y.target,{$el:ee}=e.pagination;if(e.params.pagination.el&&e.params.pagination.hideOnClick&&ee&&ee.length>0&&!ii(ce).hasClass(e.params.pagination.bulletClass)){if(e.navigation&&(e.navigation.nextEl&&ce===e.navigation.nextEl||e.navigation.prevEl&&ce===e.navigation.prevEl))return;const fe=ee.hasClass(e.params.pagination.hiddenClass);r(!0===fe?"paginationShow":"paginationHide"),ee.toggleClass(e.params.pagination.hiddenClass)}});const Z=()=>{e.$el.addClass(e.params.pagination.paginationDisabledClass),e.pagination.$el&&e.pagination.$el.addClass(e.params.pagination.paginationDisabledClass),L()};Object.assign(e.pagination,{enable:()=>{e.$el.removeClass(e.params.pagination.paginationDisabledClass),e.pagination.$el&&e.pagination.$el.removeClass(e.params.pagination.paginationDisabledClass),I(),S(),T()},disable:Z,render:S,update:T,init:I,destroy:L})}function bL(e,t){return e.transformEl?t.find(e.transformEl).css({"backface-visibility":"hidden","-webkit-backface-visibility":"hidden"}):t}const AL=["prevElRef"],EL=["nextElRef"],TL=["scrollbarElRef"],ML=["paginationElRef"];function SL(e,t){1&e&&(fg(0),Yt(1,"div",6,7)(3,"div",8,9),mg())}function DL(e,t){1&e&&Yt(0,"div",10,11)}function IL(e,t){1&e&&Yt(0,"div",12,13)}function PL(e,t){}function OL(e,t){1&e&&Tt(0,PL,0,0,"ng-template")}function kL(e,t){}function RL(e,t){1&e&&Tt(0,kL,0,0,"ng-template")}function LL(e,t){}function zL(e,t){1&e&&Tt(0,LL,0,0,"ng-template")}function FL(e,t){}const tT=function(e){return{$implicit:e}};function BL(e,t){if(1&e&&(We(0,"div",3),Tt(1,FL,0,0,"ng-template",18),rt()),2&e){const n=Sd().$implicit;ei("ngClass",Sd(2).zoomContainerClass),Bt(1),ei("ngTemplateOutlet",n.template)("ngTemplateOutletContext",Mf(3,tT,n.slideData))}}function NL(e,t){}function jL(e,t){if(1&e&&(fg(0),Tt(1,NL,0,0,"ng-template",18),mg()),2&e){const n=Sd().$implicit;Bt(1),ei("ngTemplateOutlet",n.template)("ngTemplateOutletContext",Mf(2,tT,n.slideData))}}function VL(e,t){if(1&e&&(We(0,"div",15),Tt(1,BL,2,5,"div",16),Tt(2,jL,2,4,"ng-container",17),rt()),2&e){const n=t.$implicit,r=Sd().key,l=Sd();rl(l.style),ei("ngClass",(n.class?n.class+" ":"")+l.slideClass+(""!==r?" "+l.slideDuplicateClass:""))("ngSwitch",n.zoom),Pe("data-swiper-slide-index",n.virtualIndex?n.virtualIndex:n.slideIndex)("data-swiper-autoplay",n.autoplayDelay),Bt(1),ei("ngSwitchCase",!0)}}function UL(e,t){1&e&&(Tt(0,VL,3,7,"div",14),kh(1,"async")),2&e&&ei("ngForOf",Sf(1,1,t.loopSlides))}const $L=[[["","slot","container-start"]],[["","slot","wrapper-start"]],[["","slot","wrapper-end"]],[["","slot","container-end"]]],GL=function(e){return{loopSlides:e,key:"prepend"}},HL=function(e){return{loopSlides:e,key:""}},qL=function(e){return{loopSlides:e,key:"append"}},ZL=["[slot=container-start]","[slot=wrapper-start]","[slot=wrapper-end]","[slot=container-end]"],nT=["init","enabled","_direction","touchEventsTarget","initialSlide","_speed","cssMode","updateOnWindowResize","resizeObserver","nested","focusableElements","_width","_height","preventInteractionOnTransition","userAgent","url","_edgeSwipeDetection","_edgeSwipeThreshold","_freeMode","_autoHeight","setWrapperSize","virtualTranslate","_effect","breakpoints","_spaceBetween","_slidesPerView","maxBackfaceHiddenSlides","_grid","_slidesPerGroup","_slidesPerGroupSkip","_slidesPerGroupAuto","_centeredSlides","_centeredSlidesBounds","_slidesOffsetBefore","_slidesOffsetAfter","normalizeSlideIndex","_centerInsufficientSlides","_watchOverflow","roundLengths","touchRatio","touchAngle","simulateTouch","_shortSwipes","_longSwipes","longSwipesRatio","longSwipesMs","_followFinger","allowTouchMove","_threshold","touchMoveStopPropagation","touchStartPreventDefault","touchStartForcePreventDefault","touchReleaseOnEdges","uniqueNavElements","_resistance","_resistanceRatio","_watchSlidesProgress","_grabCursor","preventClicks","preventClicksPropagation","_slideToClickedSlide","_preloadImages","updateOnImagesReady","_loop","_loopAdditionalSlides","_loopedSlides","_loopedSlidesLimit","_loopFillGroupWithBlank","loopPreventsSlide","_rewind","_allowSlidePrev","_allowSlideNext","_swipeHandler","_noSwiping","noSwipingClass","noSwipingSelector","passiveListeners","containerModifierClass","slideClass","slideBlankClass","slideActiveClass","slideDuplicateActiveClass","slideVisibleClass","slideDuplicateClass","slideNextClass","slideDuplicateNextClass","slidePrevClass","slideDuplicatePrevClass","wrapperClass","runCallbacksOnInit","observer","observeParents","observeSlideChildren","a11y","autoplay","_controller","coverflowEffect","cubeEffect","fadeEffect","flipEffect","creativeEffect","cardsEffect","hashNavigation","history","keyboard","lazy","mousewheel","_navigation","_pagination","parallax","_scrollbar","_thumbs","virtual","zoom","on"];function Bf(e){return"object"==typeof e&&null!==e&&e.constructor&&"Object"===Object.prototype.toString.call(e).slice(8,-1)}function Yb(e){return void 0!==e&&"boolean"!=typeof e&&!0===e.enabled}function iT(e,t,n){return!0===Lv(e)&&t&&!t.el||!("boolean"!=typeof t&&t.el!==(null==n?void 0:n.nativeElement)&&("string"==typeof t.el||"object"==typeof t.el))}function zd(e,t){const n=["__proto__","constructor","prototype"];Object.keys(t).filter(r=>n.indexOf(r)<0).forEach(r=>{void 0!==e[r]?e[r]&&!t[r]||(Bf(t[r])&&Bf(e[r])&&Object.keys(t[r]).length>0?t[r].__swiper__?e[r]=t[r]:zd(e[r],t[r]):e[r]=t[r]):e[r]=t[r]})}function Lv(e){return null!=e&&"false"!=`${e}`}const WL=["pagination","navigation","scrollbar","virtual"];function zv(e,t={}){return Bf(e)?e:!0===Lv(e)&&t}function Xb(e={}){const t={on:{}},n={};zd(t,Uh.defaults),zd(t,Uh.extendedDefaults),t._emitClasses=!0,t.init=!1;const r={},l=nT.map(u=>u.replace(/_/,""));return Object.keys(e).forEach(u=>{const _=u.replace(/^_/,"");l.indexOf(_)>=0?Bf(e[u])?(t[_]={},n[_]={},zd(t[_],e[u]),zd(n[_],e[u])):(t[_]=e[u],n[_]=e[u]):r[_]=e[u]}),["navigation","pagination","scrollbar"].forEach(u=>{!0===t[u]&&(t[u]={}),!1===t[u]&&delete t[u]}),{params:t,passedParams:n,rest:r}}nT.map(e=>e.replace(/_/,""));let Qb=(()=>{class e{constructor(n){this.template=n,this.class="",this.autoplayDelay=null,this.slideData={isActive:!1,isPrev:!1,isNext:!1,isVisible:!1,isDuplicate:!1}}set ngClass(n){this.class=[this.class||"",n].join(" ")}set zoom(n){this._zoom=Lv(n)}get zoom(){return this._zoom}get classNames(){return this._classNames}set classNames(n){this._classNames!==n&&(this._classNames=n,this.slideData={isActive:this._hasClass(["swiper-slide-active","swiper-slide-duplicate-active"]),isVisible:this._hasClass(["swiper-slide-visible"]),isDuplicate:this._hasClass(["swiper-slide-duplicate"]),isPrev:this._hasClass(["swiper-slide-prev","swiper-slide-duplicate-prev"]),isNext:this._hasClass(["swiper-slide-next","swiper-slide-duplicate-next"])})}_hasClass(n){return n.some(r=>this._classNames.indexOf(r)>=0)}}return e.\u0275fac=function(n){return new(n||e)(Vt(Ul))},e.\u0275dir=zi({type:e,selectors:[["ng-template","swiperSlide",""]],inputs:{virtualIndex:"virtualIndex",class:"class",ngClass:"ngClass",autoplayDelay:["data-swiper-autoplay","autoplayDelay"],zoom:"zoom"}}),e})(),rT=(()=>{class e{constructor(n,r,l,u){this._ngZone=n,this.elementRef=r,this._changeDetectorRef=l,this._platformId=u,this.slideClass="swiper-slide",this.wrapperClass="swiper-wrapper",this.showNavigation=!0,this.showPagination=!0,this.showScrollbar=!0,this.s__beforeBreakpoint=new ft,this.s__containerClasses=new ft,this.s__slideClass=new ft,this.s__swiper=new ft,this.s_activeIndexChange=new ft,this.s_afterInit=new ft,this.s_autoplay=new ft,this.s_autoplayStart=new ft,this.s_autoplayStop=new ft,this.s_autoplayPause=new ft,this.s_autoplayResume=new ft,this.s_beforeDestroy=new ft,this.s_beforeInit=new ft,this.s_beforeLoopFix=new ft,this.s_beforeResize=new ft,this.s_beforeSlideChangeStart=new ft,this.s_beforeTransitionStart=new ft,this.s_breakpoint=new ft,this.s_changeDirection=new ft,this.s_click=new ft,this.s_doubleTap=new ft,this.s_doubleClick=new ft,this.s_destroy=new ft,this.s_fromEdge=new ft,this.s_hashChange=new ft,this.s_hashSet=new ft,this.s_imagesReady=new ft,this.s_init=new ft,this.s_keyPress=new ft,this.s_lazyImageLoad=new ft,this.s_lazyImageReady=new ft,this.s_loopFix=new ft,this.s_momentumBounce=new ft,this.s_navigationHide=new ft,this.s_navigationShow=new ft,this.s_navigationPrev=new ft,this.s_navigationNext=new ft,this.s_observerUpdate=new ft,this.s_orientationchange=new ft,this.s_paginationHide=new ft,this.s_paginationRender=new ft,this.s_paginationShow=new ft,this.s_paginationUpdate=new ft,this.s_progress=new ft,this.s_reachBeginning=new ft,this.s_reachEnd=new ft,this.s_realIndexChange=new ft,this.s_resize=new ft,this.s_scroll=new ft,this.s_scrollbarDragEnd=new ft,this.s_scrollbarDragMove=new ft,this.s_scrollbarDragStart=new ft,this.s_setTransition=new ft,this.s_setTranslate=new ft,this.s_slideChange=new ft,this.s_slideChangeTransitionEnd=new ft,this.s_slideChangeTransitionStart=new ft,this.s_slideNextTransitionEnd=new ft,this.s_slideNextTransitionStart=new ft,this.s_slidePrevTransitionEnd=new ft,this.s_slidePrevTransitionStart=new ft,this.s_slideResetTransitionStart=new ft,this.s_slideResetTransitionEnd=new ft,this.s_sliderMove=new ft,this.s_sliderFirstMove=new ft,this.s_slidesLengthChange=new ft,this.s_slidesGridLengthChange=new ft,this.s_snapGridLengthChange=new ft,this.s_snapIndexChange=new ft,this.s_tap=new ft,this.s_toEdge=new ft,this.s_touchEnd=new ft,this.s_touchMove=new ft,this.s_touchMoveOpposite=new ft,this.s_touchStart=new ft,this.s_transitionEnd=new ft,this.s_transitionStart=new ft,this.s_update=new ft,this.s_zoomChange=new ft,this.s_swiper=new ft,this.s_lock=new ft,this.s_unlock=new ft,this._activeSlides=new bi,this.containerClasses="swiper",this.slidesChanges=_=>{this.slides=_.map((v,w)=>(v.slideIndex=w,v.classNames=this.slideClass||"",v)),this.loop&&!this.loopedSlides&&this.calcLoopedSlides(),this.virtual?this.swiperRef&&this.swiperRef.virtual&&this._ngZone.runOutsideAngular(()=>{this.swiperRef.virtual.slides=this.slides,this.swiperRef.virtual.update(!0)}):this.loopedSlides&&(this.prependSlides=mn(this.slides.slice(this.slides.length-this.loopedSlides)),this.appendSlides=mn(this.slides.slice(0,this.loopedSlides))),this._changeDetectorRef.detectChanges()},this.style=null,this.updateVirtualSlides=_=>{!this.swiperRef||this.currentVirtualData&&this.currentVirtualData.from===_.from&&this.currentVirtualData.to===_.to&&this.currentVirtualData.offset===_.offset||(this.style=this.swiperRef.isHorizontal()?{[this.swiperRef.rtlTranslate?"right":"left"]:`${_.offset}px`}:{top:`${_.offset}px`},this.currentVirtualData=_,this._activeSlides.next(_.slides),this._ngZone.run(()=>{this._changeDetectorRef.detectChanges()}),this._ngZone.runOutsideAngular(()=>{this.swiperRef.updateSlides(),this.swiperRef.updateProgress(),this.swiperRef.updateSlidesClasses(),Yb(this.swiperRef.params.lazy)&&this.swiperRef.lazy.load(),this.swiperRef.virtual.update(!0)}))}}set navigation(n){var r,l,u;const _="boolean"!=typeof this._navigation&&""!==this._navigation?null===(r=this._navigation)||void 0===r?void 0:r.nextEl:null,v="boolean"!=typeof this._navigation&&""!==this._navigation?null===(l=this._navigation)||void 0===l?void 0:l.prevEl:null;this._navigation=zv(n,{nextEl:_||null,prevEl:v||null}),this.showNavigation=!(!0!==Lv(n)||this._navigation&&"boolean"!=typeof this._navigation&&this._navigation.prevEl!==(null===(u=this._prevElRef)||void 0===u?void 0:u.nativeElement)&&(null!==this._navigation.prevEl||null!==this._navigation.nextEl)&&("string"==typeof this._navigation.nextEl||"string"==typeof this._navigation.prevEl||"object"==typeof this._navigation.nextEl||"object"==typeof this._navigation.prevEl))}get navigation(){return this._navigation}set pagination(n){var r;const l="boolean"!=typeof this._pagination&&""!==this._pagination?null===(r=this._pagination)||void 0===r?void 0:r.el:null;this._pagination=zv(n,{el:l||null}),this.showPagination=iT(n,this._pagination,this._paginationElRef)}get pagination(){return this._pagination}set scrollbar(n){var r;const l="boolean"!=typeof this._scrollbar&&""!==this._scrollbar?null===(r=this._scrollbar)||void 0===r?void 0:r.el:null;this._scrollbar=zv(n,{el:l||null}),this.showScrollbar=iT(n,this._scrollbar,this._scrollbarElRef)}get scrollbar(){return this._scrollbar}set virtual(n){this._virtual=zv(n)}get virtual(){return this._virtual}set config(n){this.updateSwiper(n);const{params:r}=Xb(n);Object.assign(this,r)}set prevElRef(n){this._prevElRef=n,this._setElement(n,this.navigation,"navigation","prevEl")}set nextElRef(n){this._nextElRef=n,this._setElement(n,this.navigation,"navigation","nextEl")}set scrollbarElRef(n){this._scrollbarElRef=n,this._setElement(n,this.scrollbar,"scrollbar")}set paginationElRef(n){this._paginationElRef=n,this._setElement(n,this.pagination,"pagination")}get activeSlides(){return this.virtual?this._activeSlides:mn(this.slides)}get zoomContainerClass(){return this.zoom&&"boolean"!=typeof this.zoom?this.zoom.containerClass:"swiper-zoom-container"}_setElement(n,r,l,u="el"){if(!r||!n)return;if(n.nativeElement){if(r[u]===n.nativeElement)return;r[u]=n.nativeElement}const _={};_[l]=!0,this.updateInitSwiper(_)}ngOnInit(){const{params:n}=Xb(this);Object.assign(this,n)}ngAfterViewInit(){this.childrenSlidesInit(),this.initSwiper(),this._changeDetectorRef.detectChanges(),setTimeout(()=>{this.s_swiper.emit(this.swiperRef)})}childrenSlidesInit(){this.slidesChanges(this.slidesEl),this.slidesEl.changes.subscribe(this.slidesChanges)}get isSwiperActive(){return this.swiperRef&&!this.swiperRef.destroyed}initSwiper(){const{params:n}=Xb(this);Object.assign(this,n),this._ngZone.runOutsideAngular(()=>{n.init=!1,n.virtual||(n.observer=!0),n.onAny=(w,...T)=>{const S=this["s_"+w];S&&S.emit([...T])},Object.assign(n.on,{_containerClasses:(w,T)=>{setTimeout(()=>{this.containerClasses=T})},_slideClasses:(w,T)=>{T.forEach(({slideEl:S,classNames:I},L)=>{const j=S.getAttribute("data-swiper-slide-index"),Z=j?parseInt(j):L;if(this.virtual){const G=this.slides.find(Y=>Y.virtualIndex&&Y.virtualIndex===Z);if(G)return void(G.classNames=I)}this.slides[Z]&&(this.slides[Z].classNames=I)}),this._changeDetectorRef.detectChanges()}});const _=new Uh(n);_.loopCreate=()=>{},_.loopDestroy=()=>{},n.loop&&(_.loopedSlides=this.loopedSlides);const v=Yb(_.params.virtual);if(_.virtual&&v){_.virtual.slides=this.slides;const w={cache:!1,slides:this.slides,renderExternal:this.updateVirtualSlides,renderExternalUpdate:!1};zd(_.params.virtual,w),zd(_.originalParams.virtual,w)}if(function aP(e){return e===xA}(this._platformId)){this.swiperRef=_.init(this.elementRef.nativeElement);const w=Yb(this.swiperRef.params.virtual);this.swiperRef.virtual&&w&&this.swiperRef.virtual.update(!0),this._changeDetectorRef.detectChanges()}})}ngOnChanges(n){this.updateSwiper(n),this._changeDetectorRef.detectChanges()}updateInitSwiper(n){!n||!this.swiperRef||this.swiperRef.destroyed||this._ngZone.runOutsideAngular(()=>{const{pagination:l,navigation:u,scrollbar:_,thumbs:w}=this.swiperRef;n.pagination&&(this.pagination&&"boolean"!=typeof this.pagination&&this.pagination.el&&l&&!l.el?(this.updateParameter("pagination",this.pagination),l.init(),l.render(),l.update()):(l.destroy(),l.el=null)),n.scrollbar&&(this.scrollbar&&"boolean"!=typeof this.scrollbar&&this.scrollbar.el&&_&&!_.el?(this.updateParameter("scrollbar",this.scrollbar),_.init(),_.updateSize(),_.setTranslate()):(_.destroy(),_.el=null)),n.navigation&&(this.navigation&&"boolean"!=typeof this.navigation&&this.navigation.prevEl&&this.navigation.nextEl&&u&&!u.prevEl&&!u.nextEl?(this.updateParameter("navigation",this.navigation),u.init(),u.update()):u.prevEl&&u.nextEl&&(u.destroy(),u.nextEl=null,u.prevEl=null)),n.thumbs&&this.thumbs&&this.thumbs.swiper&&(this.updateParameter("thumbs",this.thumbs),w.init()&&w.update(!0)),n.controller&&this.controller&&this.controller.control&&(this.swiperRef.controller.control=this.controller.control),this.swiperRef.update()})}updateSwiper(n){this._ngZone.runOutsideAngular(()=>{var r,l;if(!n.config&&n&&this.swiperRef&&!this.swiperRef.destroyed){for(const u in n){if(WL.indexOf(u)>=0)continue;const _=null!==(l=null===(r=n[u])||void 0===r?void 0:r.currentValue)&&void 0!==l?l:n[u];this.updateParameter(u,_)}n.allowSlideNext&&(this.swiperRef.allowSlideNext=this.allowSlideNext),n.allowSlidePrev&&(this.swiperRef.allowSlidePrev=this.allowSlidePrev),n.direction&&this.swiperRef.changeDirection(this.direction,!1),n.breakpoints&&(this.loop&&!this.loopedSlides&&this.calcLoopedSlides(),this.swiperRef.currentBreakpoint=null,this.swiperRef.setBreakpoint()),(n.thumbs||n.controller)&&this.updateInitSwiper(n),this.swiperRef.update()}})}calcLoopedSlides(){if(!this.loop)return!1;let n=this.slidesPerView;if(this.breakpoints){const l=Uh.prototype.getBreakpoint(this.breakpoints),u=l in this.breakpoints?this.breakpoints[l]:void 0;u&&u.slidesPerView&&(n=u.slidesPerView)}if("auto"===n)return this.loopedSlides=this.slides.length,this.slides.length;let r=this.loopedSlides||n;return!!r&&(this.loopAdditionalSlides&&(r+=this.loopAdditionalSlides),r>this.slides.length&&(r=this.slides.length),this.loopedSlides=r,!0)}updateParameter(n,r){if(!this.swiperRef||this.swiperRef.destroyed)return;const l=n.replace(/^_/,""),u=Bf(this.swiperRef.params[l]);"enabled"!==l?u&&Bf(r)?zd(this.swiperRef.params[l],r):this.swiperRef.params[l]=r:!0===r?this.swiperRef.enable():!1===r&&this.swiperRef.disable()}ngOnDestroy(){this._ngZone.runOutsideAngular(()=>{var n;null===(n=this.swiperRef)||void 0===n||n.destroy(!0,!1)})}}return e.\u0275fac=function(n){return new(n||e)(Vt(Wr),Vt(nu),Vt(Yy),Vt(Nx))},e.\u0275cmp=ti({type:e,selectors:[["swiper"],["","swiper",""]],contentQueries:function(n,r,l){if(1&n&&Hy(l,Qb,4),2&n){let u;ou(u=su())&&(r.slidesEl=u)}},viewQuery:function(n,r){if(1&n&&(Df(AL,5),Df(EL,5),Df(TL,5),Df(ML,5)),2&n){let l;ou(l=su())&&(r.prevElRef=l.first),ou(l=su())&&(r.nextElRef=l.first),ou(l=su())&&(r.scrollbarElRef=l.first),ou(l=su())&&(r.paginationElRef=l.first)}},hostVars:2,hostBindings:function(n,r){2&n&&function Bw(e){sl(Oi,Vl,e,!0)}(r.containerClasses)},inputs:{enabled:"enabled",on:"on",direction:"direction",touchEventsTarget:"touchEventsTarget",initialSlide:"initialSlide",speed:"speed",cssMode:"cssMode",updateOnWindowResize:"updateOnWindowResize",resizeObserver:"resizeObserver",nested:"nested",focusableElements:"focusableElements",width:"width",height:"height",preventInteractionOnTransition:"preventInteractionOnTransition",userAgent:"userAgent",url:"url",edgeSwipeDetection:"edgeSwipeDetection",edgeSwipeThreshold:"edgeSwipeThreshold",freeMode:"freeMode",autoHeight:"autoHeight",setWrapperSize:"setWrapperSize",virtualTranslate:"virtualTranslate",effect:"effect",breakpoints:"breakpoints",spaceBetween:"spaceBetween",slidesPerView:"slidesPerView",maxBackfaceHiddenSlides:"maxBackfaceHiddenSlides",grid:"grid",slidesPerGroup:"slidesPerGroup",slidesPerGroupSkip:"slidesPerGroupSkip",centeredSlides:"centeredSlides",centeredSlidesBounds:"centeredSlidesBounds",slidesOffsetBefore:"slidesOffsetBefore",slidesOffsetAfter:"slidesOffsetAfter",normalizeSlideIndex:"normalizeSlideIndex",centerInsufficientSlides:"centerInsufficientSlides",watchOverflow:"watchOverflow",roundLengths:"roundLengths",touchRatio:"touchRatio",touchAngle:"touchAngle",simulateTouch:"simulateTouch",shortSwipes:"shortSwipes",longSwipes:"longSwipes",longSwipesRatio:"longSwipesRatio",longSwipesMs:"longSwipesMs",followFinger:"followFinger",allowTouchMove:"allowTouchMove",threshold:"threshold",touchMoveStopPropagation:"touchMoveStopPropagation",touchStartPreventDefault:"touchStartPreventDefault",touchStartForcePreventDefault:"touchStartForcePreventDefault",touchReleaseOnEdges:"touchReleaseOnEdges",uniqueNavElements:"uniqueNavElements",resistance:"resistance",resistanceRatio:"resistanceRatio",watchSlidesProgress:"watchSlidesProgress",grabCursor:"grabCursor",preventClicks:"preventClicks",preventClicksPropagation:"preventClicksPropagation",slideToClickedSlide:"slideToClickedSlide",preloadImages:"preloadImages",updateOnImagesReady:"updateOnImagesReady",loop:"loop",loopAdditionalSlides:"loopAdditionalSlides",loopedSlides:"loopedSlides",loopedSlidesLimit:"loopedSlidesLimit",loopFillGroupWithBlank:"loopFillGroupWithBlank",loopPreventsSlide:"loopPreventsSlide",rewind:"rewind",allowSlidePrev:"allowSlidePrev",allowSlideNext:"allowSlideNext",swipeHandler:"swipeHandler",noSwiping:"noSwiping",noSwipingClass:"noSwipingClass",noSwipingSelector:"noSwipingSelector",passiveListeners:"passiveListeners",containerModifierClass:"containerModifierClass",slideClass:"slideClass",slideBlankClass:"slideBlankClass",slideActiveClass:"slideActiveClass",slideDuplicateActiveClass:"slideDuplicateActiveClass",slideVisibleClass:"slideVisibleClass",slideDuplicateClass:"slideDuplicateClass",slideNextClass:"slideNextClass",slideDuplicateNextClass:"slideDuplicateNextClass",slidePrevClass:"slidePrevClass",slideDuplicatePrevClass:"slideDuplicatePrevClass",wrapperClass:"wrapperClass",runCallbacksOnInit:"runCallbacksOnInit",observeParents:"observeParents",observeSlideChildren:"observeSlideChildren",a11y:"a11y",autoplay:"autoplay",controller:"controller",coverflowEffect:"coverflowEffect",cubeEffect:"cubeEffect",fadeEffect:"fadeEffect",flipEffect:"flipEffect",creativeEffect:"creativeEffect",cardsEffect:"cardsEffect",hashNavigation:"hashNavigation",history:"history",keyboard:"keyboard",lazy:"lazy",mousewheel:"mousewheel",parallax:"parallax",thumbs:"thumbs",zoom:"zoom",class:"class",id:"id",navigation:"navigation",pagination:"pagination",scrollbar:"scrollbar",virtual:"virtual",config:"config"},outputs:{s__beforeBreakpoint:"_beforeBreakpoint",s__containerClasses:"_containerClasses",s__slideClass:"_slideClass",s__swiper:"_swiper",s_activeIndexChange:"activeIndexChange",s_afterInit:"afterInit",s_autoplay:"autoplay",s_autoplayStart:"autoplayStart",s_autoplayStop:"autoplayStop",s_autoplayPause:"autoplayPause",s_autoplayResume:"autoplayResume",s_beforeDestroy:"beforeDestroy",s_beforeInit:"beforeInit",s_beforeLoopFix:"beforeLoopFix",s_beforeResize:"beforeResize",s_beforeSlideChangeStart:"beforeSlideChangeStart",s_beforeTransitionStart:"beforeTransitionStart",s_breakpoint:"breakpoint",s_changeDirection:"changeDirection",s_click:"click",s_doubleTap:"doubleTap",s_doubleClick:"doubleClick",s_destroy:"destroy",s_fromEdge:"fromEdge",s_hashChange:"hashChange",s_hashSet:"hashSet",s_imagesReady:"imagesReady",s_init:"init",s_keyPress:"keyPress",s_lazyImageLoad:"lazyImageLoad",s_lazyImageReady:"lazyImageReady",s_loopFix:"loopFix",s_momentumBounce:"momentumBounce",s_navigationHide:"navigationHide",s_navigationShow:"navigationShow",s_navigationPrev:"navigationPrev",s_navigationNext:"navigationNext",s_observerUpdate:"observerUpdate",s_orientationchange:"orientationchange",s_paginationHide:"paginationHide",s_paginationRender:"paginationRender",s_paginationShow:"paginationShow",s_paginationUpdate:"paginationUpdate",s_progress:"progress",s_reachBeginning:"reachBeginning",s_reachEnd:"reachEnd",s_realIndexChange:"realIndexChange",s_resize:"resize",s_scroll:"scroll",s_scrollbarDragEnd:"scrollbarDragEnd",s_scrollbarDragMove:"scrollbarDragMove",s_scrollbarDragStart:"scrollbarDragStart",s_setTransition:"setTransition",s_setTranslate:"setTranslate",s_slideChange:"slideChange",s_slideChangeTransitionEnd:"slideChangeTransitionEnd",s_slideChangeTransitionStart:"slideChangeTransitionStart",s_slideNextTransitionEnd:"slideNextTransitionEnd",s_slideNextTransitionStart:"slideNextTransitionStart",s_slidePrevTransitionEnd:"slidePrevTransitionEnd",s_slidePrevTransitionStart:"slidePrevTransitionStart",s_slideResetTransitionStart:"slideResetTransitionStart",s_slideResetTransitionEnd:"slideResetTransitionEnd",s_sliderMove:"sliderMove",s_sliderFirstMove:"sliderFirstMove",s_slidesLengthChange:"slidesLengthChange",s_slidesGridLengthChange:"slidesGridLengthChange",s_snapGridLengthChange:"snapGridLengthChange",s_snapIndexChange:"snapIndexChange",s_tap:"tap",s_toEdge:"toEdge",s_touchEnd:"touchEnd",s_touchMove:"touchMove",s_touchMoveOpposite:"touchMoveOpposite",s_touchStart:"touchStart",s_transitionEnd:"transitionEnd",s_transitionStart:"transitionStart",s_update:"update",s_zoomChange:"zoomChange",s_swiper:"swiper",s_lock:"lock",s_unlock:"unlock"},features:[ds],ngContentSelectors:ZL,decls:13,vars:17,consts:[[4,"ngIf"],["class","swiper-scrollbar",4,"ngIf"],["class","swiper-pagination",4,"ngIf"],[3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["slidesTemplate",""],[1,"swiper-button-prev"],["prevElRef",""],[1,"swiper-button-next"],["nextElRef",""],[1,"swiper-scrollbar"],["scrollbarElRef",""],[1,"swiper-pagination"],["paginationElRef",""],[3,"ngClass","style","ngSwitch",4,"ngFor","ngForOf"],[3,"ngClass","ngSwitch"],[3,"ngClass",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(n,r){if(1&n&&(function vw(e){const t=it()[16][6];if(!t.projection){const r=t.projection=rh(e?e.length:1,null),l=r.slice();let u=t.child;for(;null!==u;){const _=e?gT(u,e):0;null!==_&&(l[_]?l[_].projectionNext=u:r[_]=u,l[_]=u),u=u.next}}}($L),gg(0),Tt(1,SL,5,0,"ng-container",0),Tt(2,DL,2,0,"div",1),Tt(3,IL,2,0,"div",2),We(4,"div",3),gg(5,1),Tt(6,OL,1,0,null,4),Tt(7,RL,1,0,null,4),Tt(8,zL,1,0,null,4),gg(9,2),rt(),gg(10,3),Tt(11,UL,2,3,"ng-template",null,5,lC)),2&n){const l=function Xn(e){return Rs(function Va(){return Gt.lFrame.contextLView}(),20+e)}(12);Bt(1),ei("ngIf",r.navigation&&r.showNavigation),Bt(1),ei("ngIf",r.scrollbar&&r.showScrollbar),Bt(1),ei("ngIf",r.pagination&&r.showPagination),Bt(1),ei("ngClass",r.wrapperClass),Pe("id",r.id),Bt(2),ei("ngTemplateOutlet",l)("ngTemplateOutletContext",Mf(11,GL,r.prependSlides)),Bt(1),ei("ngTemplateOutlet",l)("ngTemplateOutletContext",Mf(13,HL,r.activeSlides)),Bt(1),ei("ngTemplateOutlet",l)("ngTemplateOutletContext",Mf(15,qL,r.appendSlides))}},directives:[uA,lA,mA,cu,cv,hA,pA],pipes:[gA],styles:["swiper{display:block}\n"],encapsulation:2,changeDetection:0}),e})(),YL=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=hr({type:e}),e.\u0275inj=Li({imports:[[Pg]]}),e})(),oT=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=hr({type:e}),e.\u0275inj=Li({imports:[[Pg,hu,YL]]}),e})(),XL=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=hr({type:e}),e.\u0275inj=Li({imports:[[Pg,hu]]}),e})(),QL=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=hr({type:e}),e.\u0275inj=Li({imports:[[Pg,oT,hu,XL]]}),e})(),KL=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-not-page-found"]],decls:2,vars:0,template:function(n,r){1&n&&(We(0,"p"),xt(1,"not-page-found works!"),rt())},styles:[""]}),e})();const JL=[{path:"login",component:(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-login"]],decls:0,vars:0,template:function(n,r){},styles:[""]}),e})()},{path:"register",component:(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-register"]],decls:2,vars:0,template:function(n,r){1&n&&(We(0,"p"),xt(1,"register works!"),rt())},styles:[""]}),e})()}];let ez=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=hr({type:e}),e.\u0275inj=Li({imports:[[hu.forChild(JL)],hu]}),e})(),Fv=(()=>{class e{constructor(n){this.router=n,this.title="",this.titleSubs$=this.getDataArgs().subscribe(({title:r})=>{this.title=r})}ngOnDestroy(){this.titleSubs$.unsubscribe()}getDataArgs(){return this.router.events.pipe(Od(n=>n instanceof $A),Od(n=>null===n.snapshot.firstChild),Qn(n=>n.snapshot.data))}}return e.\u0275fac=function(n){return new(n||e)(Vt(vs))},e.\u0275cmp=ti({type:e,selectors:[["app-title"]],decls:3,vars:1,consts:[[1,"title-section"],[1,"mb-4"]],template:function(n,r){1&n&&(We(0,"div",0)(1,"h2",1),xt(2),rt()()),2&n&&(Bt(2),ba(r.title))},styles:['.title-section[_ngcontent-%COMP%]{flex:0 0 100%;margin-top:30px;max-width:100%;margin-bottom:60px}.title-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:40px;font-family:Rubik,sans-serif;font-weight:700;margin:0;position:relative}.title-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]:before{content:"";height:4px;width:50px;position:absolute;top:100%;left:0;background-color:var( --main-color )}.title-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]:after{content:"";height:4px;width:25px;position:absolute;top:100%;left:0;margin-top:8px;background-color:var( --main-color )}']}),e})(),tz=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-social-networks"]],decls:23,vars:0,consts:[[1,"contact__social","text-center"],["href","#"],[1,"fab","fa-facebook"],[1,"fab","fa-twitter"],["href","https://www.instagram.com/eve_estilistas/","target","_blank"],[1,"fab","fa-instagram"],[1,"fab","fa-whatsapp"],[1,"contact__text","text-center","py-4"],[1,"custom-text-pink"]],template:function(n,r){1&n&&(We(0,"div")(1,"div",0)(2,"a",1),Yt(3,"i",2),rt(),We(4,"a",1),Yt(5,"i",3),rt(),We(6,"a",4),Yt(7,"i",5),rt(),We(8,"a",1),Yt(9,"i",6),rt()()(),We(10,"div",7)(11,"p")(12,"span",8),xt(13,"Tel\xe9fono:"),rt(),xt(14," +569 12345678"),rt(),We(15,"p")(16,"span",8),xt(17,"Email:"),rt(),xt(18," qwerty@gmail.com"),rt(),We(19,"p")(20,"span",8),xt(21,"Direcci\xf3n"),rt(),xt(22," 123 Antofa"),rt()())},styles:[".contact__social[_ngcontent-%COMP%]{padding-top:20px;margin-bottom:40px}.contact__social[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline-block;font-size:30px;text-align:center;width:60px;height:60px;padding-top:8px;margin-right:6px;color:#222;border-radius:50%;background:#E8E8E8;transition:.3s}.contact__social[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background:#E0698D;color:#fff}.contact__text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:18px;color:#222}.contact__text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:18px}"]}),e})();var Bv=Hl(898),nz=Hl.n(Bv);const iz=["mapDiv"];let rz=(()=>{class e{constructor(){this.staticLnLat=[-70.4087393,-23.6710097]}ngAfterViewInit(){const n=new Bv.Map({container:this.mapDivElement.nativeElement,style:"mapbox://styles/mapbox/streets-v11",center:this.staticLnLat,zoom:14});new Bv.Marker({color:"#E0698D",draggable:!0}).setLngLat(this.staticLnLat).setPopup((new Bv.Popup).setHTML("<h2 class='my-3'>Hair by Eve</h2>")).addTo(n)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-map"]],viewQuery:function(n,r){if(1&n&&Df(iz,5),2&n){let l;ou(l=su())&&(r.mapDivElement=l.first)}},decls:2,vars:0,consts:[[1,"mapbox-map-container","rounded"],["mapDiv",""]],template:function(n,r){1&n&&Yt(0,"div",0,1)},styles:[".mapbox-map-container[_ngcontent-%COMP%]{background-color:#0ff;height:400px;width:100%}"]}),e})(),oz=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-contact"]],decls:9,vars:0,consts:[[1,"py-5","animate__animated","animate__fadeIn","animate__faster"],[1,"row"],[1,"row","row-cols-1","row-cols-md-2","g-4"],[1,"col"]],template:function(n,r){1&n&&(We(0,"section",0)(1,"div",1),Yt(2,"app-title"),rt(),Yt(3,"hr"),We(4,"div",2)(5,"div",3),Yt(6,"app-social-networks"),rt(),We(7,"div",3),Yt(8,"app-map"),rt()()())},directives:[Fv,tz,rz],encapsulation:2}),e})();function sz(e,t){if(1&e&&(We(0,"div",3)(1,"div",4)(2,"h3"),xt(3),rt(),We(4,"p"),xt(5),kh(6,"slice"),rt(),We(7,"button",5),xt(8,"Reservar Hora"),rt()()()),2&e){const n=Sd().$implicit;(function Jw(e,t,n){rl(tt(it(),e,t,n))})("background-image: url('",n.url,"');"),Bt(3),ba(n.title),Bt(2),Ri(" ",function J1(e,t,n,r,l){const u=e+20,_=it(),v=Rs(_,u);return Eg(_,u)?X1(_,pr(),t,v.transform,n,r,l,v):v.transform(n,r,l)}(6,5,n.p,0,230),"... ")}}function az(e,t){1&e&&Tt(0,sz,9,9,"ng-template",2)}const lz=function(){return{delay:3500,disableOnInteraction:!1}},cz=function(){return{clickable:!0}};Uh.use([function vL({swiper:e,extendParams:t,on:n,emit:r}){let l;function u(){if(!e.size)return e.autoplay.running=!1,void(e.autoplay.paused=!1);const G=e.slides.eq(e.activeIndex);let Y=e.params.autoplay.delay;G.attr("data-swiper-autoplay")&&(Y=G.attr("data-swiper-autoplay")||e.params.autoplay.delay),clearTimeout(l),l=Ov(()=>{let ce;e.params.autoplay.reverseDirection?e.params.loop?(e.loopFix(),ce=e.slidePrev(e.params.speed,!0,!0),r("autoplay")):e.isBeginning?e.params.autoplay.stopOnLastSlide?v():(ce=e.slideTo(e.slides.length-1,e.params.speed,!0,!0),r("autoplay")):(ce=e.slidePrev(e.params.speed,!0,!0),r("autoplay")):e.params.loop?(e.loopFix(),ce=e.slideNext(e.params.speed,!0,!0),r("autoplay")):e.isEnd?e.params.autoplay.stopOnLastSlide?v():(ce=e.slideTo(0,e.params.speed,!0,!0),r("autoplay")):(ce=e.slideNext(e.params.speed,!0,!0),r("autoplay")),(e.params.cssMode&&e.autoplay.running||!1===ce)&&u()},Y)}function _(){return void 0===l&&!e.autoplay.running&&(e.autoplay.running=!0,r("autoplayStart"),u(),!0)}function v(){return!(!e.autoplay.running||void 0===l||(l&&(clearTimeout(l),l=void 0),e.autoplay.running=!1,r("autoplayStop"),0))}function w(G){!e.autoplay.running||e.autoplay.paused||(l&&clearTimeout(l),e.autoplay.paused=!0,0!==G&&e.params.autoplay.waitForTransition?["transitionend","webkitTransitionEnd"].forEach(Y=>{e.$wrapperEl[0].addEventListener(Y,S)}):(e.autoplay.paused=!1,u()))}function T(){const G=go();"hidden"===G.visibilityState&&e.autoplay.running&&w(),"visible"===G.visibilityState&&e.autoplay.paused&&(u(),e.autoplay.paused=!1)}function S(G){!e||e.destroyed||!e.$wrapperEl||G.target===e.$wrapperEl[0]&&(["transitionend","webkitTransitionEnd"].forEach(Y=>{e.$wrapperEl[0].removeEventListener(Y,S)}),e.autoplay.paused=!1,e.autoplay.running?u():v())}function I(){e.params.autoplay.disableOnInteraction?v():(r("autoplayPause"),w()),["transitionend","webkitTransitionEnd"].forEach(G=>{e.$wrapperEl[0].removeEventListener(G,S)})}function L(){e.params.autoplay.disableOnInteraction||(e.autoplay.paused=!1,r("autoplayResume"),u())}e.autoplay={running:!1,paused:!1},t({autoplay:{enabled:!1,delay:3e3,waitForTransition:!0,disableOnInteraction:!0,stopOnLastSlide:!1,reverseDirection:!1,pauseOnMouseEnter:!1}}),n("init",()=>{e.params.autoplay.enabled&&(_(),go().addEventListener("visibilitychange",T),function j(){e.params.autoplay.pauseOnMouseEnter&&(e.$el.on("mouseenter",I),e.$el.on("mouseleave",L))}())}),n("beforeTransitionStart",(G,Y,ce)=>{e.autoplay.running&&(ce||!e.params.autoplay.disableOnInteraction?e.autoplay.pause(Y):v())}),n("sliderFirstMove",()=>{e.autoplay.running&&(e.params.autoplay.disableOnInteraction?v():w())}),n("touchEnd",()=>{e.params.cssMode&&e.autoplay.paused&&!e.params.autoplay.disableOnInteraction&&u()}),n("destroy",()=>{(function Z(){e.$el.off("mouseenter",I),e.$el.off("mouseleave",L)})(),e.autoplay.running&&v(),go().removeEventListener("visibilitychange",T)}),Object.assign(e.autoplay,{pause:w,run:u,start:_,stop:v})},function CL({swiper:e,extendParams:t,on:n}){t({fadeEffect:{crossFade:!1,transformEl:null}}),function xL(e){const{effect:t,swiper:n,on:r,setTranslate:l,setTransition:u,overwriteParams:_,perspective:v,recreateShadows:w,getEffectParams:T}=e;let S;r("beforeInit",()=>{if(n.params.effect!==t)return;n.classNames.push(`${n.params.containerModifierClass}${t}`),v&&v()&&n.classNames.push(`${n.params.containerModifierClass}3d`);const I=_?_():{};Object.assign(n.params,I),Object.assign(n.originalParams,I)}),r("setTranslate",()=>{n.params.effect===t&&l()}),r("setTransition",(I,L)=>{n.params.effect===t&&u(L)}),r("transitionEnd",()=>{if(n.params.effect===t&&w){if(!T||!T().slideShadows)return;n.slides.each(I=>{n.$(I).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").remove()}),w()}}),r("virtualUpdate",()=>{n.params.effect===t&&(n.slides.length||(S=!0),requestAnimationFrame(()=>{S&&n.slides&&n.slides.length&&(l(),S=!1)}))})}({effect:"fade",swiper:e,on:n,setTranslate:()=>{const{slides:u}=e,_=e.params.fadeEffect;for(let v=0;v<u.length;v+=1){const w=e.slides.eq(v);let S=-w[0].swiperSlideOffset;e.params.virtualTranslate||(S-=e.translate);let I=0;e.isHorizontal()||(I=S,S=0);const L=e.params.fadeEffect.crossFade?Math.max(1-Math.abs(w[0].progress),0):1+Math.min(Math.max(w[0].progress,-1),0);bL(_,w).css({opacity:L}).transform(`translate3d(${S}px, ${I}px, 0px)`)}},setTransition:u=>{const{transformEl:_}=e.params.fadeEffect;(_?e.slides.find(_):e.slides).transition(u),function wL({swiper:e,duration:t,transformEl:n,allSlides:r}){const{slides:l,activeIndex:u,$wrapperEl:_}=e;if(e.params.virtualTranslate&&0!==t){let w,v=!1;w=r?n?l.find(n):l:n?l.eq(u).find(n):l.eq(u),w.transitionEnd(()=>{if(v||!e||e.destroyed)return;v=!0,e.animating=!1;const T=["webkitTransitionEnd","transitionend"];for(let S=0;S<T.length;S+=1)_.trigger(T[S])})}}({swiper:e,duration:u,transformEl:_,allSlides:!0})},overwriteParams:()=>({slidesPerView:1,slidesPerGroup:1,watchSlidesProgress:!0,spaceBetween:0,virtualTranslate:!e.params.cssMode})})},Zb,Wb]);let uz=(()=>{class e{constructor(){this.slideItems=[{title:"Slide Title 1",p:"jaksdfj jj k kjasd jk j askd jfkjsldfkajsf",url:"assets/images/banner.jpg"},{title:"Slide Title 2",p:"jaksdfj jj k kjasd jk j askd jfkjsldfkajsf",url:"https://swiperjs.com/demos/images/nature-1.jpg"},{title:"Slide Title 3",p:"jaksdfj jj k kjasd jk j askd jfkjsldfkajsf",url:"https://swiperjs.com/demos/images/nature-2.jpg"},{title:"Slide Title 4",p:"jaksdfj jj k kjasd jk j askd jfkjsldfkajsf",url:"https://swiperjs.com/demos/images/nature-3.jpg"},{title:"Slide Title 5",p:"jaksdfj jj k kjasd jk j askd jfkjsldfkajsf",url:"https://swiperjs.com/demos/images/nature-4.jpg"}]}ngOnInit(){}onSwiper([n]){console.log(n)}onSlideChange(){console.log("slide change")}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-slide-show"]],decls:2,vars:10,consts:[[1,"mySwiper","rounded",3,"slidesPerView","spaceBetween","loop","effect","autoplay","pagination","navigation"],[4,"ngFor","ngForOf"],["swiperSlide",""],[1,"slide-item"],[1,"item-description","p-4","text-start"],[1,"btn","custom-btn-pink"]],template:function(n,r){1&n&&(We(0,"swiper",0),Tt(1,az,1,0,null,1),rt()),2&n&&(ei("slidesPerView",1)("spaceBetween",30)("loop",!0)("effect","fade")("autoplay",ru(8,lz))("pagination",ru(9,cz))("navigation",!0),Bt(1),ei("ngForOf",r.slideItems))},directives:[rT,cu,Qb],pipes:[vA],styles:['@font-face{font-family:swiper-icons;src:url(data:application/font-woff;charset=utf-8;base64,\\ d09GRgABAAAAAAZgABAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAGRAAAABoAAAAci6qHkUdERUYAAAWgAAAAIwAAACQAYABXR1BPUwAABhQAAAAuAAAANuAY7+xHU1VCAAAFxAAAAFAAAABm2fPczU9TLzIAAAHcAAAASgAAAGBP9V5RY21hcAAAAkQAAACIAAABYt6F0cBjdnQgAAACzAAAAAQAAAAEABEBRGdhc3AAAAWYAAAACAAAAAj//wADZ2x5ZgAAAywAAADMAAAD2MHtryVoZWFkAAABbAAAADAAAAA2E2+eoWhoZWEAAAGcAAAAHwAAACQC9gDzaG10eAAAAigAAAAZAAAArgJkABFsb2NhAAAC0AAAAFoAAABaFQAUGG1heHAAAAG8AAAAHwAAACAAcABAbmFtZQAAA/gAAAE5AAACXvFdBwlwb3N0AAAFNAAAAGIAAACE5s74hXjaY2BkYGAAYpf5Hu/j+W2+MnAzMYDAzaX6QjD6/4//Bxj5GA8AuRwMYGkAPywL13jaY2BkYGA88P8Agx4j+/8fQDYfA1AEBWgDAIB2BOoAeNpjYGRgYNBh4GdgYgABEMnIABJzYNADCQAACWgAsQB42mNgYfzCOIGBlYGB0YcxjYGBwR1Kf2WQZGhhYGBiYGVmgAFGBiQQkOaawtDAoMBQxXjg/wEGPcYDDA4wNUA2CCgwsAAAO4EL6gAAeNpj2M0gyAACqxgGNWBkZ2D4/wMA+xkDdgAAAHjaY2BgYGaAYBkGRgYQiAHyGMF8FgYHIM3DwMHABGQrMOgyWDLEM1T9/w8UBfEMgLzE////P/5//f/V/xv+r4eaAAeMbAxwIUYmIMHEgKYAYjUcsDAwsLKxc3BycfPw8jEQA/gZBASFhEVExcQlJKWkZWTl5BUUlZRVVNXUNTQZBgMAAMR+E+gAEQFEAAAAKgAqACoANAA+AEgAUgBcAGYAcAB6AIQAjgCYAKIArAC2AMAAygDUAN4A6ADyAPwBBgEQARoBJAEuATgBQgFMAVYBYAFqAXQBfgGIAZIBnAGmAbIBzgHsAAB42u2NMQ6CUAyGW568x9AneYYgm4MJbhKFaExIOAVX8ApewSt4Bic4AfeAid3VOBixDxfPYEza5O+Xfi04YADggiUIULCuEJK8VhO4bSvpdnktHI5QCYtdi2sl8ZnXaHlqUrNKzdKcT8cjlq+rwZSvIVczNiezsfnP/uznmfPFBNODM2K7MTQ45YEAZqGP81AmGGcF3iPqOop0r1SPTaTbVkfUe4HXj97wYE+yNwWYxwWu4v1ugWHgo3S1XdZEVqWM7ET0cfnLGxWfkgR42o2PvWrDMBSFj/IHLaF0zKjRgdiVMwScNRAoWUoH78Y2icB/yIY09An6AH2Bdu/UB+yxopYshQiEvnvu0dURgDt8QeC8PDw7Fpji3fEA4z/PEJ6YOB5hKh4dj3EvXhxPqH/SKUY3rJ7srZ4FZnh1PMAtPhwP6fl2PMJMPDgeQ4rY8YT6Gzao0eAEA409DuggmTnFnOcSCiEiLMgxCiTI6Cq5DZUd3Qmp10vO0LaLTd2cjN4fOumlc7lUYbSQcZFkutRG7g6JKZKy0RmdLY680CDnEJ+UMkpFFe1RN7nxdVpXrC4aTtnaurOnYercZg2YVmLN/d/gczfEimrE/fs/bOuq29Zmn8tloORaXgZgGa78yO9/cnXm2BpaGvq25Dv9S4E9+5SIc9PqupJKhYFSSl47+Qcr1mYNAAAAeNptw0cKwkAAAMDZJA8Q7OUJvkLsPfZ6zFVERPy8qHh2YER+3i/BP83vIBLLySsoKimrqKqpa2hp6+jq6RsYGhmbmJqZSy0sraxtbO3sHRydnEMU4uR6yx7JJXveP7WrDycAAAAAAAH//wACeNpjYGRgYOABYhkgZgJCZgZNBkYGLQZtIJsFLMYAAAw3ALgAeNolizEKgDAQBCchRbC2sFER0YD6qVQiBCv/H9ezGI6Z5XBAw8CBK/m5iQQVauVbXLnOrMZv2oLdKFa8Pjuru2hJzGabmOSLzNMzvutpB3N42mNgZGBg4GKQYzBhYMxJLMlj4GBgAYow/P/PAJJhLM6sSoWKfWCAAwDAjgbRAAB42mNgYGBkAIIbCZo5IPrmUn0hGA0AO8EFTQAA);font-weight:400;font-style:normal}:root{--swiper-theme-color:#007aff}.swiper{margin-left:auto;margin-right:auto;position:relative;overflow:hidden;list-style:none;padding:0;z-index:1}.swiper-vertical>.swiper-wrapper{flex-direction:column}.swiper-wrapper{position:relative;width:100%;height:100%;z-index:1;display:flex;transition-property:transform;box-sizing:content-box}.swiper-android .swiper-slide,.swiper-wrapper{transform:translate(0)}.swiper-pointer-events{touch-action:pan-y}.swiper-pointer-events.swiper-vertical{touch-action:pan-x}.swiper-slide{flex-shrink:0;width:100%;height:100%;position:relative;transition-property:transform}.swiper-slide-invisible-blank{visibility:hidden}.swiper-autoheight,.swiper-autoheight .swiper-slide{height:auto}.swiper-autoheight .swiper-wrapper{align-items:flex-start;transition-property:transform,height}.swiper-backface-hidden .swiper-slide{transform:translateZ(0);-webkit-backface-visibility:hidden;backface-visibility:hidden}.swiper-3d,.swiper-3d.swiper-css-mode .swiper-wrapper{perspective:1200px}.swiper-3d .swiper-cube-shadow,.swiper-3d .swiper-slide,.swiper-3d .swiper-slide-shadow,.swiper-3d .swiper-slide-shadow-bottom,.swiper-3d .swiper-slide-shadow-left,.swiper-3d .swiper-slide-shadow-right,.swiper-3d .swiper-slide-shadow-top,.swiper-3d .swiper-wrapper{transform-style:preserve-3d}.swiper-3d .swiper-slide-shadow,.swiper-3d .swiper-slide-shadow-bottom,.swiper-3d .swiper-slide-shadow-left,.swiper-3d .swiper-slide-shadow-right,.swiper-3d .swiper-slide-shadow-top{position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:10}.swiper-3d .swiper-slide-shadow{background:rgba(0,0,0,.15)}.swiper-3d .swiper-slide-shadow-left{background-image:linear-gradient(to left,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-3d .swiper-slide-shadow-right{background-image:linear-gradient(to right,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-3d .swiper-slide-shadow-top{background-image:linear-gradient(to top,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-3d .swiper-slide-shadow-bottom{background-image:linear-gradient(to bottom,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-css-mode>.swiper-wrapper{overflow:auto;scrollbar-width:none;-ms-overflow-style:none}.swiper-css-mode>.swiper-wrapper::-webkit-scrollbar{display:none}.swiper-css-mode>.swiper-wrapper>.swiper-slide{scroll-snap-align:start start}.swiper-horizontal.swiper-css-mode>.swiper-wrapper{scroll-snap-type:x mandatory}.swiper-vertical.swiper-css-mode>.swiper-wrapper{scroll-snap-type:y mandatory}.swiper-centered>.swiper-wrapper:before{content:"";flex-shrink:0;order:9999}.swiper-centered.swiper-horizontal>.swiper-wrapper>.swiper-slide:first-child{margin-inline-start:var(--swiper-centered-offset-before)}.swiper-centered.swiper-horizontal>.swiper-wrapper:before{height:100%;min-height:1px;width:var(--swiper-centered-offset-after)}.swiper-centered.swiper-vertical>.swiper-wrapper>.swiper-slide:first-child{margin-block-start:var(--swiper-centered-offset-before)}.swiper-centered.swiper-vertical>.swiper-wrapper:before{width:100%;min-width:1px;height:var(--swiper-centered-offset-after)}.swiper-centered>.swiper-wrapper>.swiper-slide{scroll-snap-align:center center}@font-face{font-family:swiper-icons;src:url(data:application/font-woff;charset=utf-8;base64,\\ d09GRgABAAAAAAZgABAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAGRAAAABoAAAAci6qHkUdERUYAAAWgAAAAIwAAACQAYABXR1BPUwAABhQAAAAuAAAANuAY7+xHU1VCAAAFxAAAAFAAAABm2fPczU9TLzIAAAHcAAAASgAAAGBP9V5RY21hcAAAAkQAAACIAAABYt6F0cBjdnQgAAACzAAAAAQAAAAEABEBRGdhc3AAAAWYAAAACAAAAAj//wADZ2x5ZgAAAywAAADMAAAD2MHtryVoZWFkAAABbAAAADAAAAA2E2+eoWhoZWEAAAGcAAAAHwAAACQC9gDzaG10eAAAAigAAAAZAAAArgJkABFsb2NhAAAC0AAAAFoAAABaFQAUGG1heHAAAAG8AAAAHwAAACAAcABAbmFtZQAAA/gAAAE5AAACXvFdBwlwb3N0AAAFNAAAAGIAAACE5s74hXjaY2BkYGAAYpf5Hu/j+W2+MnAzMYDAzaX6QjD6/4//Bxj5GA8AuRwMYGkAPywL13jaY2BkYGA88P8Agx4j+/8fQDYfA1AEBWgDAIB2BOoAeNpjYGRgYNBh4GdgYgABEMnIABJzYNADCQAACWgAsQB42mNgYfzCOIGBlYGB0YcxjYGBwR1Kf2WQZGhhYGBiYGVmgAFGBiQQkOaawtDAoMBQxXjg/wEGPcYDDA4wNUA2CCgwsAAAO4EL6gAAeNpj2M0gyAACqxgGNWBkZ2D4/wMA+xkDdgAAAHjaY2BgYGaAYBkGRgYQiAHyGMF8FgYHIM3DwMHABGQrMOgyWDLEM1T9/w8UBfEMgLzE////P/5//f/V/xv+r4eaAAeMbAxwIUYmIMHEgKYAYjUcsDAwsLKxc3BycfPw8jEQA/gZBASFhEVExcQlJKWkZWTl5BUUlZRVVNXUNTQZBgMAAMR+E+gAEQFEAAAAKgAqACoANAA+AEgAUgBcAGYAcAB6AIQAjgCYAKIArAC2AMAAygDUAN4A6ADyAPwBBgEQARoBJAEuATgBQgFMAVYBYAFqAXQBfgGIAZIBnAGmAbIBzgHsAAB42u2NMQ6CUAyGW568x9AneYYgm4MJbhKFaExIOAVX8ApewSt4Bic4AfeAid3VOBixDxfPYEza5O+Xfi04YADggiUIULCuEJK8VhO4bSvpdnktHI5QCYtdi2sl8ZnXaHlqUrNKzdKcT8cjlq+rwZSvIVczNiezsfnP/uznmfPFBNODM2K7MTQ45YEAZqGP81AmGGcF3iPqOop0r1SPTaTbVkfUe4HXj97wYE+yNwWYxwWu4v1ugWHgo3S1XdZEVqWM7ET0cfnLGxWfkgR42o2PvWrDMBSFj/IHLaF0zKjRgdiVMwScNRAoWUoH78Y2icB/yIY09An6AH2Bdu/UB+yxopYshQiEvnvu0dURgDt8QeC8PDw7Fpji3fEA4z/PEJ6YOB5hKh4dj3EvXhxPqH/SKUY3rJ7srZ4FZnh1PMAtPhwP6fl2PMJMPDgeQ4rY8YT6Gzao0eAEA409DuggmTnFnOcSCiEiLMgxCiTI6Cq5DZUd3Qmp10vO0LaLTd2cjN4fOumlc7lUYbSQcZFkutRG7g6JKZKy0RmdLY680CDnEJ+UMkpFFe1RN7nxdVpXrC4aTtnaurOnYercZg2YVmLN/d/gczfEimrE/fs/bOuq29Zmn8tloORaXgZgGa78yO9/cnXm2BpaGvq25Dv9S4E9+5SIc9PqupJKhYFSSl47+Qcr1mYNAAAAeNptw0cKwkAAAMDZJA8Q7OUJvkLsPfZ6zFVERPy8qHh2YER+3i/BP83vIBLLySsoKimrqKqpa2hp6+jq6RsYGhmbmJqZSy0sraxtbO3sHRydnEMU4uR6yx7JJXveP7WrDycAAAAAAAH//wACeNpjYGRgYOABYhkgZgJCZgZNBkYGLQZtIJsFLMYAAAw3ALgAeNolizEKgDAQBCchRbC2sFER0YD6qVQiBCv/H9ezGI6Z5XBAw8CBK/m5iQQVauVbXLnOrMZv2oLdKFa8Pjuru2hJzGabmOSLzNMzvutpB3N42mNgZGBg4GKQYzBhYMxJLMlj4GBgAYow/P/PAJJhLM6sSoWKfWCAAwDAjgbRAAB42mNgYGBkAIIbCZo5IPrmUn0hGA0AO8EFTQAA);font-weight:400;font-style:normal}:root{--swiper-theme-color:#007aff}.swiper{margin-left:auto;margin-right:auto;position:relative;overflow:hidden;list-style:none;padding:0;z-index:1}.swiper-vertical>.swiper-wrapper{flex-direction:column}.swiper-wrapper{position:relative;width:100%;height:100%;z-index:1;display:flex;transition-property:transform;box-sizing:content-box}.swiper-android .swiper-slide,.swiper-wrapper{transform:translate(0)}.swiper-pointer-events{touch-action:pan-y}.swiper-pointer-events.swiper-vertical{touch-action:pan-x}.swiper-slide{flex-shrink:0;width:100%;height:100%;position:relative;transition-property:transform}.swiper-slide-invisible-blank{visibility:hidden}.swiper-autoheight,.swiper-autoheight .swiper-slide{height:auto}.swiper-autoheight .swiper-wrapper{align-items:flex-start;transition-property:transform,height}.swiper-backface-hidden .swiper-slide{transform:translateZ(0);-webkit-backface-visibility:hidden;backface-visibility:hidden}.swiper-3d,.swiper-3d.swiper-css-mode .swiper-wrapper{perspective:1200px}.swiper-3d .swiper-cube-shadow,.swiper-3d .swiper-slide,.swiper-3d .swiper-slide-shadow,.swiper-3d .swiper-slide-shadow-bottom,.swiper-3d .swiper-slide-shadow-left,.swiper-3d .swiper-slide-shadow-right,.swiper-3d .swiper-slide-shadow-top,.swiper-3d .swiper-wrapper{transform-style:preserve-3d}.swiper-3d .swiper-slide-shadow,.swiper-3d .swiper-slide-shadow-bottom,.swiper-3d .swiper-slide-shadow-left,.swiper-3d .swiper-slide-shadow-right,.swiper-3d .swiper-slide-shadow-top{position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:10}.swiper-3d .swiper-slide-shadow{background:rgba(0,0,0,.15)}.swiper-3d .swiper-slide-shadow-left{background-image:linear-gradient(to left,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-3d .swiper-slide-shadow-right{background-image:linear-gradient(to right,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-3d .swiper-slide-shadow-top{background-image:linear-gradient(to top,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-3d .swiper-slide-shadow-bottom{background-image:linear-gradient(to bottom,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-css-mode>.swiper-wrapper{overflow:auto;scrollbar-width:none;-ms-overflow-style:none}.swiper-css-mode>.swiper-wrapper::-webkit-scrollbar{display:none}.swiper-css-mode>.swiper-wrapper>.swiper-slide{scroll-snap-align:start start}.swiper-horizontal.swiper-css-mode>.swiper-wrapper{scroll-snap-type:x mandatory}.swiper-vertical.swiper-css-mode>.swiper-wrapper{scroll-snap-type:y mandatory}.swiper-centered>.swiper-wrapper:before{content:"";flex-shrink:0;order:9999}.swiper-centered.swiper-horizontal>.swiper-wrapper>.swiper-slide:first-child{margin-inline-start:var(--swiper-centered-offset-before)}.swiper-centered.swiper-horizontal>.swiper-wrapper:before{height:100%;min-height:1px;width:var(--swiper-centered-offset-after)}.swiper-centered.swiper-vertical>.swiper-wrapper>.swiper-slide:first-child{margin-block-start:var(--swiper-centered-offset-before)}.swiper-centered.swiper-vertical>.swiper-wrapper:before{width:100%;min-width:1px;height:var(--swiper-centered-offset-after)}.swiper-centered>.swiper-wrapper>.swiper-slide{scroll-snap-align:center center}.swiper-virtual .swiper-slide{-webkit-backface-visibility:hidden;transform:translateZ(0)}.swiper-virtual.swiper-css-mode .swiper-wrapper:after{content:"";position:absolute;left:0;top:0;pointer-events:none}.swiper-virtual.swiper-css-mode.swiper-horizontal .swiper-wrapper:after{height:1px;width:var(--swiper-virtual-size)}.swiper-virtual.swiper-css-mode.swiper-vertical .swiper-wrapper:after{width:1px;height:var(--swiper-virtual-size)}:root{--swiper-navigation-size:44px}.swiper-button-next,.swiper-button-prev{position:absolute;top:50%;width:calc(var(--swiper-navigation-size)/ 44 * 27);height:var(--swiper-navigation-size);margin-top:calc(0px - (var(--swiper-navigation-size)/ 2));z-index:10;cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--swiper-navigation-color,var(--swiper-theme-color))}.swiper-button-next.swiper-button-disabled,.swiper-button-prev.swiper-button-disabled{opacity:.35;cursor:auto;pointer-events:none}.swiper-button-next.swiper-button-hidden,.swiper-button-prev.swiper-button-hidden{opacity:0;cursor:auto;pointer-events:none}.swiper-navigation-disabled .swiper-button-next,.swiper-navigation-disabled .swiper-button-prev{display:none!important}.swiper-button-next:after,.swiper-button-prev:after{font-family:swiper-icons;font-size:var(--swiper-navigation-size);text-transform:none!important;letter-spacing:0;font-feature-settings:;font-variant:initial;line-height:1}.swiper-button-prev,.swiper-rtl .swiper-button-next{left:10px;right:auto}.swiper-button-prev:after,.swiper-rtl .swiper-button-next:after{content:"prev"}.swiper-button-next,.swiper-rtl .swiper-button-prev{right:10px;left:auto}.swiper-button-next:after,.swiper-rtl .swiper-button-prev:after{content:"next"}.swiper-button-lock{display:none}.swiper-pagination{position:absolute;text-align:center;transition:.3s opacity;transform:translate(0);z-index:10}.swiper-pagination.swiper-pagination-hidden{opacity:0}.swiper-pagination-disabled>.swiper-pagination,.swiper-pagination.swiper-pagination-disabled{display:none!important}.swiper-horizontal>.swiper-pagination-bullets,.swiper-pagination-bullets.swiper-pagination-horizontal,.swiper-pagination-custom,.swiper-pagination-fraction{bottom:10px;left:0;width:100%}.swiper-pagination-bullets-dynamic{overflow:hidden;font-size:0}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{transform:scale(.33);position:relative}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active,.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-main{transform:scale(1)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-prev{transform:scale(.66)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-prev-prev{transform:scale(.33)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-next{transform:scale(.66)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-next-next{transform:scale(.33)}.swiper-pagination-bullet{width:var(--swiper-pagination-bullet-width,var(--swiper-pagination-bullet-size,8px));height:var(--swiper-pagination-bullet-height,var(--swiper-pagination-bullet-size,8px));display:inline-block;border-radius:50%;background:var(--swiper-pagination-bullet-inactive-color,#000);opacity:var(--swiper-pagination-bullet-inactive-opacity, .2)}button.swiper-pagination-bullet{border:none;margin:0;padding:0;box-shadow:none;-webkit-appearance:none;appearance:none}.swiper-pagination-clickable .swiper-pagination-bullet{cursor:pointer}.swiper-pagination-bullet:only-child{display:none!important}.swiper-pagination-bullet-active{opacity:var(--swiper-pagination-bullet-opacity, 1);background:var(--swiper-pagination-color,var(--swiper-theme-color))}.swiper-pagination-vertical.swiper-pagination-bullets,.swiper-vertical>.swiper-pagination-bullets{right:10px;top:50%;transform:translateY(-50%)}.swiper-pagination-vertical.swiper-pagination-bullets .swiper-pagination-bullet,.swiper-vertical>.swiper-pagination-bullets .swiper-pagination-bullet{margin:var(--swiper-pagination-bullet-vertical-gap,6px) 0;display:block}.swiper-pagination-vertical.swiper-pagination-bullets.swiper-pagination-bullets-dynamic,.swiper-vertical>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic{top:50%;transform:translateY(-50%);width:8px}.swiper-pagination-vertical.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet,.swiper-vertical>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{display:inline-block;transition:.2s transform,.2s top}.swiper-horizontal>.swiper-pagination-bullets .swiper-pagination-bullet,.swiper-pagination-horizontal.swiper-pagination-bullets .swiper-pagination-bullet{margin:0 var(--swiper-pagination-bullet-horizontal-gap,4px)}.swiper-horizontal>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic,.swiper-pagination-horizontal.swiper-pagination-bullets.swiper-pagination-bullets-dynamic{left:50%;transform:translate(-50%);white-space:nowrap}.swiper-horizontal>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet,.swiper-pagination-horizontal.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{transition:.2s transform,.2s left}.swiper-horizontal.swiper-rtl>.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{transition:.2s transform,.2s right}.swiper-pagination-progressbar{background:rgba(0,0,0,.25);position:absolute}.swiper-pagination-progressbar .swiper-pagination-progressbar-fill{background:var(--swiper-pagination-color,var(--swiper-theme-color));position:absolute;left:0;top:0;width:100%;height:100%;transform:scale(0);transform-origin:left top}.swiper-rtl .swiper-pagination-progressbar .swiper-pagination-progressbar-fill{transform-origin:right top}.swiper-horizontal>.swiper-pagination-progressbar,.swiper-pagination-progressbar.swiper-pagination-horizontal,.swiper-pagination-progressbar.swiper-pagination-vertical.swiper-pagination-progressbar-opposite,.swiper-vertical>.swiper-pagination-progressbar.swiper-pagination-progressbar-opposite{width:100%;height:4px;left:0;top:0}.swiper-horizontal>.swiper-pagination-progressbar.swiper-pagination-progressbar-opposite,.swiper-pagination-progressbar.swiper-pagination-horizontal.swiper-pagination-progressbar-opposite,.swiper-pagination-progressbar.swiper-pagination-vertical,.swiper-vertical>.swiper-pagination-progressbar{width:4px;height:100%;left:0;top:0}.swiper-pagination-lock{display:none}.swiper-scrollbar{border-radius:10px;position:relative;-ms-touch-action:none;background:rgba(0,0,0,.1)}.swiper-scrollbar-disabled>.swiper-scrollbar,.swiper-scrollbar.swiper-scrollbar-disabled{display:none!important}.swiper-horizontal>.swiper-scrollbar,.swiper-scrollbar.swiper-scrollbar-horizontal{position:absolute;left:1%;bottom:3px;z-index:50;height:5px;width:98%}.swiper-scrollbar.swiper-scrollbar-vertical,.swiper-vertical>.swiper-scrollbar{position:absolute;right:3px;top:1%;z-index:50;width:5px;height:98%}.swiper-scrollbar-drag{height:100%;width:100%;position:relative;background:rgba(0,0,0,.5);border-radius:10px;left:0;top:0}.swiper-scrollbar-cursor-drag{cursor:move}.swiper-scrollbar-lock{display:none}.swiper-zoom-container{width:100%;height:100%;display:flex;justify-content:center;align-items:center;text-align:center}.swiper-zoom-container>canvas,.swiper-zoom-container>img,.swiper-zoom-container>svg{max-width:100%;max-height:100%;object-fit:contain}.swiper-slide-zoomed{cursor:move}.swiper-lazy-preloader{width:42px;height:42px;position:absolute;left:50%;top:50%;margin-left:-21px;margin-top:-21px;z-index:10;transform-origin:50%;box-sizing:border-box;border:4px solid var(--swiper-preloader-color,var(--swiper-theme-color));border-radius:50%;border-top-color:transparent}.swiper-watch-progress .swiper-slide-visible .swiper-lazy-preloader,.swiper:not(.swiper-watch-progress) .swiper-lazy-preloader{animation:swiper-preloader-spin 1s infinite linear}.swiper-lazy-preloader-white{--swiper-preloader-color:#fff}.swiper-lazy-preloader-black{--swiper-preloader-color:#000}@keyframes swiper-preloader-spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.swiper .swiper-notification{position:absolute;left:0;top:0;pointer-events:none;opacity:0;z-index:-1000}.swiper-free-mode>.swiper-wrapper{transition-timing-function:ease-out;margin:0 auto}.swiper-grid>.swiper-wrapper{flex-wrap:wrap}.swiper-grid-column>.swiper-wrapper{flex-wrap:wrap;flex-direction:column}.swiper-fade.swiper-free-mode .swiper-slide{transition-timing-function:ease-out}.swiper-fade .swiper-slide{pointer-events:none;transition-property:opacity}.swiper-fade .swiper-slide .swiper-slide{pointer-events:none}.swiper-fade .swiper-slide-active,.swiper-fade .swiper-slide-active .swiper-slide-active{pointer-events:auto}.swiper-cube{overflow:visible}.swiper-cube .swiper-slide{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;z-index:1;visibility:hidden;transform-origin:0 0;width:100%;height:100%}.swiper-cube .swiper-slide .swiper-slide{pointer-events:none}.swiper-cube.swiper-rtl .swiper-slide{transform-origin:100% 0}.swiper-cube .swiper-slide-active,.swiper-cube .swiper-slide-active .swiper-slide-active{pointer-events:auto}.swiper-cube .swiper-slide-active,.swiper-cube .swiper-slide-next,.swiper-cube .swiper-slide-next+.swiper-slide,.swiper-cube .swiper-slide-prev{pointer-events:auto;visibility:visible}.swiper-cube .swiper-slide-shadow-bottom,.swiper-cube .swiper-slide-shadow-left,.swiper-cube .swiper-slide-shadow-right,.swiper-cube .swiper-slide-shadow-top{z-index:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}.swiper-cube .swiper-cube-shadow{position:absolute;left:0;bottom:0;width:100%;height:100%;opacity:.6;z-index:0}.swiper-cube .swiper-cube-shadow:before{content:"";background:#000;position:absolute;inset:0;filter:blur(50px)}.swiper-flip{overflow:visible}.swiper-flip .swiper-slide{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;z-index:1}.swiper-flip .swiper-slide .swiper-slide{pointer-events:none}.swiper-flip .swiper-slide-active,.swiper-flip .swiper-slide-active .swiper-slide-active{pointer-events:auto}.swiper-flip .swiper-slide-shadow-bottom,.swiper-flip .swiper-slide-shadow-left,.swiper-flip .swiper-slide-shadow-right,.swiper-flip .swiper-slide-shadow-top{z-index:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}.swiper-creative .swiper-slide{-webkit-backface-visibility:hidden;backface-visibility:hidden;overflow:hidden;transition-property:transform,opacity,height}.swiper-cards{overflow:visible}.swiper-cards .swiper-slide{transform-origin:center bottom;-webkit-backface-visibility:hidden;backface-visibility:hidden;overflow:hidden}.swiper{width:100%;height:100%}.swiper-slide{text-align:center;font-size:18px;background:#fff;display:flex;justify-content:center;align-items:center}.swiper-slide img{display:block;width:100%;height:100%;object-fit:cover}.slide-item{display:block;background-size:cover;width:100%;height:500px}.swiper-container{width:100%;border-radius:10px;margin-left:10px;margin-right:10px}.swiper-button-prev,.swiper-button-next{color:#f2f0ef}.item-description{background-color:#0000004d;bottom:0;padding:5px 30px;position:absolute;width:100%}.item-description h3{color:#f2f0ef}.item-description p{color:#fffc}\n'],encapsulation:2}),e})(),dz=(()=>{class e{constructor(){}ngOnInit(){this.setAboutInfo()}setAboutInfo(){this.aboutInfo=[{name:"Misi\xf3n",contentText:"[MISSION Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus molestie venenatis augue vel venenatis. Donec ornare nibh non arcu ornare aliquam. Nam posuere tortor ut magna mollis, sit amet tempus nisi lobortis. Aenean commodo magna porttitor, cursus arcu at, vehicula arcu. Mauris non condimentum tellus,"},{name:"Visi\xf3n",contentText:"[VISION] Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus molestie venenatis augue vel venenatis. Donec ornare nibh non arcu ornare aliquam. Nam posuere tortor ut magna mollis, sit amet tempus nisi lobortis. Aenean commodo magna porttitor, cursus arcu at, vehicula arcu. Mauris non condimentum tellus,"},{name:"Sobre mi",contentText:"[ABOUT] Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus molestie venenatis augue vel venenatis. Donec ornare nibh non arcu ornare aliquam. Nam posuere tortor ut magna mollis, sit amet tempus nisi lobortis. Aenean commodo magna porttitor, cursus arcu at, vehicula arcu. Mauris non condimentum tellus,"}]}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-home-about"]],decls:17,vars:6,consts:[["id","myTab","role","tablist",1,"nav","nav-tabs","justify-content-center"],["role","presentation",1,"nav-item"],["id","home-tab","data-bs-toggle","tab","data-bs-target","#home-tab-pane","type","button","role","tab","aria-controls","home-tab-pane","aria-selected","true",1,"nav-link","active","custom-text-pink"],["id","profile-tab","data-bs-toggle","tab","data-bs-target","#profile-tab-pane","type","button","role","tab","aria-controls","profile-tab-pane","aria-selected","false",1,"nav-link","custom-text-pink"],["id","contact-tab","data-bs-toggle","tab","data-bs-target","#contact-tab-pane","type","button","role","tab","aria-controls","contact-tab-pane","aria-selected","false",1,"nav-link","custom-text-pink"],["id","myTabContent",1,"tab-content","py-5"],["id","home-tab-pane","role","tabpanel","aria-labelledby","home-tab","tabindex","0",1,"tab-pane","fade","show","active","p-3"],["id","profile-tab-pane","role","tabpanel","aria-labelledby","profile-tab","tabindex","0",1,"tab-pane","fade","p-3"],["id","contact-tab-pane","role","tabpanel","aria-labelledby","contact-tab","tabindex","0",1,"tab-pane","fade","p-3"]],template:function(n,r){1&n&&(We(0,"ul",0)(1,"li",1)(2,"button",2),xt(3),rt()(),We(4,"li",1)(5,"button",3),xt(6),rt()(),We(7,"li",1)(8,"button",4),xt(9),rt()()(),We(10,"div",5)(11,"div",6),xt(12),rt(),We(13,"div",7),xt(14),rt(),We(15,"div",8),xt(16),rt()()),2&n&&(Bt(3),Ri(" ",r.aboutInfo[0].name," "),Bt(3),ba(r.aboutInfo[1].name),Bt(3),ba(r.aboutInfo[2].name),Bt(3),Ri(" ",r.aboutInfo[0].contentText," "),Bt(2),Ri(" ",r.aboutInfo[1].contentText," "),Bt(2),Ri(" ",r.aboutInfo[2].contentText," "))},encapsulation:2}),e})();function hz(e,t){if(1&e&&(We(0,"div",4),Yt(1,"img",5),We(2,"h3",6),xt(3),rt(),We(4,"button",7),xt(5," Ir a productos "),rt()()),2&e){const n=Sd().$implicit;Bt(1),ei("alt",n.name),Bt(2),ba(n.name)}}function pz(e,t){1&e&&Tt(0,hz,6,2,"ng-template",3)}const fz=function(){return{delay:4e3,disableOnInteraction:!1}},mz=function(){return{clickable:!0}},gz=function(){return{slidesPerView:2,spaceBetween:20}},_z=function(){return{slidesPerView:3,spaceBetween:30}},yz=function(){return{slidesPerView:4,spaceBetween:40}},vz=function(e,t,n){return{640:e,768:t,1024:n}};Uh.use([Wb,Zb]);let xz=(()=>{class e{constructor(){this.productsTest=[{name:"test 1"},{name:"test 2"},{name:"test 3"},{name:"test 4"},{name:"test 5"},{name:"test 6"},{name:"test 7"},{name:"test 8"},{name:"test 9"}]}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-home-products"]],decls:4,vars:15,consts:[[1,"p-5"],[1,"mySwiper",3,"slidesPerView","spaceBetween","autoplay","pagination","breakpoints"],[4,"ngFor","ngForOf"],["swiperSlide",""],[1,"mb-5"],["src","assets/images/product.jpg",1,"img-thumbnail",3,"alt"],[1,"my-2"],[1,"mt-3","btn","custom-btn-pink"]],template:function(n,r){1&n&&(We(0,"div",0)(1,"swiper",1),Tt(2,pz,1,0,null,2),rt(),xt(3,"`\n"),rt()),2&n&&(Bt(1),ei("slidesPerView",1)("spaceBetween",20)("autoplay",ru(6,fz))("pagination",ru(7,mz))("breakpoints",function Z1(e,t,n,r,l,u){return X1(it(),pr(),e,t,n,r,l,u)}(11,vz,ru(8,gz),ru(9,_z),ru(10,yz))),Bt(1),ei("ngForOf",r.productsTest))},directives:[rT,cu,Qb],styles:['@font-face{font-family:swiper-icons;src:url(data:application/font-woff;charset=utf-8;base64,\\ d09GRgABAAAAAAZgABAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAGRAAAABoAAAAci6qHkUdERUYAAAWgAAAAIwAAACQAYABXR1BPUwAABhQAAAAuAAAANuAY7+xHU1VCAAAFxAAAAFAAAABm2fPczU9TLzIAAAHcAAAASgAAAGBP9V5RY21hcAAAAkQAAACIAAABYt6F0cBjdnQgAAACzAAAAAQAAAAEABEBRGdhc3AAAAWYAAAACAAAAAj//wADZ2x5ZgAAAywAAADMAAAD2MHtryVoZWFkAAABbAAAADAAAAA2E2+eoWhoZWEAAAGcAAAAHwAAACQC9gDzaG10eAAAAigAAAAZAAAArgJkABFsb2NhAAAC0AAAAFoAAABaFQAUGG1heHAAAAG8AAAAHwAAACAAcABAbmFtZQAAA/gAAAE5AAACXvFdBwlwb3N0AAAFNAAAAGIAAACE5s74hXjaY2BkYGAAYpf5Hu/j+W2+MnAzMYDAzaX6QjD6/4//Bxj5GA8AuRwMYGkAPywL13jaY2BkYGA88P8Agx4j+/8fQDYfA1AEBWgDAIB2BOoAeNpjYGRgYNBh4GdgYgABEMnIABJzYNADCQAACWgAsQB42mNgYfzCOIGBlYGB0YcxjYGBwR1Kf2WQZGhhYGBiYGVmgAFGBiQQkOaawtDAoMBQxXjg/wEGPcYDDA4wNUA2CCgwsAAAO4EL6gAAeNpj2M0gyAACqxgGNWBkZ2D4/wMA+xkDdgAAAHjaY2BgYGaAYBkGRgYQiAHyGMF8FgYHIM3DwMHABGQrMOgyWDLEM1T9/w8UBfEMgLzE////P/5//f/V/xv+r4eaAAeMbAxwIUYmIMHEgKYAYjUcsDAwsLKxc3BycfPw8jEQA/gZBASFhEVExcQlJKWkZWTl5BUUlZRVVNXUNTQZBgMAAMR+E+gAEQFEAAAAKgAqACoANAA+AEgAUgBcAGYAcAB6AIQAjgCYAKIArAC2AMAAygDUAN4A6ADyAPwBBgEQARoBJAEuATgBQgFMAVYBYAFqAXQBfgGIAZIBnAGmAbIBzgHsAAB42u2NMQ6CUAyGW568x9AneYYgm4MJbhKFaExIOAVX8ApewSt4Bic4AfeAid3VOBixDxfPYEza5O+Xfi04YADggiUIULCuEJK8VhO4bSvpdnktHI5QCYtdi2sl8ZnXaHlqUrNKzdKcT8cjlq+rwZSvIVczNiezsfnP/uznmfPFBNODM2K7MTQ45YEAZqGP81AmGGcF3iPqOop0r1SPTaTbVkfUe4HXj97wYE+yNwWYxwWu4v1ugWHgo3S1XdZEVqWM7ET0cfnLGxWfkgR42o2PvWrDMBSFj/IHLaF0zKjRgdiVMwScNRAoWUoH78Y2icB/yIY09An6AH2Bdu/UB+yxopYshQiEvnvu0dURgDt8QeC8PDw7Fpji3fEA4z/PEJ6YOB5hKh4dj3EvXhxPqH/SKUY3rJ7srZ4FZnh1PMAtPhwP6fl2PMJMPDgeQ4rY8YT6Gzao0eAEA409DuggmTnFnOcSCiEiLMgxCiTI6Cq5DZUd3Qmp10vO0LaLTd2cjN4fOumlc7lUYbSQcZFkutRG7g6JKZKy0RmdLY680CDnEJ+UMkpFFe1RN7nxdVpXrC4aTtnaurOnYercZg2YVmLN/d/gczfEimrE/fs/bOuq29Zmn8tloORaXgZgGa78yO9/cnXm2BpaGvq25Dv9S4E9+5SIc9PqupJKhYFSSl47+Qcr1mYNAAAAeNptw0cKwkAAAMDZJA8Q7OUJvkLsPfZ6zFVERPy8qHh2YER+3i/BP83vIBLLySsoKimrqKqpa2hp6+jq6RsYGhmbmJqZSy0sraxtbO3sHRydnEMU4uR6yx7JJXveP7WrDycAAAAAAAH//wACeNpjYGRgYOABYhkgZgJCZgZNBkYGLQZtIJsFLMYAAAw3ALgAeNolizEKgDAQBCchRbC2sFER0YD6qVQiBCv/H9ezGI6Z5XBAw8CBK/m5iQQVauVbXLnOrMZv2oLdKFa8Pjuru2hJzGabmOSLzNMzvutpB3N42mNgZGBg4GKQYzBhYMxJLMlj4GBgAYow/P/PAJJhLM6sSoWKfWCAAwDAjgbRAAB42mNgYGBkAIIbCZo5IPrmUn0hGA0AO8EFTQAA);font-weight:400;font-style:normal}[_ngcontent-%COMP%]:root{--swiper-theme-color:#007aff}.swiper[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;position:relative;overflow:hidden;list-style:none;padding:0;z-index:1}.swiper-vertical[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{flex-direction:column}.swiper-wrapper[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;z-index:1;display:flex;transition-property:transform;box-sizing:content-box}.swiper-android[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%], .swiper-wrapper[_ngcontent-%COMP%]{transform:translate(0)}.swiper-pointer-events[_ngcontent-%COMP%]{touch-action:pan-y}.swiper-pointer-events.swiper-vertical[_ngcontent-%COMP%]{touch-action:pan-x}.swiper-slide[_ngcontent-%COMP%]{flex-shrink:0;width:100%;height:100%;position:relative;transition-property:transform}.swiper-slide-invisible-blank[_ngcontent-%COMP%]{visibility:hidden}.swiper-autoheight[_ngcontent-%COMP%], .swiper-autoheight[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{height:auto}.swiper-autoheight[_ngcontent-%COMP%]   .swiper-wrapper[_ngcontent-%COMP%]{align-items:flex-start;transition-property:transform,height}.swiper-backface-hidden[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{transform:translateZ(0);-webkit-backface-visibility:hidden;backface-visibility:hidden}.swiper-3d[_ngcontent-%COMP%], .swiper-3d.swiper-css-mode[_ngcontent-%COMP%]   .swiper-wrapper[_ngcontent-%COMP%]{perspective:1200px}.swiper-3d[_ngcontent-%COMP%]   .swiper-cube-shadow[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-bottom[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-left[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-right[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-top[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-wrapper[_ngcontent-%COMP%]{transform-style:preserve-3d}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-bottom[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-left[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-right[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-top[_ngcontent-%COMP%]{position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:10}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow[_ngcontent-%COMP%]{background:rgba(0,0,0,.15)}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-left[_ngcontent-%COMP%]{background-image:linear-gradient(to left,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-right[_ngcontent-%COMP%]{background-image:linear-gradient(to right,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-top[_ngcontent-%COMP%]{background-image:linear-gradient(to top,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-bottom[_ngcontent-%COMP%]{background-image:linear-gradient(to bottom,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{overflow:auto;scrollbar-width:none;-ms-overflow-style:none}.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%] > .swiper-slide[_ngcontent-%COMP%]{scroll-snap-align:start start}.swiper-horizontal.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{scroll-snap-type:x mandatory}.swiper-vertical.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{scroll-snap-type:y mandatory}.swiper-centered[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]:before{content:"";flex-shrink:0;order:9999}.swiper-centered.swiper-horizontal[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%] > .swiper-slide[_ngcontent-%COMP%]:first-child{margin-inline-start:var(--swiper-centered-offset-before)}.swiper-centered.swiper-horizontal[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]:before{height:100%;min-height:1px;width:var(--swiper-centered-offset-after)}.swiper-centered.swiper-vertical[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%] > .swiper-slide[_ngcontent-%COMP%]:first-child{margin-block-start:var(--swiper-centered-offset-before)}.swiper-centered.swiper-vertical[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]:before{width:100%;min-width:1px;height:var(--swiper-centered-offset-after)}.swiper-centered[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%] > .swiper-slide[_ngcontent-%COMP%]{scroll-snap-align:center center}@font-face{font-family:swiper-icons;src:url(data:application/font-woff;charset=utf-8;base64,\\ d09GRgABAAAAAAZgABAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAGRAAAABoAAAAci6qHkUdERUYAAAWgAAAAIwAAACQAYABXR1BPUwAABhQAAAAuAAAANuAY7+xHU1VCAAAFxAAAAFAAAABm2fPczU9TLzIAAAHcAAAASgAAAGBP9V5RY21hcAAAAkQAAACIAAABYt6F0cBjdnQgAAACzAAAAAQAAAAEABEBRGdhc3AAAAWYAAAACAAAAAj//wADZ2x5ZgAAAywAAADMAAAD2MHtryVoZWFkAAABbAAAADAAAAA2E2+eoWhoZWEAAAGcAAAAHwAAACQC9gDzaG10eAAAAigAAAAZAAAArgJkABFsb2NhAAAC0AAAAFoAAABaFQAUGG1heHAAAAG8AAAAHwAAACAAcABAbmFtZQAAA/gAAAE5AAACXvFdBwlwb3N0AAAFNAAAAGIAAACE5s74hXjaY2BkYGAAYpf5Hu/j+W2+MnAzMYDAzaX6QjD6/4//Bxj5GA8AuRwMYGkAPywL13jaY2BkYGA88P8Agx4j+/8fQDYfA1AEBWgDAIB2BOoAeNpjYGRgYNBh4GdgYgABEMnIABJzYNADCQAACWgAsQB42mNgYfzCOIGBlYGB0YcxjYGBwR1Kf2WQZGhhYGBiYGVmgAFGBiQQkOaawtDAoMBQxXjg/wEGPcYDDA4wNUA2CCgwsAAAO4EL6gAAeNpj2M0gyAACqxgGNWBkZ2D4/wMA+xkDdgAAAHjaY2BgYGaAYBkGRgYQiAHyGMF8FgYHIM3DwMHABGQrMOgyWDLEM1T9/w8UBfEMgLzE////P/5//f/V/xv+r4eaAAeMbAxwIUYmIMHEgKYAYjUcsDAwsLKxc3BycfPw8jEQA/gZBASFhEVExcQlJKWkZWTl5BUUlZRVVNXUNTQZBgMAAMR+E+gAEQFEAAAAKgAqACoANAA+AEgAUgBcAGYAcAB6AIQAjgCYAKIArAC2AMAAygDUAN4A6ADyAPwBBgEQARoBJAEuATgBQgFMAVYBYAFqAXQBfgGIAZIBnAGmAbIBzgHsAAB42u2NMQ6CUAyGW568x9AneYYgm4MJbhKFaExIOAVX8ApewSt4Bic4AfeAid3VOBixDxfPYEza5O+Xfi04YADggiUIULCuEJK8VhO4bSvpdnktHI5QCYtdi2sl8ZnXaHlqUrNKzdKcT8cjlq+rwZSvIVczNiezsfnP/uznmfPFBNODM2K7MTQ45YEAZqGP81AmGGcF3iPqOop0r1SPTaTbVkfUe4HXj97wYE+yNwWYxwWu4v1ugWHgo3S1XdZEVqWM7ET0cfnLGxWfkgR42o2PvWrDMBSFj/IHLaF0zKjRgdiVMwScNRAoWUoH78Y2icB/yIY09An6AH2Bdu/UB+yxopYshQiEvnvu0dURgDt8QeC8PDw7Fpji3fEA4z/PEJ6YOB5hKh4dj3EvXhxPqH/SKUY3rJ7srZ4FZnh1PMAtPhwP6fl2PMJMPDgeQ4rY8YT6Gzao0eAEA409DuggmTnFnOcSCiEiLMgxCiTI6Cq5DZUd3Qmp10vO0LaLTd2cjN4fOumlc7lUYbSQcZFkutRG7g6JKZKy0RmdLY680CDnEJ+UMkpFFe1RN7nxdVpXrC4aTtnaurOnYercZg2YVmLN/d/gczfEimrE/fs/bOuq29Zmn8tloORaXgZgGa78yO9/cnXm2BpaGvq25Dv9S4E9+5SIc9PqupJKhYFSSl47+Qcr1mYNAAAAeNptw0cKwkAAAMDZJA8Q7OUJvkLsPfZ6zFVERPy8qHh2YER+3i/BP83vIBLLySsoKimrqKqpa2hp6+jq6RsYGhmbmJqZSy0sraxtbO3sHRydnEMU4uR6yx7JJXveP7WrDycAAAAAAAH//wACeNpjYGRgYOABYhkgZgJCZgZNBkYGLQZtIJsFLMYAAAw3ALgAeNolizEKgDAQBCchRbC2sFER0YD6qVQiBCv/H9ezGI6Z5XBAw8CBK/m5iQQVauVbXLnOrMZv2oLdKFa8Pjuru2hJzGabmOSLzNMzvutpB3N42mNgZGBg4GKQYzBhYMxJLMlj4GBgAYow/P/PAJJhLM6sSoWKfWCAAwDAjgbRAAB42mNgYGBkAIIbCZo5IPrmUn0hGA0AO8EFTQAA);font-weight:400;font-style:normal}[_ngcontent-%COMP%]:root{--swiper-theme-color:#007aff}.swiper[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;position:relative;overflow:hidden;list-style:none;padding:0;z-index:1}.swiper-vertical[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{flex-direction:column}.swiper-wrapper[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;z-index:1;display:flex;transition-property:transform;box-sizing:content-box}.swiper-android[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%], .swiper-wrapper[_ngcontent-%COMP%]{transform:translate(0)}.swiper-pointer-events[_ngcontent-%COMP%]{touch-action:pan-y}.swiper-pointer-events.swiper-vertical[_ngcontent-%COMP%]{touch-action:pan-x}.swiper-slide[_ngcontent-%COMP%]{flex-shrink:0;width:100%;height:100%;position:relative;transition-property:transform}.swiper-slide-invisible-blank[_ngcontent-%COMP%]{visibility:hidden}.swiper-autoheight[_ngcontent-%COMP%], .swiper-autoheight[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{height:auto}.swiper-autoheight[_ngcontent-%COMP%]   .swiper-wrapper[_ngcontent-%COMP%]{align-items:flex-start;transition-property:transform,height}.swiper-backface-hidden[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{transform:translateZ(0);-webkit-backface-visibility:hidden;backface-visibility:hidden}.swiper-3d[_ngcontent-%COMP%], .swiper-3d.swiper-css-mode[_ngcontent-%COMP%]   .swiper-wrapper[_ngcontent-%COMP%]{perspective:1200px}.swiper-3d[_ngcontent-%COMP%]   .swiper-cube-shadow[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-bottom[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-left[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-right[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-top[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-wrapper[_ngcontent-%COMP%]{transform-style:preserve-3d}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-bottom[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-left[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-right[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-top[_ngcontent-%COMP%]{position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:10}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow[_ngcontent-%COMP%]{background:rgba(0,0,0,.15)}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-left[_ngcontent-%COMP%]{background-image:linear-gradient(to left,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-right[_ngcontent-%COMP%]{background-image:linear-gradient(to right,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-top[_ngcontent-%COMP%]{background-image:linear-gradient(to top,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-bottom[_ngcontent-%COMP%]{background-image:linear-gradient(to bottom,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{overflow:auto;scrollbar-width:none;-ms-overflow-style:none}.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%] > .swiper-slide[_ngcontent-%COMP%]{scroll-snap-align:start start}.swiper-horizontal.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{scroll-snap-type:x mandatory}.swiper-vertical.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{scroll-snap-type:y mandatory}.swiper-centered[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]:before{content:"";flex-shrink:0;order:9999}.swiper-centered.swiper-horizontal[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%] > .swiper-slide[_ngcontent-%COMP%]:first-child{margin-inline-start:var(--swiper-centered-offset-before)}.swiper-centered.swiper-horizontal[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]:before{height:100%;min-height:1px;width:var(--swiper-centered-offset-after)}.swiper-centered.swiper-vertical[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%] > .swiper-slide[_ngcontent-%COMP%]:first-child{margin-block-start:var(--swiper-centered-offset-before)}.swiper-centered.swiper-vertical[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]:before{width:100%;min-width:1px;height:var(--swiper-centered-offset-after)}.swiper-centered[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%] > .swiper-slide[_ngcontent-%COMP%]{scroll-snap-align:center center}.swiper-virtual[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;transform:translateZ(0)}.swiper-virtual.swiper-css-mode[_ngcontent-%COMP%]   .swiper-wrapper[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;top:0;pointer-events:none}.swiper-virtual.swiper-css-mode.swiper-horizontal[_ngcontent-%COMP%]   .swiper-wrapper[_ngcontent-%COMP%]:after{height:1px;width:var(--swiper-virtual-size)}.swiper-virtual.swiper-css-mode.swiper-vertical[_ngcontent-%COMP%]   .swiper-wrapper[_ngcontent-%COMP%]:after{width:1px;height:var(--swiper-virtual-size)}[_ngcontent-%COMP%]:root{--swiper-navigation-size:44px}.swiper-button-next[_ngcontent-%COMP%], .swiper-button-prev[_ngcontent-%COMP%]{position:absolute;top:50%;width:calc(var(--swiper-navigation-size)/ 44 * 27);height:var(--swiper-navigation-size);margin-top:calc(0px - (var(--swiper-navigation-size)/ 2));z-index:10;cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--swiper-navigation-color,var(--swiper-theme-color))}.swiper-button-next.swiper-button-disabled[_ngcontent-%COMP%], .swiper-button-prev.swiper-button-disabled[_ngcontent-%COMP%]{opacity:.35;cursor:auto;pointer-events:none}.swiper-button-next.swiper-button-hidden[_ngcontent-%COMP%], .swiper-button-prev.swiper-button-hidden[_ngcontent-%COMP%]{opacity:0;cursor:auto;pointer-events:none}.swiper-navigation-disabled[_ngcontent-%COMP%]   .swiper-button-next[_ngcontent-%COMP%], .swiper-navigation-disabled[_ngcontent-%COMP%]   .swiper-button-prev[_ngcontent-%COMP%]{display:none!important}.swiper-button-next[_ngcontent-%COMP%]:after, .swiper-button-prev[_ngcontent-%COMP%]:after{font-family:swiper-icons;font-size:var(--swiper-navigation-size);text-transform:none!important;letter-spacing:0;font-feature-settings:;font-variant:initial;line-height:1}.swiper-button-prev[_ngcontent-%COMP%], .swiper-rtl[_ngcontent-%COMP%]   .swiper-button-next[_ngcontent-%COMP%]{left:10px;right:auto}.swiper-button-prev[_ngcontent-%COMP%]:after, .swiper-rtl[_ngcontent-%COMP%]   .swiper-button-next[_ngcontent-%COMP%]:after{content:"prev"}.swiper-button-next[_ngcontent-%COMP%], .swiper-rtl[_ngcontent-%COMP%]   .swiper-button-prev[_ngcontent-%COMP%]{right:10px;left:auto}.swiper-button-next[_ngcontent-%COMP%]:after, .swiper-rtl[_ngcontent-%COMP%]   .swiper-button-prev[_ngcontent-%COMP%]:after{content:"next"}.swiper-button-lock[_ngcontent-%COMP%]{display:none}.swiper-pagination[_ngcontent-%COMP%]{position:absolute;text-align:center;transition:.3s opacity;transform:translate(0);z-index:10}.swiper-pagination.swiper-pagination-hidden[_ngcontent-%COMP%]{opacity:0}.swiper-pagination-disabled[_ngcontent-%COMP%] > .swiper-pagination[_ngcontent-%COMP%], .swiper-pagination.swiper-pagination-disabled[_ngcontent-%COMP%]{display:none!important}.swiper-horizontal[_ngcontent-%COMP%] > .swiper-pagination-bullets[_ngcontent-%COMP%], .swiper-pagination-bullets.swiper-pagination-horizontal[_ngcontent-%COMP%], .swiper-pagination-custom[_ngcontent-%COMP%], .swiper-pagination-fraction[_ngcontent-%COMP%]{bottom:10px;left:0;width:100%}.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]{overflow:hidden;font-size:0}.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%]{transform:scale(.33);position:relative}.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet-active[_ngcontent-%COMP%], .swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet-active-main[_ngcontent-%COMP%]{transform:scale(1)}.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet-active-prev[_ngcontent-%COMP%]{transform:scale(.66)}.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet-active-prev-prev[_ngcontent-%COMP%]{transform:scale(.33)}.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet-active-next[_ngcontent-%COMP%]{transform:scale(.66)}.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet-active-next-next[_ngcontent-%COMP%]{transform:scale(.33)}.swiper-pagination-bullet[_ngcontent-%COMP%]{width:var(--swiper-pagination-bullet-width,var(--swiper-pagination-bullet-size,8px));height:var(--swiper-pagination-bullet-height,var(--swiper-pagination-bullet-size,8px));display:inline-block;border-radius:50%;background:var(--swiper-pagination-bullet-inactive-color,#000);opacity:var(--swiper-pagination-bullet-inactive-opacity, .2)}button.swiper-pagination-bullet[_ngcontent-%COMP%]{border:none;margin:0;padding:0;box-shadow:none;-webkit-appearance:none;appearance:none}.swiper-pagination-clickable[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%]{cursor:pointer}.swiper-pagination-bullet[_ngcontent-%COMP%]:only-child{display:none!important}.swiper-pagination-bullet-active[_ngcontent-%COMP%]{opacity:var(--swiper-pagination-bullet-opacity, 1);background:var(--swiper-pagination-color,var(--swiper-theme-color))}.swiper-pagination-vertical.swiper-pagination-bullets[_ngcontent-%COMP%], .swiper-vertical[_ngcontent-%COMP%] > .swiper-pagination-bullets[_ngcontent-%COMP%]{right:10px;top:50%;transform:translateY(-50%)}.swiper-pagination-vertical.swiper-pagination-bullets[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%], .swiper-vertical[_ngcontent-%COMP%] > .swiper-pagination-bullets[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%]{margin:var(--swiper-pagination-bullet-vertical-gap,6px) 0;display:block}.swiper-pagination-vertical.swiper-pagination-bullets.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%], .swiper-vertical[_ngcontent-%COMP%] > .swiper-pagination-bullets.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]{top:50%;transform:translateY(-50%);width:8px}.swiper-pagination-vertical.swiper-pagination-bullets.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%], .swiper-vertical[_ngcontent-%COMP%] > .swiper-pagination-bullets.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%]{display:inline-block;transition:.2s transform,.2s top}.swiper-horizontal[_ngcontent-%COMP%] > .swiper-pagination-bullets[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%], .swiper-pagination-horizontal.swiper-pagination-bullets[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%]{margin:0 var(--swiper-pagination-bullet-horizontal-gap,4px)}.swiper-horizontal[_ngcontent-%COMP%] > .swiper-pagination-bullets.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%], .swiper-pagination-horizontal.swiper-pagination-bullets.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]{left:50%;transform:translate(-50%);white-space:nowrap}.swiper-horizontal[_ngcontent-%COMP%] > .swiper-pagination-bullets.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%], .swiper-pagination-horizontal.swiper-pagination-bullets.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%]{transition:.2s transform,.2s left}.swiper-horizontal.swiper-rtl[_ngcontent-%COMP%] > .swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%]{transition:.2s transform,.2s right}.swiper-pagination-progressbar[_ngcontent-%COMP%]{background:rgba(0,0,0,.25);position:absolute}.swiper-pagination-progressbar[_ngcontent-%COMP%]   .swiper-pagination-progressbar-fill[_ngcontent-%COMP%]{background:var(--swiper-pagination-color,var(--swiper-theme-color));position:absolute;left:0;top:0;width:100%;height:100%;transform:scale(0);transform-origin:left top}.swiper-rtl[_ngcontent-%COMP%]   .swiper-pagination-progressbar[_ngcontent-%COMP%]   .swiper-pagination-progressbar-fill[_ngcontent-%COMP%]{transform-origin:right top}.swiper-horizontal[_ngcontent-%COMP%] > .swiper-pagination-progressbar[_ngcontent-%COMP%], .swiper-pagination-progressbar.swiper-pagination-horizontal[_ngcontent-%COMP%], .swiper-pagination-progressbar.swiper-pagination-vertical.swiper-pagination-progressbar-opposite[_ngcontent-%COMP%], .swiper-vertical[_ngcontent-%COMP%] > .swiper-pagination-progressbar.swiper-pagination-progressbar-opposite[_ngcontent-%COMP%]{width:100%;height:4px;left:0;top:0}.swiper-horizontal[_ngcontent-%COMP%] > .swiper-pagination-progressbar.swiper-pagination-progressbar-opposite[_ngcontent-%COMP%], .swiper-pagination-progressbar.swiper-pagination-horizontal.swiper-pagination-progressbar-opposite[_ngcontent-%COMP%], .swiper-pagination-progressbar.swiper-pagination-vertical[_ngcontent-%COMP%], .swiper-vertical[_ngcontent-%COMP%] > .swiper-pagination-progressbar[_ngcontent-%COMP%]{width:4px;height:100%;left:0;top:0}.swiper-pagination-lock[_ngcontent-%COMP%]{display:none}.swiper-scrollbar[_ngcontent-%COMP%]{border-radius:10px;position:relative;-ms-touch-action:none;background:rgba(0,0,0,.1)}.swiper-scrollbar-disabled[_ngcontent-%COMP%] > .swiper-scrollbar[_ngcontent-%COMP%], .swiper-scrollbar.swiper-scrollbar-disabled[_ngcontent-%COMP%]{display:none!important}.swiper-horizontal[_ngcontent-%COMP%] > .swiper-scrollbar[_ngcontent-%COMP%], .swiper-scrollbar.swiper-scrollbar-horizontal[_ngcontent-%COMP%]{position:absolute;left:1%;bottom:3px;z-index:50;height:5px;width:98%}.swiper-scrollbar.swiper-scrollbar-vertical[_ngcontent-%COMP%], .swiper-vertical[_ngcontent-%COMP%] > .swiper-scrollbar[_ngcontent-%COMP%]{position:absolute;right:3px;top:1%;z-index:50;width:5px;height:98%}.swiper-scrollbar-drag[_ngcontent-%COMP%]{height:100%;width:100%;position:relative;background:rgba(0,0,0,.5);border-radius:10px;left:0;top:0}.swiper-scrollbar-cursor-drag[_ngcontent-%COMP%]{cursor:move}.swiper-scrollbar-lock[_ngcontent-%COMP%]{display:none}.swiper-zoom-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;text-align:center}.swiper-zoom-container[_ngcontent-%COMP%] > canvas[_ngcontent-%COMP%], .swiper-zoom-container[_ngcontent-%COMP%] > img[_ngcontent-%COMP%], .swiper-zoom-container[_ngcontent-%COMP%] > svg[_ngcontent-%COMP%]{max-width:100%;max-height:100%;object-fit:contain}.swiper-slide-zoomed[_ngcontent-%COMP%]{cursor:move}.swiper-lazy-preloader[_ngcontent-%COMP%]{width:42px;height:42px;position:absolute;left:50%;top:50%;margin-left:-21px;margin-top:-21px;z-index:10;transform-origin:50%;box-sizing:border-box;border:4px solid var(--swiper-preloader-color,var(--swiper-theme-color));border-radius:50%;border-top-color:transparent}.swiper-watch-progress[_ngcontent-%COMP%]   .swiper-slide-visible[_ngcontent-%COMP%]   .swiper-lazy-preloader[_ngcontent-%COMP%], .swiper[_ngcontent-%COMP%]:not(.swiper-watch-progress)   .swiper-lazy-preloader[_ngcontent-%COMP%]{animation:swiper-preloader-spin 1s infinite linear}.swiper-lazy-preloader-white[_ngcontent-%COMP%]{--swiper-preloader-color:#fff}.swiper-lazy-preloader-black[_ngcontent-%COMP%]{--swiper-preloader-color:#000}@keyframes swiper-preloader-spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.swiper[_ngcontent-%COMP%]   .swiper-notification[_ngcontent-%COMP%]{position:absolute;left:0;top:0;pointer-events:none;opacity:0;z-index:-1000}.swiper-free-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{transition-timing-function:ease-out;margin:0 auto}.swiper-grid[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{flex-wrap:wrap}.swiper-grid-column[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{flex-wrap:wrap;flex-direction:column}.swiper-fade.swiper-free-mode[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{transition-timing-function:ease-out}.swiper-fade[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{pointer-events:none;transition-property:opacity}.swiper-fade[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{pointer-events:none}.swiper-fade[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%], .swiper-fade[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%]{pointer-events:auto}.swiper-cube[_ngcontent-%COMP%]{overflow:visible}.swiper-cube[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;z-index:1;visibility:hidden;transform-origin:0 0;width:100%;height:100%}.swiper-cube[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{pointer-events:none}.swiper-cube.swiper-rtl[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{transform-origin:100% 0}.swiper-cube[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%], .swiper-cube[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%]{pointer-events:auto}.swiper-cube[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%], .swiper-cube[_ngcontent-%COMP%]   .swiper-slide-next[_ngcontent-%COMP%], .swiper-cube[_ngcontent-%COMP%]   .swiper-slide-next[_ngcontent-%COMP%] + .swiper-slide[_ngcontent-%COMP%], .swiper-cube[_ngcontent-%COMP%]   .swiper-slide-prev[_ngcontent-%COMP%]{pointer-events:auto;visibility:visible}.swiper-cube[_ngcontent-%COMP%]   .swiper-slide-shadow-bottom[_ngcontent-%COMP%], .swiper-cube[_ngcontent-%COMP%]   .swiper-slide-shadow-left[_ngcontent-%COMP%], .swiper-cube[_ngcontent-%COMP%]   .swiper-slide-shadow-right[_ngcontent-%COMP%], .swiper-cube[_ngcontent-%COMP%]   .swiper-slide-shadow-top[_ngcontent-%COMP%]{z-index:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}.swiper-cube[_ngcontent-%COMP%]   .swiper-cube-shadow[_ngcontent-%COMP%]{position:absolute;left:0;bottom:0;width:100%;height:100%;opacity:.6;z-index:0}.swiper-cube[_ngcontent-%COMP%]   .swiper-cube-shadow[_ngcontent-%COMP%]:before{content:"";background:#000;position:absolute;inset:0;filter:blur(50px)}.swiper-flip[_ngcontent-%COMP%]{overflow:visible}.swiper-flip[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;z-index:1}.swiper-flip[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{pointer-events:none}.swiper-flip[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%], .swiper-flip[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%]{pointer-events:auto}.swiper-flip[_ngcontent-%COMP%]   .swiper-slide-shadow-bottom[_ngcontent-%COMP%], .swiper-flip[_ngcontent-%COMP%]   .swiper-slide-shadow-left[_ngcontent-%COMP%], .swiper-flip[_ngcontent-%COMP%]   .swiper-slide-shadow-right[_ngcontent-%COMP%], .swiper-flip[_ngcontent-%COMP%]   .swiper-slide-shadow-top[_ngcontent-%COMP%]{z-index:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}.swiper-creative[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;overflow:hidden;transition-property:transform,opacity,height}.swiper-cards[_ngcontent-%COMP%]{overflow:visible}.swiper-cards[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{transform-origin:center bottom;-webkit-backface-visibility:hidden;backface-visibility:hidden;overflow:hidden}.swiper[_ngcontent-%COMP%]{width:100%;height:100%}.swiper-slide[_ngcontent-%COMP%]{text-align:center;font-size:18px;background:#fff;display:flex;justify-content:center;align-items:center}.swiper-slide[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block;width:100%;height:100%;object-fit:cover}']}),e})();function bz(e,t){if(1&e&&(We(0,"div",3),Yt(1,"img",4),rt()),2&e){const n=t.$implicit;Bt(1),ei("src",n.url,ad)("alt",n.name)}}Uh.use([Wb,Zb]);let wz=(()=>{class e{constructor(){this.galleryItems=[{name:"test-1",url:"/assets/images/gallery/gallery-01.jpg"},{name:"test-2",url:"/assets/images/gallery/gallery-02.jpg"},{name:"test-3",url:"/assets/images/gallery/gallery-03.jpg"},{name:"test-4",url:"/assets/images/gallery/gallery-04.jpg"},{name:"test-5",url:"/assets/images/gallery/gallery-05.jpg"},{name:"test-6",url:"/assets/images/gallery/gallery-06.jpg"},{name:"test-7",url:"/assets/images/gallery/gallery-07.jpg"},{name:"test-8",url:"/assets/images/gallery/gallery-08.jpg"}]}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-home-gallery"]],decls:3,vars:1,consts:[[1,"text-center","m-0"],[1,"row","row-cols-1","row-cols-lg-4","g-2","g-lg-3","py-5"],["class","rounded p-2",4,"ngFor","ngForOf"],[1,"rounded","p-2"],[1,"img-thumbnail","p-0","border-0","rounded",3,"src","alt"]],template:function(n,r){1&n&&(We(0,"div",0)(1,"div",1),Tt(2,bz,2,2,"div",2),rt()()),2&n&&(Bt(2),ei("ngForOf",r.galleryItems))},directives:[cu],styles:['@font-face{font-family:swiper-icons;src:url(data:application/font-woff;charset=utf-8;base64,\\ d09GRgABAAAAAAZgABAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAGRAAAABoAAAAci6qHkUdERUYAAAWgAAAAIwAAACQAYABXR1BPUwAABhQAAAAuAAAANuAY7+xHU1VCAAAFxAAAAFAAAABm2fPczU9TLzIAAAHcAAAASgAAAGBP9V5RY21hcAAAAkQAAACIAAABYt6F0cBjdnQgAAACzAAAAAQAAAAEABEBRGdhc3AAAAWYAAAACAAAAAj//wADZ2x5ZgAAAywAAADMAAAD2MHtryVoZWFkAAABbAAAADAAAAA2E2+eoWhoZWEAAAGcAAAAHwAAACQC9gDzaG10eAAAAigAAAAZAAAArgJkABFsb2NhAAAC0AAAAFoAAABaFQAUGG1heHAAAAG8AAAAHwAAACAAcABAbmFtZQAAA/gAAAE5AAACXvFdBwlwb3N0AAAFNAAAAGIAAACE5s74hXjaY2BkYGAAYpf5Hu/j+W2+MnAzMYDAzaX6QjD6/4//Bxj5GA8AuRwMYGkAPywL13jaY2BkYGA88P8Agx4j+/8fQDYfA1AEBWgDAIB2BOoAeNpjYGRgYNBh4GdgYgABEMnIABJzYNADCQAACWgAsQB42mNgYfzCOIGBlYGB0YcxjYGBwR1Kf2WQZGhhYGBiYGVmgAFGBiQQkOaawtDAoMBQxXjg/wEGPcYDDA4wNUA2CCgwsAAAO4EL6gAAeNpj2M0gyAACqxgGNWBkZ2D4/wMA+xkDdgAAAHjaY2BgYGaAYBkGRgYQiAHyGMF8FgYHIM3DwMHABGQrMOgyWDLEM1T9/w8UBfEMgLzE////P/5//f/V/xv+r4eaAAeMbAxwIUYmIMHEgKYAYjUcsDAwsLKxc3BycfPw8jEQA/gZBASFhEVExcQlJKWkZWTl5BUUlZRVVNXUNTQZBgMAAMR+E+gAEQFEAAAAKgAqACoANAA+AEgAUgBcAGYAcAB6AIQAjgCYAKIArAC2AMAAygDUAN4A6ADyAPwBBgEQARoBJAEuATgBQgFMAVYBYAFqAXQBfgGIAZIBnAGmAbIBzgHsAAB42u2NMQ6CUAyGW568x9AneYYgm4MJbhKFaExIOAVX8ApewSt4Bic4AfeAid3VOBixDxfPYEza5O+Xfi04YADggiUIULCuEJK8VhO4bSvpdnktHI5QCYtdi2sl8ZnXaHlqUrNKzdKcT8cjlq+rwZSvIVczNiezsfnP/uznmfPFBNODM2K7MTQ45YEAZqGP81AmGGcF3iPqOop0r1SPTaTbVkfUe4HXj97wYE+yNwWYxwWu4v1ugWHgo3S1XdZEVqWM7ET0cfnLGxWfkgR42o2PvWrDMBSFj/IHLaF0zKjRgdiVMwScNRAoWUoH78Y2icB/yIY09An6AH2Bdu/UB+yxopYshQiEvnvu0dURgDt8QeC8PDw7Fpji3fEA4z/PEJ6YOB5hKh4dj3EvXhxPqH/SKUY3rJ7srZ4FZnh1PMAtPhwP6fl2PMJMPDgeQ4rY8YT6Gzao0eAEA409DuggmTnFnOcSCiEiLMgxCiTI6Cq5DZUd3Qmp10vO0LaLTd2cjN4fOumlc7lUYbSQcZFkutRG7g6JKZKy0RmdLY680CDnEJ+UMkpFFe1RN7nxdVpXrC4aTtnaurOnYercZg2YVmLN/d/gczfEimrE/fs/bOuq29Zmn8tloORaXgZgGa78yO9/cnXm2BpaGvq25Dv9S4E9+5SIc9PqupJKhYFSSl47+Qcr1mYNAAAAeNptw0cKwkAAAMDZJA8Q7OUJvkLsPfZ6zFVERPy8qHh2YER+3i/BP83vIBLLySsoKimrqKqpa2hp6+jq6RsYGhmbmJqZSy0sraxtbO3sHRydnEMU4uR6yx7JJXveP7WrDycAAAAAAAH//wACeNpjYGRgYOABYhkgZgJCZgZNBkYGLQZtIJsFLMYAAAw3ALgAeNolizEKgDAQBCchRbC2sFER0YD6qVQiBCv/H9ezGI6Z5XBAw8CBK/m5iQQVauVbXLnOrMZv2oLdKFa8Pjuru2hJzGabmOSLzNMzvutpB3N42mNgZGBg4GKQYzBhYMxJLMlj4GBgAYow/P/PAJJhLM6sSoWKfWCAAwDAjgbRAAB42mNgYGBkAIIbCZo5IPrmUn0hGA0AO8EFTQAA);font-weight:400;font-style:normal}[_ngcontent-%COMP%]:root{--swiper-theme-color:#007aff}.swiper[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;position:relative;overflow:hidden;list-style:none;padding:0;z-index:1}.swiper-vertical[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{flex-direction:column}.swiper-wrapper[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;z-index:1;display:flex;transition-property:transform;box-sizing:content-box}.swiper-android[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%], .swiper-wrapper[_ngcontent-%COMP%]{transform:translate(0)}.swiper-pointer-events[_ngcontent-%COMP%]{touch-action:pan-y}.swiper-pointer-events.swiper-vertical[_ngcontent-%COMP%]{touch-action:pan-x}.swiper-slide[_ngcontent-%COMP%]{flex-shrink:0;width:100%;height:100%;position:relative;transition-property:transform}.swiper-slide-invisible-blank[_ngcontent-%COMP%]{visibility:hidden}.swiper-autoheight[_ngcontent-%COMP%], .swiper-autoheight[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{height:auto}.swiper-autoheight[_ngcontent-%COMP%]   .swiper-wrapper[_ngcontent-%COMP%]{align-items:flex-start;transition-property:transform,height}.swiper-backface-hidden[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{transform:translateZ(0);-webkit-backface-visibility:hidden;backface-visibility:hidden}.swiper-3d[_ngcontent-%COMP%], .swiper-3d.swiper-css-mode[_ngcontent-%COMP%]   .swiper-wrapper[_ngcontent-%COMP%]{perspective:1200px}.swiper-3d[_ngcontent-%COMP%]   .swiper-cube-shadow[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-bottom[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-left[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-right[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-top[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-wrapper[_ngcontent-%COMP%]{transform-style:preserve-3d}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-bottom[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-left[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-right[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-top[_ngcontent-%COMP%]{position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:10}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow[_ngcontent-%COMP%]{background:rgba(0,0,0,.15)}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-left[_ngcontent-%COMP%]{background-image:linear-gradient(to left,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-right[_ngcontent-%COMP%]{background-image:linear-gradient(to right,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-top[_ngcontent-%COMP%]{background-image:linear-gradient(to top,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-bottom[_ngcontent-%COMP%]{background-image:linear-gradient(to bottom,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{overflow:auto;scrollbar-width:none;-ms-overflow-style:none}.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%] > .swiper-slide[_ngcontent-%COMP%]{scroll-snap-align:start start}.swiper-horizontal.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{scroll-snap-type:x mandatory}.swiper-vertical.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{scroll-snap-type:y mandatory}.swiper-centered[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]:before{content:"";flex-shrink:0;order:9999}.swiper-centered.swiper-horizontal[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%] > .swiper-slide[_ngcontent-%COMP%]:first-child{margin-inline-start:var(--swiper-centered-offset-before)}.swiper-centered.swiper-horizontal[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]:before{height:100%;min-height:1px;width:var(--swiper-centered-offset-after)}.swiper-centered.swiper-vertical[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%] > .swiper-slide[_ngcontent-%COMP%]:first-child{margin-block-start:var(--swiper-centered-offset-before)}.swiper-centered.swiper-vertical[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]:before{width:100%;min-width:1px;height:var(--swiper-centered-offset-after)}.swiper-centered[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%] > .swiper-slide[_ngcontent-%COMP%]{scroll-snap-align:center center}@font-face{font-family:swiper-icons;src:url(data:application/font-woff;charset=utf-8;base64,\\ d09GRgABAAAAAAZgABAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAGRAAAABoAAAAci6qHkUdERUYAAAWgAAAAIwAAACQAYABXR1BPUwAABhQAAAAuAAAANuAY7+xHU1VCAAAFxAAAAFAAAABm2fPczU9TLzIAAAHcAAAASgAAAGBP9V5RY21hcAAAAkQAAACIAAABYt6F0cBjdnQgAAACzAAAAAQAAAAEABEBRGdhc3AAAAWYAAAACAAAAAj//wADZ2x5ZgAAAywAAADMAAAD2MHtryVoZWFkAAABbAAAADAAAAA2E2+eoWhoZWEAAAGcAAAAHwAAACQC9gDzaG10eAAAAigAAAAZAAAArgJkABFsb2NhAAAC0AAAAFoAAABaFQAUGG1heHAAAAG8AAAAHwAAACAAcABAbmFtZQAAA/gAAAE5AAACXvFdBwlwb3N0AAAFNAAAAGIAAACE5s74hXjaY2BkYGAAYpf5Hu/j+W2+MnAzMYDAzaX6QjD6/4//Bxj5GA8AuRwMYGkAPywL13jaY2BkYGA88P8Agx4j+/8fQDYfA1AEBWgDAIB2BOoAeNpjYGRgYNBh4GdgYgABEMnIABJzYNADCQAACWgAsQB42mNgYfzCOIGBlYGB0YcxjYGBwR1Kf2WQZGhhYGBiYGVmgAFGBiQQkOaawtDAoMBQxXjg/wEGPcYDDA4wNUA2CCgwsAAAO4EL6gAAeNpj2M0gyAACqxgGNWBkZ2D4/wMA+xkDdgAAAHjaY2BgYGaAYBkGRgYQiAHyGMF8FgYHIM3DwMHABGQrMOgyWDLEM1T9/w8UBfEMgLzE////P/5//f/V/xv+r4eaAAeMbAxwIUYmIMHEgKYAYjUcsDAwsLKxc3BycfPw8jEQA/gZBASFhEVExcQlJKWkZWTl5BUUlZRVVNXUNTQZBgMAAMR+E+gAEQFEAAAAKgAqACoANAA+AEgAUgBcAGYAcAB6AIQAjgCYAKIArAC2AMAAygDUAN4A6ADyAPwBBgEQARoBJAEuATgBQgFMAVYBYAFqAXQBfgGIAZIBnAGmAbIBzgHsAAB42u2NMQ6CUAyGW568x9AneYYgm4MJbhKFaExIOAVX8ApewSt4Bic4AfeAid3VOBixDxfPYEza5O+Xfi04YADggiUIULCuEJK8VhO4bSvpdnktHI5QCYtdi2sl8ZnXaHlqUrNKzdKcT8cjlq+rwZSvIVczNiezsfnP/uznmfPFBNODM2K7MTQ45YEAZqGP81AmGGcF3iPqOop0r1SPTaTbVkfUe4HXj97wYE+yNwWYxwWu4v1ugWHgo3S1XdZEVqWM7ET0cfnLGxWfkgR42o2PvWrDMBSFj/IHLaF0zKjRgdiVMwScNRAoWUoH78Y2icB/yIY09An6AH2Bdu/UB+yxopYshQiEvnvu0dURgDt8QeC8PDw7Fpji3fEA4z/PEJ6YOB5hKh4dj3EvXhxPqH/SKUY3rJ7srZ4FZnh1PMAtPhwP6fl2PMJMPDgeQ4rY8YT6Gzao0eAEA409DuggmTnFnOcSCiEiLMgxCiTI6Cq5DZUd3Qmp10vO0LaLTd2cjN4fOumlc7lUYbSQcZFkutRG7g6JKZKy0RmdLY680CDnEJ+UMkpFFe1RN7nxdVpXrC4aTtnaurOnYercZg2YVmLN/d/gczfEimrE/fs/bOuq29Zmn8tloORaXgZgGa78yO9/cnXm2BpaGvq25Dv9S4E9+5SIc9PqupJKhYFSSl47+Qcr1mYNAAAAeNptw0cKwkAAAMDZJA8Q7OUJvkLsPfZ6zFVERPy8qHh2YER+3i/BP83vIBLLySsoKimrqKqpa2hp6+jq6RsYGhmbmJqZSy0sraxtbO3sHRydnEMU4uR6yx7JJXveP7WrDycAAAAAAAH//wACeNpjYGRgYOABYhkgZgJCZgZNBkYGLQZtIJsFLMYAAAw3ALgAeNolizEKgDAQBCchRbC2sFER0YD6qVQiBCv/H9ezGI6Z5XBAw8CBK/m5iQQVauVbXLnOrMZv2oLdKFa8Pjuru2hJzGabmOSLzNMzvutpB3N42mNgZGBg4GKQYzBhYMxJLMlj4GBgAYow/P/PAJJhLM6sSoWKfWCAAwDAjgbRAAB42mNgYGBkAIIbCZo5IPrmUn0hGA0AO8EFTQAA);font-weight:400;font-style:normal}[_ngcontent-%COMP%]:root{--swiper-theme-color:#007aff}.swiper[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;position:relative;overflow:hidden;list-style:none;padding:0;z-index:1}.swiper-vertical[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{flex-direction:column}.swiper-wrapper[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;z-index:1;display:flex;transition-property:transform;box-sizing:content-box}.swiper-android[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%], .swiper-wrapper[_ngcontent-%COMP%]{transform:translate(0)}.swiper-pointer-events[_ngcontent-%COMP%]{touch-action:pan-y}.swiper-pointer-events.swiper-vertical[_ngcontent-%COMP%]{touch-action:pan-x}.swiper-slide[_ngcontent-%COMP%]{flex-shrink:0;width:100%;height:100%;position:relative;transition-property:transform}.swiper-slide-invisible-blank[_ngcontent-%COMP%]{visibility:hidden}.swiper-autoheight[_ngcontent-%COMP%], .swiper-autoheight[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{height:auto}.swiper-autoheight[_ngcontent-%COMP%]   .swiper-wrapper[_ngcontent-%COMP%]{align-items:flex-start;transition-property:transform,height}.swiper-backface-hidden[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{transform:translateZ(0);-webkit-backface-visibility:hidden;backface-visibility:hidden}.swiper-3d[_ngcontent-%COMP%], .swiper-3d.swiper-css-mode[_ngcontent-%COMP%]   .swiper-wrapper[_ngcontent-%COMP%]{perspective:1200px}.swiper-3d[_ngcontent-%COMP%]   .swiper-cube-shadow[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-bottom[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-left[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-right[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-top[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-wrapper[_ngcontent-%COMP%]{transform-style:preserve-3d}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-bottom[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-left[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-right[_ngcontent-%COMP%], .swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-top[_ngcontent-%COMP%]{position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:10}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow[_ngcontent-%COMP%]{background:rgba(0,0,0,.15)}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-left[_ngcontent-%COMP%]{background-image:linear-gradient(to left,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-right[_ngcontent-%COMP%]{background-image:linear-gradient(to right,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-top[_ngcontent-%COMP%]{background-image:linear-gradient(to top,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-3d[_ngcontent-%COMP%]   .swiper-slide-shadow-bottom[_ngcontent-%COMP%]{background-image:linear-gradient(to bottom,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{overflow:auto;scrollbar-width:none;-ms-overflow-style:none}.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%] > .swiper-slide[_ngcontent-%COMP%]{scroll-snap-align:start start}.swiper-horizontal.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{scroll-snap-type:x mandatory}.swiper-vertical.swiper-css-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{scroll-snap-type:y mandatory}.swiper-centered[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]:before{content:"";flex-shrink:0;order:9999}.swiper-centered.swiper-horizontal[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%] > .swiper-slide[_ngcontent-%COMP%]:first-child{margin-inline-start:var(--swiper-centered-offset-before)}.swiper-centered.swiper-horizontal[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]:before{height:100%;min-height:1px;width:var(--swiper-centered-offset-after)}.swiper-centered.swiper-vertical[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%] > .swiper-slide[_ngcontent-%COMP%]:first-child{margin-block-start:var(--swiper-centered-offset-before)}.swiper-centered.swiper-vertical[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]:before{width:100%;min-width:1px;height:var(--swiper-centered-offset-after)}.swiper-centered[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%] > .swiper-slide[_ngcontent-%COMP%]{scroll-snap-align:center center}.swiper-virtual[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;transform:translateZ(0)}.swiper-virtual.swiper-css-mode[_ngcontent-%COMP%]   .swiper-wrapper[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;top:0;pointer-events:none}.swiper-virtual.swiper-css-mode.swiper-horizontal[_ngcontent-%COMP%]   .swiper-wrapper[_ngcontent-%COMP%]:after{height:1px;width:var(--swiper-virtual-size)}.swiper-virtual.swiper-css-mode.swiper-vertical[_ngcontent-%COMP%]   .swiper-wrapper[_ngcontent-%COMP%]:after{width:1px;height:var(--swiper-virtual-size)}[_ngcontent-%COMP%]:root{--swiper-navigation-size:44px}.swiper-button-next[_ngcontent-%COMP%], .swiper-button-prev[_ngcontent-%COMP%]{position:absolute;top:50%;width:calc(var(--swiper-navigation-size)/ 44 * 27);height:var(--swiper-navigation-size);margin-top:calc(0px - (var(--swiper-navigation-size)/ 2));z-index:10;cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--swiper-navigation-color,var(--swiper-theme-color))}.swiper-button-next.swiper-button-disabled[_ngcontent-%COMP%], .swiper-button-prev.swiper-button-disabled[_ngcontent-%COMP%]{opacity:.35;cursor:auto;pointer-events:none}.swiper-button-next.swiper-button-hidden[_ngcontent-%COMP%], .swiper-button-prev.swiper-button-hidden[_ngcontent-%COMP%]{opacity:0;cursor:auto;pointer-events:none}.swiper-navigation-disabled[_ngcontent-%COMP%]   .swiper-button-next[_ngcontent-%COMP%], .swiper-navigation-disabled[_ngcontent-%COMP%]   .swiper-button-prev[_ngcontent-%COMP%]{display:none!important}.swiper-button-next[_ngcontent-%COMP%]:after, .swiper-button-prev[_ngcontent-%COMP%]:after{font-family:swiper-icons;font-size:var(--swiper-navigation-size);text-transform:none!important;letter-spacing:0;font-feature-settings:;font-variant:initial;line-height:1}.swiper-button-prev[_ngcontent-%COMP%], .swiper-rtl[_ngcontent-%COMP%]   .swiper-button-next[_ngcontent-%COMP%]{left:10px;right:auto}.swiper-button-prev[_ngcontent-%COMP%]:after, .swiper-rtl[_ngcontent-%COMP%]   .swiper-button-next[_ngcontent-%COMP%]:after{content:"prev"}.swiper-button-next[_ngcontent-%COMP%], .swiper-rtl[_ngcontent-%COMP%]   .swiper-button-prev[_ngcontent-%COMP%]{right:10px;left:auto}.swiper-button-next[_ngcontent-%COMP%]:after, .swiper-rtl[_ngcontent-%COMP%]   .swiper-button-prev[_ngcontent-%COMP%]:after{content:"next"}.swiper-button-lock[_ngcontent-%COMP%]{display:none}.swiper-pagination[_ngcontent-%COMP%]{position:absolute;text-align:center;transition:.3s opacity;transform:translate(0);z-index:10}.swiper-pagination.swiper-pagination-hidden[_ngcontent-%COMP%]{opacity:0}.swiper-pagination-disabled[_ngcontent-%COMP%] > .swiper-pagination[_ngcontent-%COMP%], .swiper-pagination.swiper-pagination-disabled[_ngcontent-%COMP%]{display:none!important}.swiper-horizontal[_ngcontent-%COMP%] > .swiper-pagination-bullets[_ngcontent-%COMP%], .swiper-pagination-bullets.swiper-pagination-horizontal[_ngcontent-%COMP%], .swiper-pagination-custom[_ngcontent-%COMP%], .swiper-pagination-fraction[_ngcontent-%COMP%]{bottom:10px;left:0;width:100%}.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]{overflow:hidden;font-size:0}.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%]{transform:scale(.33);position:relative}.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet-active[_ngcontent-%COMP%], .swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet-active-main[_ngcontent-%COMP%]{transform:scale(1)}.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet-active-prev[_ngcontent-%COMP%]{transform:scale(.66)}.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet-active-prev-prev[_ngcontent-%COMP%]{transform:scale(.33)}.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet-active-next[_ngcontent-%COMP%]{transform:scale(.66)}.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet-active-next-next[_ngcontent-%COMP%]{transform:scale(.33)}.swiper-pagination-bullet[_ngcontent-%COMP%]{width:var(--swiper-pagination-bullet-width,var(--swiper-pagination-bullet-size,8px));height:var(--swiper-pagination-bullet-height,var(--swiper-pagination-bullet-size,8px));display:inline-block;border-radius:50%;background:var(--swiper-pagination-bullet-inactive-color,#000);opacity:var(--swiper-pagination-bullet-inactive-opacity, .2)}button.swiper-pagination-bullet[_ngcontent-%COMP%]{border:none;margin:0;padding:0;box-shadow:none;-webkit-appearance:none;appearance:none}.swiper-pagination-clickable[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%]{cursor:pointer}.swiper-pagination-bullet[_ngcontent-%COMP%]:only-child{display:none!important}.swiper-pagination-bullet-active[_ngcontent-%COMP%]{opacity:var(--swiper-pagination-bullet-opacity, 1);background:var(--swiper-pagination-color,var(--swiper-theme-color))}.swiper-pagination-vertical.swiper-pagination-bullets[_ngcontent-%COMP%], .swiper-vertical[_ngcontent-%COMP%] > .swiper-pagination-bullets[_ngcontent-%COMP%]{right:10px;top:50%;transform:translateY(-50%)}.swiper-pagination-vertical.swiper-pagination-bullets[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%], .swiper-vertical[_ngcontent-%COMP%] > .swiper-pagination-bullets[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%]{margin:var(--swiper-pagination-bullet-vertical-gap,6px) 0;display:block}.swiper-pagination-vertical.swiper-pagination-bullets.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%], .swiper-vertical[_ngcontent-%COMP%] > .swiper-pagination-bullets.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]{top:50%;transform:translateY(-50%);width:8px}.swiper-pagination-vertical.swiper-pagination-bullets.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%], .swiper-vertical[_ngcontent-%COMP%] > .swiper-pagination-bullets.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%]{display:inline-block;transition:.2s transform,.2s top}.swiper-horizontal[_ngcontent-%COMP%] > .swiper-pagination-bullets[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%], .swiper-pagination-horizontal.swiper-pagination-bullets[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%]{margin:0 var(--swiper-pagination-bullet-horizontal-gap,4px)}.swiper-horizontal[_ngcontent-%COMP%] > .swiper-pagination-bullets.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%], .swiper-pagination-horizontal.swiper-pagination-bullets.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]{left:50%;transform:translate(-50%);white-space:nowrap}.swiper-horizontal[_ngcontent-%COMP%] > .swiper-pagination-bullets.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%], .swiper-pagination-horizontal.swiper-pagination-bullets.swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%]{transition:.2s transform,.2s left}.swiper-horizontal.swiper-rtl[_ngcontent-%COMP%] > .swiper-pagination-bullets-dynamic[_ngcontent-%COMP%]   .swiper-pagination-bullet[_ngcontent-%COMP%]{transition:.2s transform,.2s right}.swiper-pagination-progressbar[_ngcontent-%COMP%]{background:rgba(0,0,0,.25);position:absolute}.swiper-pagination-progressbar[_ngcontent-%COMP%]   .swiper-pagination-progressbar-fill[_ngcontent-%COMP%]{background:var(--swiper-pagination-color,var(--swiper-theme-color));position:absolute;left:0;top:0;width:100%;height:100%;transform:scale(0);transform-origin:left top}.swiper-rtl[_ngcontent-%COMP%]   .swiper-pagination-progressbar[_ngcontent-%COMP%]   .swiper-pagination-progressbar-fill[_ngcontent-%COMP%]{transform-origin:right top}.swiper-horizontal[_ngcontent-%COMP%] > .swiper-pagination-progressbar[_ngcontent-%COMP%], .swiper-pagination-progressbar.swiper-pagination-horizontal[_ngcontent-%COMP%], .swiper-pagination-progressbar.swiper-pagination-vertical.swiper-pagination-progressbar-opposite[_ngcontent-%COMP%], .swiper-vertical[_ngcontent-%COMP%] > .swiper-pagination-progressbar.swiper-pagination-progressbar-opposite[_ngcontent-%COMP%]{width:100%;height:4px;left:0;top:0}.swiper-horizontal[_ngcontent-%COMP%] > .swiper-pagination-progressbar.swiper-pagination-progressbar-opposite[_ngcontent-%COMP%], .swiper-pagination-progressbar.swiper-pagination-horizontal.swiper-pagination-progressbar-opposite[_ngcontent-%COMP%], .swiper-pagination-progressbar.swiper-pagination-vertical[_ngcontent-%COMP%], .swiper-vertical[_ngcontent-%COMP%] > .swiper-pagination-progressbar[_ngcontent-%COMP%]{width:4px;height:100%;left:0;top:0}.swiper-pagination-lock[_ngcontent-%COMP%]{display:none}.swiper-scrollbar[_ngcontent-%COMP%]{border-radius:10px;position:relative;-ms-touch-action:none;background:rgba(0,0,0,.1)}.swiper-scrollbar-disabled[_ngcontent-%COMP%] > .swiper-scrollbar[_ngcontent-%COMP%], .swiper-scrollbar.swiper-scrollbar-disabled[_ngcontent-%COMP%]{display:none!important}.swiper-horizontal[_ngcontent-%COMP%] > .swiper-scrollbar[_ngcontent-%COMP%], .swiper-scrollbar.swiper-scrollbar-horizontal[_ngcontent-%COMP%]{position:absolute;left:1%;bottom:3px;z-index:50;height:5px;width:98%}.swiper-scrollbar.swiper-scrollbar-vertical[_ngcontent-%COMP%], .swiper-vertical[_ngcontent-%COMP%] > .swiper-scrollbar[_ngcontent-%COMP%]{position:absolute;right:3px;top:1%;z-index:50;width:5px;height:98%}.swiper-scrollbar-drag[_ngcontent-%COMP%]{height:100%;width:100%;position:relative;background:rgba(0,0,0,.5);border-radius:10px;left:0;top:0}.swiper-scrollbar-cursor-drag[_ngcontent-%COMP%]{cursor:move}.swiper-scrollbar-lock[_ngcontent-%COMP%]{display:none}.swiper-zoom-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;text-align:center}.swiper-zoom-container[_ngcontent-%COMP%] > canvas[_ngcontent-%COMP%], .swiper-zoom-container[_ngcontent-%COMP%] > img[_ngcontent-%COMP%], .swiper-zoom-container[_ngcontent-%COMP%] > svg[_ngcontent-%COMP%]{max-width:100%;max-height:100%;object-fit:contain}.swiper-slide-zoomed[_ngcontent-%COMP%]{cursor:move}.swiper-lazy-preloader[_ngcontent-%COMP%]{width:42px;height:42px;position:absolute;left:50%;top:50%;margin-left:-21px;margin-top:-21px;z-index:10;transform-origin:50%;box-sizing:border-box;border:4px solid var(--swiper-preloader-color,var(--swiper-theme-color));border-radius:50%;border-top-color:transparent}.swiper-watch-progress[_ngcontent-%COMP%]   .swiper-slide-visible[_ngcontent-%COMP%]   .swiper-lazy-preloader[_ngcontent-%COMP%], .swiper[_ngcontent-%COMP%]:not(.swiper-watch-progress)   .swiper-lazy-preloader[_ngcontent-%COMP%]{animation:swiper-preloader-spin 1s infinite linear}.swiper-lazy-preloader-white[_ngcontent-%COMP%]{--swiper-preloader-color:#fff}.swiper-lazy-preloader-black[_ngcontent-%COMP%]{--swiper-preloader-color:#000}@keyframes swiper-preloader-spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.swiper[_ngcontent-%COMP%]   .swiper-notification[_ngcontent-%COMP%]{position:absolute;left:0;top:0;pointer-events:none;opacity:0;z-index:-1000}.swiper-free-mode[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{transition-timing-function:ease-out;margin:0 auto}.swiper-grid[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{flex-wrap:wrap}.swiper-grid-column[_ngcontent-%COMP%] > .swiper-wrapper[_ngcontent-%COMP%]{flex-wrap:wrap;flex-direction:column}.swiper-fade.swiper-free-mode[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{transition-timing-function:ease-out}.swiper-fade[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{pointer-events:none;transition-property:opacity}.swiper-fade[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{pointer-events:none}.swiper-fade[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%], .swiper-fade[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%]{pointer-events:auto}.swiper-cube[_ngcontent-%COMP%]{overflow:visible}.swiper-cube[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;z-index:1;visibility:hidden;transform-origin:0 0;width:100%;height:100%}.swiper-cube[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{pointer-events:none}.swiper-cube.swiper-rtl[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{transform-origin:100% 0}.swiper-cube[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%], .swiper-cube[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%]{pointer-events:auto}.swiper-cube[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%], .swiper-cube[_ngcontent-%COMP%]   .swiper-slide-next[_ngcontent-%COMP%], .swiper-cube[_ngcontent-%COMP%]   .swiper-slide-next[_ngcontent-%COMP%] + .swiper-slide[_ngcontent-%COMP%], .swiper-cube[_ngcontent-%COMP%]   .swiper-slide-prev[_ngcontent-%COMP%]{pointer-events:auto;visibility:visible}.swiper-cube[_ngcontent-%COMP%]   .swiper-slide-shadow-bottom[_ngcontent-%COMP%], .swiper-cube[_ngcontent-%COMP%]   .swiper-slide-shadow-left[_ngcontent-%COMP%], .swiper-cube[_ngcontent-%COMP%]   .swiper-slide-shadow-right[_ngcontent-%COMP%], .swiper-cube[_ngcontent-%COMP%]   .swiper-slide-shadow-top[_ngcontent-%COMP%]{z-index:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}.swiper-cube[_ngcontent-%COMP%]   .swiper-cube-shadow[_ngcontent-%COMP%]{position:absolute;left:0;bottom:0;width:100%;height:100%;opacity:.6;z-index:0}.swiper-cube[_ngcontent-%COMP%]   .swiper-cube-shadow[_ngcontent-%COMP%]:before{content:"";background:#000;position:absolute;inset:0;filter:blur(50px)}.swiper-flip[_ngcontent-%COMP%]{overflow:visible}.swiper-flip[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;z-index:1}.swiper-flip[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{pointer-events:none}.swiper-flip[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%], .swiper-flip[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%]   .swiper-slide-active[_ngcontent-%COMP%]{pointer-events:auto}.swiper-flip[_ngcontent-%COMP%]   .swiper-slide-shadow-bottom[_ngcontent-%COMP%], .swiper-flip[_ngcontent-%COMP%]   .swiper-slide-shadow-left[_ngcontent-%COMP%], .swiper-flip[_ngcontent-%COMP%]   .swiper-slide-shadow-right[_ngcontent-%COMP%], .swiper-flip[_ngcontent-%COMP%]   .swiper-slide-shadow-top[_ngcontent-%COMP%]{z-index:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}.swiper-creative[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;overflow:hidden;transition-property:transform,opacity,height}.swiper-cards[_ngcontent-%COMP%]{overflow:visible}.swiper-cards[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{transform-origin:center bottom;-webkit-backface-visibility:hidden;backface-visibility:hidden;overflow:hidden}.swiper[_ngcontent-%COMP%]{width:100%;height:100%}.swiper-slide[_ngcontent-%COMP%]{text-align:center;font-size:18px;background:#fff;display:flex;justify-content:center;align-items:center}.swiper-slide[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block;width:100%;height:100%;object-fit:cover}']}),e})(),Cz=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-home"]],decls:10,vars:0,consts:[[1,"py-4","animate__animated","animate__fadeIn","animate__faster","m-0","p-0"],[1,"row","pb-5"],[1,"row","my-5"],[1,"row"],[1,"row","m-0"]],template:function(n,r){1&n&&(We(0,"section",0)(1,"div",1),Yt(2,"app-slide-show"),rt(),Yt(3,"hr"),We(4,"div",2),Yt(5,"app-home-about"),rt(),We(6,"div",3),Yt(7,"app-home-products"),rt(),We(8,"div",4),Yt(9,"app-home-gallery"),rt()())},directives:[uz,dz,xz,wz],encapsulation:2}),e})();const Az=function(){return{exact:!0}};function Ez(e,t){if(1&e&&(We(0,"li",21)(1,"a",22),xt(2),rt()()),2&e){const n=t.$implicit;Bt(1),ei("routerLink",n.url)("routerLinkActiveOptions",ru(3,Az)),Bt(1),Ri(" ",n.name," ")}}let Tz=(()=>{class e{constructor(){this.menuItems=[{name:"Inicio",url:"/"},{name:"Productos",url:"products"},{name:"Servicios",url:"services"},{name:"Contacto",url:"contact"}],this.logedMenu=[]}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-header"]],decls:32,vars:1,consts:[[1,"navbar","navbar-expand-lg","navbar-dark","bg-dark","fixed-top","py-4"],[1,"container-fluid"],["routerLink","/",1,"navbar-brand","custom-text-pink"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarSupportedContent","aria-controls","navbarSupportedContent","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarSupportedContent",1,"collapse","navbar-collapse"],[1,"navbar-nav","me-auto","mb-2","mb-lg-0","mx-2"],["class","nav-item",4,"ngFor","ngForOf"],[1,"navbar-nav","mx-2"],[1,"nav-item","dropdown"],["href","#","role","button","data-bs-toggle","dropdown","aria-expanded","false",1,"nav-link","dropdown-toggle"],[1,"fas","fa-user"],[1,"dropdown-menu","mb-4"],["href","#",1,"dropdown-item"],[1,"fas","fa-shopping-cart"],[1,"fas","fa-sticky-note"],[1,"dropdown-divider"],[1,"fas","fa-sign-out-alt","text-danger"],["role","search",1,"d-flex","mx-2"],["type","search","placeholder","\xbfQu\xe9 deseas buscar?","aria-label","Search",1,"form-control","me-2"],["type","submit",1,"btn","custom-btn-outline-pink"],[1,"nav-item"],["routerLinkActive","active",1,"nav-link",3,"routerLink","routerLinkActiveOptions"]],template:function(n,r){1&n&&(We(0,"nav",0)(1,"div",1)(2,"a",2),xt(3,"HAIR BY EVE"),rt(),We(4,"button",3),Yt(5,"span",4),rt(),We(6,"div",5)(7,"ul",6),Tt(8,Ez,3,4,"li",7),rt(),We(9,"ul",8)(10,"li",9)(11,"a",10),Yt(12,"i",11),rt(),We(13,"ul",12)(14,"li")(15,"a",13),Yt(16,"i",14),xt(17," Carrito de compras"),rt()(),We(18,"li")(19,"a",13),Yt(20,"i",15),xt(21," Ver mis reservas"),rt()(),We(22,"li"),Yt(23,"hr",16),rt(),We(24,"li")(25,"a",13),Yt(26,"i",17),xt(27," Cerrar Sesi\xf3n"),rt()()()()(),We(28,"form",18),Yt(29,"input",19),We(30,"button",20),xt(31,"Buscar"),rt()()()()()),2&n&&(Bt(8),ei("ngForOf",r.menuItems))},directives:[Pv,cu,LE],styles:[""]}),e})(),Mz=(()=>{class e{constructor(){this.currentYear=(new Date).getFullYear()}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-footer"]],decls:5,vars:1,consts:[[1,"text-center","p-5"],["href","#","target","_blank",1,"newflare-brand"]],template:function(n,r){1&n&&(We(0,"footer",0)(1,"p"),xt(2),We(3,"a",1),xt(4,"Newflare"),rt()()()),2&n&&(Bt(2),Ri("Copyright \xa9 ",r.currentYear," Todos los derechos reservados | Creado por "))},styles:[".newflare-brand[_ngcontent-%COMP%]{text-decoration:none;font-weight:600;color:var( --main-color )}"]}),e})(),Sz=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-pages"]],decls:5,vars:0,consts:[[1,"container","pt-5"]],template:function(n,r){1&n&&(We(0,"div"),Yt(1,"app-header"),We(2,"div",0),Yt(3,"router-outlet")(4,"app-footer"),rt()())},directives:[Tz,Av,Mz],styles:[""]}),e})(),Dz=(()=>{class e{constructor(){this.cardTitle="Hola"}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-product-card"]],inputs:{cardTitle:"cardTitle"},decls:26,vars:1,consts:[[1,"card"],["src","assets/images/product.jpg","alt","product",1,"card-img-top"],[1,"card-body"],[1,"card-title"],[1,"card-text"],[1,"list-group","list-group-flush"],[1,"list-group-item"],[1,"custom-text-pink"],["href","#",1,"text-end","fw-bold"],[1,"d-flex","justify-content-between"],["type","button",1,"btn","custom-btn-pink"],[1,"fas","fa-shopping-cart"],["role","group","aria-label","Basic example",1,"btn-group"],["type","button","disabled","",1,"btn","custom-btn-outline-pink"]],template:function(n,r){1&n&&(We(0,"div",0),Yt(1,"img",1),We(2,"div",2)(3,"h5",3),xt(4),rt(),We(5,"p",4),xt(6,"Some quick example text to build on the card title and make up the bulk of the card's content."),rt()(),We(7,"ul",5)(8,"li",6),xt(9,"Stock: "),We(10,"span",7),xt(11,"14"),rt()()(),We(12,"div",2)(13,"p",8),xt(14,"$ 4.000"),rt(),We(15,"div",9)(16,"button",10),Yt(17,"i",11),xt(18," Agregar al carro "),rt(),We(19,"div",12)(20,"button",10),xt(21,"-"),rt(),We(22,"button",13),xt(23,"0"),rt(),We(24,"button",10),xt(25,"+"),rt()()()()()),2&n&&(Bt(4),ba(r.cardTitle))},encapsulation:2}),e})();function Iz(e,t){if(1&e&&(We(0,"div",4),Yt(1,"app-product-card",5),rt()),2&e){const n=t.$implicit;Bt(1),ei("cardTitle",n.name)}}let Pz=(()=>{class e{constructor(){this.productsTest=[{name:"test 1"},{name:"test 2"},{name:"test 3"},{name:"test 4"},{name:"test 5"},{name:"test 6"}]}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-products"]],decls:6,vars:1,consts:[[1,"py-5","p-3","animate__animated","animate__fadeIn","animate__faster"],[1,"row"],[1,"row","row-cols-1","row-cols-md-3","g-4"],["class","col",4,"ngFor","ngForOf"],[1,"col"],[3,"cardTitle"]],template:function(n,r){1&n&&(We(0,"section",0)(1,"div",1),Yt(2,"app-title"),rt(),Yt(3,"hr"),We(4,"div",2),Tt(5,Iz,2,1,"div",3),rt()()),2&n&&(Bt(5),ei("ngForOf",r.productsTest))},directives:[Fv,cu,Dz],encapsulation:2}),e})();function Oz(e,t){if(1&e&&(We(0,"div",15),Yt(1,"input",16),We(2,"label",17),xt(3),rt()()),2&e){const n=t.$implicit;Bt(3),Ri(" \xa0",n.hour," ")}}function kz(e,t){if(1&e&&(We(0,"div",18),Yt(1,"input",16),We(2,"label",17),xt(3),rt()()),2&e){const n=t.$implicit;Bt(3),Ri(" \xa0",n.hour," ")}}function Rz(e,t){if(1&e&&(We(0,"div",18),Yt(1,"input",16),We(2,"label",17),xt(3),rt()()),2&e){const n=t.$implicit;Bt(3),Ri(" \xa0",n.hour," ")}}let Lz=(()=>{class e{constructor(){this.freeHours1=[{hour:"9:00"},{hour:"10:00"},{hour:"11:00"},{hour:"12:00"},{hour:"13:00"},{hour:"14:00"},{hour:"15:00"},{hour:"16:00"},{hour:"17:00"},{hour:"18:00"}],this.freeHours2=[{hour:"10:00"},{hour:"12:00"},{hour:"13:00"},{hour:"15:00"},{hour:"16:00"}],this.freeHours3=[{hour:"11:00"},{hour:"12:00"},{hour:"13:00"},{hour:"14:00"},{hour:"16:00"},{hour:"17:00"},{hour:"18:00"}]}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-hours-picker"]],decls:27,vars:3,consts:[[1,"d-flex","justify-content-between","mb-4"],[1,"btn","custom-btn-pink"],["id","pills-tab","role","tablist",1,"nav","nav-pills","mb-3"],["role","presentation",1,"nav-item"],["id","pills-home-tab","data-bs-toggle","pill","data-bs-target","#pills-home","type","button","role","tab","aria-controls","pills-home","aria-selected","true",1,"nav-link","active"],["id","pills-profile-tab","data-bs-toggle","pill","data-bs-target","#pills-profile","type","button","role","tab","aria-controls","pills-profile","aria-selected","false",1,"nav-link"],["id","pills-contact-tab","data-bs-toggle","pill","data-bs-target","#pills-contact","type","button","role","tab","aria-controls","pills-contact","aria-selected","false","disabled","",1,"nav-link"],["id","pills-disabled-tab","data-bs-toggle","pill","data-bs-target","#pills-disabled","type","button","role","tab","aria-controls","pills-disabled","aria-selected","false",1,"nav-link"],["id","pills-tabContent",1,"tab-content"],["id","pills-home","role","tabpanel","aria-labelledby","pills-home-tab","tabindex","0",1,"tab-pane","fade","show","active"],["class","form-check-inline ml-3 my-3",4,"ngFor","ngForOf"],["id","pills-profile","role","tabpanel","aria-labelledby","pills-profile-tab","tabindex","0",1,"tab-pane","fade"],["class","form-check-inline my-3",4,"ngFor","ngForOf"],["id","pills-contact","role","tabpanel","aria-labelledby","pills-contact-tab","tabindex","0",1,"tab-pane","fade"],["id","pills-disabled","role","tabpanel","aria-labelledby","pills-disabled-tab","tabindex","0",1,"tab-pane","fade"],[1,"form-check-inline","ml-3","my-3"],["type","radio","name","flexRadioDefault","id","flexRadioDefault1",1,"form-check-input"],["for","flexRadioDefault1",1,"form-check-label","fw-bold"],[1,"form-check-inline","my-3"]],template:function(n,r){1&n&&(We(0,"div",0)(1,"h3"),xt(2,"Semana 17-Oct a 22-Oct "),rt(),We(3,"button",1),xt(4,"Volver a servicios"),rt()(),We(5,"ul",2)(6,"li",3)(7,"button",4),xt(8,"Lunes "),rt()(),We(9,"li",3)(10,"button",5),xt(11,"Martes"),rt()(),We(12,"li",3)(13,"button",6),xt(14,"Mi\xe9rcoles"),rt()(),We(15,"li",3)(16,"button",7),xt(17,"Jueves"),rt()()(),We(18,"div",8)(19,"div",9),Tt(20,Oz,4,1,"div",10),rt(),We(21,"div",11),Tt(22,kz,4,1,"div",12),rt(),We(23,"div",13),xt(24,"..."),rt(),We(25,"div",14),Tt(26,Rz,4,1,"div",12),rt()()),2&n&&(Bt(20),ei("ngForOf",r.freeHours1),Bt(2),ei("ngForOf",r.freeHours2),Bt(4),ei("ngForOf",r.freeHours3))},directives:[cu],encapsulation:2}),e})(),zz=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-reservation"]],decls:36,vars:0,consts:[[1,"py-5","animate__animated","animate__fadeIn","animate__faster"],[1,"row"],[1,"row","row-cols-1","row-cols-md-2","g-4"],[1,"col"],[1,"card","border-dark","mb-3"],[1,"card-header"],[1,"card-body","text-dark"],[1,"card-title"],[1,"list-group"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"badge","custom-bg-pink","rounded-pill"],[1,"d-flex","justify-content-between"],[1,"custom-text-pink","fw-bold"],["routerLink","/reservation",1,"m-3","btn","custom-btn-pink"]],template:function(n,r){1&n&&(We(0,"section",0)(1,"div",1),Yt(2,"app-title"),rt(),Yt(3,"hr"),We(4,"div",2)(5,"div",3),Yt(6,"app-hours-picker"),rt(),We(7,"div",3)(8,"div",4)(9,"div",5),xt(10,"Hair By Eve"),rt(),We(11,"div",6)(12,"h5",7),xt(13,"Detalle de los servicios"),rt(),Yt(14,"hr"),We(15,"ul",8)(16,"li",9),xt(17," Corte de ni\xf1a "),We(18,"span",10),xt(19,"$ 15.900"),rt()(),We(20,"li",9),xt(21," Corte de mujer (cabello largo) "),We(22,"span",10),xt(23,"$ 25.900"),rt()(),We(24,"li",9),xt(25," Terapia intensiva Kerastase "),We(26,"span",10),xt(27,"$ 59.900"),rt()()(),Yt(28,"hr"),We(29,"div",11)(30,"div"),xt(31,"Total"),rt(),We(32,"div",12),xt(33,"$ 101.700"),rt()()(),We(34,"button",13),xt(35,"Ir a pagar"),rt()()()()())},directives:[Fv,Lz,qg],encapsulation:2}),e})();function Fz(e,t){if(1&e&&(We(0,"div",15)(1,"div",16),Yt(2,"input",17),We(3,"label",18)(4,"div"),xt(5),We(6,"p"),xt(7),rt()(),We(8,"div"),xt(9),rt()()()()),2&e){const n=t.$implicit;Bt(5),Ri(" ",n.name," "),Bt(2),ba(n.time),Bt(2),Ri(" $ ",n.price," ")}}function Bz(e,t){if(1&e&&(We(0,"div",15)(1,"div",16),Yt(2,"input",17),We(3,"label",18)(4,"div"),xt(5),We(6,"p"),xt(7),rt()(),We(8,"div"),xt(9),rt()()()()),2&e){const n=t.$implicit;Bt(5),Ri(" ",n.name," "),Bt(2),ba(n.time),Bt(2),Ri(" ",n.price," ")}}function Nz(e,t){if(1&e&&(We(0,"div",15)(1,"div",16),Yt(2,"input",17),We(3,"label",18)(4,"div"),xt(5),We(6,"p"),xt(7),rt()(),We(8,"div"),xt(9),rt()()()()),2&e){const n=t.$implicit;Bt(5),Ri(" ",n.name," "),Bt(2),ba(n.time),Bt(2),Ri(" ",n.price," ")}}function jz(e,t){if(1&e&&(We(0,"div",15)(1,"div",16),Yt(2,"input",17),We(3,"label",18)(4,"div"),xt(5),We(6,"p"),xt(7),rt()(),We(8,"div"),xt(9),rt()()()()),2&e){const n=t.$implicit;Bt(5),Ri(" ",n.name," "),Bt(2),ba(n.time),Bt(2),Ri(" ",n.price," ")}}let Vz=(()=>{class e{constructor(){}ngOnInit(){this.setAccordionItems()}setAccordionItems(){this.accordionItems=[{id:"flush-headingOne",title:"Corte y Estilo",options:[{name:"Corte de ni\xf1o",time:"30min",price:"10.900"},{name:"Corte de ni\xf1a",time:"1h",price:"15.900"},{name:"Corte de hombre",time:"30 min",price:"14.900"},{name:"Corte de mujer (cabello corto)",time:"1h",price:"22.900"},{name:"Corte de mujer (cabello largo)",time:"1h",price:"25.900"}]},{id:"flush-headingTwo",title:"Coloraci\xf3n",options:[{name:"Coloraci\xf3n global Tradicional",time:"1h",price:"27.990"},{name:"Coloraci\xf3n global Premiun",time:"1h",price:"30.990"},{name:"Visos / Reflejos",time:"4h - 5h",price:"59.990"},{name:"Smoky Hair",time:"4h - 5h",price:"99.990"}]},{id:"flush-headingThree",title:"Tratamientos capilares",options:[{name:"Terapia intensiva Kerastase",time:"1h",price:"59.900"},{name:"Ritual mix Loreal",time:"30min",price:"21.990"}]},{id:"flush-headingFour",title:"Tratamientos reconstructivos",options:[{name:"Botox capilar",time:"1h",price:"35.900"},{name:"Alisado Queratina",time:"30min",price:"15.000"},{name:"Olaplex Stand Alone",time:"35min",price:"28.900"}]}]}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-accordion"]],decls:29,vars:16,consts:[["id","accordionFlushExample",1,"accordion","accordion-flush"],[1,"accordion-item"],["id","flush-headingOne",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#flush-collapseOne","aria-expanded","false","aria-controls","flush-collapseOne",1,"accordion-button","collapsed","fw-bold"],["id","flush-collapseOne","aria-labelledby","flush-headingOne","data-bs-parent","#accordionFlushExample",1,"accordion-collapse","collapse"],["class","accordion-body",4,"ngFor","ngForOf"],["id","flush-headingTwo",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#flush-collapseTwo","aria-expanded","false","aria-controls","flush-collapseTwo",1,"accordion-button","collapsed","fw-bold"],["id","flush-collapseTwo","aria-labelledby","flush-headingTwo","data-bs-parent","#accordionFlushExample",1,"accordion-collapse","collapse"],["id","flush-headingThree",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#flush-collapseThree","aria-expanded","false","aria-controls","flush-collapseThree",1,"accordion-button","collapsed","fw-bold"],["id","flush-collapseThree","aria-labelledby","flush-headingThree","data-bs-parent","#accordionFlushExample",1,"accordion-collapse","collapse"],["id","flush-headingFour",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#flush-collapseFour","aria-expanded","false","aria-controls","flush-collapseFour",1,"accordion-button","collapsed","fw-bold"],["id","flush-collapseFour","aria-labelledby","flush-headingFour","data-bs-parent","#accordionFlushExample",1,"accordion-collapse","collapse"],[1,"accordion-body"],[1,"form-check"],["type","checkbox","value","","id","flexCheckDefault",1,"form-check-input"],["for","flexCheckDefault",1,"form-check-label","d-flex","justify-content-between"]],template:function(n,r){1&n&&(We(0,"div",0)(1,"div",1)(2,"h2",2)(3,"button",3),xt(4),kh(5,"uppercase"),rt()(),We(6,"div",4),Tt(7,Fz,10,3,"div",5),rt()(),We(8,"div",1)(9,"h2",6)(10,"button",7),xt(11),kh(12,"uppercase"),rt()(),We(13,"div",8),Tt(14,Bz,10,3,"div",5),rt()(),We(15,"div",1)(16,"h2",9)(17,"button",10),xt(18),kh(19,"uppercase"),rt()(),We(20,"div",11),Tt(21,Nz,10,3,"div",5),rt()(),We(22,"div",1)(23,"h2",12)(24,"button",13),xt(25),kh(26,"uppercase"),rt()(),We(27,"div",14),Tt(28,jz,10,3,"div",5),rt()()()),2&n&&(Bt(4),Ri(" ",Sf(5,8,r.accordionItems[0].title)," "),Bt(3),ei("ngForOf",r.accordionItems[0].options),Bt(4),Ri(" ",Sf(12,10,r.accordionItems[1].title)," "),Bt(3),ei("ngForOf",r.accordionItems[1].options),Bt(4),Ri(" ",Sf(19,12,r.accordionItems[2].title)," "),Bt(3),ei("ngForOf",r.accordionItems[2].options),Bt(4),Ri(" ",Sf(26,14,r.accordionItems[3].title)," "),Bt(3),ei("ngForOf",r.accordionItems[3].options))},directives:[cu],pipes:[_A],encapsulation:2}),e})();const Uz=[{path:"",component:Sz,children:[{path:"",component:Cz,data:{title:"Inicio"}},{path:"products",component:Pz,data:{title:"Productos"}},{path:"services",component:(()=>{class e{constructor(){this.servicesList=[{serviceName:"Corte 1",price:"3000"},{serviceName:"Corte 2",price:"3000"},{serviceName:"Corte 3",price:"3000"},{serviceName:"Corte 4",price:"3000"},{serviceName:"Corte 5",price:"3000"},{serviceName:"Corte 6",price:"3000"},{serviceName:"Corte 7",price:"3000"},{serviceName:"Corte 8",price:"3000"}]}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=ti({type:e,selectors:[["app-services"]],decls:25,vars:0,consts:[[1,"py-5","animate__animated","animate__fadeIn","animate__faster"],[1,"row"],[1,"row","row-cols-1","row-cols-md-2","g-4"],[1,"col"],[1,"card","border-dark","mb-3"],[1,"card-header"],[1,"card-body","text-dark"],[1,"card-title"],[1,"card-text","text-center","my-5"],[1,"d-flex","justify-content-between"],["routerLink","/reservation",1,"m-3","btn","custom-btn-pink"]],template:function(n,r){1&n&&(We(0,"section",0)(1,"div",1),Yt(2,"app-title"),rt(),Yt(3,"hr"),We(4,"div",2)(5,"div",3),Yt(6,"app-accordion"),rt(),We(7,"div",3)(8,"div",4)(9,"div",5),xt(10,"Hair By Eve"),rt(),We(11,"div",6)(12,"h5",7),xt(13,"Detalle de los servicios"),rt(),Yt(14,"hr"),We(15,"p",8),xt(16,"No hay servicios selecionados"),rt(),Yt(17,"hr"),We(18,"div",9)(19,"div"),xt(20,"Total"),rt(),We(21,"div"),xt(22,"$ 0"),rt()()(),We(23,"button",10),xt(24,"Reservar hora"),rt()()()()())},directives:[Fv,Vz,qg],encapsulation:2}),e})(),data:{title:"Nuestros Servicios"}},{path:"reservation",component:zz,data:{title:"Reserva tu hora"}},{path:"contact",component:oz,data:{title:"Contacto"}}]}];let $z=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=hr({type:e}),e.\u0275inj=Li({imports:[[hu.forChild(Uz)],hu]}),e})();const Gz=[{path:"",redirectTo:"/",pathMatch:"full"},{path:"**",component:KL}];let Hz=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=hr({type:e}),e.\u0275inj=Li({imports:[[hu.forRoot(Gz),ez,$z],hu]}),e})(),qz=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=hr({type:e,bootstrap:[fk]}),e.\u0275inj=Li({providers:[],imports:[[Hz,zP,oT,QL]]}),e})();nz().accessToken="pk.eyJ1IjoibmV3ZmxhcmUiLCJhIjoiY2w4d2ozam41MGNyMjNvcnNxb2Jic2g2NCJ9.qV5h6WL3jU0lcdRIxUvR0A",function ED(){BC=!1}(),RP().bootstrapModule(qz).catch(e=>console.error(e))},898:function(Nf){Nf.exports=function(){"use strict";var fu,Hl,_i;function Fd(p,ot){if(fu)if(Hl){var Ws="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+fu+")(sharedChunk); ("+Hl+")(sharedChunk); self.onerror = null;",kr={};fu(kr),_i=ot(kr),"undefined"!=typeof window&&window&&window.URL&&window.URL.createObjectURL&&(_i.workerUrl=window.URL.createObjectURL(new Blob([Ws],{type:"text/javascript"})))}else Hl=ot;else fu=ot}return Fd(0,function(p){var ot="undefined"!=typeof self?self:{},Ws=kr;function kr(s,i,o,c){this.cx=3*s,this.bx=3*(o-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(c-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=c,this.p2x=o,this.p2y=c}kr.prototype.sampleCurveX=function(s){return((this.ax*s+this.bx)*s+this.cx)*s},kr.prototype.sampleCurveY=function(s){return((this.ay*s+this.by)*s+this.cy)*s},kr.prototype.sampleCurveDerivativeX=function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},kr.prototype.solveCurveX=function(s,i){var o,c,h,m,y;for(void 0===i&&(i=1e-6),h=s,y=0;y<8;y++){if(m=this.sampleCurveX(h)-s,Math.abs(m)<i)return h;var b=this.sampleCurveDerivativeX(h);if(Math.abs(b)<1e-6)break;h-=m/b}if((h=s)<(o=0))return o;if(h>(c=1))return c;for(;o<c;){if(m=this.sampleCurveX(h),Math.abs(m-s)<i)return h;s>m?o=h:c=h,h=.5*(c-o)+o}return h},kr.prototype.solve=function(s,i){return this.sampleCurveY(this.solveCurveX(s,i))};var dt=Qt;function Qt(s,i){this.x=s,this.y=i}Qt.prototype={clone:function(){return new Qt(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,i){return this.clone()._rotateAround(s,i)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var i=s.x-this.x,o=s.y-this.y;return i*i+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,i){return Math.atan2(this.x*i-this.y*s,this.x*s+this.y*i)},_matMult:function(s){var i=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=i,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var i=Math.cos(s),o=Math.sin(s),c=o*this.x+i*this.y;return this.x=i*this.x-o*this.y,this.y=c,this},_rotateAround:function(s,i){var o=Math.cos(s),c=Math.sin(s),h=i.y+c*(this.x-i.x)+o*(this.y-i.y);return this.x=i.x+o*(this.x-i.x)-c*(this.y-i.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Qt.convert=function(s){return s instanceof Qt?s:Array.isArray(s)?new Qt(s[0],s[1]):s};const Cr=Math.PI/180,Oo=180/Math.PI;function ln(s){return s*Cr}function cr(s){return s*Oo}const mu=[[0,0],[1,0],[1,1],[0,1]];function ql(s){if(s<=0)return 0;if(s>=1)return 1;const i=s*s,o=i*s;return 4*(s<.5?o:3*(s-i)+o-.75)}function bs(s,i,o,c){const h=new Ws(s,i,o,c);return function(m){return h.solve(m)}}const _o=bs(.25,.1,.25,1);function Zt(s,i,o){return Math.min(o,Math.max(i,s))}function es(s,i,o){return(o=Zt((o-s)/(i-s),0,1))*o*(3-2*o)}function ts(s,i,o){const c=o-i,h=((s-i)%c+c)%c+i;return h===i?o:h}function Ys(s,i,o){if(!s.length)return o(null,[]);let c=s.length;const h=new Array(s.length);let m=null;s.forEach((y,b)=>{i(y,(A,E)=>{A&&(m=A),h[b]=E,0==--c&&o(m,h)})})}function Xs(s){const i=[];for(const o in s)i.push(s[o]);return i}function ji(s,...i){for(const o of i)for(const c in o)s[c]=o[c];return s}let Ma=1;function ws(){return Ma++}function dl(){return function s(i){return i?(i^Math.random()*(16>>i/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,s)}()}function hl(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function gu(s){return!!s&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(s)}function ns(s,i){s.forEach(o=>{i[o]&&(i[o]=i[o].bind(i))})}function yo(s,i){return-1!==s.indexOf(i,s.length-i.length)}function Cs(s,i,o){const c={};for(const h in s)c[h]=i.call(o||this,s[h],h,s);return c}function Qs(s,i,o){const c={};for(const h in s)i.call(o||this,s[h],h,s)&&(c[h]=s[h]);return c}function Hn(s){return Array.isArray(s)?s.map(Hn):"object"==typeof s&&s?Cs(s,Hn):s}const pl={};function vi(s){pl[s]||("undefined"!=typeof console&&console.warn(s),pl[s]=!0)}function ur(s,i,o){return(o.y-s.y)*(i.x-s.x)>(i.y-s.y)*(o.x-s.x)}function As(s){let i=0;for(let o,c,h=0,m=s.length,y=m-1;h<m;y=h++)o=s[h],c=s[y],i+=(c.x-o.x)*(o.y+c.y);return i}function bi(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function is(s){const i={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,c,h,m)=>{const y=h||m;return i[c]=!y||y.toLowerCase(),""}),i["max-age"]){const o=parseInt(i["max-age"],10);isNaN(o)?delete i["max-age"]:i["max-age"]=o}return i}let rs=null;function wi(s){if(null==rs){const i=s.navigator?s.navigator.userAgent:null;rs=!!s.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return rs}function Mi(s){try{const i=ot[s];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch(i){return!1}}function Es(s,i){return[s[4*i],s[4*i+1],s[4*i+2],s[4*i+3]]}const Qn=ot.performance;function Ts(s){const i=s?s.url.toString():void 0;return Qn.getEntriesByName(i)}let xn,Ks,ml,Ms;const ko={now:()=>void 0!==ml?ml:ot.performance.now(),setNow(s){ml=s},restoreNow(){ml=void 0},frame(s){const i=ot.requestAnimationFrame(s);return{cancel:()=>ot.cancelAnimationFrame(i)}},getImageData(s,i=0){const{width:o,height:c}=s;Ms||(Ms=ot.document.createElement("canvas"));const h=Ms.getContext("2d");if(!h)throw new Error("failed to create canvas 2d context");return(o>Ms.width||c>Ms.height)&&(Ms.width=o,Ms.height=c),h.clearRect(-i,-i,o+2*i,c+2*i),h.drawImage(s,0,0,o,c),h.getImageData(-i,-i,o+2*i,c+2*i)},resolveURL:s=>(xn||(xn=ot.document.createElement("a")),xn.href=s,xn.href),get devicePixelRatio(){return ot.devicePixelRatio},get prefersReducedMotion(){return!!ot.matchMedia&&(null==Ks&&(Ks=ot.matchMedia("(prefers-reduced-motion: reduce)")),Ks.matches)}};let gl;const bn={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==gl){const s=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{gl=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):s}catch(i){gl=s}}return gl},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ss={supported:!1,testSupport:function(s){!Sa&&os&&(Zl?_u(s):Js=s)}};let Js,os,Sa=!1,Zl=!1;function _u(s){const i=s.createTexture();s.bindTexture(s.TEXTURE_2D,i);try{if(s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,os),s.isContextLost())return;Ss.supported=!0}catch(o){}s.deleteTexture(i),Sa=!0}ot.document&&(os=ot.document.createElement("img"),os.onload=function(){Js&&_u(Js),Js=null,Zl=!0},os.onerror=function(){Sa=!0,Js=null},os.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const yu="01",Vi="NO_ACCESS_TOKEN";function ss(s){return 0===s.indexOf("mapbox:")}function _l(s){return bn.API_URL_REGEX.test(s)}const vu=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function vo(s){const i=s.match(vu);if(!i)throw new Error("Unable to parse URL object");return{protocol:i[1],authority:i[2],path:i[3]||"/",params:i[4]?i[4].split("&"):[]}}function Ds(s){const i=s.params.length?`?${s.params.join("&")}`:"";return`${s.protocol}://${s.authority}${s.path}${i}`}function Bd(s){if(!s)return null;const i=s.split(".");if(!i||3!==i.length)return null;try{return JSON.parse(decodeURIComponent(ot.atob(i[1]).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch(o){return null}}class xu{constructor(i){this.type=i,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(i){const o=Bd(bn.ACCESS_TOKEN);let c="";return c=o&&o.u?ot.btoa(encodeURIComponent(o.u).replace(/%([0-9A-F]{2})/g,(h,m)=>String.fromCharCode(Number("0x"+m)))):bn.ACCESS_TOKEN||"",i?`mapbox.eventData.${i}:${c}`:`mapbox.eventData:${c}`}fetchEventData(){const i=Mi("localStorage"),o=this.getStorageKey(),c=this.getStorageKey("uuid");if(i)try{const h=ot.localStorage.getItem(o);h&&(this.eventData=JSON.parse(h));const m=ot.localStorage.getItem(c);m&&(this.anonId=m)}catch(h){vi("Unable to read from LocalStorage")}}saveEventData(){const i=Mi("localStorage"),o=this.getStorageKey(),c=this.getStorageKey("uuid");if(i)try{ot.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&ot.localStorage.setItem(o,JSON.stringify(this.eventData))}catch(h){vi("Unable to write to LocalStorage")}}processRequests(i){}postEvent(i,o,c,h){if(!bn.EVENTS_URL)return;const m=vo(bn.EVENTS_URL);m.params.push(`access_token=${h||bn.ACCESS_TOKEN||""}`);const y={event:this.type,created:new Date(i).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"2.10.0",skuId:yu,userId:this.anonId},b=o?ji(y,o):y,A={url:Ds(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([b])};this.pendingRequest=Ye(A,E=>{this.pendingRequest=null,c(E),this.saveEventData(),this.processRequests(h)})}queueRequest(i,o){this.queue.push(i),this.processRequests(o)}}const bu=new class extends xu{constructor(s){super("appUserTurnstile"),this._customAccessToken=s}postTurnstileEvent(s,i){bn.EVENTS_URL&&bn.ACCESS_TOKEN&&Array.isArray(s)&&s.some(o=>ss(o)||_l(o))&&this.queueRequest(Date.now(),i)}processRequests(s){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const i=Bd(bn.ACCESS_TOKEN),o=i?i.u:bn.ACCESS_TOKEN;let c=o!==this.eventData.tokenU;gu(this.anonId)||(this.anonId=dl(),c=!0);const h=this.queue.shift();if(this.eventData.lastSuccess){const m=new Date(this.eventData.lastSuccess),y=new Date(h),b=(h-this.eventData.lastSuccess)/864e5;c=c||b>=1||b<-1||m.getDate()!==y.getDate()}else c=!0;c?this.postEvent(h,{"enabled.telemetry":!1},m=>{m||(this.eventData.lastSuccess=h,this.eventData.tokenU=o)},s):this.processRequests()}},wu=bu.postTurnstileEvent.bind(bu),Cu=new class extends xu{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(s,i,o,c){this.skuToken=i,this.errorCb=c,bn.EVENTS_URL&&(o||bn.ACCESS_TOKEN?this.queueRequest({id:s,timestamp:Date.now()},o):this.errorCb(new Error(Vi)))}processRequests(s){if(this.pendingRequest||0===this.queue.length)return;const{id:i,timestamp:o}=this.queue.shift();i&&this.success[i]||(this.anonId||this.fetchEventData(),gu(this.anonId)||(this.anonId=dl()),this.postEvent(o,{skuToken:this.skuToken},c=>{c?this.errorCb(c):i&&(this.success[i]=!0)},s))}},Wl=Cu.postMapLoadEvent.bind(Cu),Yl=new class extends xu{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(s,i,o,c){if(!bn.API_URL||!bn.SESSION_PATH)return;const h=vo(bn.API_URL+bn.SESSION_PATH);h.params.push(`sku=${i||""}`),h.params.push(`access_token=${c||bn.ACCESS_TOKEN||""}`);const m={url:Ds(h),headers:{"Content-Type":"text/plain"}};this.pendingRequest=st(m,y=>{this.pendingRequest=null,o(y),this.saveEventData(),this.processRequests(c)})}getSessionAPI(s,i,o,c){this.skuToken=i,this.errorCb=c,bn.SESSION_PATH&&bn.API_URL&&(o||bn.ACCESS_TOKEN?this.queueRequest({id:s,timestamp:Date.now()},o):this.errorCb(new Error(Vi)))}processRequests(s){if(this.pendingRequest||0===this.queue.length)return;const{id:i,timestamp:o}=this.queue.shift();i&&this.success[i]||this.getSession(o,this.skuToken,c=>{c?this.errorCb(c):i&&(this.success[i]=!0)},s)}},Au=Yl.getSessionAPI.bind(Yl),Is=new Set;let as,yl=500,Xl=50,Ar={};function vl(s){const i=H(s);let o,c;i&&i.forEach(m=>{const y=m.split("=");"language"===y[0]?o=y[1]:"worldview"===y[0]&&(c=y[1])});let h="mapbox-tiles";return o&&(h+=`-${o}`),c&&(h+=`-${c}`),h}function le(){try{return ot.caches}catch(s){}}function V(s){const i=le();i&&!Ar[s]&&(Ar[s]=i.open(s))}function H(s){const i=s.indexOf("?");return i>0?s.slice(i+1).split("&"):[]}function oe(s){const i=s.indexOf("?");if(i<0)return s;const o=H(s).filter(c=>{const h=c.split("=");return"language"===h[0]||"worldview"===h[0]});return o.length?`${s.slice(0,i)}?${o.join("&")}`:s.slice(0,i)}let ue=1/0;const be={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(be);class Te extends Error{constructor(i,o,c){401===o&&_l(c)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(i),this.status=o,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Ae=bi()?()=>self.worker&&self.worker.referrer:()=>("blob:"===ot.location.protocol?ot.parent:ot).location.href,we=function(s,i){if(!(/^file:/.test(o=s.url)||/^file:/.test(Ae())&&!/^\w+:/.test(o))){if(ot.fetch&&ot.Request&&ot.AbortController&&ot.Request.prototype.hasOwnProperty("signal"))return function(c,h){const m=new ot.AbortController,y=new ot.Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:Ae(),signal:m.signal});let b=!1,A=!1;const E=(P=y.url).indexOf("sku=")>0&&_l(P);var P;"json"===c.type&&y.headers.set("Accept","application/json");const k=(B,N,q)=>{if(A)return;if(B&&"SecurityError"!==B.message&&vi(B),N&&q)return R(N);const Q=Date.now();ot.fetch(y).then(se=>{if(se.ok){const he=E?se.clone():null;return R(se,he,Q)}return h(new Te(se.statusText,se.status,c.url))}).catch(se=>{20!==se.code&&h(new Error(se.message))})},R=(B,N,q)=>{("arrayBuffer"===c.type?B.arrayBuffer():"json"===c.type?B.json():B.text()).then(Q=>{A||(N&&q&&function(se,he,ae){const de=vl(se.url);if(V(de),!Ar[de])return;const ye={status:he.status,statusText:he.statusText,headers:new ot.Headers};he.headers.forEach((Pe,Fe)=>ye.headers.set(Fe,Pe));const me=is(he.headers.get("Cache-Control")||"");if(me["no-store"])return;me["max-age"]&&ye.headers.set("Expires",new Date(ae+1e3*me["max-age"]).toUTCString());const De=ye.headers.get("Expires");De&&(new Date(De).getTime()-ae<42e4||function(Pe,Fe){if(void 0===as)try{new Response(new ReadableStream),as=!0}catch(tt){as=!1}as?Fe(Pe.body):Pe.blob().then(Fe)}(he,Pe=>{const Fe=new ot.Response(Pe,ye);V(de),Ar[de]&&Ar[de].then(tt=>tt.put(oe(se.url),Fe)).catch(tt=>vi(tt.message))}))}(y,N,q),b=!0,h(null,Q,B.headers.get("Cache-Control"),B.headers.get("Expires")))}).catch(Q=>{A||h(new Error(Q.message))})};return E?function(B,N){const q=vl(B.url);if(V(q),!Ar[q])return N(null);const Q=oe(B.url);Ar[q].then(se=>{se.match(Q).then(he=>{const ae=function(de){if(!de)return!1;const ye=new Date(de.headers.get("Expires")||0),me=is(de.headers.get("Cache-Control")||"");return ye>Date.now()&&!me["no-cache"]}(he);se.delete(Q),ae&&se.put(Q,he.clone()),N(null,he,ae)}).catch(N)}).catch(N)}(y,k):k(null,null),{cancel:()=>{A=!0,b||m.abort()}}}(s,i);if(bi()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,i,void 0,!0)}var o;return function(c,h){const m=new ot.XMLHttpRequest;m.open(c.method||"GET",c.url,!0),"arrayBuffer"===c.type&&(m.responseType="arraybuffer");for(const y in c.headers)m.setRequestHeader(y,c.headers[y]);return"json"===c.type&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials="include"===c.credentials,m.onerror=()=>{h(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||0===m.status)&&null!==m.response){let y=m.response;if("json"===c.type)try{y=JSON.parse(m.response)}catch(b){return h(b)}h(null,y,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else h(new Te(m.statusText,m.status,c.url))},m.send(c.body),{cancel:()=>m.abort()}}(s,i)},Me=function(s,i){return we(ji(s,{type:"arrayBuffer"}),i)},Ye=function(s,i){return we(ji(s,{method:"POST"}),i)},st=function(s,i){return we(ji(s,{method:"GET"}),i)};function Xe(s){const i=ot.document.createElement("a");return i.href=s,i.protocol===ot.document.location.protocol&&i.host===ot.document.location.host}const St="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Ft,Pt;Ft=[],Pt=0;const Nt=function(s,i){if(Ss.supported&&(s.headers||(s.headers={}),s.headers.accept="image/webp,*/*"),Pt>=bn.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:s,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return Ft.push(m),m}Pt++;let o=!1;const c=()=>{if(!o)for(o=!0,Pt--;Ft.length&&Pt<bn.MAX_PARALLEL_IMAGE_REQUESTS;){const m=Ft.shift(),{requestParameters:y,callback:b,cancelled:A}=m;A||(m.cancel=Nt(y,b).cancel)}},h=Me(s,(m,y,b,A)=>{c(),m?i(m):y&&(ot.createImageBitmap?function(E,P){const k=new ot.Blob([new Uint8Array(E)],{type:"image/png"});ot.createImageBitmap(k).then(R=>{P(null,R)}).catch(R=>{P(new Error(`Could not load image because of ${R.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(y,(E,P)=>i(E,P,b,A)):function(E,P){const k=new ot.Image,R=ot.URL;k.onload=()=>{P(null,k),R.revokeObjectURL(k.src),k.onload=null,ot.requestAnimationFrame(()=>{k.src=St})},k.onerror=()=>P(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const B=new ot.Blob([new Uint8Array(E)],{type:"image/png"});k.src=E.byteLength?R.createObjectURL(B):St}(y,(E,P)=>i(E,P,b,A)))});return{cancel:()=>{h.cancel(),c()}}};function tn(s,i,o){o[s]&&-1!==o[s].indexOf(i)||(o[s]=o[s]||[],o[s].push(i))}function Ln(s,i,o){if(o&&o[s]){const c=o[s].indexOf(i);-1!==c&&o[s].splice(c,1)}}class Mn{constructor(i,o={}){ji(this,o),this.type=i}}class zn extends Mn{constructor(i,o={}){super("error",ji({error:i},o))}}class Rt{on(i,o){return this._listeners=this._listeners||{},tn(i,o,this._listeners),this}off(i,o){return Ln(i,o,this._listeners),Ln(i,o,this._oneTimeListeners),this}once(i,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},tn(i,o,this._oneTimeListeners),this):new Promise(c=>this.once(i,c))}fire(i,o){"string"==typeof i&&(i=new Mn(i,o||{}));const c=i.type;if(this.listens(c)){i.target=this;const h=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const b of h)b.call(this,i);const m=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const b of m)Ln(c,b,this._oneTimeListeners),b.call(this,i);const y=this._eventedParent;y&&(ji(i,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),y.fire(i))}else i instanceof zn&&console.error(i.error);return this}listens(i){return!!(this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i))}setEventedParent(i,o){return this._eventedParent=i,this._eventedParentData=o,this}}var Re=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Xr(s,...i){for(const o of i)for(const c in o)s[c]=o[c];return s}function yi(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function ea(s){if(Array.isArray(s))return s.map(ea);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const i={};for(const o in s)i[o]=ea(s[o]);return i}return yi(s)}class Eu extends Error{constructor(i,o){super(o),this.message=o,this.key=i}}var xo=Eu;class Tu{constructor(i,o=[]){this.parent=i,this.bindings={};for(const[c,h]of o)this.bindings[c]=h}concat(i){return new Tu(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}var Vf=Tu;const Si={kind:"null"},gt={kind:"number"},cn={kind:"string"},rn={kind:"boolean"},wn={kind:"color"},Qr={kind:"object"},Ct={kind:"value"},Da={kind:"collator"},Ql={kind:"formatted"},Ia={kind:"resolvedImage"};function Ut(s,i){return{kind:"array",itemType:s,N:i}}function ci(s){if("array"===s.kind){const i=ci(s.itemType);return"number"==typeof s.N?`array<${i}, ${s.N}>`:"value"===s.itemType.kind?"array":`array<${i}>`}return s.kind}const Uf=[Si,gt,cn,rn,wn,Ql,Qr,Ut(Ct),Ia];function En(s,i){if("error"===i.kind)return null;if("array"===s.kind){if("array"===i.kind&&(0===i.N&&"value"===i.itemType.kind||!En(s.itemType,i.itemType))&&("number"!=typeof s.N||s.N===i.N))return null}else{if(s.kind===i.kind)return null;if("value"===s.kind)for(const o of Uf)if(!En(o,i))return null}return`Expected ${ci(s)} but found ${ci(i)} instead.`}function xl(s,i){return i.some(o=>o.kind===s.kind)}function qt(s,i){return i.some(o=>"null"===o?null===s:"array"===o?Array.isArray(s):"object"===o?s&&!Array.isArray(s)&&"object"==typeof s:o===typeof s)}function Ui(s){var i={exports:{}};return s(i,i.exports),i.exports}var ta=Ui(function(s,i){var o={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function c(b){return(b=Math.round(b))<0?0:b>255?255:b}function h(b){return c("%"===b[b.length-1]?parseFloat(b)/100*255:parseInt(b))}function m(b){return(A="%"===b[b.length-1]?parseFloat(b)/100:parseFloat(b))<0?0:A>1?1:A;var A}function y(b,A,E){return E<0?E+=1:E>1&&(E-=1),6*E<1?b+(A-b)*E*6:2*E<1?A:3*E<2?b+(A-b)*(2/3-E)*6:b}try{i.parseCSSColor=function(b){var A,E=b.replace(/ /g,"").toLowerCase();if(E in o)return o[E].slice();if("#"===E[0])return 4===E.length?(A=parseInt(E.substr(1),16))>=0&&A<=4095?[(3840&A)>>4|(3840&A)>>8,240&A|(240&A)>>4,15&A|(15&A)<<4,1]:null:7===E.length&&(A=parseInt(E.substr(1),16))>=0&&A<=16777215?[(16711680&A)>>16,(65280&A)>>8,255&A,1]:null;var P=E.indexOf("("),k=E.indexOf(")");if(-1!==P&&k+1===E.length){var R=E.substr(0,P),B=E.substr(P+1,k-(P+1)).split(","),N=1;switch(R){case"rgba":if(4!==B.length)return null;N=m(B.pop());case"rgb":return 3!==B.length?null:[h(B[0]),h(B[1]),h(B[2]),N];case"hsla":if(4!==B.length)return null;N=m(B.pop());case"hsl":if(3!==B.length)return null;var q=(parseFloat(B[0])%360+360)%360/360,Q=m(B[1]),se=m(B[2]),he=se<=.5?se*(Q+1):se+Q-se*Q,ae=2*se-he;return[c(255*y(ae,he,q+1/3)),c(255*y(ae,he,q)),c(255*y(ae,he,q-1/3)),N];default:return null}}return null}}catch(b){}});class Rr{constructor(i,o,c,h=1){this.r=i,this.g=o,this.b=c,this.a=h}static parse(i){if(!i)return;if(i instanceof Rr)return i;if("string"!=typeof i)return;const o=ta.parseCSSColor(i);return o?new Rr(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3]):void 0}toString(){const[i,o,c,h]=this.toArray();return`rgba(${Math.round(i)},${Math.round(o)},${Math.round(c)},${h})`}toArray(){const{r:i,g:o,b:c,a:h}=this;return 0===h?[0,0,0,0]:[255*i/h,255*o/h,255*c/h,h]}toArray01(){const{r:i,g:o,b:c,a:h}=this;return 0===h?[0,0,0,0]:[i/h,o/h,c/h,h]}toArray01PremultipliedAlpha(){const{r:i,g:o,b:c,a:h}=this;return[i,o,c,h]}}Rr.black=new Rr(0,0,0,1),Rr.white=new Rr(1,1,1,1),Rr.transparent=new Rr(0,0,0,0),Rr.red=new Rr(1,0,0,1),Rr.blue=new Rr(0,0,1,1);var qn=Rr;class bl{constructor(i,o,c){this.sensitivity=i?o?"variant":"case":o?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,o){return this.collator.compare(i,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class er{constructor(i,o,c,h,m){this.text=i.normalize?i.normalize():i,this.image=o,this.scale=c,this.fontStack=h,this.textColor=m}}class Kr{constructor(i){this.sections=i}static fromString(i){return new Kr([new er(i,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(i=>0!==i.text.length||i.image&&0!==i.image.name.length)}static factory(i){return i instanceof Kr?i:Kr.fromString(i)}toString(){return 0===this.sections.length?"":this.sections.map(i=>i.text).join("")}serialize(){const i=["format"];for(const o of this.sections){if(o.image){i.push(["image",o.image.name]);continue}i.push(o.text);const c={};o.fontStack&&(c["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(c["font-scale"]=o.scale),o.textColor&&(c["text-color"]=["rgba"].concat(o.textColor.toArray())),i.push(c)}return i}}class Lr{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new Lr({name:i,available:!1}):null}serialize(){return["image",this.name]}}function Hh(s,i,o,c){return"number"==typeof s&&s>=0&&s<=255&&"number"==typeof i&&i>=0&&i<=255&&"number"==typeof o&&o>=0&&o<=255?void 0===c||"number"==typeof c&&c>=0&&c<=1?null:`Invalid rgba value [${[s,i,o,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof c?[s,i,o,c]:[s,i,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function dr(s){if(null===s||"string"==typeof s||"boolean"==typeof s||"number"==typeof s||s instanceof qn||s instanceof bl||s instanceof Kr||s instanceof Lr)return!0;if(Array.isArray(s)){for(const i of s)if(!dr(i))return!1;return!0}if("object"==typeof s){for(const i in s)if(!dr(s[i]))return!1;return!0}return!1}function Di(s){if(null===s)return Si;if("string"==typeof s)return cn;if("boolean"==typeof s)return rn;if("number"==typeof s)return gt;if(s instanceof qn)return wn;if(s instanceof bl)return Da;if(s instanceof Kr)return Ql;if(s instanceof Lr)return Ia;if(Array.isArray(s)){const i=s.length;let o;for(const c of s){const h=Di(c);if(o){if(o===h)continue;o=Ct;break}o=h}return Ut(o||Ct,i)}return Qr}function Mu(s){const i=typeof s;return null===s?"":"string"===i||"number"===i||"boolean"===i?String(s):s instanceof qn||s instanceof Kr||s instanceof Lr?s.toString():JSON.stringify(s)}class qh{constructor(i,o){this.type=i,this.value=o}static parse(i,o){if(2!==i.length)return o.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!dr(i[1]))return o.error("invalid value");const c=i[1];let h=Di(c);const m=o.expectedType;return"array"!==h.kind||0!==h.N||!m||"array"!==m.kind||"number"==typeof m.N&&0!==m.N||(h=m),new qh(h,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof qn?["rgba"].concat(this.value.toArray()):this.value instanceof Kr?this.value.serialize():this.value}}var Su=qh,Zi=class{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}};const Du={string:cn,number:gt,boolean:rn,object:Qr};class Nd{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");let c,h=1;const m=i[0];if("array"===m){let b,A;if(i.length>2){const E=i[1];if("string"!=typeof E||!(E in Du)||"object"===E)return o.error('The item type argument of "array" must be one of string, number, boolean',1);b=Du[E],h++}else b=Ct;if(i.length>3){if(null!==i[2]&&("number"!=typeof i[2]||i[2]<0||i[2]!==Math.floor(i[2])))return o.error('The length argument to "array" must be a positive integer literal',2);A=i[2],h++}c=Ut(b,A)}else c=Du[m];const y=[];for(;h<i.length;h++){const b=o.parse(i[h],h,Ct);if(!b)return null;y.push(b)}return new Nd(c,y)}evaluate(i){for(let o=0;o<this.args.length;o++){const c=this.args[o].evaluate(i);if(!En(this.type,Di(c)))return c;if(o===this.args.length-1)throw new Zi(`Expected value to be of type ${ci(this.type)}, but found ${ci(Di(c))} instead.`)}return null}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=this.type,o=[i.kind];if("array"===i.kind){const c=i.itemType;if("string"===c.kind||"number"===c.kind||"boolean"===c.kind){o.push(c.kind);const h=i.N;("number"==typeof h||this.args.length>1)&&o.push(h)}}return o.concat(this.args.map(c=>c.serialize()))}}var Ro=Nd;class tr{constructor(i){this.type=Ql,this.sections=i}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");const c=i[1];if(!Array.isArray(c)&&"object"==typeof c)return o.error("First argument must be an image or text section.");const h=[];let m=!1;for(let y=1;y<=i.length-1;++y){const b=i[y];if(m&&"object"==typeof b&&!Array.isArray(b)){m=!1;let A=null;if(b["font-scale"]&&(A=o.parse(b["font-scale"],1,gt),!A))return null;let E=null;if(b["text-font"]&&(E=o.parse(b["text-font"],1,Ut(cn)),!E))return null;let P=null;if(b["text-color"]&&(P=o.parse(b["text-color"],1,wn),!P))return null;const k=h[h.length-1];k.scale=A,k.font=E,k.textColor=P}else{const A=o.parse(i[y],1,Ct);if(!A)return null;const E=A.type.kind;if("string"!==E&&"value"!==E&&"null"!==E&&"resolvedImage"!==E)return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,h.push({content:A,scale:null,font:null,textColor:null})}}return new tr(h)}evaluate(i){return new Kr(this.sections.map(o=>{const c=o.content.evaluate(i);return Di(c)===Ia?new er("",c,null,null,null):new er(Mu(c),null,o.scale?o.scale.evaluate(i):null,o.font?o.font.evaluate(i).join(","):null,o.textColor?o.textColor.evaluate(i):null)}))}eachChild(i){for(const o of this.sections)i(o.content),o.scale&&i(o.scale),o.font&&i(o.font),o.textColor&&i(o.textColor)}outputDefined(){return!1}serialize(){const i=["format"];for(const o of this.sections){i.push(o.content.serialize());const c={};o.scale&&(c["font-scale"]=o.scale.serialize()),o.font&&(c["text-font"]=o.font.serialize()),o.textColor&&(c["text-color"]=o.textColor.serialize()),i.push(c)}return i}}class Zn{constructor(i){this.type=Ia,this.input=i}static parse(i,o){if(2!==i.length)return o.error("Expected two arguments.");const c=o.parse(i[1],1,cn);return c?new Zn(c):o.error("No image name provided.")}evaluate(i){const o=this.input.evaluate(i),c=Lr.fromString(o);return c&&i.availableImages&&(c.available=i.availableImages.indexOf(o)>-1),c}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Yg={"to-boolean":rn,"to-color":wn,"to-number":gt,"to-string":cn};class Zh{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");const c=i[0];if(("to-boolean"===c||"to-string"===c)&&2!==i.length)return o.error("Expected one argument.");const h=Yg[c],m=[];for(let y=1;y<i.length;y++){const b=o.parse(i[y],y,Ct);if(!b)return null;m.push(b)}return new Zh(h,m)}evaluate(i){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(i));if("color"===this.type.kind){let o,c;for(const h of this.args){if(o=h.evaluate(i),c=null,o instanceof qn)return o;if("string"==typeof o){const m=i.parseColor(o);if(m)return m}else if(Array.isArray(o)&&(c=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:Hh(o[0],o[1],o[2],o[3]),!c))return new qn(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Zi(c||`Could not parse color from value '${"string"==typeof o?o:String(JSON.stringify(o))}'`)}if("number"===this.type.kind){let o=null;for(const c of this.args){if(o=c.evaluate(i),null===o)return 0;const h=Number(o);if(!isNaN(h))return h}throw new Zi(`Could not convert ${JSON.stringify(o)} to number.`)}return"formatted"===this.type.kind?Kr.fromString(Mu(this.args[0].evaluate(i))):"resolvedImage"===this.type.kind?Lr.fromString(Mu(this.args[0].evaluate(i))):Mu(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){if("formatted"===this.type.kind)return new tr([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Zn(this.args[0]).serialize();const i=[`to-${this.type.kind}`];return this.eachChild(o=>{i.push(o.serialize())}),i}}var Kl=Zh;const Sn=["Unknown","Point","LineString","Polygon"];var $f=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Sn[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const s=this.featureDistanceData.center,i=this.featureDistanceData.scale,{x:o,y:c}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(o*i-s[0])+this.featureDistanceData.bearing[1]*(c*i-s[1])}return 0}parseColor(s){let i=this._parseColorCache[s];return i||(i=this._parseColorCache[s]=qn.parse(s)),i}};class Li{constructor(i,o,c,h){this.name=i,this.type=o,this._evaluate=c,this.args=h}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(i=>i.serialize()))}static parse(i,o){const c=i[0],h=Li.definitions[c];if(!h)return o.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,b=y.filter(([E])=>!Array.isArray(E)||E.length===i.length-1);let A=null;for(const[E,P]of b){A=new wl(o.registry,o.path,null,o.scope);const k=[];let R=!1;for(let B=1;B<i.length;B++){const N=i[B],q=Array.isArray(E)?E[B-1]:E.type,Q=A.parse(N,1+k.length,q);if(!Q){R=!0;break}k.push(Q)}if(!R)if(Array.isArray(E)&&E.length!==k.length)A.error(`Expected ${E.length} arguments, but found ${k.length} instead.`);else{for(let B=0;B<k.length;B++){const N=Array.isArray(E)?E[B]:E.type,q=k[B];A.concat(B+1).checkSubtype(N,q.type)}if(0===A.errors.length)return new Li(c,m,P,k)}}if(1===b.length)o.errors.push(...A.errors);else{const E=(b.length?b:y).map(([k])=>{return R=k,Array.isArray(R)?`(${R.map(ci).join(", ")})`:`(${ci(R.type)}...)`;var R}).join(" | "),P=[];for(let k=1;k<i.length;k++){const R=o.parse(i[k],1+P.length);if(!R)return null;P.push(ci(R.type))}o.error(`Expected arguments of type ${E}, but found (${P.join(", ")}) instead.`)}return null}static register(i,o){Li.definitions=o;for(const c in o)i[c]=Li}}var Jr=Li;class Jl{constructor(i,o,c){this.type=Da,this.locale=c,this.caseSensitive=i,this.diacriticSensitive=o}static parse(i,o){if(2!==i.length)return o.error("Expected one argument.");const c=i[1];if("object"!=typeof c||Array.isArray(c))return o.error("Collator options argument must be an object.");const h=o.parse(void 0!==c["case-sensitive"]&&c["case-sensitive"],1,rn);if(!h)return null;const m=o.parse(void 0!==c["diacritic-sensitive"]&&c["diacritic-sensitive"],1,rn);if(!m)return null;let y=null;return c.locale&&(y=o.parse(c.locale,1,cn),!y)?null:new Jl(h,m,y)}evaluate(i){return new bl(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}serialize(){const i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]}}const na=8192;function jd(s,i){s[0]=Math.min(s[0],i[0]),s[1]=Math.min(s[1],i[1]),s[2]=Math.max(s[2],i[0]),s[3]=Math.max(s[3],i[1])}function ec(s,i){return!(s[0]<=i[0]||s[2]>=i[2]||s[1]<=i[1]||s[3]>=i[3])}function Iu(s,i){const o=(180+s[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,h=Math.pow(2,i.z);return[Math.round(o*h*na),Math.round(c*h*na)]}function Vd(s,i,o){const c=s[0]-i[0],h=s[1]-i[1],m=s[0]-o[0],y=s[1]-o[1];return c*y-m*h==0&&c*m<=0&&h*y<=0}function tc(s,i){let o=!1;for(let y=0,b=i.length;y<b;y++){const A=i[y];for(let E=0,P=A.length;E<P-1;E++){if(Vd(s,A[E],A[E+1]))return!1;(h=A[E])[1]>(c=s)[1]!=(m=A[E+1])[1]>c[1]&&c[0]<(m[0]-h[0])*(c[1]-h[1])/(m[1]-h[1])+h[0]&&(o=!o)}}var c,h,m;return o}function Pu(s,i){for(let o=0;o<i.length;o++)if(tc(s,i[o]))return!0;return!1}function nn(s,i,o,c){const h=c[0]-o[0],m=c[1]-o[1],y=(s[0]-o[0])*m-h*(s[1]-o[1]),b=(i[0]-o[0])*m-h*(i[1]-o[1]);return y>0&&b<0||y<0&&b>0}function Ud(s,i,o){for(const E of o)for(let P=0;P<E.length-1;++P)if((b=[(y=E[P+1])[0]-(m=E[P])[0],y[1]-m[1]])[0]*(A=[(h=i)[0]-(c=s)[0],h[1]-c[1]])[1]-b[1]*A[0]!=0&&nn(c,h,m,y)&&nn(m,y,c,h))return!0;var c,h,m,y,b,A;return!1}function Wh(s,i){for(let o=0;o<s.length;++o)if(!tc(s[o],i))return!1;for(let o=0;o<s.length-1;++o)if(Ud(s[o],s[o+1],i))return!1;return!0}function ia(s,i){for(let o=0;o<i.length;o++)if(Wh(s,i[o]))return!0;return!1}function eo(s,i,o){const c=[];for(let h=0;h<s.length;h++){const m=[];for(let y=0;y<s[h].length;y++){const b=Iu(s[h][y],o);jd(i,b),m.push(b)}c.push(m)}return c}function Yh(s,i,o){const c=[];for(let h=0;h<s.length;h++){const m=eo(s[h],i,o);c.push(m)}return c}function ls(s,i,o,c){if(s[0]<o[0]||s[0]>o[2]){const h=.5*c;let m=s[0]-o[0]>h?-c:o[0]-s[0]>h?c:0;0===m&&(m=s[0]-o[2]>h?-c:o[2]-s[0]>h?c:0),s[0]+=m}jd(i,s)}function to(s,i,o,c){const h=Math.pow(2,c.z)*na,m=[c.x*na,c.y*na],y=[];if(!s)return y;for(const b of s)for(const A of b){const E=[A.x+m[0],A.y+m[1]];ls(E,i,o,h),y.push(E)}return y}function Xh(s,i,o,c){const h=Math.pow(2,c.z)*na,m=[c.x*na,c.y*na],y=[];if(!s)return y;for(const A of s){const E=[];for(const P of A){const k=[P.x+m[0],P.y+m[1]];jd(i,k),E.push(k)}y.push(E)}if(i[2]-i[0]<=h/2){(b=i)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const A of y)for(const E of A)ls(E,i,o,h)}var b;return y}class nc{constructor(i,o){this.type=rn,this.geojson=i,this.geometries=o}static parse(i,o){if(2!==i.length)return o.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(dr(i[1])){const c=i[1];if("FeatureCollection"===c.type)for(let h=0;h<c.features.length;++h){const m=c.features[h].geometry.type;if("Polygon"===m||"MultiPolygon"===m)return new nc(c,c.features[h].geometry)}else if("Feature"===c.type){const h=c.geometry.type;if("Polygon"===h||"MultiPolygon"===h)return new nc(c,c.geometry)}else if("Polygon"===c.type||"MultiPolygon"===c.type)return new nc(c,c)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(null!=i.geometry()&&null!=i.canonicalID()){if("Point"===i.geometryType())return function(o,c){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=o.canonicalID();if(!y)return!1;if("Polygon"===c.type){const b=eo(c.coordinates,m,y),A=to(o.geometry(),h,m,y);if(!ec(h,m))return!1;for(const E of A)if(!tc(E,b))return!1}if("MultiPolygon"===c.type){const b=Yh(c.coordinates,m,y),A=to(o.geometry(),h,m,y);if(!ec(h,m))return!1;for(const E of A)if(!Pu(E,b))return!1}return!0}(i,this.geometries);if("LineString"===i.geometryType())return function(o,c){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=o.canonicalID();if(!y)return!1;if("Polygon"===c.type){const b=eo(c.coordinates,m,y),A=Xh(o.geometry(),h,m,y);if(!ec(h,m))return!1;for(const E of A)if(!Wh(E,b))return!1}if("MultiPolygon"===c.type){const b=Yh(c.coordinates,m,y),A=Xh(o.geometry(),h,m,y);if(!ec(h,m))return!1;for(const E of A)if(!ia(E,b))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var no=nc;function Pa(s){if(s instanceof Jr&&("get"===s.name&&1===s.args.length||"feature-state"===s.name||"has"===s.name&&1===s.args.length||"properties"===s.name||"geometry-type"===s.name||"id"===s.name||/^filter-/.test(s.name))||s instanceof no)return!1;let i=!0;return s.eachChild(o=>{i&&!Pa(o)&&(i=!1)}),i}function ra(s){if(s instanceof Jr&&"feature-state"===s.name)return!1;let i=!0;return s.eachChild(o=>{i&&!ra(o)&&(i=!1)}),i}function ic(s,i){if(s instanceof Jr&&i.indexOf(s.name)>=0)return!1;let o=!0;return s.eachChild(c=>{o&&!ic(c,i)&&(o=!1)}),o}class $d{constructor(i,o){this.type=o.type,this.name=i,this.boundExpression=o}static parse(i,o){if(2!==i.length||"string"!=typeof i[1])return o.error("'var' expression requires exactly one string literal argument.");const c=i[1];return o.scope.has(c)?new $d(c,o.scope.get(c)):o.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Vn=$d;class Gd{constructor(i,o=[],c,h=new Vf,m=[]){this.registry=i,this.path=o,this.key=o.map(y=>`[${y}]`).join(""),this.scope=h,this.errors=m,this.expectedType=c}parse(i,o,c,h,m={}){return o?this.concat(o,c,h)._parse(i,m):this._parse(i,m)}_parse(i,o){function c(h,m,y){return"assert"===y?new Ro(m,[h]):"coerce"===y?new Kl(m,[h]):h}if(null!==i&&"string"!=typeof i&&"boolean"!=typeof i&&"number"!=typeof i||(i=["literal",i]),Array.isArray(i)){if(0===i.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=i[0];if("string"!=typeof h)return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[h];if(m){let y=m.parse(i,this);if(!y)return null;if(this.expectedType){const b=this.expectedType,A=y.type;if("string"!==b.kind&&"number"!==b.kind&&"boolean"!==b.kind&&"object"!==b.kind&&"array"!==b.kind||"value"!==A.kind)if("color"!==b.kind&&"formatted"!==b.kind&&"resolvedImage"!==b.kind||"value"!==A.kind&&"string"!==A.kind){if(this.checkSubtype(b,A))return null}else y=c(y,b,o.typeAnnotation||"coerce");else y=c(y,b,o.typeAnnotation||"assert")}if(!(y instanceof Su)&&"resolvedImage"!==y.type.kind&&fn(y)){const b=new $f;try{y=new Su(y.type,y.evaluate(b))}catch(A){return this.error(A.message),null}}return y}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===i?"'undefined' value invalid. Use null instead.":"object"==typeof i?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,o,c){const h="number"==typeof i?this.path.concat(i):this.path,m=c?this.scope.concat(c):this.scope;return new Gd(this.registry,h,o||null,m,this.errors)}error(i,...o){const c=`${this.key}${o.map(h=>`[${h}]`).join("")}`;this.errors.push(new xo(c,i))}checkSubtype(i,o){const c=En(i,o);return c&&this.error(c),c}}var wl=Gd;function fn(s){if(s instanceof Vn)return fn(s.boundExpression);if(s instanceof Jr&&"error"===s.name||s instanceof Jl||s instanceof no)return!1;const i=s instanceof Kl||s instanceof Ro;let o=!0;return s.eachChild(c=>{o=i?o&&fn(c):o&&c instanceof Su}),!!o&&Pa(s)&&ic(s,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Wn(s,i){const o=s.length-1;let c,h,m=0,y=o,b=0;for(;m<=y;)if(b=Math.floor((m+y)/2),c=s[b],h=s[b+1],c<=i){if(b===o||i<h)return b;m=b+1}else{if(!(c>i))throw new Zi("Input is not a number.");y=b-1}return 0}class Cl{constructor(i,o,c){this.type=i,this.input=o,this.labels=[],this.outputs=[];for(const[h,m]of c)this.labels.push(h),this.outputs.push(m)}static parse(i,o){if(i.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return o.error("Expected an even number of arguments.");const c=o.parse(i[1],1,gt);if(!c)return null;const h=[];let m=null;o.expectedType&&"value"!==o.expectedType.kind&&(m=o.expectedType);for(let y=1;y<i.length;y+=2){const b=1===y?-1/0:i[y],A=i[y+1],E=y,P=y+1;if("number"!=typeof b)return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',E);if(h.length&&h[h.length-1][0]>=b)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',E);const k=o.parse(A,P,m);if(!k)return null;m=m||k.type,h.push([b,k])}return new Cl(m,c,h)}evaluate(i){const o=this.labels,c=this.outputs;if(1===o.length)return c[0].evaluate(i);const h=this.input.evaluate(i);if(h<=o[0])return c[0].evaluate(i);const m=o.length;return h>=o[m-1]?c[m-1].evaluate(i):c[Wn(o,h)].evaluate(i)}eachChild(i){i(this.input);for(const o of this.outputs)i(o)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){const i=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&i.push(this.labels[o]),i.push(this.outputs[o].serialize());return i}}var rc=Cl;function _n(s,i,o){return s*(1-o)+i*o}function Oa(s,i,o){return s.map((c,h)=>_n(c,i[h],o))}var io=Object.freeze({__proto__:null,number:_n,color:function(s,i,o){return new qn(_n(s.r,i.r,o),_n(s.g,i.g,o),_n(s.b,i.b,o),_n(s.a,i.a,o))},array:Oa});const ti=4/29,oa=6/29,Al=3*oa*oa,Qh=Math.PI/180,Ou=180/Math.PI;function hr(s){return s>.008856451679035631?Math.pow(s,1/3):s/Al+ti}function qd(s){return s>oa?s*s*s:Al*(s-ti)}function ku(s){return 255*(s<=.0031308?12.92*s:1.055*Math.pow(s,1/2.4)-.055)}function zi(s){return(s/=255)<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function Er(s){const i=zi(s.r),o=zi(s.g),c=zi(s.b),h=hr((.4124564*i+.3575761*o+.1804375*c)/.95047),m=hr((.2126729*i+.7151522*o+.072175*c)/1);return{l:116*m-16,a:500*(h-m),b:200*(m-hr((.0193339*i+.119192*o+.9503041*c)/1.08883)),alpha:s.a}}function Wi(s){let i=(s.l+16)/116,o=isNaN(s.a)?i:i+s.a/500,c=isNaN(s.b)?i:i-s.b/200;return i=1*qd(i),o=.95047*qd(o),c=1.08883*qd(c),new qn(ku(3.2404542*o-1.5371385*i-.4985314*c),ku(-.969266*o+1.8760108*i+.041556*c),ku(.0556434*o-.2040259*i+1.0572252*c),s.alpha)}function Ps(s,i,o){const c=i-s;return s+o*(c>180||c<-180?c-360*Math.round(c/360):c)}const Lo={forward:Er,reverse:Wi,interpolate:function(s,i,o){return{l:_n(s.l,i.l,o),a:_n(s.a,i.a,o),b:_n(s.b,i.b,o),alpha:_n(s.alpha,i.alpha,o)}}},nr={forward:function(s){const{l:i,a:o,b:c}=Er(s),h=Math.atan2(c,o)*Ou;return{h:h<0?h+360:h,c:Math.sqrt(o*o+c*c),l:i,alpha:s.a}},reverse:function(s){const i=s.h*Qh,o=s.c;return Wi({l:s.l,a:Math.cos(i)*o,b:Math.sin(i)*o,alpha:s.alpha})},interpolate:function(s,i,o){return{h:Ps(s.h,i.h,o),c:_n(s.c,i.c,o),l:_n(s.l,i.l,o),alpha:_n(s.alpha,i.alpha,o)}}};var oc=Object.freeze({__proto__:null,lab:Lo,hcl:nr});class Ra{constructor(i,o,c,h,m){this.type=i,this.operator=o,this.interpolation=c,this.input=h,this.labels=[],this.outputs=[];for(const[y,b]of m)this.labels.push(y),this.outputs.push(b)}static interpolationFactor(i,o,c,h){let m=0;if("exponential"===i.name)m=sa(o,i.base,c,h);else if("linear"===i.name)m=sa(o,1,c,h);else if("cubic-bezier"===i.name){const y=i.controlPoints;m=new Ws(y[0],y[1],y[2],y[3]).solve(sa(o,1,c,h))}return m}static parse(i,o){let[c,h,m,...y]=i;if(!Array.isArray(h)||0===h.length)return o.error("Expected an interpolation type expression.",1);if("linear"===h[0])h={name:"linear"};else if("exponential"===h[0]){const E=h[1];if("number"!=typeof E)return o.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:E}}else{if("cubic-bezier"!==h[0])return o.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const E=h.slice(1);if(4!==E.length||E.some(P=>"number"!=typeof P||P<0||P>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:E}}}if(i.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(m=o.parse(m,2,gt),!m)return null;const b=[];let A=null;"interpolate-hcl"===c||"interpolate-lab"===c?A=wn:o.expectedType&&"value"!==o.expectedType.kind&&(A=o.expectedType);for(let E=0;E<y.length;E+=2){const P=y[E],k=y[E+1],R=E+3,B=E+4;if("number"!=typeof P)return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(b.length&&b[b.length-1][0]>=P)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',R);const N=o.parse(k,B,A);if(!N)return null;A=A||N.type,b.push([P,N])}return"number"===A.kind||"color"===A.kind||"array"===A.kind&&"number"===A.itemType.kind&&"number"==typeof A.N?new Ra(A,c,h,m,b):o.error(`Type ${ci(A)} is not interpolatable.`)}evaluate(i){const o=this.labels,c=this.outputs;if(1===o.length)return c[0].evaluate(i);const h=this.input.evaluate(i);if(h<=o[0])return c[0].evaluate(i);const m=o.length;if(h>=o[m-1])return c[m-1].evaluate(i);const y=Wn(o,h),b=Ra.interpolationFactor(this.interpolation,h,o[y],o[y+1]),A=c[y].evaluate(i),E=c[y+1].evaluate(i);return"interpolate"===this.operator?io[this.type.kind.toLowerCase()](A,E,b):"interpolate-hcl"===this.operator?nr.reverse(nr.interpolate(nr.forward(A),nr.forward(E),b)):Lo.reverse(Lo.interpolate(Lo.forward(A),Lo.forward(E),b))}eachChild(i){i(this.input);for(const o of this.outputs)i(o)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){let i;i="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const o=[this.operator,i,this.input.serialize()];for(let c=0;c<this.labels.length;c++)o.push(this.labels[c],this.outputs[c].serialize());return o}}function sa(s,i,o,c){const h=c-o,m=s-o;return 0===h?0:1===i?m/h:(Math.pow(i,m)-1)/(Math.pow(i,h)-1)}var ro=Ra;class Os{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expectected at least one argument.");let c=null;const h=o.expectedType;h&&"value"!==h.kind&&(c=h);const m=[];for(const b of i.slice(1)){const A=o.parse(b,1+m.length,c,void 0,{typeAnnotation:"omit"});if(!A)return null;c=c||A.type,m.push(A)}const y=h&&m.some(b=>En(h,b.type));return new Os(y?Ct:c,m)}evaluate(i){let o,c=null,h=0;for(const m of this.args){if(h++,c=m.evaluate(i),c&&c instanceof Lr&&!c.available&&(o||(o=c),c=null,h===this.args.length))return o;if(null!==c)break}return c}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=["coalesce"];return this.eachChild(o=>{i.push(o.serialize())}),i}}var ir=Os;class Zd{constructor(i,o){this.type=o.type,this.bindings=[].concat(i),this.result=o}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const o of this.bindings)i(o[1]);i(this.result)}static parse(i,o){if(i.length<4)return o.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const c=[];for(let m=1;m<i.length-1;m+=2){const y=i[m];if("string"!=typeof y)return o.error(`Expected string, but found ${typeof y} instead.`,m);if(/[^a-zA-Z0-9_]/.test(y))return o.error("Variable names must contain only alphanumeric characters or '_'.",m);const b=o.parse(i[m+1],m+1);if(!b)return null;c.push([y,b])}const h=o.parse(i[i.length-1],i.length-1,o.expectedType,c);return h?new Zd(c,h):null}outputDefined(){return this.result.outputDefined()}serialize(){const i=["let"];for(const[o,c]of this.bindings)i.push(o,c.serialize());return i.push(this.result.serialize()),i}}var oo=Zd;class At{constructor(i,o,c){this.type=i,this.index=o,this.input=c}static parse(i,o){if(3!==i.length)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const c=o.parse(i[1],1,gt),h=o.parse(i[2],2,Ut(o.expectedType||Ct));return c&&h?new At(h.type.itemType,c,h):null}evaluate(i){const o=this.index.evaluate(i),c=this.input.evaluate(i);if(o<0)throw new Zi(`Array index out of bounds: ${o} < 0.`);if(o>=c.length)throw new Zi(`Array index out of bounds: ${o} > ${c.length-1}.`);if(o!==Math.floor(o))throw new Zi(`Array index must be an integer, but found ${o} instead.`);return c[o]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var yn=At;class ui{constructor(i,o){this.type=rn,this.needle=i,this.haystack=o}static parse(i,o){if(3!==i.length)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const c=o.parse(i[1],1,Ct),h=o.parse(i[2],2,Ct);return c&&h?xl(c.type,[rn,cn,gt,Si,Ct])?new ui(c,h):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ci(c.type)} instead`):null}evaluate(i){const o=this.needle.evaluate(i),c=this.haystack.evaluate(i);if(null==c)return!1;if(!qt(o,["boolean","string","number","null"]))throw new Zi(`Expected first argument to be of type boolean, string, number or null, but found ${ci(Di(o))} instead.`);if(!qt(c,["string","array"]))throw new Zi(`Expected second argument to be of type array or string, but found ${ci(Di(c))} instead.`);return c.indexOf(o)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var so=ui;class cs{constructor(i,o,c){this.type=gt,this.needle=i,this.haystack=o,this.fromIndex=c}static parse(i,o){if(i.length<=2||i.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const c=o.parse(i[1],1,Ct),h=o.parse(i[2],2,Ct);if(!c||!h)return null;if(!xl(c.type,[rn,cn,gt,Si,Ct]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ci(c.type)} instead`);if(4===i.length){const m=o.parse(i[3],3,gt);return m?new cs(c,h,m):null}return new cs(c,h)}evaluate(i){const o=this.needle.evaluate(i),c=this.haystack.evaluate(i);if(!qt(o,["boolean","string","number","null"]))throw new Zi(`Expected first argument to be of type boolean, string, number or null, but found ${ci(Di(o))} instead.`);if(!qt(c,["string","array"]))throw new Zi(`Expected second argument to be of type array or string, but found ${ci(Di(c))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(i);return c.indexOf(o,h)}return c.indexOf(o)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Yi=cs;class us{constructor(i,o,c,h,m,y){this.inputType=i,this.type=o,this.input=c,this.cases=h,this.outputs=m,this.otherwise=y}static parse(i,o){if(i.length<5)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return o.error("Expected an even number of arguments.");let c,h;o.expectedType&&"value"!==o.expectedType.kind&&(h=o.expectedType);const m={},y=[];for(let E=2;E<i.length-1;E+=2){let P=i[E];const k=i[E+1];Array.isArray(P)||(P=[P]);const R=o.concat(E);if(0===P.length)return R.error("Expected at least one branch label.");for(const N of P){if("number"!=typeof N&&"string"!=typeof N)return R.error("Branch labels must be numbers or strings.");if("number"==typeof N&&Math.abs(N)>Number.MAX_SAFE_INTEGER)return R.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof N&&Math.floor(N)!==N)return R.error("Numeric branch labels must be integer values.");if(c){if(R.checkSubtype(c,Di(N)))return null}else c=Di(N);if(void 0!==m[String(N)])return R.error("Branch labels must be unique.");m[String(N)]=y.length}const B=o.parse(k,E,h);if(!B)return null;h=h||B.type,y.push(B)}const b=o.parse(i[1],1,Ct);if(!b)return null;const A=o.parse(i[i.length-1],i.length-1,h);return A?"value"!==b.type.kind&&o.concat(1).checkSubtype(c,b.type)?null:new us(c,h,b,m,y,A):null}evaluate(i){const o=this.input.evaluate(i);return(Di(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),c=[],h={};for(const y of o){const b=h[this.cases[y]];void 0===b?(h[this.cases[y]]=c.length,c.push([this.cases[y],[y]])):c[b][1].push(y)}const m=y=>"number"===this.inputType.kind?Number(y):y;for(const[y,b]of c)i.push(1===b.length?m(b[0]):b.map(m)),i.push(this.outputs[y].serialize());return i.push(this.otherwise.serialize()),i}}var Ci=us;class aa{constructor(i,o,c){this.type=i,this.branches=o,this.otherwise=c}static parse(i,o){if(i.length<4)return o.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return o.error("Expected an odd number of arguments.");let c;o.expectedType&&"value"!==o.expectedType.kind&&(c=o.expectedType);const h=[];for(let y=1;y<i.length-1;y+=2){const b=o.parse(i[y],y,rn);if(!b)return null;const A=o.parse(i[y+1],y+1,c);if(!A)return null;h.push([b,A]),c=c||A.type}const m=o.parse(i[i.length-1],i.length-1,c);return m?new aa(c,h,m):null}evaluate(i){for(const[o,c]of this.branches)if(o.evaluate(i))return c.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[o,c]of this.branches)i(o),i(c);i(this.otherwise)}outputDefined(){return this.branches.every(([i,o])=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["case"];return this.eachChild(o=>{i.push(o.serialize())}),i}}var El=aa;class an{constructor(i,o,c,h){this.type=i,this.input=o,this.beginIndex=c,this.endIndex=h}static parse(i,o){if(i.length<=2||i.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const c=o.parse(i[1],1,Ct),h=o.parse(i[2],2,gt);if(!c||!h)return null;if(!xl(c.type,[Ut(Ct),cn,Ct]))return o.error(`Expected first argument to be of type array or string, but found ${ci(c.type)} instead`);if(4===i.length){const m=o.parse(i[3],3,gt);return m?new an(c.type,c,h,m):null}return new an(c.type,c,h)}evaluate(i){const o=this.input.evaluate(i),c=this.beginIndex.evaluate(i);if(!qt(o,["string","array"]))throw new Zi(`Expected first argument to be of type array or string, but found ${ci(Di(o))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(i);return o.slice(c,h)}return o.slice(c)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var sc=an;function la(s,i){return"=="===s||"!="===s?"boolean"===i.kind||"string"===i.kind||"number"===i.kind||"null"===i.kind||"value"===i.kind:"string"===i.kind||"number"===i.kind||"value"===i.kind}function ac(s,i,o,c){return 0===c.compare(i,o)}function zo(s,i,o){const c="=="!==s&&"!="!==s;return class dT{constructor(m,y,b){this.type=rn,this.lhs=m,this.rhs=y,this.collator=b,this.hasUntypedArgument="value"===m.type.kind||"value"===y.type.kind}static parse(m,y){if(3!==m.length&&4!==m.length)return y.error("Expected two or three arguments.");const b=m[0];let A=y.parse(m[1],1,Ct);if(!A)return null;if(!la(b,A.type))return y.concat(1).error(`"${b}" comparisons are not supported for type '${ci(A.type)}'.`);let E=y.parse(m[2],2,Ct);if(!E)return null;if(!la(b,E.type))return y.concat(2).error(`"${b}" comparisons are not supported for type '${ci(E.type)}'.`);if(A.type.kind!==E.type.kind&&"value"!==A.type.kind&&"value"!==E.type.kind)return y.error(`Cannot compare types '${ci(A.type)}' and '${ci(E.type)}'.`);c&&("value"===A.type.kind&&"value"!==E.type.kind?A=new Ro(E.type,[A]):"value"!==A.type.kind&&"value"===E.type.kind&&(E=new Ro(A.type,[E])));let P=null;if(4===m.length){if("string"!==A.type.kind&&"string"!==E.type.kind&&"value"!==A.type.kind&&"value"!==E.type.kind)return y.error("Cannot use collator to compare non-string types.");if(P=y.parse(m[3],3,Da),!P)return null}return new dT(A,E,P)}evaluate(m){const y=this.lhs.evaluate(m),b=this.rhs.evaluate(m);if(c&&this.hasUntypedArgument){const A=Di(y),E=Di(b);if(A.kind!==E.kind||"string"!==A.kind&&"number"!==A.kind)throw new Zi(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${A.kind}, ${E.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const A=Di(y),E=Di(b);if("string"!==A.kind||"string"!==E.kind)return i(m,y,b)}return this.collator?o(m,y,b,this.collator.evaluate(m)):i(m,y,b)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}serialize(){const m=[s];return this.eachChild(y=>{m.push(y.serialize())}),m}}}const zr=zo("==",function(s,i,o){return i===o},ac),lc=zo("!=",function(s,i,o){return i!==o},function(s,i,o,c){return!ac(0,i,o,c)}),Tl=zo("<",function(s,i,o){return i<o},function(s,i,o,c){return c.compare(i,o)<0}),Fr=zo(">",function(s,i,o){return i>o},function(s,i,o,c){return c.compare(i,o)>0}),ri=zo("<=",function(s,i,o){return i<=o},function(s,i,o,c){return c.compare(i,o)<=0}),Kh=zo(">=",function(s,i,o){return i>=o},function(s,i,o,c){return c.compare(i,o)>=0});class Wd{constructor(i,o,c,h,m,y){this.type=cn,this.number=i,this.locale=o,this.currency=c,this.unit=h,this.minFractionDigits=m,this.maxFractionDigits=y}static parse(i,o){if(3!==i.length)return o.error("Expected two arguments.");const c=o.parse(i[1],1,gt);if(!c)return null;const h=i[2];if("object"!=typeof h||Array.isArray(h))return o.error("NumberFormat options argument must be an object.");let m=null;if(h.locale&&(m=o.parse(h.locale,1,cn),!m))return null;let y=null;if(h.currency&&(y=o.parse(h.currency,1,cn),!y))return null;let b=null;if(h.unit&&(b=o.parse(h.unit,1,cn),!b))return null;let A=null;if(h["min-fraction-digits"]&&(A=o.parse(h["min-fraction-digits"],1,gt),!A))return null;let E=null;return h["max-fraction-digits"]&&(E=o.parse(h["max-fraction-digits"],1,gt),!E)?null:new Wd(c,m,y,b,A,E)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(i):void 0,unit:this.unit?this.unit.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.unit&&i(this.unit),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.unit&&(i.unit=this.unit.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]}}class bo{constructor(i){this.type=gt,this.input=i}static parse(i,o){if(2!==i.length)return o.error(`Expected 1 argument, but found ${i.length-1} instead.`);const c=o.parse(i[1],1);return c?"array"!==c.type.kind&&"string"!==c.type.kind&&"value"!==c.type.kind?o.error(`Expected argument of type string or array, but found ${ci(c.type)} instead.`):new bo(c):null}evaluate(i){const o=this.input.evaluate(i);if("string"==typeof o||Array.isArray(o))return o.length;throw new Zi(`Expected value to be of type string or array, but found ${ci(Di(o))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){const i=["length"];return this.eachChild(o=>{i.push(o.serialize())}),i}}const wo={"==":zr,"!=":lc,">":Fr,"<":Tl,">=":Kh,"<=":ri,array:Ro,at:yn,boolean:Ro,case:El,coalesce:ir,collator:Jl,format:tr,image:Zn,in:so,"index-of":Yi,interpolate:ro,"interpolate-hcl":ro,"interpolate-lab":ro,length:bo,let:oo,literal:Su,match:Ci,number:Ro,"number-format":Wd,object:Ro,slice:sc,step:rc,string:Ro,"to-boolean":Kl,"to-color":Kl,"to-number":Kl,"to-string":Kl,var:Vn,within:no};function cc(s,[i,o,c,h]){i=i.evaluate(s),o=o.evaluate(s),c=c.evaluate(s);const m=h?h.evaluate(s):1,y=Hh(i,o,c,m);if(y)throw new Zi(y);return new qn(i/255*m,o/255*m,c/255*m,m)}function Ml(s,i){return s in i}function La(s,i){const o=i[s];return void 0===o?null:o}function $i(s){return{type:s}}Jr.register(wo,{error:[{kind:"error"},[cn],(s,[i])=>{throw new Zi(i.evaluate(s))}],typeof:[cn,[Ct],(s,[i])=>ci(Di(i.evaluate(s)))],"to-rgba":[Ut(gt,4),[wn],(s,[i])=>i.evaluate(s).toArray()],rgb:[wn,[gt,gt,gt],cc],rgba:[wn,[gt,gt,gt,gt],cc],has:{type:rn,overloads:[[[cn],(s,[i])=>Ml(i.evaluate(s),s.properties())],[[cn,Qr],(s,[i,o])=>Ml(i.evaluate(s),o.evaluate(s))]]},get:{type:Ct,overloads:[[[cn],(s,[i])=>La(i.evaluate(s),s.properties())],[[cn,Qr],(s,[i,o])=>La(i.evaluate(s),o.evaluate(s))]]},"feature-state":[Ct,[cn],(s,[i])=>La(i.evaluate(s),s.featureState||{})],properties:[Qr,[],s=>s.properties()],"geometry-type":[cn,[],s=>s.geometryType()],id:[Ct,[],s=>s.id()],zoom:[gt,[],s=>s.globals.zoom],pitch:[gt,[],s=>s.globals.pitch||0],"distance-from-center":[gt,[],s=>s.distanceFromCenter()],"heatmap-density":[gt,[],s=>s.globals.heatmapDensity||0],"line-progress":[gt,[],s=>s.globals.lineProgress||0],"sky-radial-progress":[gt,[],s=>s.globals.skyRadialProgress||0],accumulated:[Ct,[],s=>void 0===s.globals.accumulated?null:s.globals.accumulated],"+":[gt,$i(gt),(s,i)=>{let o=0;for(const c of i)o+=c.evaluate(s);return o}],"*":[gt,$i(gt),(s,i)=>{let o=1;for(const c of i)o*=c.evaluate(s);return o}],"-":{type:gt,overloads:[[[gt,gt],(s,[i,o])=>i.evaluate(s)-o.evaluate(s)],[[gt],(s,[i])=>-i.evaluate(s)]]},"/":[gt,[gt,gt],(s,[i,o])=>i.evaluate(s)/o.evaluate(s)],"%":[gt,[gt,gt],(s,[i,o])=>i.evaluate(s)%o.evaluate(s)],ln2:[gt,[],()=>Math.LN2],pi:[gt,[],()=>Math.PI],e:[gt,[],()=>Math.E],"^":[gt,[gt,gt],(s,[i,o])=>Math.pow(i.evaluate(s),o.evaluate(s))],sqrt:[gt,[gt],(s,[i])=>Math.sqrt(i.evaluate(s))],log10:[gt,[gt],(s,[i])=>Math.log(i.evaluate(s))/Math.LN10],ln:[gt,[gt],(s,[i])=>Math.log(i.evaluate(s))],log2:[gt,[gt],(s,[i])=>Math.log(i.evaluate(s))/Math.LN2],sin:[gt,[gt],(s,[i])=>Math.sin(i.evaluate(s))],cos:[gt,[gt],(s,[i])=>Math.cos(i.evaluate(s))],tan:[gt,[gt],(s,[i])=>Math.tan(i.evaluate(s))],asin:[gt,[gt],(s,[i])=>Math.asin(i.evaluate(s))],acos:[gt,[gt],(s,[i])=>Math.acos(i.evaluate(s))],atan:[gt,[gt],(s,[i])=>Math.atan(i.evaluate(s))],min:[gt,$i(gt),(s,i)=>Math.min(...i.map(o=>o.evaluate(s)))],max:[gt,$i(gt),(s,i)=>Math.max(...i.map(o=>o.evaluate(s)))],abs:[gt,[gt],(s,[i])=>Math.abs(i.evaluate(s))],round:[gt,[gt],(s,[i])=>{const o=i.evaluate(s);return o<0?-Math.round(-o):Math.round(o)}],floor:[gt,[gt],(s,[i])=>Math.floor(i.evaluate(s))],ceil:[gt,[gt],(s,[i])=>Math.ceil(i.evaluate(s))],"filter-==":[rn,[cn,Ct],(s,[i,o])=>s.properties()[i.value]===o.value],"filter-id-==":[rn,[Ct],(s,[i])=>s.id()===i.value],"filter-type-==":[rn,[cn],(s,[i])=>s.geometryType()===i.value],"filter-<":[rn,[cn,Ct],(s,[i,o])=>{const c=s.properties()[i.value],h=o.value;return typeof c==typeof h&&c<h}],"filter-id-<":[rn,[Ct],(s,[i])=>{const o=s.id(),c=i.value;return typeof o==typeof c&&o<c}],"filter->":[rn,[cn,Ct],(s,[i,o])=>{const c=s.properties()[i.value],h=o.value;return typeof c==typeof h&&c>h}],"filter-id->":[rn,[Ct],(s,[i])=>{const o=s.id(),c=i.value;return typeof o==typeof c&&o>c}],"filter-<=":[rn,[cn,Ct],(s,[i,o])=>{const c=s.properties()[i.value],h=o.value;return typeof c==typeof h&&c<=h}],"filter-id-<=":[rn,[Ct],(s,[i])=>{const o=s.id(),c=i.value;return typeof o==typeof c&&o<=c}],"filter->=":[rn,[cn,Ct],(s,[i,o])=>{const c=s.properties()[i.value],h=o.value;return typeof c==typeof h&&c>=h}],"filter-id->=":[rn,[Ct],(s,[i])=>{const o=s.id(),c=i.value;return typeof o==typeof c&&o>=c}],"filter-has":[rn,[Ct],(s,[i])=>i.value in s.properties()],"filter-has-id":[rn,[],s=>null!==s.id()&&void 0!==s.id()],"filter-type-in":[rn,[Ut(cn)],(s,[i])=>i.value.indexOf(s.geometryType())>=0],"filter-id-in":[rn,[Ut(Ct)],(s,[i])=>i.value.indexOf(s.id())>=0],"filter-in-small":[rn,[cn,Ut(Ct)],(s,[i,o])=>o.value.indexOf(s.properties()[i.value])>=0],"filter-in-large":[rn,[cn,Ut(Ct)],(s,[i,o])=>function(c,h,m,y){for(;m<=y;){const b=m+y>>1;if(h[b]===c)return!0;h[b]>c?y=b-1:m=b+1}return!1}(s.properties()[i.value],o.value,0,o.value.length-1)],all:{type:rn,overloads:[[[rn,rn],(s,[i,o])=>i.evaluate(s)&&o.evaluate(s)],[$i(rn),(s,i)=>{for(const o of i)if(!o.evaluate(s))return!1;return!0}]]},any:{type:rn,overloads:[[[rn,rn],(s,[i,o])=>i.evaluate(s)||o.evaluate(s)],[$i(rn),(s,i)=>{for(const o of i)if(o.evaluate(s))return!0;return!1}]]},"!":[rn,[rn],(s,[i])=>!i.evaluate(s)],"is-supported-script":[rn,[cn],(s,[i])=>{const o=s.globals&&s.globals.isSupportedScript;return!o||o(i.evaluate(s))}],upcase:[cn,[cn],(s,[i])=>i.evaluate(s).toUpperCase()],downcase:[cn,[cn],(s,[i])=>i.evaluate(s).toLowerCase()],concat:[cn,$i(Ct),(s,i)=>i.map(o=>Mu(o.evaluate(s))).join("")],"resolved-locale":[cn,[Da],(s,[i])=>i.evaluate(s).resolvedLocale()]});var uc=wo;function Gf(s){return{result:"success",value:s}}function Sl(s){return{result:"error",value:s}}function Dl(s){return"data-driven"===s["property-type"]||"cross-faded-data-driven"===s["property-type"]}function Hf(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function Jh(s){return!!s.expression&&s.expression.interpolated}function On(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":null===s?"null":typeof s}function Ru(s){return"object"==typeof s&&null!==s&&!Array.isArray(s)}function qf(s){return s}function Lu(s,i){const o="color"===i.type,c=s.stops&&"object"==typeof s.stops[0][0],h=c||!(c||void 0!==s.property),m=s.type||(Jh(i)?"exponential":"interval");if(o&&((s=Xr({},s)).stops&&(s.stops=s.stops.map(E=>[E[0],qn.parse(E[1])])),s.default=qn.parse(s.default?s.default:i.default)),s.colorSpace&&"rgb"!==s.colorSpace&&!oc[s.colorSpace])throw new Error(`Unknown color space: ${s.colorSpace}`);let y,b,A;if("exponential"===m)y=ep;else if("interval"===m)y=za;else if("categorical"===m){y=Xg,b=Object.create(null);for(const E of s.stops)b[E[0]]=E[1];A=typeof s.stops[0][0]}else{if("identity"!==m)throw new Error(`Unknown function type "${m}"`);y=dc}if(c){const E={},P=[];for(let B=0;B<s.stops.length;B++){const N=s.stops[B],q=N[0].zoom;void 0===E[q]&&(E[q]={zoom:q,type:s.type,property:s.property,default:s.default,stops:[]},P.push(q)),E[q].stops.push([N[0].value,N[1]])}const k=[];for(const B of P)k.push([E[B].zoom,Lu(E[B],i)]);const R={name:"linear"};return{kind:"composite",interpolationType:R,interpolationFactor:ro.interpolationFactor.bind(void 0,R),zoomStops:k.map(B=>B[0]),evaluate:({zoom:B},N)=>ep({stops:k,base:s.base},i,B).evaluate(B,N)}}if(h){const E="exponential"===m?{name:"exponential",base:void 0!==s.base?s.base:1}:null;return{kind:"camera",interpolationType:E,interpolationFactor:ro.interpolationFactor.bind(void 0,E),zoomStops:s.stops.map(P=>P[0]),evaluate:({zoom:P})=>y(s,i,P,b,A)}}return{kind:"source",evaluate(E,P){const k=P&&P.properties?P.properties[s.property]:void 0;return void 0===k?zu(s.default,i.default):y(s,i,k,b,A)}}}function zu(s,i,o){return void 0!==s?s:void 0!==i?i:void 0!==o?o:void 0}function Xg(s,i,o,c,h){return zu(typeof o===h?c[o]:void 0,s.default,i.default)}function za(s,i,o){if("number"!==On(o))return zu(s.default,i.default);const c=s.stops.length;if(1===c||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[c-1][0])return s.stops[c-1][1];const h=Wn(s.stops.map(m=>m[0]),o);return s.stops[h][1]}function ep(s,i,o){const c=void 0!==s.base?s.base:1;if("number"!==On(o))return zu(s.default,i.default);const h=s.stops.length;if(1===h||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[h-1][0])return s.stops[h-1][1];const m=Wn(s.stops.map(P=>P[0]),o),y=function(P,k,R,B){const N=B-R,q=P-R;return 0===N?0:1===k?q/N:(Math.pow(k,q)-1)/(Math.pow(k,N)-1)}(o,c,s.stops[m][0],s.stops[m+1][0]),b=s.stops[m][1],A=s.stops[m+1][1];let E=io[i.type]||qf;if(s.colorSpace&&"rgb"!==s.colorSpace){const P=oc[s.colorSpace];E=(k,R)=>P.reverse(P.interpolate(P.forward(k),P.forward(R),y))}return"function"==typeof b.evaluate?{evaluate(...P){const k=b.evaluate.apply(void 0,P),R=A.evaluate.apply(void 0,P);if(void 0!==k&&void 0!==R)return E(k,R,y)}}:E(b,A,y)}function dc(s,i,o){return"color"===i.type?o=qn.parse(o):"formatted"===i.type?o=Kr.fromString(o.toString()):"resolvedImage"===i.type?o=Lr.fromString(o.toString()):On(o)===i.type||"enum"===i.type&&i.values[o]||(o=void 0),zu(o,s.default,i.default)}class tp{constructor(i,o){var c;this.expression=i,this._warningHistory={},this._evaluator=new $f,this._defaultValue=o?"color"===(c=o).type&&(Ru(c.default)||Array.isArray(c.default))?new qn(0,0,0,0):"color"===c.type?qn.parse(c.default)||null:void 0===c.default?null:c.default:null,this._enumValues=o&&"enum"===o.type?o.values:null}evaluateWithoutErrorHandling(i,o,c,h,m,y,b,A){return this._evaluator.globals=i,this._evaluator.feature=o,this._evaluator.featureState=c,this._evaluator.canonical=h||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=A||null,this.expression.evaluate(this._evaluator)}evaluate(i,o,c,h,m,y,b,A){this._evaluator.globals=i,this._evaluator.feature=o||null,this._evaluator.featureState=c||null,this._evaluator.canonical=h||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y||null,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=A||null;try{const E=this.expression.evaluate(this._evaluator);if(null==E||"number"==typeof E&&E!=E)return this._defaultValue;if(this._enumValues&&!(E in this._enumValues))throw new Zi(`Expected value to be one of ${Object.keys(this._enumValues).map(P=>JSON.stringify(P)).join(", ")}, but found ${JSON.stringify(E)} instead.`);return E}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,"undefined"!=typeof console&&console.warn(E.message)),this._defaultValue}}}function Yd(s){return Array.isArray(s)&&s.length>0&&"string"==typeof s[0]&&s[0]in uc}function hc(s,i){const o=new wl(uc,[],i?function(h){const m={color:wn,string:cn,number:gt,enum:cn,boolean:rn,formatted:Ql,resolvedImage:Ia};return"array"===h.type?Ut(m[h.value]||Ct,h.length):m[h.type]}(i):void 0),c=o.parse(s,void 0,void 0,void 0,i&&"string"===i.type?{typeAnnotation:"coerce"}:void 0);return c?Gf(new tp(c,i)):Sl(o.errors)}class Fu{constructor(i,o){this.kind=i,this._styleExpression=o,this.isStateDependent="constant"!==i&&!ra(o.expression)}evaluateWithoutErrorHandling(i,o,c,h,m,y){return this._styleExpression.evaluateWithoutErrorHandling(i,o,c,h,m,y)}evaluate(i,o,c,h,m,y){return this._styleExpression.evaluate(i,o,c,h,m,y)}}class Fa{constructor(i,o,c,h){this.kind=i,this.zoomStops=c,this._styleExpression=o,this.isStateDependent="camera"!==i&&!ra(o.expression),this.interpolationType=h}evaluateWithoutErrorHandling(i,o,c,h,m,y){return this._styleExpression.evaluateWithoutErrorHandling(i,o,c,h,m,y)}evaluate(i,o,c,h,m,y){return this._styleExpression.evaluate(i,o,c,h,m,y)}interpolationFactor(i,o,c){return this.interpolationType?ro.interpolationFactor(this.interpolationType,i,o,c):0}}function np(s,i){if("error"===(s=hc(s,i)).result)return s;const o=s.value.expression,c=Pa(o);if(!c&&!Dl(i))return Sl([new xo("","data expressions not supported")]);const h=ic(o,["zoom","pitch","distance-from-center"]);if(!h&&!Hf(i))return Sl([new xo("","zoom expressions not supported")]);const m=fc(o);return m||h?m instanceof xo?Sl([m]):m instanceof ro&&!Jh(i)?Sl([new xo("",'"interpolate" expressions cannot be used with this property')]):Gf(m?new Fa(c?"camera":"composite",s.value,m.labels,m instanceof ro?m.interpolation:void 0):new Fu(c?"constant":"source",s.value)):Sl([new xo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class pc{constructor(i,o){this._parameters=i,this._specification=o,Xr(this,Lu(this._parameters,this._specification))}static deserialize(i){return new pc(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function fc(s){let i=null;if(s instanceof oo)i=fc(s.result);else if(s instanceof ir){for(const o of s.args)if(i=fc(o),i)break}else(s instanceof rc||s instanceof ro)&&s.input instanceof Jr&&"zoom"===s.input.name&&(i=s);return i instanceof xo||s.eachChild(o=>{const c=fc(o);c instanceof xo?i=c:!i&&c?i=new xo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&c&&i!==c&&(i=new xo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}class mt{constructor(i,o,c,h){this.message=(i?`${i}: `:"")+c,h&&(this.identifier=h),null!=o&&o.__line__&&(this.line=o.__line__)}}function ao(s){const i=s.key,o=s.value,c=s.valueSpec||{},h=s.objectElementValidators||{},m=s.style,y=s.styleSpec;let b=[];const A=On(o);if("object"!==A)return[new mt(i,o,`object expected, ${A} found`)];for(const E in o){const P=E.split(".")[0],k=c[P]||c["*"];let R;h[P]?R=h[P]:c[P]?R=Gi:h["*"]?R=h["*"]:c["*"]&&(R=Gi),R?b=b.concat(R({key:(i&&`${i}.`)+E,value:o[E],valueSpec:k,style:m,styleSpec:y,object:o,objectKey:E},o)):b.push(new mt(i,o[E],`unknown property "${E}"`))}for(const E in c)h[E]||c[E].required&&void 0===c[E].default&&void 0===o[E]&&b.push(new mt(i,o,`missing required property "${E}"`));return b}function ds(s){const i=s.value,o=s.valueSpec,c=s.style,h=s.styleSpec,m=s.key,y=s.arrayElementValidator||Gi;if("array"!==On(i))return[new mt(m,i,`array expected, ${On(i)} found`)];if(o.length&&i.length!==o.length)return[new mt(m,i,`array length ${o.length} expected, length ${i.length} found`)];if(o["min-length"]&&i.length<o["min-length"])return[new mt(m,i,`array length at least ${o["min-length"]} expected, length ${i.length} found`)];let b={type:o.value,values:o.values,minimum:o.minimum,maximum:o.maximum,function:void 0};h.$version<7&&(b.function=o.function),"object"===On(o.value)&&(b=o.value);let A=[];for(let E=0;E<i.length;E++)A=A.concat(y({array:i,arrayIndex:E,value:i[E],valueSpec:b,style:c,styleSpec:h,key:`${m}[${E}]`}));return A}function Bu(s){const i=s.key,o=s.value,c=s.valueSpec;let h=On(o);if("number"===h&&o!=o&&(h="NaN"),"number"!==h)return[new mt(i,o,`number expected, ${h} found`)];if("minimum"in c){let m=c.minimum;if("array"===On(c.minimum)&&(m=c.minimum[s.arrayIndex]),o<m)return[new mt(i,o,`${o} is less than the minimum value ${m}`)]}if("maximum"in c){let m=c.maximum;if("array"===On(c.maximum)&&(m=c.maximum[s.arrayIndex]),o>m)return[new mt(i,o,`${o} is greater than the maximum value ${m}`)]}return[]}function mc(s){const i=s.valueSpec,o=yi(s.value.type);let c,h,m,y={};const b="categorical"!==o&&void 0===s.value.property,A=!b,E="array"===On(s.value.stops)&&"array"===On(s.value.stops[0])&&"object"===On(s.value.stops[0][0]),P=ao({key:s.key,value:s.value,valueSpec:s.styleSpec.function,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(B){if("identity"===o)return[new mt(B.key,B.value,'identity function may not have a "stops" property')];let N=[];const q=B.value;return N=N.concat(ds({key:B.key,value:q,valueSpec:B.valueSpec,style:B.style,styleSpec:B.styleSpec,arrayElementValidator:k})),"array"===On(q)&&0===q.length&&N.push(new mt(B.key,q,"array must have at least one stop")),N},default:function(B){return Gi({key:B.key,value:B.value,valueSpec:i,style:B.style,styleSpec:B.styleSpec})}}});return"identity"===o&&b&&P.push(new mt(s.key,s.value,'missing required property "property"')),"identity"===o||s.value.stops||P.push(new mt(s.key,s.value,'missing required property "stops"')),"exponential"===o&&s.valueSpec.expression&&!Jh(s.valueSpec)&&P.push(new mt(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(A&&!Dl(s.valueSpec)?P.push(new mt(s.key,s.value,"property functions not supported")):b&&!Hf(s.valueSpec)&&P.push(new mt(s.key,s.value,"zoom functions not supported"))),"categorical"!==o&&!E||void 0!==s.value.property||P.push(new mt(s.key,s.value,'"property" property is required')),P;function k(B){let N=[];const q=B.value,Q=B.key;if("array"!==On(q))return[new mt(Q,q,`array expected, ${On(q)} found`)];if(2!==q.length)return[new mt(Q,q,`array length 2 expected, length ${q.length} found`)];if(E){if("object"!==On(q[0]))return[new mt(Q,q,`object expected, ${On(q[0])} found`)];if(void 0===q[0].zoom)return[new mt(Q,q,"object stop key must have zoom")];if(void 0===q[0].value)return[new mt(Q,q,"object stop key must have value")];const se=yi(q[0].zoom);if("number"!=typeof se)return[new mt(Q,q[0].zoom,"stop zoom values must be numbers")];if(m&&m>se)return[new mt(Q,q[0].zoom,"stop zoom values must appear in ascending order")];se!==m&&(m=se,h=void 0,y={}),N=N.concat(ao({key:`${Q}[0]`,value:q[0],valueSpec:{zoom:{}},style:B.style,styleSpec:B.styleSpec,objectElementValidators:{zoom:Bu,value:R}}))}else N=N.concat(R({key:`${Q}[0]`,value:q[0],valueSpec:{},style:B.style,styleSpec:B.styleSpec},q));return Yd(ea(q[1]))?N.concat([new mt(`${Q}[1]`,q[1],"expressions are not allowed in function stops.")]):N.concat(Gi({key:`${Q}[1]`,value:q[1],valueSpec:i,style:B.style,styleSpec:B.styleSpec}))}function R(B,N){const q=On(B.value),Q=yi(B.value),se=null!==B.value?B.value:N;if(c){if(q!==c)return[new mt(B.key,se,`${q} stop domain type must match previous stop domain type ${c}`)]}else c=q;if("number"!==q&&"string"!==q&&"boolean"!==q&&"number"!=typeof Q&&"string"!=typeof Q&&"boolean"!=typeof Q)return[new mt(B.key,se,"stop domain value must be a number, string, or boolean")];if("number"!==q&&"categorical"!==o){let he=`number expected, ${q} found`;return Dl(i)&&void 0===o&&(he+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new mt(B.key,se,he)]}return"categorical"!==o||"number"!==q||"number"==typeof Q&&isFinite(Q)&&Math.floor(Q)===Q?"categorical"!==o&&"number"===q&&"number"==typeof Q&&"number"==typeof h&&void 0!==h&&Q<h?[new mt(B.key,se,"stop domain values must appear in ascending order")]:(h=Q,"categorical"===o&&Q in y?[new mt(B.key,se,"stop domain values must be unique")]:(y[Q]=!0,[])):[new mt(B.key,se,`integer expected, found ${String(Q)}`)]}}function Fo(s){const i=("property"===s.expressionContext?np:hc)(ea(s.value),s.valueSpec);if("error"===i.result)return i.value.map(c=>new mt(`${s.key}${c.key}`,s.value,c.message));const o=i.value.expression||i.value._styleExpression.expression;if("property"===s.expressionContext&&"text-font"===s.propertyKey&&!o.outputDefined())return[new mt(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===s.expressionContext&&"layout"===s.propertyType&&!ra(o))return[new mt(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===s.expressionContext)return Nu(o,s);if(s.expressionContext&&0===s.expressionContext.indexOf("cluster")){if(!ic(o,["zoom","feature-state"]))return[new mt(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===s.expressionContext&&!Pa(o))return[new mt(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Nu(s,i){const o=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(i.valueSpec&&i.valueSpec.expression)for(const h of i.valueSpec.expression.parameters)o.delete(h);if(0===o.size)return[];const c=[];return s instanceof Jr&&o.has(s.name)?[new mt(i.key,i.value,`["${s.name}"] expression is not supported in a filter for a ${i.object.type} layer with id: ${i.object.id}`)]:(s.eachChild(h=>{c.push(...Nu(h,i))}),c)}function Il(s){const i=s.key,o=s.value,c=s.valueSpec,h=[];return Array.isArray(c.values)?-1===c.values.indexOf(yi(o))&&h.push(new mt(i,o,`expected one of [${c.values.join(", ")}], ${JSON.stringify(o)} found`)):-1===Object.keys(c.values).indexOf(yi(o))&&h.push(new mt(i,o,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(o)} found`)),h}function gc(s){if(!0===s||!1===s)return!0;if(!Array.isArray(s)||0===s.length)return!1;switch(s[0]){case"has":return s.length>=2&&"$id"!==s[1]&&"$type"!==s[1];case"in":return s.length>=3&&("string"!=typeof s[1]||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==s.length||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const i of s.slice(1))if(!gc(i)&&"boolean"!=typeof i)return!1;return!0;default:return!0}}function Ba(s,i="fill"){if(null==s)return{filter:()=>!0,needGeometry:!1,needFeature:!1};gc(s)||(s=ju(s));const o=s;let c=!0;try{c=function(E){if(!Bo(E))return E;let P=ea(E);return Br(P),P=ip(P),P}(o)}catch(E){console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(o,null,2)}\n        `)}const h=Re[`filter_${i}`],m=hc(c,h);let y=null;if("error"===m.result)throw new Error(m.value.map(E=>`${E.key}: ${E.message}`).join(", "));y=(E,P,k)=>m.value.evaluate(E,P,{},k);let b=null,A=null;if(c!==o){const E=hc(o,h);if("error"===E.result)throw new Error(E.value.map(P=>`${P.key}: ${P.message}`).join(", "));b=(P,k,R,B,N)=>E.value.evaluate(P,k,{},R,void 0,void 0,B,N),A=!Pa(E.value.expression)}return{filter:y,dynamicFilter:b||void 0,needGeometry:rp(c),needFeature:!!A}}function ip(s){if(!Array.isArray(s))return s;const i=function(o){if(Zf.has(o[0]))for(let c=1;c<o.length;c++)if(Bo(o[c]))return!0;return o}(s);return!0===i?i:i.map(o=>ip(o))}function Br(s){let i=!1;const o=[];if("case"===s[0]){for(let c=1;c<s.length-1;c+=2)i=i||Bo(s[c]),o.push(s[c+1]);o.push(s[s.length-1])}else if("match"===s[0]){i=i||Bo(s[1]);for(let c=2;c<s.length-1;c+=2)o.push(s[c+1]);o.push(s[s.length-1])}else if("step"===s[0]){i=i||Bo(s[1]);for(let c=1;c<s.length-1;c+=2)o.push(s[c+1])}i&&(s.length=0,s.push("any",...o));for(let c=1;c<s.length;c++)Br(s[c])}function Bo(s){if(!Array.isArray(s))return!1;if("pitch"===(i=s[0])||"distance-from-center"===i)return!0;var i;for(let o=1;o<s.length;o++)if(Bo(s[o]))return!0;return!1}const Zf=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Xd(s,i){return s<i?-1:s>i?1:0}function rp(s){if(!Array.isArray(s))return!1;if("within"===s[0])return!0;for(let i=1;i<s.length;i++)if(rp(s[i]))return!0;return!1}function ju(s){if(!s)return!0;const i=s[0];return s.length<=1?"any"!==i:"=="===i?_c(s[1],s[2],"=="):"!="===i?Tr(_c(s[1],s[2],"==")):"<"===i||">"===i||"<="===i||">="===i?_c(s[1],s[2],i):"any"===i?(o=s.slice(1),["any"].concat(o.map(ju))):"all"===i?["all"].concat(s.slice(1).map(ju)):"none"===i?["all"].concat(s.slice(1).map(ju).map(Tr)):"in"===i?yc(s[1],s.slice(2)):"!in"===i?Tr(yc(s[1],s.slice(2))):"has"===i?Na(s[1]):"!has"===i?Tr(Na(s[1])):"within"!==i||s;var o}function _c(s,i,o){switch(s){case"$type":return[`filter-type-${o}`,i];case"$id":return[`filter-id-${o}`,i];default:return[`filter-${o}`,s,i]}}function yc(s,i){if(0===i.length)return!1;switch(s){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(o=>typeof o!=typeof i[0])?["filter-in-large",s,["literal",i.sort(Xd)]]:["filter-in-small",s,["literal",i]]}}function Na(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function Tr(s){return["!",s]}function oi(s){return gc(ea(s.value))?Fo(Xr({},s,{expressionContext:"filter",valueSpec:s.styleSpec[`filter_${s.layerType||"fill"}`]})):Qd(s)}function Qd(s){const i=s.value,o=s.key;if("array"!==On(i))return[new mt(o,i,`array expected, ${On(i)} found`)];const c=s.styleSpec;let h,m=[];if(i.length<1)return[new mt(o,i,"filter array must have at least 1 element")];switch(m=m.concat(Il({key:`${o}[0]`,value:i[0],valueSpec:c.filter_operator,style:s.style,styleSpec:s.styleSpec})),yi(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&"$type"===yi(i[1])&&m.push(new mt(o,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":3!==i.length&&m.push(new mt(o,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(h=On(i[1]),"string"!==h&&m.push(new mt(`${o}[1]`,i[1],`string expected, ${h} found`)));for(let y=2;y<i.length;y++)h=On(i[y]),"$type"===yi(i[1])?m=m.concat(Il({key:`${o}[${y}]`,value:i[y],valueSpec:c.geometry_type,style:s.style,styleSpec:s.styleSpec})):"string"!==h&&"number"!==h&&"boolean"!==h&&m.push(new mt(`${o}[${y}]`,i[y],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let y=1;y<i.length;y++)m=m.concat(Qd({key:`${o}[${y}]`,value:i[y],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":h=On(i[1]),2!==i.length?m.push(new mt(o,i,`filter array for "${i[0]}" operator must have 2 elements`)):"string"!==h&&m.push(new mt(`${o}[1]`,i[1],`string expected, ${h} found`));break;case"within":h=On(i[1]),2!==i.length?m.push(new mt(o,i,`filter array for "${i[0]}" operator must have 2 elements`)):"object"!==h&&m.push(new mt(`${o}[1]`,i[1],`object expected, ${h} found`))}return m}function op(s,i){const o=s.key,c=s.style,h=s.styleSpec,m=s.value,y=s.objectKey,b=h[`${i}_${s.layerType}`];if(!b)return[];const A=y.match(/^(.*)-transition$/);if("paint"===i&&A&&b[A[1]]&&b[A[1]].transition)return Gi({key:o,value:m,valueSpec:h.transition,style:c,styleSpec:h});const E=s.valueSpec||b[y];if(!E)return[new mt(o,m,`unknown property "${y}"`)];let P;if("string"===On(m)&&Dl(E)&&!E.tokens&&(P=/^{([^}]+)}$/.exec(m)))return[new mt(o,m,`"${y}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(P[1])} }\`.`)];const k=[];return"symbol"===s.layerType&&("text-field"===y&&c&&!c.glyphs&&k.push(new mt(o,m,'use of "text-field" requires a style "glyphs" property')),"text-font"===y&&Ru(ea(m))&&"identity"===yi(m.type)&&k.push(new mt(o,m,'"text-font" does not support identity functions'))),k.concat(Gi({key:s.key,value:m,valueSpec:E,style:c,styleSpec:h,expressionContext:"property",propertyType:i,propertyKey:y}))}function Ii(s){return op(s,"paint")}function sp(s){return op(s,"layout")}function Kd(s){let i=[];const o=s.value,c=s.key,h=s.style,m=s.styleSpec;o.type||o.ref||i.push(new mt(c,o,'either "type" or "ref" is required'));let y=yi(o.type);const b=yi(o.ref);if(o.id){const A=yi(o.id);for(let E=0;E<s.arrayIndex;E++){const P=h.layers[E];yi(P.id)===A&&i.push(new mt(c,o.id,`duplicate layer id "${o.id}", previously used at line ${P.id.__line__}`))}}if("ref"in o){let A;["type","source","source-layer","filter","layout"].forEach(E=>{E in o&&i.push(new mt(c,o[E],`"${E}" is prohibited for ref layers`))}),h.layers.forEach(E=>{yi(E.id)===b&&(A=E)}),A?A.ref?i.push(new mt(c,o.ref,"ref cannot reference another ref layer")):y=yi(A.type):"string"==typeof b&&i.push(new mt(c,o.ref,`ref layer "${b}" not found`))}else if("background"!==y&&"sky"!==y)if(o.source){const A=h.sources&&h.sources[o.source],E=A&&yi(A.type);A?"vector"===E&&"raster"===y?i.push(new mt(c,o.source,`layer "${o.id}" requires a raster source`)):"raster"===E&&"raster"!==y?i.push(new mt(c,o.source,`layer "${o.id}" requires a vector source`)):"vector"!==E||o["source-layer"]?"raster-dem"===E&&"hillshade"!==y?i.push(new mt(c,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==y||!o.paint||!o.paint["line-gradient"]&&!o.paint["line-trim-offset"]||"geojson"===E&&A.lineMetrics||i.push(new mt(c,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new mt(c,o,`layer "${o.id}" must specify a "source-layer"`)):i.push(new mt(c,o.source,`source "${o.source}" not found`))}else i.push(new mt(c,o,'missing required property "source"'));return i=i.concat(ao({key:c,value:o,valueSpec:m.layer,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Gi({key:`${c}.type`,value:o.type,valueSpec:m.layer.type,style:s.style,styleSpec:s.styleSpec,object:o,objectKey:"type"}),filter:A=>oi(Xr({layerType:y},A)),layout:A=>ao({layer:o,key:A.key,value:A.value,valueSpec:{},style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":E=>sp(Xr({layerType:y},E))}}),paint:A=>ao({layer:o,key:A.key,value:A.value,valueSpec:{},style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":E=>Ii(Xr({layerType:y},E))}})}})),i}function ks(s){const i=s.value,o=s.key,c=On(i);return"string"!==c?[new mt(o,i,`string expected, ${c} found`)]:[]}const Mr={promoteId:function({key:s,value:i}){if("string"===On(i))return ks({key:s,value:i});{const o=[];for(const c in i)o.push(...ks({key:`${s}.${c}`,value:i[c]}));return o}}};function ap(s){const i=s.value,o=s.key,c=s.styleSpec,h=s.style;if(!i.type)return[new mt(o,i,'"type" is required')];const m=yi(i.type);let y;switch(m){case"vector":case"raster":case"raster-dem":return y=ao({key:o,value:i,valueSpec:c[`source_${m.replace("-","_")}`],style:s.style,styleSpec:c,objectElementValidators:Mr}),y;case"geojson":if(y=ao({key:o,value:i,valueSpec:c.source_geojson,style:h,styleSpec:c,objectElementValidators:Mr}),i.cluster)for(const b in i.clusterProperties){const[A,E]=i.clusterProperties[b],P="string"==typeof A?[A,["accumulated"],["get",b]]:A;y.push(...Fo({key:`${o}.${b}.map`,value:E,expressionContext:"cluster-map"})),y.push(...Fo({key:`${o}.${b}.reduce`,value:P,expressionContext:"cluster-reduce"}))}return y;case"video":return ao({key:o,value:i,valueSpec:c.source_video,style:h,styleSpec:c});case"image":return ao({key:o,value:i,valueSpec:c.source_image,style:h,styleSpec:c});case"canvas":return[new mt(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Il({key:`${o}.type`,value:i.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:h,styleSpec:c})}}function Vu(s){const i=s.value,o=s.styleSpec,c=o.light,h=s.style;let m=[];const y=On(i);if(void 0===i)return m;if("object"!==y)return m=m.concat([new mt("light",i,`object expected, ${y} found`)]),m;for(const b in i){const A=b.match(/^(.*)-transition$/);m=m.concat(A&&c[A[1]]&&c[A[1]].transition?Gi({key:b,value:i[b],valueSpec:o.transition,style:h,styleSpec:o}):c[b]?Gi({key:b,value:i[b],valueSpec:c[b],style:h,styleSpec:o}):[new mt(b,i[b],`unknown property "${b}"`)])}return m}function Rs(s){const i=s.value,o=s.key,c=s.style,h=s.styleSpec,m=h.terrain;let y=[];const b=On(i);if(void 0===i)return y;if("object"!==b)return y=y.concat([new mt("terrain",i,`object expected, ${b} found`)]),y;for(const A in i){const E=A.match(/^(.*)-transition$/);y=y.concat(E&&m[E[1]]&&m[E[1]].transition?Gi({key:A,value:i[A],valueSpec:h.transition,style:c,styleSpec:h}):m[A]?Gi({key:A,value:i[A],valueSpec:m[A],style:c,styleSpec:h}):[new mt(A,i[A],`unknown property "${A}"`)])}if(i.source){const A=c.sources&&c.sources[i.source],E=A&&yi(A.type);A?"raster-dem"!==E&&y.push(new mt(o,i.source,`terrain cannot be used with a source of type ${String(E)}, it only be used with a "raster-dem" source type`)):y.push(new mt(o,i.source,`source "${i.source}" not found`))}else y.push(new mt(o,i,'terrain is missing required property "source"'));return y}function Nr(s){const i=s.value,o=s.style,c=s.styleSpec,h=c.fog;let m=[];const y=On(i);if(void 0===i)return m;if("object"!==y)return m=m.concat([new mt("fog",i,`object expected, ${y} found`)]),m;for(const b in i){const A=b.match(/^(.*)-transition$/);m=m.concat(A&&h[A[1]]&&h[A[1]].transition?Gi({key:b,value:i[b],valueSpec:c.transition,style:o,styleSpec:c}):h[b]?Gi({key:b,value:i[b],valueSpec:h[b],style:o,styleSpec:c}):[new mt(b,i[b],`unknown property "${b}"`)])}return m}const Uu={"*":()=>[],array:ds,boolean:function(s){const i=s.value,o=s.key,c=On(i);return"boolean"!==c?[new mt(o,i,`boolean expected, ${c} found`)]:[]},number:Bu,color:function(s){const i=s.key,o=s.value,c=On(o);return"string"!==c?[new mt(i,o,`color expected, ${c} found`)]:null===ta.parseCSSColor(o)?[new mt(i,o,`color expected, "${o}" found`)]:[]},enum:Il,filter:oi,function:mc,layer:Kd,object:ao,source:ap,light:Vu,terrain:Rs,fog:Nr,string:ks,formatted:function(s){return 0===ks(s).length?[]:Fo(s)},resolvedImage:function(s){return 0===ks(s).length?[]:Fo(s)},projection:function(s){const i=s.value,o=s.styleSpec,c=o.projection,h=s.style;let m=[];const y=On(i);if("object"===y)for(const b in i)m=m.concat(Gi({key:b,value:i[b],valueSpec:c[b],style:h,styleSpec:o}));else"string"!==y&&(m=m.concat([new mt("projection",i,`object or string expected, ${y} found`)]));return m}};function Gi(s){const i=s.value,o=s.valueSpec,c=s.styleSpec;return o.expression&&Ru(yi(i))?mc(s):o.expression&&Yd(ea(i))?Fo(s):o.type&&Uu[o.type]?Uu[o.type](s):ao(Xr({},s,{valueSpec:o.type?c[o.type]:o}))}function Wf(s){const i=s.value,o=s.key,c=ks(s);return c.length||(-1===i.indexOf("{fontstack}")&&c.push(new mt(o,i,'"glyphs" url must include a "{fontstack}" token')),-1===i.indexOf("{range}")&&c.push(new mt(o,i,'"glyphs" url must include a "{range}" token'))),c}function No(s,i=Re){return Gt(Gi({key:"",value:s,valueSpec:i.$root,styleSpec:i,style:s,objectElementValidators:{glyphs:Wf,"*":()=>[]}}))}const vc=s=>Gt(Ii(s)),$u=s=>Gt(sp(s));function Gt(s){return s.slice().sort((i,o)=>i.line&&o.line?i.line-o.line:0)}function Gu(s,i){let o=!1;if(i&&i.length)for(const c of i)s.fire(new zn(new Error(c.message))),o=!0;return o}var xc=Co;function Co(s,i,o){var c=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var h=new Int32Array(this.arrayBuffer);s=h[0],this.d=(i=h[1])+2*(o=h[2]);for(var m=0;m<this.d*this.d;m++){var y=h[3+m],b=h[3+m+1];c.push(y===b?null:h.subarray(y,b))}var A=h[3+c.length+1];this.keys=h.subarray(h[3+c.length],A),this.bboxes=h.subarray(A),this.insert=this._insertReadonly}else{this.d=i+2*o;for(var E=0;E<this.d*this.d;E++)c.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=s,this.padding=o,this.scale=i/s,this.uid=0;var P=o/i*s;this.min=-P,this.max=s+P}Co.prototype.insert=function(s,i,o,c,h){this._forEachCell(i,o,c,h,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(i),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(h)},Co.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Co.prototype._insertCell=function(s,i,o,c,h,m){this.cells[h].push(m)},Co.prototype.query=function(s,i,o,c,h){var m=this.min,y=this.max;if(s<=m&&i<=m&&y<=o&&y<=c&&!h)return Array.prototype.slice.call(this.keys);var b=[];return this._forEachCell(s,i,o,c,this._queryCell,b,{},h),b},Co.prototype._queryCell=function(s,i,o,c,h,m,y,b){var A=this.cells[h];if(null!==A)for(var E=this.keys,P=this.bboxes,k=0;k<A.length;k++){var R=A[k];if(void 0===y[R]){var B=4*R;(b?b(P[B+0],P[B+1],P[B+2],P[B+3]):s<=P[B+2]&&i<=P[B+3]&&o>=P[B+0]&&c>=P[B+1])?(y[R]=!0,m.push(E[R])):y[R]=!1}}},Co.prototype._forEachCell=function(s,i,o,c,h,m,y,b){for(var A=this._convertToCellCoord(s),E=this._convertToCellCoord(i),P=this._convertToCellCoord(o),k=this._convertToCellCoord(c),R=A;R<=P;R++)for(var B=E;B<=k;B++){var N=this.d*B+R;if((!b||b(this._convertFromCellCoord(R),this._convertFromCellCoord(B),this._convertFromCellCoord(R+1),this._convertFromCellCoord(B+1)))&&h.call(this,s,i,o,c,N,m,y,b))return}},Co.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},Co.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},Co.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,i=3+this.cells.length+1+1,o=0,c=0;c<this.cells.length;c++)o+=this.cells[c].length;var h=new Int32Array(i+o+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var m=i,y=0;y<s.length;y++){var b=s[y];h[3+y]=m,h.set(b,m),m+=b.length}return h[3+s.length]=m,h.set(this.keys,m),h[3+s.length+1]=m+=this.keys.length,h.set(this.bboxes,m),m+=this.bboxes.length,h.buffer};const Hu={};function vt(s,i,o={}){Object.defineProperty(s,"_classRegistryKey",{value:i,writeable:!1}),Hu[i]={klass:s,omit:o.omit||[]}}vt(Object,"Object"),xc.serialize=function(s,i){const o=s.toArrayBuffer();return i&&i.push(o),{buffer:o}},xc.deserialize=function(s){return new xc(s.buffer)},Object.defineProperty(xc,"name",{value:"Grid"}),vt(xc,"Grid"),vt(qn,"Color"),vt(Error,"Error"),vt(Te,"AJAXError"),vt(Lr,"ResolvedImage"),vt(pc,"StylePropertyFunction"),vt(tp,"StyleExpression",{omit:["_evaluator"]}),vt(Fa,"ZoomDependentExpression"),vt(Fu,"ZoomConstantExpression"),vt(Jr,"CompoundExpression",{omit:["_evaluate"]});for(const s in uc)Hu[uc[s]._classRegistryKey]||vt(uc[s],`Expression${s}`);function Jd(s){return s&&"undefined"!=typeof ArrayBuffer&&(s instanceof ArrayBuffer||s.constructor&&"ArrayBuffer"===s.constructor.name)}function lp(s){return ot.ImageBitmap&&s instanceof ot.ImageBitmap}function Pl(s,i){if(null==s||"boolean"==typeof s||"number"==typeof s||"string"==typeof s||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp)return s;if(Jd(s)||lp(s))return i&&i.push(s),s;if(ArrayBuffer.isView(s)){const o=s;return i&&i.push(o.buffer),o}if(s instanceof ot.ImageData)return i&&i.push(s.data.buffer),s;if(Array.isArray(s)){const o=[];for(const c of s)o.push(Pl(c,i));return o}if("object"==typeof s){const o=s.constructor,c=o._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);const h=o.serialize?o.serialize(s,i):{};if(!o.serialize){for(const m in s)s.hasOwnProperty(m)&&(Hu[c].omit.indexOf(m)>=0||(h[m]=Pl(s[m],i)));s instanceof Error&&(h.message=s.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==c&&(h.$name=c),h}throw new Error("can't serialize object of type "+typeof s)}function it(s){if(null==s||"boolean"==typeof s||"number"==typeof s||"string"==typeof s||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||Jd(s)||lp(s)||ArrayBuffer.isView(s)||s instanceof ot.ImageData)return s;if(Array.isArray(s))return s.map(it);if("object"==typeof s){const i=s.$name||"Object",{klass:o}=Hu[i];if(!o)throw new Error(`can't deserialize unregistered class ${i}`);if(o.deserialize)return o.deserialize(s);const c=Object.create(o.prototype);for(const h of Object.keys(s))"$name"!==h&&(c[h]=it(s[h]));return c}throw new Error("can't deserialize object of type "+typeof s)}class Tn{constructor(){this.first=!0}update(i,o){const c=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=o),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=c,!0))}}const cp=s=>s>=1536&&s<=1791,Fi=s=>s>=1872&&s<=1919,eh=s=>s>=2208&&s<=2303,Ol=s=>s>=11904&&s<=12031,jo=s=>s>=12032&&s<=12255,ja=s=>s>=12272&&s<=12287,kl=s=>s>=12288&&s<=12351,up=s=>s>=12352&&s<=12447,Va=s=>s>=12448&&s<=12543,Yf=s=>s>=12544&&s<=12591,Rl=s=>s>=12704&&s<=12735,pr=s=>s>=12736&&s<=12783,Vo=s=>s>=12784&&s<=12799,qu=s=>s>=12800&&s<=13055,ca=s=>s>=13056&&s<=13311,Uo=s=>s>=13312&&s<=19903,bc=s=>s>=19968&&s<=40959,wc=s=>s>=40960&&s<=42127,dp=s=>s>=42128&&s<=42191,hp=s=>s>=44032&&s<=55215,Zu=s=>s>=63744&&s<=64255,Ua=s=>s>=64336&&s<=65023,th=s=>s>=65040&&s<=65055,Cc=s=>s>=65072&&s<=65103,pp=s=>s>=65104&&s<=65135,Wu=s=>s>=65136&&s<=65279,Ll=s=>s>=65280&&s<=65519;function Ac(s){for(const i of s)if(Ec(i.charCodeAt(0)))return!0;return!1}function fp(s){for(const i of s)if(!mp(i.charCodeAt(0)))return!1;return!0}function mp(s){return!(cp(s)||Fi(s)||eh(s)||Ua(s)||Wu(s))}function Ec(s){return!(746!==s&&747!==s&&(s<4352||!(Rl(s)||Yf(s)||Cc(s)&&!(s>=65097&&s<=65103)||Zu(s)||ca(s)||Ol(s)||pr(s)||!(!kl(s)||s>=12296&&s<=12305||s>=12308&&s<=12319||12336===s)||Uo(s)||bc(s)||qu(s)||(i=s,i>=12592&&i<=12687)||(i=>i>=43360&&i<=43391)(s)||(i=>i>=55216&&i<=55295)(s)||(i=>i>=4352&&i<=4607)(s)||hp(s)||up(s)||ja(s)||(i=>i>=12688&&i<=12703)(s)||jo(s)||Vo(s)||Va(s)&&12540!==s||!(!Ll(s)||65288===s||65289===s||65293===s||s>=65306&&s<=65310||65339===s||65341===s||65343===s||s>=65371&&s<=65503||65507===s||s>=65512&&s<=65519)||!(!pp(s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||(i=>i>=5120&&i<=5759)(s)||(i=>i>=6320&&i<=6399)(s)||th(s)||(i=>i>=19904&&i<=19967)(s)||wc(s)||dp(s))));var i}function ua(s){return!(Ec(s)||(i=s,(o=i)>=128&&o<=255&&(167===i||169===i||174===i||177===i||188===i||189===i||190===i||215===i||247===i)||(o=>o>=8192&&o<=8303)(i)&&(8214===i||8224===i||8225===i||8240===i||8241===i||8251===i||8252===i||8258===i||8263===i||8264===i||8265===i||8273===i)||(o=>o>=8448&&o<=8527)(i)||(o=>o>=8528&&o<=8591)(i)||(o=>o>=8960&&o<=9215)(i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||9003===i||i>=9085&&i<=9114||i>=9150&&i<=9165||9167===i||i>=9169&&i<=9179||i>=9186&&i<=9215)||(o=>o>=9216&&o<=9279)(i)&&9251!==i||(o=>o>=9280&&o<=9311)(i)||(o=>o>=9312&&o<=9471)(i)||(o=>o>=9632&&o<=9727)(i)||(o=>o>=9728&&o<=9983)(i)&&!(i>=9754&&i<=9759)||(o=>o>=11008&&o<=11263)(i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||kl(i)||Va(i)||(o=>o>=57344&&o<=63743)(i)||Cc(i)||pp(i)||Ll(i)||8734===i||8756===i||8757===i||i>=9984&&i<=10087||i>=10102&&i<=10131||65532===i||65533===i));var i,o}function f(s){return s>=1424&&s<=2303||Ua(s)||Wu(s)}function a(s,i){return!(!i&&f(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||(o=s,o>=6016&&o<=6143));var o}function d(s){for(const i of s)if(f(i.charCodeAt(0)))return!0;return!1}const g="deferred",x="loading",C="loaded";let M=null,D="unavailable",O=null;const z=function(s){s&&"string"==typeof s&&s.indexOf("NetworkError")>-1&&(D="error"),M&&M(s)};function F(){U.fire(new Mn("pluginStateChange",{pluginStatus:D,pluginURL:O}))}const U=new Rt,W=function(){return D},ne=function(){if(D!==g||!O)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");D=x,F(),O&&Me({url:O},s=>{s?z(s):(D=C,F())})},K={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>D===C||null!=K.applyArabicShaping,isLoading:()=>D===x,setState(s){D=s.pluginStatus,O=s.pluginURL},isParsed:()=>null!=K.applyArabicShaping&&null!=K.processBidirectionalText&&null!=K.processStyledBidirectionalText,getPluginURL:()=>O};class J{constructor(i,o){this.zoom=i,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition,this.pitch=o.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Tn,this.transition={},this.pitch=0)}isSupportedScript(i){return function(o,c){for(const h of o)if(!a(h.charCodeAt(0),c))return!1;return!0}(i,K.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const i=this.zoom,o=i-Math.floor(i),c=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*o}}}class te{constructor(i,o){this.property=i,this.value=o,this.expression=function(c,h){if(Ru(c))return new pc(c,h);if(Yd(c)){const m=np(c,h);if("error"===m.result)throw new Error(m.value.map(y=>`${y.key}: ${y.message}`).join(", "));return m.value}{let m=c;return"string"==typeof c&&"color"===h.type&&(m=qn.parse(c)),{kind:"constant",evaluate:()=>m}}}(void 0===o?i.specification.default:o,i.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(i,o,c){return this.property.possiblyEvaluate(this,i,o,c)}}class X{constructor(i){this.property=i,this.value=new te(i,void 0)}transitioned(i,o){return new ie(this.property,this.value,o,ji({},i.transition,this.transition),i.now)}untransitioned(){return new ie(this.property,this.value,null,{},0)}}class re{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)}getValue(i){return Hn(this._values[i].value.value)}setValue(i,o){this._values.hasOwnProperty(i)||(this._values[i]=new X(this._values[i].property)),this._values[i].value=new te(this._values[i].property,null===o?void 0:Hn(o))}getTransition(i){return Hn(this._values[i].transition)}setTransition(i,o){this._values.hasOwnProperty(i)||(this._values[i]=new X(this._values[i].property)),this._values[i].transition=Hn(o)||void 0}serialize(){const i={};for(const o of Object.keys(this._values)){const c=this.getValue(o);void 0!==c&&(i[o]=c);const h=this.getTransition(o);void 0!==h&&(i[`${o}-transition`]=h)}return i}transitioned(i,o){const c=new xe(this._properties);for(const h of Object.keys(this._values))c._values[h]=this._values[h].transitioned(i,o._values[h]);return c}untransitioned(){const i=new xe(this._properties);for(const o of Object.keys(this._values))i._values[o]=this._values[o].untransitioned();return i}}class ie{constructor(i,o,c,h,m){const y=h.delay||0,b=h.duration||0;m=m||0,this.property=i,this.value=o,this.begin=m+y,this.end=this.begin+b,i.specification.transition&&(h.delay||h.duration)&&(this.prior=c)}possiblyEvaluate(i,o,c){const h=i.now||0,m=this.value.possiblyEvaluate(i,o,c),y=this.prior;if(y){if(h>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(h<this.begin)return y.possiblyEvaluate(i,o,c);{const b=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(i,o,c),m,ql(b))}}return m}}class xe{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,o,c){const h=new ve(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(i,o,c);return h}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class ge{constructor(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)}getValue(i){return Hn(this._values[i].value)}setValue(i,o){this._values[i]=new te(this._values[i].property,null===o?void 0:Hn(o))}serialize(){const i={};for(const o of Object.keys(this._values)){const c=this.getValue(o);void 0!==c&&(i[o]=c)}return i}possiblyEvaluate(i,o,c){const h=new ve(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(i,o,c);return h}}class pe{constructor(i,o,c){this.property=i,this.value=o,this.parameters=c}isConstant(){return"constant"===this.value.kind}constantOr(i){return"constant"===this.value.kind?this.value.value:i}evaluate(i,o,c,h){return this.property.evaluate(this.value,this.parameters,i,o,c,h)}}class ve{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class _e{constructor(i){this.specification=i}possiblyEvaluate(i,o){return i.expression.evaluate(o)}interpolate(i,o,c){const h=io[this.specification.type];return h?h(i,o,c):i}}class Ce{constructor(i,o){this.specification=i,this.overrides=o}possiblyEvaluate(i,o,c,h){return new pe(this,"constant"===i.expression.kind||"camera"===i.expression.kind?{kind:"constant",value:i.expression.evaluate(o,null,{},c,h)}:i.expression,o)}interpolate(i,o,c){if("constant"!==i.value.kind||"constant"!==o.value.kind)return i;if(void 0===i.value.value||void 0===o.value.value)return new pe(this,{kind:"constant",value:void 0},i.parameters);const h=io[this.specification.type];return h?new pe(this,{kind:"constant",value:h(i.value.value,o.value.value,c)},i.parameters):i}evaluate(i,o,c,h,m,y){return"constant"===i.kind?i.value:i.evaluate(o,c,h,m,y)}}class Se extends Ce{possiblyEvaluate(i,o,c,h){if(void 0===i.value)return new pe(this,{kind:"constant",value:void 0},o);if("constant"===i.expression.kind){const m=i.expression.evaluate(o,null,{},c,h),y="resolvedImage"===i.property.specification.type&&"string"!=typeof m?m.name:m,b=this._calculate(y,y,y,o);return new pe(this,{kind:"constant",value:b},o)}if("camera"===i.expression.kind){const m=this._calculate(i.expression.evaluate({zoom:o.zoom-1}),i.expression.evaluate({zoom:o.zoom}),i.expression.evaluate({zoom:o.zoom+1}),o);return new pe(this,{kind:"constant",value:m},o)}return new pe(this,i.expression,o)}evaluate(i,o,c,h,m,y){if("source"===i.kind){const b=i.evaluate(o,c,h,m,y);return this._calculate(b,b,b,o)}return"composite"===i.kind?this._calculate(i.evaluate({zoom:Math.floor(o.zoom)-1},c,h),i.evaluate({zoom:Math.floor(o.zoom)},c,h),i.evaluate({zoom:Math.floor(o.zoom)+1},c,h),o):i.value}_calculate(i,o,c,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:i,to:o,other:c}:{from:c,to:o,other:i}}interpolate(i){return i}}class Je{constructor(i){this.specification=i}possiblyEvaluate(i,o,c,h){if(void 0!==i.value){if("constant"===i.expression.kind){const m=i.expression.evaluate(o,null,{},c,h);return this._calculate(m,m,m,o)}return this._calculate(i.expression.evaluate(new J(Math.floor(o.zoom-1),o)),i.expression.evaluate(new J(Math.floor(o.zoom),o)),i.expression.evaluate(new J(Math.floor(o.zoom+1),o)),o)}}_calculate(i,o,c,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:i,to:o}:{from:c,to:o}}interpolate(i){return i}}class Ee{constructor(i){this.specification=i}possiblyEvaluate(i,o,c,h){return!!i.expression.evaluate(o,null,{},c,h)}interpolate(){return!1}}class je{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const o=new J(0,{});for(const c in i){const h=i[c];h.specification.overridable&&this.overridableProperties.push(c);const m=this.defaultPropertyValues[c]=new te(h,void 0),y=this.defaultTransitionablePropertyValues[c]=new X(h);this.defaultTransitioningPropertyValues[c]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=m.possiblyEvaluate(o)}}}function Ge(s,i){return 256*(s=Zt(Math.floor(s),0,255))+Zt(Math.floor(i),0,255)}vt(Ce,"DataDrivenProperty"),vt(_e,"DataConstantProperty"),vt(Se,"CrossFadedDataDrivenProperty"),vt(Je,"CrossFadedProperty"),vt(Ee,"ColorRampProperty");const at={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ke{constructor(i,o){this._structArray=i,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class et{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,o){return i._trim(),o&&(i.isTransferred=!0,o.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const o=Object.create(this.prototype);return o.arrayBuffer=i.arrayBuffer,o.length=i.length,o.capacity=i.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function He(s,i=1){let o=0,c=0;return{members:s.map(h=>{const m=at[h.type].BYTES_PER_ELEMENT,y=o=ht(o,Math.max(i,m)),b=h.components||1;return c=Math.max(c,m),o+=m*b,{name:h.name,type:h.type,components:b,offset:y}}),size:ht(o,Math.max(c,i)),alignment:i}}function ht(s,i){return Math.ceil(s/i)*i}class lt extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o){const c=this.length;return this.resize(c+1),this.emplace(c,i,o)}emplace(i,o,c){const h=2*i;return this.int16[h+0]=o,this.int16[h+1]=c,i}}lt.prototype.bytesPerElement=4,vt(lt,"StructArrayLayout2i4");class wt extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,c){const h=this.length;return this.resize(h+1),this.emplace(h,i,o,c)}emplace(i,o,c,h){const m=3*i;return this.int16[m+0]=o,this.int16[m+1]=c,this.int16[m+2]=h,i}}wt.prototype.bytesPerElement=6,vt(wt,"StructArrayLayout3i6");class Lt extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,c,h){const m=this.length;return this.resize(m+1),this.emplace(m,i,o,c,h)}emplace(i,o,c,h,m){const y=4*i;return this.int16[y+0]=o,this.int16[y+1]=c,this.int16[y+2]=h,this.int16[y+3]=m,i}}Lt.prototype.bytesPerElement=8,vt(Lt,"StructArrayLayout4i8");class jt extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,c,h,m,y,b){const A=this.length;return this.resize(A+1),this.emplace(A,i,o,c,h,m,y,b)}emplace(i,o,c,h,m,y,b,A){const E=6*i,P=12*i,k=3*i;return this.int16[E+0]=o,this.int16[E+1]=c,this.uint8[P+4]=h,this.uint8[P+5]=m,this.uint8[P+6]=y,this.uint8[P+7]=b,this.float32[k+2]=A,i}}jt.prototype.bytesPerElement=12,vt(jt,"StructArrayLayout2i4ub1f12");class un extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,c,h){const m=this.length;return this.resize(m+1),this.emplace(m,i,o,c,h)}emplace(i,o,c,h,m){const y=4*i;return this.float32[y+0]=o,this.float32[y+1]=c,this.float32[y+2]=h,this.float32[y+3]=m,i}}un.prototype.bytesPerElement=16,vt(un,"StructArrayLayout4f16");class Et extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,c,h,m,y,b,A,E,P){const k=this.length;return this.resize(k+1),this.emplace(k,i,o,c,h,m,y,b,A,E,P)}emplace(i,o,c,h,m,y,b,A,E,P,k){const R=10*i;return this.uint16[R+0]=o,this.uint16[R+1]=c,this.uint16[R+2]=h,this.uint16[R+3]=m,this.uint16[R+4]=y,this.uint16[R+5]=b,this.uint16[R+6]=A,this.uint16[R+7]=E,this.uint16[R+8]=P,this.uint16[R+9]=k,i}}Et.prototype.bytesPerElement=20,vt(Et,"StructArrayLayout10ui20");class Wt extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,c,h,m,y,b,A){const E=this.length;return this.resize(E+1),this.emplace(E,i,o,c,h,m,y,b,A)}emplace(i,o,c,h,m,y,b,A,E){const P=8*i;return this.uint16[P+0]=o,this.uint16[P+1]=c,this.uint16[P+2]=h,this.uint16[P+3]=m,this.uint16[P+4]=y,this.uint16[P+5]=b,this.uint16[P+6]=A,this.uint16[P+7]=E,i}}Wt.prototype.bytesPerElement=16,vt(Wt,"StructArrayLayout8ui16");class pn extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,c,h,m,y){const b=this.length;return this.resize(b+1),this.emplace(b,i,o,c,h,m,y)}emplace(i,o,c,h,m,y,b){const A=6*i;return this.int16[A+0]=o,this.int16[A+1]=c,this.int16[A+2]=h,this.int16[A+3]=m,this.int16[A+4]=y,this.int16[A+5]=b,i}}pn.prototype.bytesPerElement=12,vt(pn,"StructArrayLayout6i12");class Kn extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,c,h,m,y,b,A,E,P,k,R){const B=this.length;return this.resize(B+1),this.emplace(B,i,o,c,h,m,y,b,A,E,P,k,R)}emplace(i,o,c,h,m,y,b,A,E,P,k,R,B){const N=12*i;return this.int16[N+0]=o,this.int16[N+1]=c,this.int16[N+2]=h,this.int16[N+3]=m,this.uint16[N+4]=y,this.uint16[N+5]=b,this.uint16[N+6]=A,this.uint16[N+7]=E,this.int16[N+8]=P,this.int16[N+9]=k,this.int16[N+10]=R,this.int16[N+11]=B,i}}Kn.prototype.bytesPerElement=24,vt(Kn,"StructArrayLayout4i4ui4i24");class di extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,c,h,m,y){const b=this.length;return this.resize(b+1),this.emplace(b,i,o,c,h,m,y)}emplace(i,o,c,h,m,y,b){const A=10*i,E=5*i;return this.int16[A+0]=o,this.int16[A+1]=c,this.int16[A+2]=h,this.float32[E+2]=m,this.float32[E+3]=y,this.float32[E+4]=b,i}}di.prototype.bytesPerElement=20,vt(di,"StructArrayLayout3i3f20");class Dn extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint32[1*i+0]=o,i}}Dn.prototype.bytesPerElement=4,vt(Dn,"StructArrayLayout1ul4");class Bi extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,c,h,m,y,b,A,E,P,k,R,B){const N=this.length;return this.resize(N+1),this.emplace(N,i,o,c,h,m,y,b,A,E,P,k,R,B)}emplace(i,o,c,h,m,y,b,A,E,P,k,R,B,N){const q=20*i,Q=10*i;return this.int16[q+0]=o,this.int16[q+1]=c,this.int16[q+2]=h,this.int16[q+3]=m,this.int16[q+4]=y,this.float32[Q+3]=b,this.float32[Q+4]=A,this.float32[Q+5]=E,this.float32[Q+6]=P,this.int16[q+14]=k,this.uint32[Q+8]=R,this.uint16[q+18]=B,this.uint16[q+19]=N,i}}Bi.prototype.bytesPerElement=40,vt(Bi,"StructArrayLayout5i4f1i1ul2ui40");class $o extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,c,h,m,y,b){const A=this.length;return this.resize(A+1),this.emplace(A,i,o,c,h,m,y,b)}emplace(i,o,c,h,m,y,b,A){const E=8*i;return this.int16[E+0]=o,this.int16[E+1]=c,this.int16[E+2]=h,this.int16[E+4]=m,this.int16[E+5]=y,this.int16[E+6]=b,this.int16[E+7]=A,i}}$o.prototype.bytesPerElement=16,vt($o,"StructArrayLayout3i2i2i16");class hs extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,c,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,i,o,c,h,m)}emplace(i,o,c,h,m,y){const b=4*i,A=8*i;return this.float32[b+0]=o,this.float32[b+1]=c,this.float32[b+2]=h,this.int16[A+6]=m,this.int16[A+7]=y,i}}hs.prototype.bytesPerElement=16,vt(hs,"StructArrayLayout2f1f2i16");class ni extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,c,h){const m=this.length;return this.resize(m+1),this.emplace(m,i,o,c,h)}emplace(i,o,c,h,m){const y=12*i,b=3*i;return this.uint8[y+0]=o,this.uint8[y+1]=c,this.float32[b+1]=h,this.float32[b+2]=m,i}}ni.prototype.bytesPerElement=12,vt(ni,"StructArrayLayout2ub2f12");class si extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,c){const h=this.length;return this.resize(h+1),this.emplace(h,i,o,c)}emplace(i,o,c,h){const m=3*i;return this.float32[m+0]=o,this.float32[m+1]=c,this.float32[m+2]=h,i}}si.prototype.bytesPerElement=12,vt(si,"StructArrayLayout3f12");class on extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,c){const h=this.length;return this.resize(h+1),this.emplace(h,i,o,c)}emplace(i,o,c,h){const m=3*i;return this.uint16[m+0]=o,this.uint16[m+1]=c,this.uint16[m+2]=h,i}}on.prototype.bytesPerElement=6,vt(on,"StructArrayLayout3ui6");class Pi extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,o,c,h,m,y,b,A,E,P,k,R,B,N,q,Q,se,he,ae,de,ye){const me=this.length;return this.resize(me+1),this.emplace(me,i,o,c,h,m,y,b,A,E,P,k,R,B,N,q,Q,se,he,ae,de,ye)}emplace(i,o,c,h,m,y,b,A,E,P,k,R,B,N,q,Q,se,he,ae,de,ye,me){const De=30*i,Pe=15*i,Fe=60*i;return this.int16[De+0]=o,this.int16[De+1]=c,this.int16[De+2]=h,this.float32[Pe+2]=m,this.float32[Pe+3]=y,this.uint16[De+8]=b,this.uint16[De+9]=A,this.uint32[Pe+5]=E,this.uint32[Pe+6]=P,this.uint32[Pe+7]=k,this.uint16[De+16]=R,this.uint16[De+17]=B,this.uint16[De+18]=N,this.float32[Pe+10]=q,this.float32[Pe+11]=Q,this.uint8[Fe+48]=se,this.uint8[Fe+49]=he,this.uint8[Fe+50]=ae,this.uint32[Pe+13]=de,this.int16[De+28]=ye,this.uint8[Fe+58]=me,i}}Pi.prototype.bytesPerElement=60,vt(Pi,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class fr extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,o,c,h,m,y,b,A,E,P,k,R,B,N,q,Q,se,he,ae,de,ye,me,De,Pe,Fe,tt,Oe,Ve,qe,Ue){const Qe=this.length;return this.resize(Qe+1),this.emplace(Qe,i,o,c,h,m,y,b,A,E,P,k,R,B,N,q,Q,se,he,ae,de,ye,me,De,Pe,Fe,tt,Oe,Ve,qe,Ue)}emplace(i,o,c,h,m,y,b,A,E,P,k,R,B,N,q,Q,se,he,ae,de,ye,me,De,Pe,Fe,tt,Oe,Ve,qe,Ue,Qe){const Ze=38*i,pt=19*i;return this.int16[Ze+0]=o,this.int16[Ze+1]=c,this.int16[Ze+2]=h,this.float32[pt+2]=m,this.float32[pt+3]=y,this.int16[Ze+8]=b,this.int16[Ze+9]=A,this.int16[Ze+10]=E,this.int16[Ze+11]=P,this.int16[Ze+12]=k,this.int16[Ze+13]=R,this.uint16[Ze+14]=B,this.uint16[Ze+15]=N,this.uint16[Ze+16]=q,this.uint16[Ze+17]=Q,this.uint16[Ze+18]=se,this.uint16[Ze+19]=he,this.uint16[Ze+20]=ae,this.uint16[Ze+21]=de,this.uint16[Ze+22]=ye,this.uint16[Ze+23]=me,this.uint16[Ze+24]=De,this.uint16[Ze+25]=Pe,this.uint16[Ze+26]=Fe,this.uint16[Ze+27]=tt,this.uint16[Ze+28]=Oe,this.uint32[pt+15]=Ve,this.float32[pt+16]=qe,this.float32[pt+17]=Ue,this.float32[pt+18]=Qe,i}}fr.prototype.bytesPerElement=76,vt(fr,"StructArrayLayout3i2f6i15ui1ul3f76");class Fn extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.float32[1*i+0]=o,i}}Fn.prototype.bytesPerElement=4,vt(Fn,"StructArrayLayout1f4");class Ni extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,c,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,i,o,c,h,m)}emplace(i,o,c,h,m,y){const b=5*i;return this.float32[b+0]=o,this.float32[b+1]=c,this.float32[b+2]=h,this.float32[b+3]=m,this.float32[b+4]=y,i}}Ni.prototype.bytesPerElement=20,vt(Ni,"StructArrayLayout5f20");class $a extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,c,h){const m=this.length;return this.resize(m+1),this.emplace(m,i,o,c,h)}emplace(i,o,c,h,m){const y=6*i;return this.uint32[3*i+0]=o,this.uint16[y+2]=c,this.uint16[y+3]=h,this.uint16[y+4]=m,i}}$a.prototype.bytesPerElement=12,vt($a,"StructArrayLayout1ul3ui12");class mr extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o){const c=this.length;return this.resize(c+1),this.emplace(c,i,o)}emplace(i,o,c){const h=2*i;return this.uint16[h+0]=o,this.uint16[h+1]=c,i}}mr.prototype.bytesPerElement=4,vt(mr,"StructArrayLayout2ui4");class da extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint16[1*i+0]=o,i}}da.prototype.bytesPerElement=2,vt(da,"StructArrayLayout1ui2");class Ao extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o){const c=this.length;return this.resize(c+1),this.emplace(c,i,o)}emplace(i,o,c){const h=2*i;return this.float32[h+0]=o,this.float32[h+1]=c,i}}Ao.prototype.bytesPerElement=8,vt(Ao,"StructArrayLayout2f8");class Ga extends ke{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}Ga.prototype.size=12;class rr extends pn{get(i){return new Ga(this,i)}}vt(rr,"FillExtrusionExtArray");class Go extends ke{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Go.prototype.size=40;class lo extends Bi{get(i){return new Go(this,i)}}vt(lo,"CollisionBoxArray");class ps extends ke{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(i){this._structArray.uint8[this._pos1+49]=i}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(i){this._structArray.uint8[this._pos1+50]=i}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(i){this._structArray.uint32[this._pos4+13]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(i){this._structArray.uint8[this._pos1+58]=i}}ps.prototype.size=60;class Tc extends Pi{get(i){return new ps(this,i)}}vt(Tc,"PlacedSymbolArray");class Xf extends ke{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(i){this._structArray.uint32[this._pos4+15]=i}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Xf.prototype.size=76;class gp extends fr{get(i){return new Xf(this,i)}}vt(gp,"SymbolInstanceArray");class Mc extends Fn{getoffsetX(i){return this.float32[1*i+0]}}vt(Mc,"GlyphOffsetArray");class $v extends wt{getx(i){return this.int16[3*i+0]}gety(i){return this.int16[3*i+1]}gettileUnitDistanceFromAnchor(i){return this.int16[3*i+2]}}vt($v,"SymbolLineVertexArray");class Qg extends ke{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Qg.prototype.size=12;class Bn extends $a{get(i){return new Qg(this,i)}}vt(Bn,"FeatureIndexArray");class Kg extends ke{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}Kg.prototype.size=4;class Gv extends mr{get(i){return new Kg(this,i)}}vt(Gv,"FillExtrusionCentroidArray");class Hv extends ke{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}Hv.prototype.size=12;class qv extends pn{get(i){return new Hv(this,i)}}vt(qv,"CircleGlobeExtArray");const nw=He([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),iw=He([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var Zv=Ui(function(s){s.exports=function(i,o){var c,h,m,y,b,A,E,P;for(h=i.length-(c=3&i.length),m=o,b=3432918353,A=461845907,P=0;P<h;)E=255&i.charCodeAt(P)|(255&i.charCodeAt(++P))<<8|(255&i.charCodeAt(++P))<<16|(255&i.charCodeAt(++P))<<24,++P,m=27492+(65535&(y=5*(65535&(m=(m^=E=(65535&(E=(E=(65535&E)*b+(((E>>>16)*b&65535)<<16)&4294967295)<<15|E>>>17))*A+(((E>>>16)*A&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(E=0,c){case 3:E^=(255&i.charCodeAt(P+2))<<16;case 2:E^=(255&i.charCodeAt(P+1))<<8;case 1:m^=E=(65535&(E=(E=(65535&(E^=255&i.charCodeAt(P)))*b+(((E>>>16)*b&65535)<<16)&4294967295)<<15|E>>>17))*A+(((E>>>16)*A&65535)<<16)&4294967295}return m^=i.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}}),nh=Ui(function(s){s.exports=function(i,o){for(var c,h=i.length,m=o^h,y=0;h>=4;)c=1540483477*(65535&(c=255&i.charCodeAt(y)|(255&i.charCodeAt(++y))<<8|(255&i.charCodeAt(++y))<<16|(255&i.charCodeAt(++y))<<24))+((1540483477*(c>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),h-=4,++y;switch(h){case 3:m^=(255&i.charCodeAt(y+2))<<16;case 2:m^=(255&i.charCodeAt(y+1))<<8;case 1:m=1540483477*(65535&(m^=255&i.charCodeAt(y)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}}),_p=Zv,or=nh;_p.murmur3=Zv,_p.murmur2=or;class Yu{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,o,c,h){this.ids.push(Xu(i)),this.positions.push(o,c,h)}getPositions(i){const o=Xu(i);let c=0,h=this.ids.length-1;for(;c<h;){const y=c+h>>1;this.ids[y]>=o?h=y:c=y+1}const m=[];for(;this.ids[c]===o;)m.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return m}static serialize(i,o){const c=new Float64Array(i.ids),h=new Uint32Array(i.positions);return Jg(c,h,0,c.length-1),o&&o.push(c.buffer,h.buffer),{ids:c,positions:h}}static deserialize(i){const o=new Yu;return o.ids=i.ids,o.positions=i.positions,o.indexed=!0,o}}function Xu(s){const i=+s;return!isNaN(i)&&Number.MIN_SAFE_INTEGER<=i&&i<=Number.MAX_SAFE_INTEGER?i:_p(String(s))}function Jg(s,i,o,c){for(;o<c;){const h=s[o+c>>1];let m=o-1,y=c+1;for(;;){do{m++}while(s[m]<h);do{y--}while(s[y]>h);if(m>=y)break;yp(s,m,y),yp(i,3*m,3*y),yp(i,3*m+1,3*y+1),yp(i,3*m+2,3*y+2)}y-o<c-y?(Jg(s,i,o,y),o=y+1):(Jg(s,i,y+1,c),c=y)}}function yp(s,i,o){const c=s[i];s[i]=s[o],s[o]=c}vt(Yu,"FeaturePositionMap");class Xi{constructor(i){this.gl=i.gl,this.initialized=!1}fetchUniformLocation(i,o){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(i,o),this.initialized=!0),!!this.location}}class Ho extends Xi{constructor(i){super(i),this.current=0}set(i,o,c){this.fetchUniformLocation(i,o)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class Qf extends Xi{constructor(i){super(i),this.current=[0,0,0,0]}set(i,o,c){this.fetchUniformLocation(i,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class ih extends Xi{constructor(i){super(i),this.current=qn.transparent}set(i,o,c){this.fetchUniformLocation(i,o)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const rh=new Float32Array(16),e_=new Float32Array(9),Wv=new Float32Array(4);function Kf(s){return[Ge(255*s.r,255*s.g),Ge(255*s.b,255*s.a)]}class vp{constructor(i,o,c){this.value=i,this.uniformNames=o.map(h=>`u_${h}`),this.type=c}setUniform(i,o,c,h,m){o.set(i,m,h.constantOr(this.value))}getBinding(i,o){return"color"===this.type?new ih(i):new Ho(i)}}class oh{constructor(i,o){this.uniformNames=o.map(c=>`u_${c}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(i,o){this.pixelRatioFrom=o.pixelRatio||1,this.pixelRatioTo=i.pixelRatio||1,this.patternFrom=o.tl.concat(o.br),this.patternTo=i.tl.concat(i.br)}setUniform(i,o,c,h,m){const y="u_pattern_to"===m||"u_dash_to"===m?this.patternTo:"u_pattern_from"===m||"u_dash_from"===m?this.patternFrom:"u_pixel_ratio_to"===m?this.pixelRatioTo:"u_pixel_ratio_from"===m?this.pixelRatioFrom:null;y&&o.set(i,m,y)}getBinding(i,o){return"u_pattern_from"===o||"u_pattern_to"===o||"u_dash_from"===o||"u_dash_to"===o?new Qf(i):new Ho(i)}}class ha{constructor(i,o,c,h){this.expression=i,this.type=c,this.maxValue=0,this.paintVertexAttributes=o.map(m=>({name:`a_${m}`,type:"Float32",components:"color"===c?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(i,o,c,h,m,y){const b=this.paintVertexArray.length,A=this.expression.evaluate(new J(0),o,{},m,h,y);this.paintVertexArray.resize(i),this._setPaintValue(b,i,A)}updatePaintArray(i,o,c,h,m){const y=this.expression.evaluate({zoom:0},c,h,void 0,m);this._setPaintValue(i,o,y)}_setPaintValue(i,o,c){if("color"===this.type){const h=Kf(c);for(let m=i;m<o;m++)this.paintVertexArray.emplace(m,h[0],h[1])}else{for(let h=i;h<o;h++)this.paintVertexArray.emplace(h,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Oi{constructor(i,o,c,h,m,y){this.expression=i,this.uniformNames=o.map(b=>`u_${b}_t`),this.type=c,this.useIntegerZoom=h,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=o.map(b=>({name:`a_${b}`,type:"Float32",components:"color"===c?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(i,o,c,h,m,y){const b=this.expression.evaluate(new J(this.zoom),o,{},m,h,y),A=this.expression.evaluate(new J(this.zoom+1),o,{},m,h,y),E=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(E,i,b,A)}updatePaintArray(i,o,c,h,m){const y=this.expression.evaluate({zoom:this.zoom},c,h,void 0,m),b=this.expression.evaluate({zoom:this.zoom+1},c,h,void 0,m);this._setPaintValue(i,o,y,b)}_setPaintValue(i,o,c,h){if("color"===this.type){const m=Kf(c),y=Kf(h);for(let b=i;b<o;b++)this.paintVertexArray.emplace(b,m[0],m[1],y[0],y[1])}else{for(let m=i;m<o;m++)this.paintVertexArray.emplace(m,c,h);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(h))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,o,c,h,m){const y=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,b=Zt(this.expression.interpolationFactor(y,this.zoom,this.zoom+1),0,1);o.set(i,m,b)}getBinding(i,o){return new Ho(i)}}class pa{constructor(i,o,c,h,m,y,b){this.expression=i,this.type=c,this.useIntegerZoom=h,this.zoom=m,this.layerId=b,this.paintVertexAttributes=("array"===c?iw:nw).members;for(let A=0;A<o.length;++A);this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(i,o,c){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(h,i,o.patterns&&o.patterns[this.layerId],c)}updatePaintArray(i,o,c,h,m,y){this._setPaintValues(i,o,c.patterns&&c.patterns[this.layerId],y)}_setPaintValues(i,o,c,h){if(!h||!c)return;const{min:m,mid:y,max:b}=c,A=h[m],E=h[y],P=h[b];if(A&&E&&P)for(let k=i;k<o;k++)this._setPaintValue(this.zoomInPaintVertexArray,k,E,A),this._setPaintValue(this.zoomOutPaintVertexArray,k,E,P)}_setPaintValue(i,o,c,h){i.emplace(o,c.tl[0],c.tl[1],c.br[0],c.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1],c.pixelRatio,h.pixelRatio)}upload(i){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class qo{constructor(i,o,c=(()=>!0)){this.binders={},this._buffers=[];const h=[];for(const m in i.paint._values){if(!c(m))continue;const y=i.paint.get(m);if(!(y instanceof pe&&Dl(y.property.specification)))continue;const b=Yv(m,i.type),A=y.value,E=y.property.specification.type,P=y.property.useIntegerZoom,k=y.property.specification["property-type"],R="cross-faded"===k||"cross-faded-data-driven"===k,B="line-dasharray"===String(m)&&"constant"!==i.layout.get("line-cap").value.kind;if("constant"!==A.kind||B)if("source"===A.kind||B||R){const N=n_(m,E,"source");this.binders[m]=R?new pa(A,b,E,P,o,N,i.id):new ha(A,b,E,N),h.push(`/a_${m}`)}else{const N=n_(m,E,"composite");this.binders[m]=new Oi(A,b,E,P,o,N),h.push(`/z_${m}`)}else this.binders[m]=R?new oh(A.value,b):new vp(A.value,b,E),h.push(`/u_${m}`)}this.cacheKey=h.sort().join("")}getMaxValue(i){const o=this.binders[i];return o instanceof ha||o instanceof Oi?o.maxValue:0}populatePaintArrays(i,o,c,h,m,y){for(const b in this.binders){const A=this.binders[b];(A instanceof ha||A instanceof Oi||A instanceof pa)&&A.populatePaintArray(i,o,c,h,m,y)}}setConstantPatternPositions(i,o){for(const c in this.binders){const h=this.binders[c];h instanceof oh&&h.setConstantPatternPositions(i,o)}}updatePaintArrays(i,o,c,h,m,y){let b=!1;for(const A in i){const E=o.getPositions(A);for(const P of E){const k=c.feature(P.index);for(const R in this.binders){const B=this.binders[R];if((B instanceof ha||B instanceof Oi||B instanceof pa)&&!0===B.expression.isStateDependent){const N=h.paint.get(R);B.expression=N.value,B.updatePaintArray(P.start,P.end,k,i[A],m,y),b=!0}}}}return b}defines(){const i=[];for(const o in this.binders){const c=this.binders[o];(c instanceof vp||c instanceof oh)&&i.push(...c.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return i}getBinderAttributes(){const i=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof ha||c instanceof Oi||c instanceof pa)for(let h=0;h<c.paintVertexAttributes.length;h++)i.push(c.paintVertexAttributes[h].name)}return i}getBinderUniforms(){const i=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof vp||c instanceof oh||c instanceof Oi)for(const h of c.uniformNames)i.push(h)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i){const o=[];for(const c in this.binders){const h=this.binders[c];if(h instanceof vp||h instanceof oh||h instanceof Oi)for(const m of h.uniformNames)o.push({name:m,property:c,binding:h.getBinding(i,m)})}return o}setUniforms(i,o,c,h,m){for(const{name:y,property:b,binding:A}of c)this.binders[b].setUniform(i,A,m,h.get(b),y)}updatePaintBuffers(i){this._buffers=[];for(const o in this.binders){const c=this.binders[o];if(i&&c instanceof pa){const h=2===i.fromScale?c.zoomInPaintVertexBuffer:c.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(c instanceof ha||c instanceof Oi)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(i){for(const o in this.binders){const c=this.binders[o];(c instanceof ha||c instanceof Oi||c instanceof pa)&&c.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const o=this.binders[i];(o instanceof ha||o instanceof Oi||o instanceof pa)&&o.destroy()}}}class Qu{constructor(i,o,c=(()=>!0)){this.programConfigurations={};for(const h of i)this.programConfigurations[h.id]=new qo(h,o,c);this.needsUpload=!1,this._featureMap=new Yu,this._bufferOffset=0}populatePaintArrays(i,o,c,h,m,y,b){for(const A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(i,o,h,m,y,b);void 0!==o.id&&this._featureMap.add(o.id,c,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,o,c,h,m){for(const y of c)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(i,this._featureMap,o,y,h,m)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}const t_={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function Yv(s,i){return t_[s]||[s.replace(`${i}-`,"").replace(/-/g,"_")]}const Xv={"line-pattern":{source:Et,composite:Et},"fill-pattern":{source:Et,composite:Et},"fill-extrusion-pattern":{source:Et,composite:Et},"line-dasharray":{source:Wt,composite:Wt}},Qv={color:{source:Ao,composite:un},number:{source:Fn,composite:Ao}};function n_(s,i,o){const c=Xv[s];return c&&c[o]||Qv[i][o]}vt(vp,"ConstantBinder"),vt(oh,"CrossFadedConstantBinder"),vt(ha,"SourceExpressionBinder"),vt(pa,"CrossFadedCompositeBinder"),vt(Oi,"CompositeExpressionBinder"),vt(qo,"ProgramConfiguration",{omit:["_buffers"]}),vt(Qu,"ProgramConfigurationSet");const xp="-transition";class fs extends Rt{constructor(i,o){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==i.type&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,"background"!==i.type&&"sky"!==i.type&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),o.layout&&(this._unevaluatedLayout=new ge(o.layout)),o.paint)){this._transitionablePaint=new re(o.paint);for(const c in i.paint)this.setPaintProperty(c,i.paint[c],{validate:!1});for(const c in i.layout)this.setLayoutProperty(c,i.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ve(o.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(i){return"visibility"===i?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,o,c={}){null!=o&&this._validate($u,`layers.${this.id}.layout.${i}`,i,o,c)||("visibility"!==i?this._unevaluatedLayout.setValue(i,o):this.visibility=o)}getPaintProperty(i){return yo(i,xp)?this._transitionablePaint.getTransition(i.slice(0,-xp.length)):this._transitionablePaint.getValue(i)}setPaintProperty(i,o,c={}){if(null!=o&&this._validate(vc,`layers.${this.id}.paint.${i}`,i,o,c))return!1;if(yo(i,xp))return this._transitionablePaint.setTransition(i.slice(0,-xp.length),o||void 0),!1;{const h=this._transitionablePaint._values[i],m="cross-faded-data-driven"===h.property.specification["property-type"],y=h.value.isDataDriven(),b=h.value;this._transitionablePaint.setValue(i,o),this._handleSpecialPaintPropertyUpdate(i);const A=this._transitionablePaint._values[i].value;return A.isDataDriven()||y||m||this._handleOverridablePaintPropertyUpdate(i,b,A)}}_handleSpecialPaintPropertyUpdate(i){}getProgramIds(){return null}getProgramConfiguration(i){return null}_handleOverridablePaintPropertyUpdate(i,o,c){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||"none"===this.visibility}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,o){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,o)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),Qs(i,(o,c)=>!(void 0===o||"layout"===c&&!Object.keys(o).length||"paint"===c&&!Object.keys(o).length))}_validate(i,o,c,h,m={}){return(!m||!1!==m.validate)&&Gu(this,i.call(No,{key:o,layerType:this.type,objectKey:c,value:h,styleSpec:Re,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const o=this.paint.get(i);if(o instanceof pe&&Dl(o.property.specification)&&("source"===o.value.kind||"composite"===o.value.kind)&&o.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Ba(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Jf=He([{name:"a_pos",components:2,type:"Int16"}],4),bp=He([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Hi{constructor(i=[]){this.segments=i}prepareSegment(i,o,c,h){let m=this.segments[this.segments.length-1];return i>Hi.MAX_VERTEX_ARRAY_LENGTH&&vi(`Max vertices per segment is ${Hi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!m||m.vertexLength+i>Hi.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==h)&&(m={vertexOffset:o.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},void 0!==h&&(m.sortKey=h),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const i of this.segments)for(const o in i.vaos)i.vaos[o].destroy()}static simpleSegment(i,o,c,h){return new Hi([{vertexOffset:i,primitiveOffset:o,vertexLength:c,primitiveLength:h,vaos:{},sortKey:0}])}}Hi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,vt(Hi,"SegmentVector");var zt=8192;class fa{constructor(i,o){i&&(o?this.setSouthWest(i).setNorthEast(o):4===i.length?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1]))}setNorthEast(i){return this._ne=i instanceof kn?new kn(i.lng,i.lat):kn.convert(i),this}setSouthWest(i){return this._sw=i instanceof kn?new kn(i.lng,i.lat):kn.convert(i),this}extend(i){const o=this._sw,c=this._ne;let h,m;if(i instanceof kn)h=i,m=i;else{if(!(i instanceof fa))return Array.isArray(i)?4===i.length||i.every(Array.isArray)?this.extend(fa.convert(i)):this.extend(kn.convert(i)):this;if(h=i._sw,m=i._ne,!h||!m)return this}return o||c?(o.lng=Math.min(h.lng,o.lng),o.lat=Math.min(h.lat,o.lat),c.lng=Math.max(m.lng,c.lng),c.lat=Math.max(m.lat,c.lat)):(this._sw=new kn(h.lng,h.lat),this._ne=new kn(m.lng,m.lat)),this}getCenter(){return new kn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new kn(this.getWest(),this.getNorth())}getSouthEast(){return new kn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:o,lat:c}=kn.convert(i);let h=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&h}static convert(i){return!i||i instanceof fa?i:new fa(i)}}const Ku=6371008.8;class kn{constructor(i,o){if(isNaN(i)||isNaN(o))throw new Error(`Invalid LngLat object: (${i}, ${o})`);if(this.lng=+i,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new kn(ts(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const o=Math.PI/180,c=this.lat*o,h=i.lat*o,m=Math.sin(c)*Math.sin(h)+Math.cos(c)*Math.cos(h)*Math.cos((i.lng-this.lng)*o);return Ku*Math.acos(Math.min(m,1))}toBounds(i=0){const o=360*i/40075017,c=o/Math.cos(Math.PI/180*this.lat);return new fa(new kn(this.lng-c,this.lat-o),new kn(this.lng+c,this.lat+o))}static convert(i){if(i instanceof kn)return i;if(Array.isArray(i)&&(2===i.length||3===i.length))return new kn(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&"object"==typeof i&&null!==i)return new kn(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const i_=2*Math.PI*Ku;function em(s){return i_*Math.cos(s*Math.PI/180)}function Ls(s){return(180+s)/360}function Ha(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function jr(s,i){return s/em(i)}function Zo(s){return 360*s-180}function gr(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function Jt(s,i){return s*em(gr(i))}const zs=85.051129;function r_(s){return 1/Math.cos(s*Math.PI/180)}class zl{constructor(i,o,c=0){this.x=+i,this.y=+o,this.z=+c}static fromLngLat(i,o=0){const c=kn.convert(i);return new zl(Ls(c.lng),Ha(c.lat),jr(o,c.lat))}toLngLat(){return new kn(Zo(this.x),gr(this.y))}toAltitude(){return Jt(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/i_*r_(gr(this.y))}}function Sc(s,i,o,c,h,m,y,b,A){const E=(i+c)/2,P=(o+h)/2,k=new dt(E,P);b(k),function(R,B,N,q,Q,se){const he=N-Q,ae=q-se;return Math.abs((q-B)*he-(N-R)*ae)/Math.hypot(he,ae)}(k.x,k.y,m.x,m.y,y.x,y.y)>=A?(Sc(s,i,o,E,P,m,k,b,A),Sc(s,E,P,c,h,k,y,b,A)):s.push(y)}function o_(s,i,o){let c=s[0],h=c.x,m=c.y;i(c);const y=[c];for(let b=1;b<s.length;b++){const A=s[b],{x:E,y:P}=A;i(A),Sc(y,h,m,E,P,c,A,i,o),h=E,m=P,c=A}return y}function tm(s,i,o,c,h){if(h(i,o)){const m=i.add(o).mult(.5);c(m),tm(s,i,m,c,h),tm(s,m,o,c,h)}else s.push(o)}function Kv(s,i,o){let c=s[0];i(c);const h=[c];for(let m=1;m<s.length;m++){const y=s[m];i(y),tm(h,c,y,i,o),c=y}return h}const Ju=Math.pow(2,14)-1,qa=-Ju-1;function s_(s,i){const o=Math.round(s.x*i),c=Math.round(s.y*i);return s.x=Zt(o,qa,Ju),s.y=Zt(c,qa,Ju),(o<s.x||o>s.x+1||c<s.y||c>s.y+1)&&vi("Geometry exceeds allowed extent, reduce your vector tile buffer size"),s}function Wo(s,i,o){const c=s.loadGeometry(),h=s.extent,m=zt/h;if(i&&o&&o.projection.isReprojectedInTileSpace){const y=1<<i.z,{scale:b,x:A,y:E,projection:P}=o,k=R=>{const B=Zo((i.x+R.x/h)/y),N=gr((i.y+R.y/h)/y),q=P.project(B,N);R.x=(q.x*b-A)*h,R.y=(q.y*b-E)*h};for(let R=0;R<c.length;R++)if(1!==s.type)c[R]=o_(c[R],k,1);else{const B=[];for(const N of c[R])N.x<0||N.x>=h||N.y<0||N.y>=h||(k(N),B.push(N));c[R]=B}}for(const y of c)for(const b of y)s_(b,m);return c}function Dc(s,i){return{type:s.type,id:s.id,properties:s.properties,geometry:i?Wo(s):[]}}function sh(s,i,o,c,h){s.emplaceBack(2*i+(c+1)/2,2*o+(h+1)/2)}function ed(s,i,o){s.emplaceBack(i.x,i.y,i.z,16384*o[0],16384*o[1],16384*o[2])}class td{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasPattern=!1,this.projection=i.projection,this.layoutVertexArray=new lt,this.indexArray=new on,this.segments=new Hi,this.programConfigurations=new Qu(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,c,h){const m=this.layers[0],y=[];let b=null;"circle"===m.type&&(b=m.layout.get("circle-sort-key"));for(const{feature:E,id:P,index:k,sourceLayerIndex:R}of i){const B=this.layers[0]._featureFilter.needGeometry,N=Dc(E,B);if(!this.layers[0]._featureFilter.filter(new J(this.zoom),N,c))continue;const q=b?b.evaluate(N,{},c):void 0,Q={id:P,properties:E.properties,type:E.type,sourceLayerIndex:R,index:k,geometry:B?N.geometry:Wo(E,c,h),patterns:{},sortKey:q};y.push(Q)}b&&y.sort((E,P)=>E.sortKey-P.sortKey);let A=null;"globe"===h.projection.name&&(this.globeExtVertexArray=new qv,A=h.projection);for(const E of y){const{geometry:P,index:k,sourceLayerIndex:R}=E,B=i[k].feature;this.addFeature(E,P,k,o.availableImages,c,A),o.featureIndex.insert(B,P,k,R,this.index)}}update(i,o,c,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,c,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Jf.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,bp.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(i,o,c,h,m,y){for(const b of o)for(const A of b){const E=A.x,P=A.y;if(E<0||E>=zt||P<0||P>=zt)continue;if(y){const B=y.projectTilePoint(E,P,m),N=y.upVector(m,E,P),q=this.globeExtVertexArray;ed(q,B,N),ed(q,B,N),ed(q,B,N),ed(q,B,N)}const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),R=k.vertexLength;sh(this.layoutVertexArray,E,P,-1,-1),sh(this.layoutVertexArray,E,P,1,-1),sh(this.layoutVertexArray,E,P,1,1),sh(this.layoutVertexArray,E,P,-1,1),this.indexArray.emplaceBack(R,R+1,R+2),this.indexArray.emplaceBack(R,R+2,R+3),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,c,{},h,m)}}function nm(s,i){for(let o=0;o<s.length;o++)if(id(i,s[o]))return!0;for(let o=0;o<i.length;o++)if(id(s,i[o]))return!0;return!!Ic(s,i)}function Jv(s,i,o){return!!id(s,i)||!!l_(i,s,o)}function a_(s,i){if(1===s.length)return c_(i,s[0]);for(let o=0;o<i.length;o++){const c=i[o];for(let h=0;h<c.length;h++)if(id(s,c[h]))return!0}for(let o=0;o<s.length;o++)if(c_(i,s[o]))return!0;for(let o=0;o<i.length;o++)if(Ic(s,i[o]))return!0;return!1}function nd(s,i,o){if(s.length>1){if(Ic(s,i))return!0;for(let c=0;c<i.length;c++)if(l_(i[c],s,o))return!0}for(let c=0;c<s.length;c++)if(l_(s[c],i,o))return!0;return!1}function Ic(s,i){if(0===s.length||0===i.length)return!1;for(let o=0;o<s.length-1;o++){const c=s[o],h=s[o+1];for(let m=0;m<i.length-1;m++)if(e0(c,h,i[m],i[m+1]))return!0}return!1}function e0(s,i,o,c){return ur(s,o,c)!==ur(i,o,c)&&ur(s,i,o)!==ur(s,i,c)}function l_(s,i,o){const c=o*o;if(1===i.length)return s.distSqr(i[0])<c;for(let h=1;h<i.length;h++)if(im(s,i[h-1],i[h])<c)return!0;return!1}function im(s,i,o){const c=i.distSqr(o);if(0===c)return s.distSqr(i);const h=((s.x-i.x)*(o.x-i.x)+(s.y-i.y)*(o.y-i.y))/c;return s.distSqr(h<0?i:h>1?o:o.sub(i)._mult(h)._add(i))}function c_(s,i){let o,c,h,m=!1;for(let y=0;y<s.length;y++){o=s[y];for(let b=0,A=o.length-1;b<o.length;A=b++)c=o[b],h=o[A],c.y>i.y!=h.y>i.y&&i.x<(h.x-c.x)*(i.y-c.y)/(h.y-c.y)+c.x&&(m=!m)}return m}function id(s,i){let o=!1;for(let c=0,h=s.length-1;c<s.length;h=c++){const m=s[c],y=s[h];m.y>i.y!=y.y>i.y&&i.x<(y.x-m.x)*(i.y-m.y)/(y.y-m.y)+m.x&&(o=!o)}return o}function u_(s,i,o,c,h){for(const y of s)if(i<=y.x&&o<=y.y&&c>=y.x&&h>=y.y)return!0;const m=[new dt(i,o),new dt(i,h),new dt(c,h),new dt(c,o)];if(s.length>2)for(const y of m)if(id(s,y))return!0;for(let y=0;y<s.length-1;y++)if(t0(s[y],s[y+1],m))return!0;return!1}function t0(s,i,o){const c=o[0],h=o[2];if(s.x<c.x&&i.x<c.x||s.x>h.x&&i.x>h.x||s.y<c.y&&i.y<c.y||s.y>h.y&&i.y>h.y)return!1;const m=ur(s,i,o[0]);return m!==ur(s,i,o[1])||m!==ur(s,i,o[2])||m!==ur(s,i,o[3])}function rd(s,i,o){const c=i.paint.get(s).value;return"constant"===c.kind?c.value:o.programConfigurations.get(i.id).getMaxValue(s)}function Pc(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function wp(s,i,o,c,h){if(!i[0]&&!i[1])return s;const m=dt.convert(i)._mult(h);"viewport"===o&&m._rotate(-c);const y=[];for(let b=0;b<s.length;b++)y.push(s[b].sub(m));return y}function Oc(s,i,o,c){const h=dt.convert(s)._mult(c);return"viewport"===i&&h._rotate(-o),h}vt(td,"CircleBucket",{omit:["layers"]});const n0=new je({"circle-sort-key":new Ce(Re.layout_circle["circle-sort-key"])});var r0={paint:new je({"circle-radius":new Ce(Re.paint_circle["circle-radius"]),"circle-color":new Ce(Re.paint_circle["circle-color"]),"circle-blur":new Ce(Re.paint_circle["circle-blur"]),"circle-opacity":new Ce(Re.paint_circle["circle-opacity"]),"circle-translate":new _e(Re.paint_circle["circle-translate"]),"circle-translate-anchor":new _e(Re.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new _e(Re.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new _e(Re.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ce(Re.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ce(Re.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ce(Re.paint_circle["circle-stroke-opacity"])}),layout:n0},rm=1e-6,Sr="undefined"!=typeof Float32Array?Float32Array:Array;function Cp(){var s=new Sr(9);return Sr!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function Fs(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Ap(s,i){var o=i[0],c=i[1],h=i[2],m=i[3],y=i[4],b=i[5],A=i[6],E=i[7],P=i[8],k=i[9],R=i[10],B=i[11],N=i[12],q=i[13],Q=i[14],se=i[15],he=o*b-c*y,ae=o*A-h*y,de=o*E-m*y,ye=c*A-h*b,me=c*E-m*b,De=h*E-m*A,Pe=P*q-k*N,Fe=P*Q-R*N,tt=P*se-B*N,Oe=k*Q-R*q,Ve=k*se-B*q,qe=R*se-B*Q,Ue=he*qe-ae*Ve+de*Oe+ye*tt-me*Fe+De*Pe;return Ue?(s[0]=(b*qe-A*Ve+E*Oe)*(Ue=1/Ue),s[1]=(h*Ve-c*qe-m*Oe)*Ue,s[2]=(q*De-Q*me+se*ye)*Ue,s[3]=(R*me-k*De-B*ye)*Ue,s[4]=(A*tt-y*qe-E*Fe)*Ue,s[5]=(o*qe-h*tt+m*Fe)*Ue,s[6]=(Q*de-N*De-se*ae)*Ue,s[7]=(P*De-R*de+B*ae)*Ue,s[8]=(y*Ve-b*tt+E*Pe)*Ue,s[9]=(c*tt-o*Ve-m*Pe)*Ue,s[10]=(N*me-q*de+se*he)*Ue,s[11]=(k*de-P*me-B*he)*Ue,s[12]=(b*Fe-y*Oe-A*Pe)*Ue,s[13]=(o*Oe-c*Fe+h*Pe)*Ue,s[14]=(q*ae-N*ye-Q*he)*Ue,s[15]=(P*ye-k*ae+R*he)*Ue,s):null}function kc(s,i,o){var c=i[0],h=i[1],m=i[2],y=i[3],b=i[4],A=i[5],E=i[6],P=i[7],k=i[8],R=i[9],B=i[10],N=i[11],q=i[12],Q=i[13],se=i[14],he=i[15],ae=o[0],de=o[1],ye=o[2],me=o[3];return s[0]=ae*c+de*b+ye*k+me*q,s[1]=ae*h+de*A+ye*R+me*Q,s[2]=ae*m+de*E+ye*B+me*se,s[3]=ae*y+de*P+ye*N+me*he,s[4]=(ae=o[4])*c+(de=o[5])*b+(ye=o[6])*k+(me=o[7])*q,s[5]=ae*h+de*A+ye*R+me*Q,s[6]=ae*m+de*E+ye*B+me*se,s[7]=ae*y+de*P+ye*N+me*he,s[8]=(ae=o[8])*c+(de=o[9])*b+(ye=o[10])*k+(me=o[11])*q,s[9]=ae*h+de*A+ye*R+me*Q,s[10]=ae*m+de*E+ye*B+me*se,s[11]=ae*y+de*P+ye*N+me*he,s[12]=(ae=o[12])*c+(de=o[13])*b+(ye=o[14])*k+(me=o[15])*q,s[13]=ae*h+de*A+ye*R+me*Q,s[14]=ae*m+de*E+ye*B+me*se,s[15]=ae*y+de*P+ye*N+me*he,s}function od(s,i,o){var c,h,m,y,b,A,E,P,k,R,B,N,q=o[0],Q=o[1],se=o[2];return i===s?(s[12]=i[0]*q+i[4]*Q+i[8]*se+i[12],s[13]=i[1]*q+i[5]*Q+i[9]*se+i[13],s[14]=i[2]*q+i[6]*Q+i[10]*se+i[14],s[15]=i[3]*q+i[7]*Q+i[11]*se+i[15]):(h=i[1],m=i[2],y=i[3],b=i[4],A=i[5],E=i[6],P=i[7],k=i[8],R=i[9],B=i[10],N=i[11],s[0]=c=i[0],s[1]=h,s[2]=m,s[3]=y,s[4]=b,s[5]=A,s[6]=E,s[7]=P,s[8]=k,s[9]=R,s[10]=B,s[11]=N,s[12]=c*q+b*Q+k*se+i[12],s[13]=h*q+A*Q+R*se+i[13],s[14]=m*q+E*Q+B*se+i[14],s[15]=y*q+P*Q+N*se+i[15]),s}function Rc(s,i,o){var c=o[0],h=o[1],m=o[2];return s[0]=i[0]*c,s[1]=i[1]*c,s[2]=i[2]*c,s[3]=i[3]*c,s[4]=i[4]*h,s[5]=i[5]*h,s[6]=i[6]*h,s[7]=i[7]*h,s[8]=i[8]*m,s[9]=i[9]*m,s[10]=i[10]*m,s[11]=i[11]*m,s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15],s}function om(s,i,o){var c=Math.sin(o),h=Math.cos(o),m=i[4],y=i[5],b=i[6],A=i[7],E=i[8],P=i[9],k=i[10],R=i[11];return i!==s&&(s[0]=i[0],s[1]=i[1],s[2]=i[2],s[3]=i[3],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[4]=m*h+E*c,s[5]=y*h+P*c,s[6]=b*h+k*c,s[7]=A*h+R*c,s[8]=E*h-m*c,s[9]=P*h-y*c,s[10]=k*h-b*c,s[11]=R*h-A*c,s}function Ep(s,i,o){var c=Math.sin(o),h=Math.cos(o),m=i[0],y=i[1],b=i[2],A=i[3],E=i[8],P=i[9],k=i[10],R=i[11];return i!==s&&(s[4]=i[4],s[5]=i[5],s[6]=i[6],s[7]=i[7],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[0]=m*h-E*c,s[1]=y*h-P*c,s[2]=b*h-k*c,s[3]=A*h-R*c,s[8]=m*c+E*h,s[9]=y*c+P*h,s[10]=b*c+k*h,s[11]=A*c+R*h,s}function d_(s,i){return s[0]=i[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=i[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=i[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function h_(s,i,o){var c,h,m,y=o[0],b=o[1],A=o[2],E=Math.hypot(y,b,A);return E<rm?null:(y*=E=1/E,b*=E,A*=E,c=Math.sin(i),h=Math.cos(i),s[0]=y*y*(m=1-h)+h,s[1]=b*y*m+A*c,s[2]=A*y*m-b*c,s[3]=0,s[4]=y*b*m-A*c,s[5]=b*b*m+h,s[6]=A*b*m+y*c,s[7]=0,s[8]=y*A*m+b*c,s[9]=b*A*m-y*c,s[10]=A*A*m+h,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s)}Math.hypot||(Math.hypot=function(){for(var s=0,i=arguments.length;i--;)s+=arguments[i]*arguments[i];return Math.sqrt(s)});var Fl=kc;function Lc(){var s=new Sr(3);return Sr!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function p_(s){var i=new Sr(3);return i[0]=s[0],i[1]=s[1],i[2]=s[2],i}function Tp(s){return Math.hypot(s[0],s[1],s[2])}function ah(s,i,o){var c=new Sr(3);return c[0]=s,c[1]=i,c[2]=o,c}function zc(s,i,o){return s[0]=i[0]+o[0],s[1]=i[1]+o[1],s[2]=i[2]+o[2],s}function f_(s,i,o){return s[0]=i[0]-o[0],s[1]=i[1]-o[1],s[2]=i[2]-o[2],s}function o0(s,i,o){return s[0]=i[0]*o[0],s[1]=i[1]*o[1],s[2]=i[2]*o[2],s}function Mp(s,i,o){return s[0]=Math.min(i[0],o[0]),s[1]=Math.min(i[1],o[1]),s[2]=Math.min(i[2],o[2]),s}function sm(s,i,o){return s[0]=Math.max(i[0],o[0]),s[1]=Math.max(i[1],o[1]),s[2]=Math.max(i[2],o[2]),s}function Bs(s,i,o){return s[0]=i[0]*o,s[1]=i[1]*o,s[2]=i[2]*o,s}function Sp(s,i,o,c){return s[0]=i[0]+o[0]*c,s[1]=i[1]+o[1]*c,s[2]=i[2]+o[2]*c,s}function Vr(s,i){var o=i[0],c=i[1],h=i[2],m=o*o+c*c+h*h;return m>0&&(m=1/Math.sqrt(m)),s[0]=i[0]*m,s[1]=i[1]*m,s[2]=i[2]*m,s}function Ns(s,i){return s[0]*i[0]+s[1]*i[1]+s[2]*i[2]}function am(s,i,o){var c=i[0],h=i[1],m=i[2],y=o[0],b=o[1],A=o[2];return s[0]=h*A-m*b,s[1]=m*y-c*A,s[2]=c*b-h*y,s}function Ai(s,i,o){var c=i[0],h=i[1],m=i[2],y=o[3]*c+o[7]*h+o[11]*m+o[15];return s[0]=(o[0]*c+o[4]*h+o[8]*m+o[12])/(y=y||1),s[1]=(o[1]*c+o[5]*h+o[9]*m+o[13])/y,s[2]=(o[2]*c+o[6]*h+o[10]*m+o[14])/y,s}function lm(s,i,o){var c=o[0],h=o[1],m=o[2],y=i[0],b=i[1],A=i[2],E=h*A-m*b,P=m*y-c*A,k=c*b-h*y,R=h*k-m*P,B=m*E-c*k,N=c*P-h*E,q=2*o[3];return P*=q,k*=q,B*=2,N*=2,s[0]=y+(E*=q)+(R*=2),s[1]=b+P+B,s[2]=A+k+N,s}var Eo,co=f_,m_=o0,g_=Tp;function cm(s,i,o){return s[0]=i[0]*o,s[1]=i[1]*o,s[2]=i[2]*o,s[3]=i[3]*o,s}function sd(s,i,o){var c=i[0],h=i[1],m=i[2],y=i[3];return s[0]=o[0]*c+o[4]*h+o[8]*m+o[12]*y,s[1]=o[1]*c+o[5]*h+o[9]*m+o[13]*y,s[2]=o[2]*c+o[6]*h+o[10]*m+o[14]*y,s[3]=o[3]*c+o[7]*h+o[11]*m+o[15]*y,s}function s0(){var s=new Sr(4);return Sr!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function a0(s){return s[0]=0,s[1]=0,s[2]=0,s[3]=1,s}function Dp(s,i,o){o*=.5;var c=i[0],h=i[1],m=i[2],y=i[3],b=Math.sin(o),A=Math.cos(o);return s[0]=c*A+y*b,s[1]=h*A+m*b,s[2]=m*A-h*b,s[3]=y*A-c*b,s}function Ip(s,i,o){o*=.5;var c=i[0],h=i[1],m=i[2],y=i[3],b=Math.sin(o),A=Math.cos(o);return s[0]=c*A-m*b,s[1]=h*A+y*b,s[2]=m*A+c*b,s[3]=y*A-h*b,s}Lc(),Eo=new Sr(4),Sr!=Float32Array&&(Eo[0]=0,Eo[1]=0,Eo[2]=0,Eo[3]=0),Lc(),ah(1,0,0),ah(0,1,0),s0(),s0(),Cp();class lh{constructor(i,o){this.pos=i,this.dir=o}intersectsPlane(i,o,c){const h=Ns(o,this.dir);if(Math.abs(h)<1e-6)return!1;const m=((i[0]-this.pos[0])*o[0]+(i[1]-this.pos[1])*o[1]+(i[2]-this.pos[2])*o[2])/h;return c[0]=this.pos[0]+this.dir[0]*m,c[1]=this.pos[1]+this.dir[1]*m,c[2]=this.pos[2]+this.dir[2]*m,!0}closestPointOnSphere(i,o,c){if(q=(B=this.pos)[0],Q=B[1],se=B[2],he=(N=i)[0],ae=N[1],de=N[2],Math.abs(q-he)<=rm*Math.max(1,Math.abs(q),Math.abs(he))&&Math.abs(Q-ae)<=rm*Math.max(1,Math.abs(Q),Math.abs(ae))&&Math.abs(se-de)<=rm*Math.max(1,Math.abs(se),Math.abs(de))||0===o)return c[0]=c[1]=c[2]=0,!1;var B,N,q,Q,se,he,ae,de;const[h,m,y]=this.dir,b=this.pos[0]-i[0],A=this.pos[1]-i[1],E=this.pos[2]-i[2],P=h*h+m*m+y*y,k=2*(b*h+A*m+E*y),R=k*k-4*P*(b*b+A*A+E*E-o*o);if(R<0){const B=Math.max(-k/2,0),N=b+h*B,q=A+m*B,Q=E+y*B,se=Math.hypot(N,q,Q);return c[0]=N*o/se,c[1]=q*o/se,c[2]=Q*o/se,!1}{const B=(-k-Math.sqrt(R))/(2*P);if(B<0){const N=Math.hypot(b,A,E);return c[0]=b*o/N,c[1]=A*o/N,c[2]=E*o/N,!1}return c[0]=b+h*B,c[1]=A+m*B,c[2]=E+y*B,!0}}}class __{constructor(i,o,c,h,m){this.TL=i,this.TR=o,this.BR=c,this.BL=h,this.horizon=m}static fromInvProjectionMatrix(i,o,c){const h=[-1,1,1],m=[1,1,1],y=[1,-1,1],b=[-1,-1,1],A=Ai(h,h,i),E=Ai(m,m,i),P=Ai(y,y,i),k=Ai(b,b,i);return new __(A,E,P,k,o/c)}}class y_{constructor(i,o){this.points=i,this.planes=o}static fromInvProjectionMatrix(i,o,c,h){const m=Math.pow(2,c),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(A=>{const E=sd([],A,i),P=1/E[3]/o*m;return(k=E)[0]=(R=E)[0]*(B=[P,P,h?1/E[3]:P,P])[0],k[1]=R[1]*B[1],k[2]=R[2]*B[2],k[3]=R[3]*B[3],k;var k,R,B}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(A=>{const E=Vr([],am([],co([],y[A[0]],y[A[1]]),co([],y[A[2]],y[A[1]]))),P=-Ns(E,y[A[1]]);return E.concat(P)});return new y_(y,b)}}class Ur{static fromPoints(i){const o=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],c=[Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE];for(const h of i)o[0]=Math.min(o[0],h[0]),o[1]=Math.min(o[1],h[1]),o[2]=Math.min(o[2],h[2]),c[0]=Math.max(c[0],h[0]),c[1]=Math.max(c[1],h[1]),c[2]=Math.max(c[2],h[2]);return new Ur(o,c)}constructor(i,o){this.min=i,this.max=o,this.center=Bs([],zc([],this.min,this.max),.5)}quadrant(i){const o=[i%2==0,i<2],c=p_(this.min),h=p_(this.max);for(let m=0;m<o.length;m++)c[m]=o[m]?this.min[m]:this.center[m],h[m]=o[m]?this.center[m]:this.max[m];return h[2]=this.max[2],new Ur(c,h)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}distanceZ(i){return Math.max(Math.min(this.max[2],i[2]),this.min[2])-i[2]}getCorners(){const i=this.min,o=this.max;return[[i[0],i[1],i[2]],[o[0],i[1],i[2]],[o[0],o[1],i[2]],[i[0],o[1],i[2]],[i[0],i[1],o[2]],[o[0],i[1],o[2]],[o[0],o[1],o[2]],[i[0],o[1],o[2]]]}intersects(i){const o=this.getCorners();let c=!0;for(let h=0;h<i.planes.length;h++){const m=i.planes[h];let y=0;for(let b=0;b<o.length;b++)y+=Ns(m,o[b])+m[3]>=0;if(0===y)return 0;y!==o.length&&(c=!1)}if(c)return 2;for(let h=0;h<3;h++){let m=Number.MAX_VALUE,y=-Number.MAX_VALUE;for(let b=0;b<i.points.length;b++){const A=i.points[b][h]-this.min[h];m=Math.min(m,A),y=Math.max(y,A)}if(y<0||m>this.max[h]-this.min[h])return 0}return 1}}function v_(s,i,o,c,h,m,y,b,A){if(m&&s.queryGeometry.isAboveHorizon)return!1;m&&(A*=s.pixelToTileUnitsFactor);const E=s.tileID.canonical,P=o.projection.upVectorScale(E,o.center.lat,o.worldSize).metersToTile;for(const k of i)for(const R of k){const B=R.add(b),N=h&&o.elevation?o.elevation.exaggeration()*h.getElevationAt(B.x,B.y,!0):0,q=o.projection.projectTilePoint(B.x,B.y,E);if(N>0){const ae=o.projection.upVector(E,B.x,B.y);q.x+=ae[0]*P*N,q.y+=ae[1]*P*N,q.z+=ae[2]*P*N}const Q=m?B:l0(q.x,q.y,q.z,c),se=m?s.tilespaceRays.map(ae=>b_(ae,N)):s.queryGeometry.screenGeometry,he=sd([],[q.x,q.y,q.z,1],c);if(!y&&m?A*=he[3]/o.cameraToCenterDistance:y&&!m&&(A*=o.cameraToCenterDistance/he[3]),m){const ae=gr((R.y/zt+E.y)/(1<<E.z));A/=o.projection.pixelsPerMeter(ae,1)/jr(1,ae)}if(Jv(se,Q,A))return!0}return!1}function l0(s,i,o,c){const h=sd([],[s,i,o,1],c);return new dt(h[0]/h[3],h[1]/h[3])}const x_=ah(0,0,0),c0=ah(0,0,1);function b_(s,i){const o=Lc();return x_[2]=i,s.intersectsPlane(x_,c0,o),new dt(o[0],o[1])}class ch extends td{}function w_(s,{width:i,height:o},c,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==i*o*c)throw new RangeError("mismatched image size")}else h=new Uint8Array(i*o*c);return s.width=i,s.height=o,s.data=h,s}function Pp(s,i,o){const{width:c,height:h}=i;c===s.width&&h===s.height||(um(s,i,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,c),height:Math.min(s.height,h)},o),s.width=c,s.height=h,s.data=i.data)}function um(s,i,o,c,h,m){if(0===h.width||0===h.height)return i;if(h.width>s.width||h.height>s.height||o.x>s.width-h.width||o.y>s.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>i.width||h.height>i.height||c.x>i.width-h.width||c.y>i.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const y=s.data,b=i.data;for(let A=0;A<h.height;A++){const E=((o.y+A)*s.width+o.x)*m,P=((c.y+A)*i.width+c.x)*m;for(let k=0;k<h.width*m;k++)b[P+k]=y[E+k]}return i}vt(ch,"HeatmapBucket",{omit:["layers"]});class hi{constructor(i,o){w_(this,i,1,o)}resize(i){Pp(this,new hi(i),1)}clone(){return new hi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,o,c,h,m){um(i,o,c,h,m,1)}}class To{constructor(i,o){w_(this,i,4,o)}resize(i){Pp(this,new To(i),4)}replace(i,o){o?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new To({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,o,c,h,m){um(i,o,c,h,m,4)}}vt(hi,"AlphaImage"),vt(To,"RGBAImage");var u0={paint:new je({"heatmap-radius":new Ce(Re.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ce(Re.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new _e(Re.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ee(Re.paint_heatmap["heatmap-color"]),"heatmap-opacity":new _e(Re.paint_heatmap["heatmap-opacity"])})};function ad(s){const i={},o=s.resolution||256,c=s.clips?s.clips.length:1,h=s.image||new To({width:o,height:c}),m=(y,b,A)=>{i[s.evaluationKey]=A;const E=s.expression.evaluate(i);h.data[y+b+0]=Math.floor(255*E.r/E.a),h.data[y+b+1]=Math.floor(255*E.g/E.a),h.data[y+b+2]=Math.floor(255*E.b/E.a),h.data[y+b+3]=Math.floor(255*E.a)};if(s.clips)for(let y=0,b=0;y<c;++y,b+=4*o)for(let A=0,E=0;A<o;A++,E+=4){const P=A/(o-1),{start:k,end:R}=s.clips[y];m(b,E,k*(1-P)+R*P)}else for(let y=0,b=0;y<o;y++,b+=4)m(0,b,y/(o-1));return h}var C_={paint:new je({"hillshade-illumination-direction":new _e(Re.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new _e(Re.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new _e(Re.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new _e(Re.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new _e(Re.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new _e(Re.paint_hillshade["hillshade-accent-color"])})};const d0=He([{name:"a_pos",components:2,type:"Int16"}],4),{members:h0}=d0;var Op=kp,p0=kp;function kp(s,i,o){o=o||2;var c,h,m,y,b,A,E,P=i&&i.length,k=P?i[0]*o:s.length,R=f0(s,0,k,o,!0),B=[];if(!R||R.next===R.prev)return B;if(P&&(R=function(q,Q,se,he){var ae,de,ye,me=[];for(ae=0,de=Q.length;ae<de;ae++)(ye=f0(q,Q[ae]*he,ae<de-1?Q[ae+1]*he:q.length,he,!1))===ye.next&&(ye.steiner=!0),me.push(m0(ye));for(me.sort($r),ae=0;ae<me.length;ae++)se=uh(me[ae],se);return se}(s,i,R,o)),s.length>80*o){c=m=s[0],h=y=s[1];for(var N=o;N<k;N+=o)(b=s[N])<c&&(c=b),(A=s[N+1])<h&&(h=A),b>m&&(m=b),A>y&&(y=A);E=0!==(E=Math.max(m-c,y-h))?32767/E:0}return Za(R,B,o,c,h,E,0),B}function f0(s,i,o,c,h){var m,y;if(h===gm(s,i,o,c)>0)for(m=i;m<o;m+=c)y=M_(m,s[m],s[m+1],y);else for(m=o-c;m>=i;m-=c)y=M_(m,s[m],s[m+1],y);return y&&Rp(y,y.next)&&(Nc(y),y=y.next),y}function ld(s,i){if(!s)return s;i||(i=s);var o,c=s;do{if(o=!1,c.steiner||!Rp(c,c.next)&&0!==Ei(c.prev,c,c.next))c=c.next;else{if(Nc(c),(c=i=c.prev)===c.next)break;o=!0}}while(o||c!==i);return i}function Za(s,i,o,c,h,m,y){if(s){!y&&m&&function(P,k,R,B){var N=P;do{0===N.z&&(N.z=pm(N.x,N.y,k,R,B)),N.prevZ=N.prev,N.nextZ=N.next,N=N.next}while(N!==P);N.prevZ.nextZ=null,N.prevZ=null,function(q){var Q,se,he,ae,de,ye,me,De,Pe=1;do{for(se=q,q=null,de=null,ye=0;se;){for(ye++,he=se,me=0,Q=0;Q<Pe&&(me++,he=he.nextZ);Q++);for(De=Pe;me>0||De>0&&he;)0!==me&&(0===De||!he||se.z<=he.z)?(ae=se,se=se.nextZ,me--):(ae=he,he=he.nextZ,De--),de?de.nextZ=ae:q=ae,ae.prevZ=de,de=ae;se=he}de.nextZ=null,Pe*=2}while(ye>1)}(N)}(s,c,h,m);for(var b,A,E=s;s.prev!==s.next;)if(b=s.prev,A=s.next,m?dm(s,c,h,m):uo(s))i.push(b.i/o|0),i.push(s.i/o|0),i.push(A.i/o|0),Nc(s),s=A.next,E=A.next;else if((s=A)===E){y?1===y?Za(s=A_(ld(s),i,o),i,o,c,h,m,2):2===y&&E_(s,i,o,c,h,m):Za(ld(s),i,o,c,h,m,1);break}}}function uo(s){var i=s.prev,o=s,c=s.next;if(Ei(i,o,c)>=0)return!1;for(var h=i.x,m=o.x,y=c.x,b=i.y,A=o.y,E=c.y,P=h<m?h<y?h:y:m<y?m:y,k=b<A?b<E?b:E:A<E?A:E,R=h>m?h>y?h:y:m>y?m:y,B=b>A?b>E?b:E:A>E?A:E,N=c.next;N!==i;){if(N.x>=P&&N.x<=R&&N.y>=k&&N.y<=B&&Fc(h,b,m,A,y,E,N.x,N.y)&&Ei(N.prev,N,N.next)>=0)return!1;N=N.next}return!0}function dm(s,i,o,c){var h=s.prev,m=s,y=s.next;if(Ei(h,m,y)>=0)return!1;for(var b=h.x,A=m.x,E=y.x,P=h.y,k=m.y,R=y.y,B=b<A?b<E?b:E:A<E?A:E,N=P<k?P<R?P:R:k<R?k:R,q=b>A?b>E?b:E:A>E?A:E,Q=P>k?P>R?P:R:k>R?k:R,se=pm(B,N,i,o,c),he=pm(q,Q,i,o,c),ae=s.prevZ,de=s.nextZ;ae&&ae.z>=se&&de&&de.z<=he;){if(ae.x>=B&&ae.x<=q&&ae.y>=N&&ae.y<=Q&&ae!==h&&ae!==y&&Fc(b,P,A,k,E,R,ae.x,ae.y)&&Ei(ae.prev,ae,ae.next)>=0||(ae=ae.prevZ,de.x>=B&&de.x<=q&&de.y>=N&&de.y<=Q&&de!==h&&de!==y&&Fc(b,P,A,k,E,R,de.x,de.y)&&Ei(de.prev,de,de.next)>=0))return!1;de=de.nextZ}for(;ae&&ae.z>=se;){if(ae.x>=B&&ae.x<=q&&ae.y>=N&&ae.y<=Q&&ae!==h&&ae!==y&&Fc(b,P,A,k,E,R,ae.x,ae.y)&&Ei(ae.prev,ae,ae.next)>=0)return!1;ae=ae.prevZ}for(;de&&de.z<=he;){if(de.x>=B&&de.x<=q&&de.y>=N&&de.y<=Q&&de!==h&&de!==y&&Fc(b,P,A,k,E,R,de.x,de.y)&&Ei(de.prev,de,de.next)>=0)return!1;de=de.nextZ}return!0}function A_(s,i,o){var c=s;do{var h=c.prev,m=c.next.next;!Rp(h,m)&&fm(h,c,c.next,m)&&Bc(h,m)&&Bc(m,h)&&(i.push(h.i/o|0),i.push(c.i/o|0),i.push(m.i/o|0),Nc(c),Nc(c.next),c=s=m),c=c.next}while(c!==s);return ld(c)}function E_(s,i,o,c,h,m){var y=s;do{for(var b=y.next.next;b!==y.prev;){if(y.i!==b.i&&g0(y,b)){var A=T_(y,b);return y=ld(y,y.next),A=ld(A,A.next),Za(y,i,o,c,h,m,0),void Za(A,i,o,c,h,m,0)}b=b.next}y=y.next}while(y!==s)}function $r(s,i){return s.x-i.x}function uh(s,i){var o=function(h,m){var y,b=m,A=h.x,E=h.y,P=-1/0;do{if(E<=b.y&&E>=b.next.y&&b.next.y!==b.y){var k=b.x+(E-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(k<=A&&k>P&&(P=k,y=b.x<b.next.x?b:b.next,k===A))return y}b=b.next}while(b!==m);if(!y)return null;var R,B=y,N=y.x,q=y.y,Q=1/0;b=y;do{A>=b.x&&b.x>=N&&A!==b.x&&Fc(E<q?A:P,E,N,q,E<q?P:A,E,b.x,b.y)&&(R=Math.abs(E-b.y)/(A-b.x),Bc(b,h)&&(R<Q||R===Q&&(b.x>y.x||b.x===y.x&&hm(y,b)))&&(y=b,Q=R)),b=b.next}while(b!==B);return y}(s,i);if(!o)return i;var c=T_(o,s);return ld(c,c.next),ld(o,o.next)}function hm(s,i){return Ei(s.prev,s,i.prev)<0&&Ei(i.next,s,s.next)<0}function pm(s,i,o,c,h){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-o)*h|0)|s<<8))|s<<4))|s<<2))|s<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-c)*h|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function m0(s){var i=s,o=s;do{(i.x<o.x||i.x===o.x&&i.y<o.y)&&(o=i),i=i.next}while(i!==s);return o}function Fc(s,i,o,c,h,m,y,b){return(h-y)*(i-b)>=(s-y)*(m-b)&&(s-y)*(c-b)>=(o-y)*(i-b)&&(o-y)*(m-b)>=(h-y)*(c-b)}function g0(s,i){return s.next.i!==i.i&&s.prev.i!==i.i&&!function(o,c){var h=o;do{if(h.i!==o.i&&h.next.i!==o.i&&h.i!==c.i&&h.next.i!==c.i&&fm(h,h.next,o,c))return!0;h=h.next}while(h!==o);return!1}(s,i)&&(Bc(s,i)&&Bc(i,s)&&function(o,c){var h=o,m=!1,y=(o.x+c.x)/2,b=(o.y+c.y)/2;do{h.y>b!=h.next.y>b&&h.next.y!==h.y&&y<(h.next.x-h.x)*(b-h.y)/(h.next.y-h.y)+h.x&&(m=!m),h=h.next}while(h!==o);return m}(s,i)&&(Ei(s.prev,s,i.prev)||Ei(s,i.prev,i))||Rp(s,i)&&Ei(s.prev,s,s.next)>0&&Ei(i.prev,i,i.next)>0)}function Ei(s,i,o){return(i.y-s.y)*(o.x-i.x)-(i.x-s.x)*(o.y-i.y)}function Rp(s,i){return s.x===i.x&&s.y===i.y}function fm(s,i,o,c){var h=zp(Ei(s,i,o)),m=zp(Ei(s,i,c)),y=zp(Ei(o,c,s)),b=zp(Ei(o,c,i));return h!==m&&y!==b||!(0!==h||!Lp(s,o,i))||!(0!==m||!Lp(s,c,i))||!(0!==y||!Lp(o,s,c))||!(0!==b||!Lp(o,i,c))}function Lp(s,i,o){return i.x<=Math.max(s.x,o.x)&&i.x>=Math.min(s.x,o.x)&&i.y<=Math.max(s.y,o.y)&&i.y>=Math.min(s.y,o.y)}function zp(s){return s>0?1:s<0?-1:0}function Bc(s,i){return Ei(s.prev,s,s.next)<0?Ei(s,i,s.next)>=0&&Ei(s,s.prev,i)>=0:Ei(s,i,s.prev)<0||Ei(s,s.next,i)<0}function T_(s,i){var o=new mm(s.i,s.x,s.y),c=new mm(i.i,i.x,i.y),h=s.next,m=i.prev;return s.next=i,i.prev=s,o.next=h,h.prev=o,c.next=o,o.prev=c,m.next=c,c.prev=m,c}function M_(s,i,o,c){var h=new mm(s,i,o);return c?(h.next=c.next,h.prev=c,c.next.prev=h,c.next=h):(h.prev=h,h.next=h),h}function Nc(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function mm(s,i,o){this.i=s,this.x=i,this.y=o,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function gm(s,i,o,c){for(var h=0,m=i,y=o-c;m<o;m+=c)h+=(s[y]-s[m])*(s[m+1]+s[y+1]),y=m;return h}function dh(s,i,o,c,h){S_(s,i,o||0,c||s.length-1,h||_0)}function S_(s,i,o,c,h){for(;c>o;){if(c-o>600){var m=c-o+1,y=i-o+1,b=Math.log(m),A=.5*Math.exp(2*b/3),E=.5*Math.sqrt(b*A*(m-A)/m)*(y-m/2<0?-1:1);S_(s,i,Math.max(o,Math.floor(i-y*A/m+E)),Math.min(c,Math.floor(i+(m-y)*A/m+E)),h)}var P=s[i],k=o,R=c;for(hh(s,o,i),h(s[c],P)>0&&hh(s,o,c);k<R;){for(hh(s,k,R),k++,R--;h(s[k],P)<0;)k++;for(;h(s[R],P)>0;)R--}0===h(s[o],P)?hh(s,o,R):hh(s,++R,c),R<=i&&(o=R+1),i<=R&&(c=R-1)}}function hh(s,i,o){var c=s[i];s[i]=s[o],s[o]=c}function _0(s,i){return s<i?-1:s>i?1:0}function _m(s,i){const o=s.length;if(o<=1)return[s];const c=[];let h,m;for(let y=0;y<o;y++){const b=As(s[y]);0!==b&&(s[y].area=Math.abs(b),void 0===m&&(m=b<0),m===b<0?(h&&c.push(h),h=[s[y]]):h.push(s[y]))}if(h&&c.push(h),i>1)for(let y=0;y<c.length;y++)c[y].length<=i||(dh(c[y],i,1,c[y].length-1,y0),c[y]=c[y].slice(0,i));return c}function y0(s,i){return i.area-s.area}function Fp(s,i,o){const c=o.patternDependencies;let h=!1;for(const m of i){const y=m.paint.get(`${s}-pattern`);y.isConstant()||(h=!0);const b=y.constantOr(null);b&&(h=!0,c[b.to]=!0,c[b.from]=!0)}return h}function ym(s,i,o,c,h){const m=h.patternDependencies;for(const y of i){const b=y.paint.get(`${s}-pattern`).value;if("constant"!==b.kind){let A=b.evaluate({zoom:c-1},o,{},h.availableImages),E=b.evaluate({zoom:c},o,{},h.availableImages),P=b.evaluate({zoom:c+1},o,{},h.availableImages);A=A&&A.name?A.name:A,E=E&&E.name?E.name:E,P=P&&P.name?P.name:P,m[A]=!0,m[E]=!0,m[P]=!0,o.patterns[y.id]={min:A,mid:E,max:P}}}return o}kp.deviation=function(s,i,o,c){var h=i&&i.length,m=Math.abs(gm(s,0,h?i[0]*o:s.length,o));if(h)for(var y=0,b=i.length;y<b;y++)m-=Math.abs(gm(s,i[y]*o,y<b-1?i[y+1]*o:s.length,o));var A=0;for(y=0;y<c.length;y+=3){var E=c[y]*o,P=c[y+1]*o,k=c[y+2]*o;A+=Math.abs((s[E]-s[k])*(s[P+1]-s[E+1])-(s[E]-s[P])*(s[k+1]-s[E+1]))}return 0===m&&0===A?0:Math.abs((A-m)/m)},kp.flatten=function(s){for(var i=s[0][0].length,o={vertices:[],holes:[],dimensions:i},c=0,h=0;h<s.length;h++){for(var m=0;m<s[h].length;m++)for(var y=0;y<i;y++)o.vertices.push(s[h][m][y]);h>0&&o.holes.push(c+=s[h-1].length)}return o},Op.default=p0;class Bp{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new lt,this.indexArray=new on,this.indexArray2=new mr,this.programConfigurations=new Qu(i.layers,i.zoom),this.segments=new Hi,this.segments2=new Hi,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.projection=i.projection}populate(i,o,c,h){this.hasPattern=Fp("fill",this.layers,o);const m=this.layers[0].layout.get("fill-sort-key"),y=[];for(const{feature:b,id:A,index:E,sourceLayerIndex:P}of i){const k=this.layers[0]._featureFilter.needGeometry,R=Dc(b,k);if(!this.layers[0]._featureFilter.filter(new J(this.zoom),R,c))continue;const B=m?m.evaluate(R,{},c,o.availableImages):void 0,N={id:A,properties:b.properties,type:b.type,sourceLayerIndex:P,index:E,geometry:k?R.geometry:Wo(b,c,h),patterns:{},sortKey:B};y.push(N)}m&&y.sort((b,A)=>b.sortKey-A.sortKey);for(const b of y){const{geometry:A,index:E,sourceLayerIndex:P}=b;if(this.hasPattern){const k=ym("fill",this.layers,b,this.zoom,o);this.patternFeatures.push(k)}else this.addFeature(b,A,E,c,{},o.availableImages);o.featureIndex.insert(i[E].feature,A,E,P,this.index)}}update(i,o,c,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,c,h)}addFeatures(i,o,c,h,m){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,o,c,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,h0),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,o,c,h,m,y=[]){for(const b of _m(o,500)){let A=0;for(const N of b)A+=N.length;const E=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray),P=E.vertexLength,k=[],R=[];for(const N of b){if(0===N.length)continue;N!==b[0]&&R.push(k.length/2);const q=this.segments2.prepareSegment(N.length,this.layoutVertexArray,this.indexArray2),Q=q.vertexLength;this.layoutVertexArray.emplaceBack(N[0].x,N[0].y),this.indexArray2.emplaceBack(Q+N.length-1,Q),k.push(N[0].x),k.push(N[0].y);for(let se=1;se<N.length;se++)this.layoutVertexArray.emplaceBack(N[se].x,N[se].y),this.indexArray2.emplaceBack(Q+se-1,Q+se),k.push(N[se].x),k.push(N[se].y);q.vertexLength+=N.length,q.primitiveLength+=N.length}const B=Op(k,R);for(let N=0;N<B.length;N+=3)this.indexArray.emplaceBack(P+B[N],P+B[N+1],P+B[N+2]);E.vertexLength+=A,E.primitiveLength+=B.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,c,m,y,h)}}vt(Bp,"FillBucket",{omit:["layers","patternFeatures"]});const v0=new je({"fill-sort-key":new Ce(Re.layout_fill["fill-sort-key"])});var x0={paint:new je({"fill-antialias":new _e(Re.paint_fill["fill-antialias"]),"fill-opacity":new Ce(Re.paint_fill["fill-opacity"]),"fill-color":new Ce(Re.paint_fill["fill-color"]),"fill-outline-color":new Ce(Re.paint_fill["fill-outline-color"]),"fill-translate":new _e(Re.paint_fill["fill-translate"]),"fill-translate-anchor":new _e(Re.paint_fill["fill-translate-anchor"]),"fill-pattern":new Se(Re.paint_fill["fill-pattern"])}),layout:v0};const b0=He([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),w0=He([{name:"a_centroid_pos",components:2,type:"Uint16"}]),C0=He([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:A0}=b0;var jc=ho;function ho(s,i,o,c,h){this.properties={},this.extent=o,this.type=0,this._pbf=s,this._geometry=-1,this._keys=c,this._values=h,s.readFields(rw,this,i)}function rw(s,i,o){1==s?i.id=o.readVarint():2==s?function(c,h){for(var m=c.readVarint()+c.pos;c.pos<m;){var y=h._keys[c.readVarint()],b=h._values[c.readVarint()];h.properties[y]=b}}(o,i):3==s?i.type=o.readVarint():4==s&&(i._geometry=o.pos)}function ow(s){for(var i,o,c=0,h=0,m=s.length,y=m-1;h<m;y=h++)c+=((o=s[y]).x-(i=s[h]).x)*(i.y+o.y);return c}ho.types=["Unknown","Point","LineString","Polygon"],ho.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var i,o=s.readVarint()+s.pos,c=1,h=0,m=0,y=0,b=[];s.pos<o;){if(h<=0){var A=s.readVarint();c=7&A,h=A>>3}if(h--,1===c||2===c)m+=s.readSVarint(),y+=s.readSVarint(),1===c&&(i&&b.push(i),i=[]),i.push(new dt(m,y));else{if(7!==c)throw new Error("unknown command "+c);i&&i.push(i[0].clone())}}return i&&b.push(i),b},ho.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var i=s.readVarint()+s.pos,o=1,c=0,h=0,m=0,y=1/0,b=-1/0,A=1/0,E=-1/0;s.pos<i;){if(c<=0){var P=s.readVarint();o=7&P,c=P>>3}if(c--,1===o||2===o)(h+=s.readSVarint())<y&&(y=h),h>b&&(b=h),(m+=s.readSVarint())<A&&(A=m),m>E&&(E=m);else if(7!==o)throw new Error("unknown command "+o)}return[y,A,b,E]},ho.prototype.toGeoJSON=function(s,i,o){var c,h,m=this.extent*Math.pow(2,o),y=this.extent*s,b=this.extent*i,A=this.loadGeometry(),E=ho.types[this.type];function P(B){for(var N=0;N<B.length;N++){var q=B[N];B[N]=[360*(q.x+y)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(q.y+b)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var k=[];for(c=0;c<A.length;c++)k[c]=A[c][0];P(A=k);break;case 2:for(c=0;c<A.length;c++)P(A[c]);break;case 3:for(A=function(B){var N=B.length;if(N<=1)return[B];for(var q,Q,se=[],he=0;he<N;he++){var ae=ow(B[he]);0!==ae&&(void 0===Q&&(Q=ae<0),Q===ae<0?(q&&se.push(q),q=[B[he]]):q.push(B[he]))}return q&&se.push(q),se}(A),c=0;c<A.length;c++)for(h=0;h<A[c].length;h++)P(A[c][h])}1===A.length?A=A[0]:E="Multi"+E;var R={type:"Feature",geometry:{type:E,coordinates:A},properties:this.properties};return"id"in this&&(R.id=this.id),R};var vm=E0;function E0(s,i){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(Yo,this,i),this.length=this._features.length}function Yo(s,i,o){15===s?i.version=o.readVarint():1===s?i.name=o.readString():5===s?i.extent=o.readVarint():2===s?i._features.push(o.pos):3===s?i._keys.push(o.readString()):4===s&&i._values.push(function(c){for(var h=null,m=c.readVarint()+c.pos;c.pos<m;){var y=c.readVarint()>>3;h=1===y?c.readString():2===y?c.readFloat():3===y?c.readDouble():4===y?c.readVarint64():5===y?c.readVarint():6===y?c.readSVarint():7===y?c.readBoolean():null}return h}(o))}function xm(s,i,o){if(3===s){var c=new vm(o,o.readVarint()+o.pos);c.length&&(i[c.name]=c)}}E0.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var i=this._pbf.readVarint()+this._pbf.pos;return new jc(this._pbf,i,this.extent,this._keys,this._values)};var Wa={VectorTile:function(s,i){this.layers=s.readFields(xm,{},i)},VectorTileFeature:jc,VectorTileLayer:vm};function Np(s,i,o,c){const h=[],m=0===c?(y,b,A,E,P,k)=>{y.push(new dt(k,A+(k-b)/(E-b)*(P-A)))}:(y,b,A,E,P,k)=>{y.push(new dt(b+(k-A)/(P-A)*(E-b),k))};for(const y of s){const b=[];for(const A of y){if(A.length<=2)continue;const E=[];for(let R=0;R<A.length-1;R++){const B=A[R].x,N=A[R].y,q=A[R+1].x,Q=A[R+1].y,se=0===c?B:N,he=0===c?q:Q;se<i?he>i&&m(E,B,N,q,Q,i):se>o?he<o&&m(E,B,N,q,Q,o):E.push(A[R]),he<i&&se>=i&&m(E,B,N,q,Q,i),he>o&&se<=o&&m(E,B,N,q,Q,o)}let P=A[A.length-1];const k=0===c?P.x:P.y;k>=i&&k<=o&&E.push(P),E.length&&(P=E[E.length-1],E[0].x===P.x&&E[0].y===P.y||E.push(E[0]),b.push(E))}b.length&&h.push(b)}return h}const D_=Wa.VectorTileFeature.types,ph=Math.pow(2,13);function cd(s,i,o,c,h,m,y,b){s.emplaceBack((i<<1)+y,(o<<1)+m,(Math.floor(c*ph)<<1)+h,Math.round(b))}function ud(s,i,o){s.emplaceBack(i.x,i.y,i.z,16384*o[0],16384*o[1],16384*o[2])}class jp{constructor(){this.acc=new dt(0,0),this.polyCount=[]}startRing(i){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new dt(i.x,i.y),this.max=new dt(i.x,i.y))}append(i,o){this.currentPolyCount.edges++,this.acc._add(i);const c=this.min,h=this.max;i.x<c.x?c.x=i.x:i.x>h.x&&(h.x=i.x),i.y<c.y?c.y=i.y:i.y>h.y&&(h.y=i.y),((0===i.x||i.x===zt)&&i.x===o.x)!=((0===i.y||i.y===zt)&&i.y===o.y)&&this.processBorderOverlap(i,o),o.x<0!=i.x<0&&this.addBorderIntersection(0,_n(o.y,i.y,(0-o.x)/(i.x-o.x))),o.x>zt!=i.x>zt&&this.addBorderIntersection(1,_n(o.y,i.y,(zt-o.x)/(i.x-o.x))),o.y<0!=i.y<0&&this.addBorderIntersection(2,_n(o.x,i.x,(0-o.y)/(i.y-o.y))),o.y>zt!=i.y>zt&&this.addBorderIntersection(3,_n(o.x,i.x,(zt-o.y)/(i.y-o.y)))}addBorderIntersection(i,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[i];o<c[0]&&(c[0]=o),o>c[1]&&(c[1]=o)}processBorderOverlap(i,o){if(i.x===o.x){if(i.y===o.y)return;const c=0===i.x?0:1;this.addBorderIntersection(c,o.y),this.addBorderIntersection(c,i.y)}else{const c=0===i.y?2:3;this.addBorderIntersection(c,o.x),this.addBorderIntersection(c,i.x)}}centroid(){const i=this.polyCount.reduce((o,c)=>o+c.edges,0);return 0!==i?this.acc.div(i)._round():new dt(0,0)}span(){return new dt(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((i,o)=>i+ +(o[0]!==Number.MAX_VALUE),0)}}class Vc{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=i.projection,this.layoutVertexArray=new Lt,this.centroidVertexArray=new Gv,this.indexArray=new on,this.programConfigurations=new Qu(i.layers,i.zoom),this.segments=new Hi,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.enableTerrain=i.enableTerrain}populate(i,o,c,h){this.features=[],this.hasPattern=Fp("fill-extrusion",this.layers,o),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(m){const y=Math.exp(Math.PI*(1-m.y/(1<<m.z)*2));return 80150034*y/(y*y+1)/zt/(1<<m.z)}(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:m,id:y,index:b,sourceLayerIndex:A}of i){const E=this.layers[0]._featureFilter.needGeometry,P=Dc(m,E);if(!this.layers[0]._featureFilter.filter(new J(this.zoom),P,c))continue;const k={id:y,sourceLayerIndex:A,index:b,geometry:E?P.geometry:Wo(m,c,h),properties:m.properties,type:m.type,patterns:{}},R=this.layoutVertexArray.length;this.hasPattern?this.features.push(ym("fill-extrusion",this.layers,k,this.zoom,o)):this.addFeature(k,k.geometry,b,c,{},o.availableImages,h),o.featureIndex.insert(m,k.geometry,b,A,this.index,R)}this.sortBorders()}addFeatures(i,o,c,h,m){for(const y of this.features){const{geometry:b}=y;this.addFeature(y,b,y.index,o,c,h,m)}this.sortBorders()}update(i,o,c,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,c,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,A0),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=i.createVertexBuffer(this.layoutVertexExtArray,C0.members,!0))),this.programConfigurations.upload(i),this.uploaded=!0}uploadCentroid(i){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,w0.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,o,c,h,m,y,b){const A=[new dt(0,0),new dt(zt,zt)],E=b.projection,P="globe"===E.name,k=this.enableTerrain&&!P?new jp:null,R="Polygon"===D_[i.type];P&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new rr);const B=_m(o,500);for(let se=B.length-1;se>=0;se--){const he=B[se];(0===he.length||(N=he[0]).every(ae=>ae.x<=0)||N.every(ae=>ae.x>=zt)||N.every(ae=>ae.y<=0)||N.every(ae=>ae.y>=zt))&&B.splice(se,1)}var N;let q;if(P)q=P_(B,A,h);else{q=[];for(const se of B)q.push({polygon:se,bounds:A})}const Q=R?this.edgeRadius:0;for(const{polygon:se,bounds:he}of q){let ae=0,de=0;for(const me of se)R&&!me[0].equals(me[me.length-1])&&me.push(me[0]),de+=R?me.length-1:me.length;const ye=this.segments.prepareSegment((R?5:4)*de,this.layoutVertexArray,this.indexArray);if(R){const me=[],De=[];ae=ye.vertexLength;for(const Fe of se){let tt,Oe;Fe.length&&Fe!==se[0]&&De.push(me.length/2),tt=Fe[1].sub(Fe[0])._perp()._unit();for(let Ve=1;Ve<Fe.length;Ve++){const qe=Fe[Ve],Ue=Fe[Ve===Fe.length-1?1:Ve+1];let{x:Qe,y:Ze}=qe;if(Q){Oe=Ue.sub(qe)._perp()._unit();const pt=tt.add(Oe)._unit(),Xt=Q*Math.min(4,1/(tt.x*pt.x+tt.y*pt.y));Qe+=Xt*pt.x,Ze+=Xt*pt.y,tt=Oe}cd(this.layoutVertexArray,Qe,Ze,0,0,1,1,0),ye.vertexLength++,me.push(qe.x,qe.y),P&&ud(this.layoutVertexExtArray,E.projectTilePoint(Qe,Ze,h),E.upVector(h,Qe,Ze))}}const Pe=Op(me,De);for(let Fe=0;Fe<Pe.length;Fe+=3)this.indexArray.emplaceBack(ae+Pe[Fe],ae+Pe[Fe+2],ae+Pe[Fe+1]),ye.primitiveLength++}for(const me of se){k&&me.length&&k.startRing(me[0]);let De,Pe,Fe,tt=me.length>4&&wm(me[me.length-2],me[0],me[1]),Oe=Q?sw(me[me.length-2],me[0],me[1],Q):0;Pe=me[1].sub(me[0])._perp()._unit();for(let Ve=1,qe=0;Ve<me.length;Ve++){let Ue=me[Ve-1],Qe=me[Ve];const Ze=me[Ve===me.length-1?1:Ve+1];if(k&&R&&k.currentPolyCount.top++,Vp(Qe,Ue,he)){Q&&(Pe=Ze.sub(Qe)._perp()._unit());continue}k&&k.append(Qe,Ue);const pt=Qe.sub(Ue)._perp(),Xt=pt.x/(Math.abs(pt.x)+Math.abs(pt.y)),Kt=pt.y>0?1:0,Ot=Ue.dist(Qe);if(qe+Ot>32768&&(qe=0),Q){Fe=Ze.sub(Qe)._perp()._unit();let _t=Uc(Ue,Qe,Ze,bm(Pe,Fe),Q);isNaN(_t)&&(_t=0);const Yn=Qe.sub(Ue)._unit();Ue=Ue.add(Yn.mult(Oe))._round(),Qe=Qe.add(Yn.mult(-_t))._round(),Oe=_t,Pe=Fe}const ct=ye.vertexLength,dn=me.length>4&&wm(Ue,Qe,Ze);let $t=I_(qe,tt,!0);if(cd(this.layoutVertexArray,Ue.x,Ue.y,Xt,Kt,0,0,$t),cd(this.layoutVertexArray,Ue.x,Ue.y,Xt,Kt,0,1,$t),qe+=Ot,$t=I_(qe,dn,!1),tt=dn,cd(this.layoutVertexArray,Qe.x,Qe.y,Xt,Kt,0,0,$t),cd(this.layoutVertexArray,Qe.x,Qe.y,Xt,Kt,0,1,$t),ye.vertexLength+=4,this.indexArray.emplaceBack(ct+0,ct+1,ct+2),this.indexArray.emplaceBack(ct+1,ct+3,ct+2),ye.primitiveLength+=2,Q){const _t=ae+(1===Ve?me.length-2:Ve-2),Yn=1===Ve?ae:_t+1;if(this.indexArray.emplaceBack(ct+1,_t,ct+3),this.indexArray.emplaceBack(_t,Yn,ct+3),ye.primitiveLength+=2,void 0===De&&(De=ct),!Vp(Ze,me[Ve],he)){const Un=Ve===me.length-1?De:ye.vertexLength;this.indexArray.emplaceBack(ct+2,ct+3,Un),this.indexArray.emplaceBack(ct+3,Un+1,Un),this.indexArray.emplaceBack(ct+3,Yn,Un+1),ye.primitiveLength+=3}}if(P){const _t=this.layoutVertexExtArray,Yn=E.projectTilePoint(Ue.x,Ue.y,h),Un=E.projectTilePoint(Qe.x,Qe.y,h),pi=E.upVector(h,Ue.x,Ue.y),Tt=E.upVector(h,Qe.x,Qe.y);ud(_t,Yn,pi),ud(_t,Yn,pi),ud(_t,Un,Tt),ud(_t,Un,Tt)}}R&&(ae+=me.length-1)}}if(k&&k.polyCount.length>0){if(k.borders){k.vertexArrayOffset=this.centroidVertexArray.length;const se=k.borders,he=this.featuresOnBorder.push(k)-1;for(let ae=0;ae<4;ae++)se[ae][0]!==Number.MAX_VALUE&&this.borders[ae].push(he)}this.encodeCentroid(k.borders?void 0:k.centroid(),k)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,c,m,y,h)}sortBorders(){for(let i=0;i<4;i++)this.borders[i].sort((o,c)=>this.featuresOnBorder[o].borders[i][0]-this.featuresOnBorder[c].borders[i][0])}encodeCentroid(i,o,c=!0){let h,m;if(i)if(0!==i.y){const b=o.span()._mult(this.tileToMeter);h=(Math.max(i.x,1)<<3)+Math.min(7,Math.round(b.x/10)),m=(Math.max(i.y,1)<<3)+Math.min(7,Math.round(b.y/10))}else h=Math.ceil(7*(i.x+450)),m=0;else h=0,m=+c;let y=c?this.centroidVertexArray.length:o.vertexArrayOffset;for(const b of o.polyCount){c&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*b.edges+b.top);for(let A=0;A<b.top;A++)this.centroidVertexArray.emplace(y++,h,m);for(let A=0;A<2*b.edges;A++)this.centroidVertexArray.emplace(y++,0,m),this.centroidVertexArray.emplace(y++,h,m)}}}function bm(s,i){const o=s.add(i)._unit();return s.x*o.x+s.y*o.y}function sw(s,i,o,c){const h=i.sub(s)._perp()._unit(),m=o.sub(i)._perp()._unit();return Uc(s,i,o,bm(h,m),c)}function Uc(s,i,o,c,h){const m=Math.sqrt(1-c*c);return Math.min(s.dist(i)/3,i.dist(o)/3,h*m/c)}function Vp(s,i,o){return s.x<o[0].x&&i.x<o[0].x||s.x>o[1].x&&i.x>o[1].x||s.y<o[0].y&&i.y<o[0].y||s.y>o[1].y&&i.y>o[1].y}function wm(s,i,o){if(s.x<0||s.x>=zt||i.x<0||i.x>=zt||o.x<0||o.x>=zt)return!1;const c=o.sub(i),h=c.perp(),m=s.sub(i);return(c.x*m.x+c.y*m.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(m.x*m.x+m.y*m.y))>-.866&&h.x*m.x+h.y*m.y<0}function I_(s,i,o){const c=i?2|s:-3&s;return o?1|c:-2&c}function Up(){const s=Math.PI/32,i=Math.tan(s),o=Ku;return o*Math.sqrt(1+2*i*i)-o}function P_(s,i,o){const c=1<<o.z,h=Zo(o.x/c),m=Zo((o.x+1)/c),y=gr(o.y/c),b=gr((o.y+1)/c);return function(A,E,P,k,R=0,B){const N=[];if(!A.length||!P||!k)return N;const q=(me,De)=>{for(const Pe of me)N.push({polygon:Pe,bounds:De})},Q=Math.ceil(Math.log2(P)),se=Math.ceil(Math.log2(k)),he=Q-se,ae=[];for(let me=0;me<Math.abs(he);me++)ae.push(he>0?0:1);for(let me=0;me<Math.min(Q,se);me++)ae.push(0),ae.push(1);let de=A;if(de=Np(de,E[0].y-R,E[1].y+R,1),de=Np(de,E[0].x-R,E[1].x+R,0),!de.length)return N;const ye=[];for(ae.length?ye.push({polygons:de,bounds:E,depth:0}):q(de,E);ye.length;){const me=ye.pop(),De=me.depth,Pe=ae[De],Fe=me.bounds[0],tt=me.bounds[1],Oe=0===Pe?Fe.x:Fe.y,Ve=0===Pe?tt.x:tt.y,qe=B?B(Pe,Oe,Ve):.5*(Oe+Ve),Ue=Np(me.polygons,Oe-R,qe+R,Pe),Qe=Np(me.polygons,qe-R,Ve+R,Pe);if(Ue.length){const Ze=[Fe,new dt(0===Pe?qe:tt.x,1===Pe?qe:tt.y)];ae.length>De+1?ye.push({polygons:Ue,bounds:Ze,depth:De+1}):q(Ue,Ze)}if(Qe.length){const Ze=[new dt(0===Pe?qe:Fe.x,1===Pe?qe:Fe.y),tt];ae.length>De+1?ye.push({polygons:Qe,bounds:Ze,depth:De+1}):q(Qe,Ze)}}return N}(s,i,Math.ceil((m-h)/11.25),Math.ceil((y-b)/11.25),1,(A,E,P)=>{if(0===A)return.5*(E+P);{const k=gr((o.y+E/zt)/c);return(Ha(.5*(gr((o.y+P/zt)/c)+k))*c-o.y)*zt}})}vt(Vc,"FillExtrusionBucket",{omit:["layers","features"]}),vt(jp,"PartMetadata");const T0=new je({"fill-extrusion-edge-radius":new _e(Re["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var M0={paint:new je({"fill-extrusion-opacity":new _e(Re["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ce(Re["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new _e(Re["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new _e(Re["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Se(Re["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ce(Re["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ce(Re["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new _e(Re["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new _e(Re["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new _e(Re["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:T0};function O_(s,i,o){var c=2*Math.PI*6378137/256/Math.pow(2,o);return[s*c-2*Math.PI*6378137/2,i*c-2*Math.PI*6378137/2]}class $p{constructor(i,o,c){this.z=i,this.x=o,this.y=c,this.key=$c(0,i,i,o,c)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,o){const c=(y=this.y,b=this.z,A=O_(256*(m=this.x),256*(y=Math.pow(2,b)-y-1),b),E=O_(256*(m+1),256*(y+1),b),A[0]+","+A[1]+","+E[0]+","+E[1]),h=function(m,y,b){let A,E="";for(let P=m;P>0;P--)A=1<<P-1,E+=(y&A?1:0)+(b&A?2:0);return E}(this.z,this.x,this.y);var m,y,b,A,E;return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===o?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",h).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class k_{constructor(i,o){this.wrap=i,this.canonical=o,this.key=$c(i,o.z,o.z,o.x,o.y)}}class Dr{constructor(i,o,c,h,m){this.overscaledZ=i,this.wrap=o,this.canonical=new $p(c,+h,+m),this.key=0===o&&i===c?this.canonical.key:$c(o,i,c,h,m)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){const o=this.canonical.z-i;return i>this.canonical.z?new Dr(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Dr(i,this.wrap,i,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(i,o=!0){if(this.overscaledZ===i&&o)return this.key;if(i>this.canonical.z)return $c(this.wrap*+o,i,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-i;return $c(this.wrap*+o,i,i,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(i){if(i.wrap!==this.wrap)return!1;const o=this.canonical.z-i.canonical.z;return 0===i.overscaledZ||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>o&&i.canonical.y===this.canonical.y>>o}children(i){if(this.overscaledZ>=i)return[new Dr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,c=2*this.canonical.x,h=2*this.canonical.y;return[new Dr(o,this.wrap,o,c,h),new Dr(o,this.wrap,o,c+1,h),new Dr(o,this.wrap,o,c,h+1),new Dr(o,this.wrap,o,c+1,h+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new Dr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new Dr(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new k_(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function $c(s,i,o,c,h){const m=1<<Math.min(o,22);let y=m*(h%m)+c%m;return s&&o<22&&(y+=m*m*((s<0?-2*s-1:2*s)%(1<<2*(22-o)))),16*(32*y+o)+(i-o)}function dd(s,i){return s.x*i.x+s.y*i.y}function Gp(s,i){if(1===s.length){let o=0;const c=i[o++];let h;for(;!h||c.equals(h);)if(h=i[o++],!h)return 1/0;for(;o<i.length;o++){const m=i[o],y=s[0],b=h.sub(c),A=m.sub(c),E=y.sub(c),P=dd(b,b),k=dd(b,A),R=dd(A,A),B=dd(E,b),N=dd(E,A),q=P*R-k*k,Q=(R*B-k*N)/q,se=(P*N-k*B)/q,he=c.z*(1-Q-se)+h.z*Q+m.z*se;if(isFinite(he))return he}return 1/0}{let o=1/0;for(const c of i)o=Math.min(o,c.z);return o}}function Hp(s){const i=new dt(s[0],s[1]);return i.z=s[2],i}function R_(s,i,o,c,h,m,y,b){const A=y*h.getElevationAt(s,i,!0,!0),E=0!==m[0],P=E?0===m[1]?y*(m[0]/7-450):y*function(k,R,B){const N=Math.floor(R[0]/8),q=Math.floor(R[1]/8),Q=10*(R[0]-8*N),se=10*(R[1]-8*q),he=k.getElevationAt(N,q,!0,!0),ae=k.getMeterToDEM(B),de=Math.floor(.5*(Q*ae-1)),ye=Math.floor(.5*(se*ae-1)),me=k.tileCoordToPixel(N,q),De=2*de+1,Pe=2*ye+1,Fe=(Xt=De,Kt=Pe,[(Qe=k).getElevationAtPixel(Ze=me.x-de,pt=me.y-ye,!0),Qe.getElevationAtPixel(Ze+Kt,pt,!0),Qe.getElevationAtPixel(Ze,pt+Kt,!0),Qe.getElevationAtPixel(Ze+Xt,pt+Kt,!0)]),tt=Math.abs(Fe[0]-Fe[1]),Oe=Math.abs(Fe[2]-Fe[3]),Ve=Math.abs(Fe[0]-Fe[2])+Math.abs(Fe[1]-Fe[3]),qe=Math.min(.25,.5*ae*(tt+Oe)/De),Ue=Math.min(.25,.5*ae*Ve/Pe);var Qe,Ze,pt,Xt,Kt;return he+Math.max(qe*Q,Ue*se)}(h,m,b):A;return{base:A+(0===o)?-1:o,top:E?Math.max(P+c,A+o+2):A+c}}vt($p,"CanonicalTileID"),vt(Dr,"OverscaledTileID",{omit:["projMatrix"]});const L_=He([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:z_}=L_,Gc=He([{name:"a_packed",components:4,type:"Float32"}]),{members:F_}=Gc,B_=Wa.VectorTileFeature.types,S0=Math.cos(Math.PI/180*37.5);class Hc{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.id),this.index=i.index,this.projection=i.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new jt,this.layoutVertexArray2=new un,this.indexArray=new on,this.programConfigurations=new Qu(i.layers,i.zoom),this.segments=new Hi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(i,o,c,h){this.hasPattern=Fp("line",this.layers,o);const m=this.layers[0].layout.get("line-sort-key"),y=[];for(const{feature:P,id:k,index:R,sourceLayerIndex:B}of i){const N=this.layers[0]._featureFilter.needGeometry,q=Dc(P,N);if(!this.layers[0]._featureFilter.filter(new J(this.zoom),q,c))continue;const Q=m?m.evaluate(q,{},c):void 0,se={id:k,properties:P.properties,type:P.type,sourceLayerIndex:B,index:R,geometry:N?q.geometry:Wo(P,c,h),patterns:{},sortKey:Q};y.push(se)}m&&y.sort((P,k)=>P.sortKey-k.sortKey);const{lineAtlas:b,featureIndex:A}=o,E=this.addConstantDashes(b);for(const P of y){const{geometry:k,index:R,sourceLayerIndex:B}=P;if(E&&this.addFeatureDashes(P,b),this.hasPattern){const N=ym("line",this.layers,P,this.zoom,o);this.patternFeatures.push(N)}else this.addFeature(P,k,R,c,b.positions,o.availableImages);A.insert(i[R].feature,k,R,B,this.index)}}addConstantDashes(i){let o=!1;for(const c of this.layers){const h=c.paint.get("line-dasharray").value,m=c.layout.get("line-cap").value;if("constant"!==h.kind||"constant"!==m.kind)o=!0;else{const y=m.value,b=h.value;if(!b)continue;i.addDash(b.from,y),i.addDash(b.to,y),b.other&&i.addDash(b.other,y)}}return o}addFeatureDashes(i,o){const c=this.zoom;for(const h of this.layers){const m=h.paint.get("line-dasharray").value,y=h.layout.get("line-cap").value;if("constant"===m.kind&&"constant"===y.kind)continue;let b,A,E,P,k,R;if("constant"===m.kind){const Q=m.value;if(!Q)continue;b=Q.other||Q.to,A=Q.to,E=Q.from}else b=m.evaluate({zoom:c-1},i),A=m.evaluate({zoom:c},i),E=m.evaluate({zoom:c+1},i);"constant"===y.kind?P=k=R=y.value:(P=y.evaluate({zoom:c-1},i),k=y.evaluate({zoom:c},i),R=y.evaluate({zoom:c+1},i)),o.addDash(b,P),o.addDash(A,k),o.addDash(E,R);const B=o.getKey(b,P),N=o.getKey(A,k),q=o.getKey(E,R);i.patterns[h.id]={min:B,mid:N,max:q}}}update(i,o,c,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,o,this.stateDependentLayers,c,h)}addFeatures(i,o,c,h,m){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,o,c,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,F_)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,z_),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&i.properties.hasOwnProperty("mapbox_clip_start")&&i.properties.hasOwnProperty("mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,o,c,h,m,y){const b=this.layers[0].layout,A=b.get("line-join").evaluate(i,{}),E=b.get("line-cap").evaluate(i,{}),P=b.get("line-miter-limit"),k=b.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const R of o)this.addLine(R,i,A,E,P,k);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,c,m,y,h)}addLine(i,o,c,h,m,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let se=0;se<i.length-1;se++)this.totalDistance+=i[se].dist(i[se+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b="Polygon"===B_[o.type];let A=i.length;for(;A>=2&&i[A-1].equals(i[A-2]);)A--;let E=0;for(;E<A-1&&i[E].equals(i[E+1]);)E++;if(A<(b?3:2))return;"bevel"===c&&(m=1.05);const P=this.overscaling<=16?122880/(512*this.overscaling):0,k=this.segments.prepareSegment(10*A,this.layoutVertexArray,this.indexArray);let R,B,N,q,Q;this.e1=this.e2=-1,b&&(R=i[A-2],Q=i[E].sub(R)._unit()._perp());for(let se=E;se<A;se++){if(N=se===A-1?b?i[E+1]:void 0:i[se+1],N&&i[se].equals(N))continue;Q&&(q=Q),R&&(B=R),R=i[se],Q=N?N.sub(R)._unit()._perp():q,q=q||Q;let he=q.add(Q);0===he.x&&0===he.y||he._unit();const ae=q.x*Q.x+q.y*Q.y,de=he.x*Q.x+he.y*Q.y,ye=0!==de?1/de:1/0,me=2*Math.sqrt(2-2*de),De=de<S0&&B&&N,Pe=q.x*Q.y-q.y*Q.x>0;if(De&&se>E){const Oe=R.dist(B);if(Oe>2*P){const Ve=R.sub(R.sub(B)._mult(P/Oe)._round());this.updateDistance(B,Ve),this.addCurrentVertex(Ve,q,0,0,k),B=Ve}}const Fe=B&&N;let tt=Fe?c:b?"butt":h;if(Fe&&"round"===tt&&(ye<y?tt="miter":ye<=2&&(tt="fakeround")),"miter"===tt&&ye>m&&(tt="bevel"),"bevel"===tt&&(ye>2&&(tt="flipbevel"),ye<m&&(tt="miter")),B&&this.updateDistance(B,R),"miter"===tt)he._mult(ye),this.addCurrentVertex(R,he,0,0,k);else if("flipbevel"===tt){if(ye>100)he=Q.mult(-1);else{const Oe=ye*q.add(Q).mag()/q.sub(Q).mag();he._perp()._mult(Oe*(Pe?-1:1))}this.addCurrentVertex(R,he,0,0,k),this.addCurrentVertex(R,he.mult(-1),0,0,k)}else if("bevel"===tt||"fakeround"===tt){const Oe=-Math.sqrt(ye*ye-1),Ve=Pe?Oe:0,qe=Pe?0:Oe;if(B&&this.addCurrentVertex(R,q,Ve,qe,k),"fakeround"===tt){const Ue=Math.round(180*me/Math.PI/20);for(let Qe=1;Qe<Ue;Qe++){let Ze=Qe/Ue;if(.5!==Ze){const Xt=Ze-.5;Ze+=Ze*Xt*(Ze-1)*((1.0904+ae*(ae*(3.55645-1.43519*ae)-3.2452))*Xt*Xt+(.848013+ae*(.215638*ae-1.06021)))}const pt=Q.sub(q)._mult(Ze)._add(q)._unit()._mult(Pe?-1:1);this.addHalfVertex(R,pt.x,pt.y,!1,Pe,0,k)}}N&&this.addCurrentVertex(R,Q,-Ve,-qe,k)}else if("butt"===tt)this.addCurrentVertex(R,he,0,0,k);else if("square"===tt){const Oe=B?1:-1;B||this.addCurrentVertex(R,he,Oe,Oe,k),this.addCurrentVertex(R,he,0,0,k),B&&this.addCurrentVertex(R,he,Oe,Oe,k)}else"round"===tt&&(B&&(this.addCurrentVertex(R,q,0,0,k),this.addCurrentVertex(R,q,1,1,k,!0)),N&&(this.addCurrentVertex(R,Q,-1,-1,k,!0),this.addCurrentVertex(R,Q,0,0,k)));if(De&&se<A-1){const Oe=R.dist(N);if(Oe>2*P){const Ve=R.add(N.sub(R)._mult(P/Oe)._round());this.updateDistance(R,Ve),this.addCurrentVertex(Ve,Q,0,0,k),R=Ve}}}}addCurrentVertex(i,o,c,h,m,y=!1){const b=o.y*h-o.x,A=-o.y-o.x*h;this.addHalfVertex(i,o.x+o.y*c,o.y-o.x*c,y,!1,c,m),this.addHalfVertex(i,b,A,y,!0,-h,m)}addHalfVertex({x:i,y:o},c,h,m,y,b,A){this.layoutVertexArray.emplaceBack((i<<1)+(m?1:0),(o<<1)+(y?1:0),Math.round(63*c)+128,Math.round(63*h)+128,1+(0===b?0:b<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const E=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,E),A.primitiveLength++),y?this.e2=E:this.e1=E}updateScaledDistance(){if(this.lineClips){const i=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=i*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(i,o){this.distance+=i.dist(o),this.updateScaledDistance()}}vt(Hc,"LineBucket",{omit:["layers","patternFeatures"]});const D0=new je({"line-cap":new Ce(Re.layout_line["line-cap"]),"line-join":new Ce(Re.layout_line["line-join"]),"line-miter-limit":new _e(Re.layout_line["line-miter-limit"]),"line-round-limit":new _e(Re.layout_line["line-round-limit"]),"line-sort-key":new Ce(Re.layout_line["line-sort-key"])});var Cm={paint:new je({"line-opacity":new Ce(Re.paint_line["line-opacity"]),"line-color":new Ce(Re.paint_line["line-color"]),"line-translate":new _e(Re.paint_line["line-translate"]),"line-translate-anchor":new _e(Re.paint_line["line-translate-anchor"]),"line-width":new Ce(Re.paint_line["line-width"]),"line-gap-width":new Ce(Re.paint_line["line-gap-width"]),"line-offset":new Ce(Re.paint_line["line-offset"]),"line-blur":new Ce(Re.paint_line["line-blur"]),"line-dasharray":new Se(Re.paint_line["line-dasharray"]),"line-pattern":new Se(Re.paint_line["line-pattern"]),"line-gradient":new Ee(Re.paint_line["line-gradient"]),"line-trim-offset":new _e(Re.paint_line["line-trim-offset"])}),layout:D0};const Am=new class extends Ce{possiblyEvaluate(s,i){return i=new J(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition}),super.possiblyEvaluate(s,i)}evaluate(s,i,o,c){return i=ji({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(s,i,o,c)}}(Cm.paint.properties["line-width"].specification);function Em(s,i){return i>0?i+2*s:s}Am.useIntegerZoom=!0;const Tm=He([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),N_=He([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),qp=He([{name:"a_projected_pos",components:4,type:"Float32"}],4);He([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Zp=He([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),j_=He([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);He([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Wp=He([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),V_=He([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);He([{name:"triangle",components:3,type:"Uint16"}]),He([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),He([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),He([{type:"Float32",name:"offsetX"}]),He([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const Mo=128;function Mm(s,i){const{expression:o}=i;if("constant"===o.kind)return{kind:"constant",layoutSize:o.evaluate(new J(s+1))};if("source"===o.kind)return{kind:"source"};{const{zoomStops:c,interpolationType:h}=o;let m=0;for(;m<c.length&&c[m]<=s;)m++;m=Math.max(0,m-1);let y=m;for(;y<c.length&&c[y]<s+1;)y++;y=Math.min(c.length-1,y);const b=c[m],A=c[y];return"composite"===o.kind?{kind:"composite",minZoom:b,maxZoom:A,interpolationType:h}:{kind:"camera",minZoom:b,maxZoom:A,minSize:o.evaluate(new J(b)),maxSize:o.evaluate(new J(A)),interpolationType:h}}}function fh(s,{uSize:i,uSizeT:o},{lowerSize:c,upperSize:h}){return"source"===s.kind?c/Mo:"composite"===s.kind?_n(c/Mo,h/Mo,o):i}function hd(s,i){let o=0,c=0;if("constant"===s.kind)c=s.layoutSize;else if("source"!==s.kind){const{interpolationType:h,minZoom:m,maxZoom:y}=s,b=h?Zt(ro.interpolationFactor(h,i,m,y),0,1):0;"camera"===s.kind?c=_n(s.minSize,s.maxSize,b):o=b}return{uSizeT:o,uSize:c}}var I0=Object.freeze({__proto__:null,getSizeData:Mm,evaluateSizeForFeature:fh,evaluateSizeForZoom:hd,SIZE_PACK_FACTOR:Mo});function U_(s,i,o){return s.sections.forEach(c=>{c.text=function(h,m,y){const b=m.layout.get("text-transform").evaluate(y,{});return"uppercase"===b?h=h.toLocaleUpperCase():"lowercase"===b&&(h=h.toLocaleLowerCase()),K.applyArabicShaping&&(h=K.applyArabicShaping(h)),h}(c.text,i,o)}),s}const qc={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function $_(s){return"\ufe36"===s||"\ufe48"===s||"\ufe38"===s||"\ufe44"===s||"\ufe42"===s||"\ufe3e"===s||"\ufe3c"===s||"\ufe3a"===s||"\ufe18"===s||"\ufe40"===s||"\ufe10"===s||"\ufe13"===s||"\ufe14"===s||"\uff40"===s||"\uffe3"===s||"\ufe11"===s||"\ufe12"===s}function aw(s){return"\ufe35"===s||"\ufe47"===s||"\ufe37"===s||"\ufe43"===s||"\ufe41"===s||"\ufe3d"===s||"\ufe3b"===s||"\ufe39"===s||"\ufe17"===s||"\ufe3f"===s}var Sm=function(s,i,o,c,h){var m,y,b=8*h-c-1,A=(1<<b)-1,E=A>>1,P=-7,k=o?h-1:0,R=o?-1:1,B=s[i+k];for(k+=R,m=B&(1<<-P)-1,B>>=-P,P+=b;P>0;m=256*m+s[i+k],k+=R,P-=8);for(y=m&(1<<-P)-1,m>>=-P,P+=c;P>0;y=256*y+s[i+k],k+=R,P-=8);if(0===m)m=1-E;else{if(m===A)return y?NaN:1/0*(B?-1:1);y+=Math.pow(2,c),m-=E}return(B?-1:1)*y*Math.pow(2,m-c)},G_=function(s,i,o,c,h,m){var y,b,A,E=8*m-h-1,P=(1<<E)-1,k=P>>1,R=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,B=c?0:m-1,N=c?1:-1,q=i<0||0===i&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(b=isNaN(i)?1:0,y=P):(y=Math.floor(Math.log(i)/Math.LN2),i*(A=Math.pow(2,-y))<1&&(y--,A*=2),(i+=y+k>=1?R/A:R*Math.pow(2,1-k))*A>=2&&(y++,A/=2),y+k>=P?(b=0,y=P):y+k>=1?(b=(i*A-1)*Math.pow(2,h),y+=k):(b=i*Math.pow(2,k-1)*Math.pow(2,h),y=0));h>=8;s[o+B]=255&b,B+=N,b/=256,h-=8);for(y=y<<h|b,E+=h;E>0;s[o+B]=255&y,B+=N,y/=256,E-=8);s[o+B-N]|=128*q},pd=Jn;function Jn(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}Jn.Varint=0,Jn.Fixed64=1,Jn.Bytes=2,Jn.Fixed32=5;var Dm=4294967296,ms=1/Dm,H_="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function ma(s){return s.type===Jn.Bytes?s.readVarint()+s.pos:s.pos+1}function q_(s,i,o){var c=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));o.realloc(c);for(var h=o.pos-1;h>=s;h--)o.buf[h+c]=o.buf[h]}function P0(s,i){for(var o=0;o<s.length;o++)i.writeVarint(s[o])}function O0(s,i){for(var o=0;o<s.length;o++)i.writeSVarint(s[o])}function Z_(s,i){for(var o=0;o<s.length;o++)i.writeFloat(s[o])}function k0(s,i){for(var o=0;o<s.length;o++)i.writeDouble(s[o])}function R0(s,i){for(var o=0;o<s.length;o++)i.writeBoolean(s[o])}function L0(s,i){for(var o=0;o<s.length;o++)i.writeFixed32(s[o])}function hn(s,i){for(var o=0;o<s.length;o++)i.writeSFixed32(s[o])}function Bt(s,i){for(var o=0;o<s.length;o++)i.writeFixed64(s[o])}function W_(s,i){for(var o=0;o<s.length;o++)i.writeSFixed64(s[o])}function mh(s,i){return(s[i]|s[i+1]<<8|s[i+2]<<16)+16777216*s[i+3]}function Ya(s,i,o){s[o]=i,s[o+1]=i>>>8,s[o+2]=i>>>16,s[o+3]=i>>>24}function gs(s,i){return(s[i]|s[i+1]<<8|s[i+2]<<16)+(s[i+3]<<24)}function Y_(s,i,o){i.glyphs=[],1===s&&o.readMessage(z0,i)}function z0(s,i,o){if(3===s){const{id:c,bitmap:h,width:m,height:y,left:b,top:A,advance:E}=o.readMessage(Im,{});i.glyphs.push({id:c,bitmap:new hi({width:m+6,height:y+6},h),metrics:{width:m,height:y,left:b,top:A,advance:E}})}else 4===s?i.ascender=o.readSVarint():5===s&&(i.descender=o.readSVarint())}function Im(s,i,o){1===s?i.id=o.readVarint():2===s?i.bitmap=o.readBytes():3===s?i.width=o.readVarint():4===s?i.height=o.readVarint():5===s?i.left=o.readSVarint():6===s?i.top=o.readSVarint():7===s&&(i.advance=o.readVarint())}function js(s){let i=0,o=0;for(const y of s)i+=y.w*y.h,o=Math.max(o,y.w);s.sort((y,b)=>b.h-y.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),o),h:1/0}];let h=0,m=0;for(const y of s)for(let b=c.length-1;b>=0;b--){const A=c[b];if(!(y.w>A.w||y.h>A.h)){if(y.x=A.x,y.y=A.y,m=Math.max(m,y.y+y.h),h=Math.max(h,y.x+y.w),y.w===A.w&&y.h===A.h){const E=c.pop();b<c.length&&(c[b]=E)}else y.h===A.h?(A.x+=y.w,A.w-=y.w):y.w===A.w?(A.y+=y.h,A.h-=y.h):(c.push({x:A.x+y.w,y:A.y,w:A.w-y.w,h:y.h}),A.y+=y.h,A.h-=y.h);break}}return{w:h,h:m,fill:i/(h*m)||0}}Jn.prototype={destroy:function(){this.buf=null},readFields:function(s,i,o){for(o=o||this.length;this.pos<o;){var c=this.readVarint(),h=c>>3,m=this.pos;this.type=7&c,s(h,i,this),this.pos===m&&this.skip(c)}return i},readMessage:function(s,i){return this.readFields(s,i,this.readVarint()+this.pos)},readFixed32:function(){var s=mh(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=gs(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=mh(this.buf,this.pos)+mh(this.buf,this.pos+4)*Dm;return this.pos+=8,s},readSFixed64:function(){var s=mh(this.buf,this.pos)+gs(this.buf,this.pos+4)*Dm;return this.pos+=8,s},readFloat:function(){var s=Sm(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=Sm(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var i,o,c=this.buf;return i=127&(o=c[this.pos++]),o<128?i:(i|=(127&(o=c[this.pos++]))<<7,o<128?i:(i|=(127&(o=c[this.pos++]))<<14,o<128?i:(i|=(127&(o=c[this.pos++]))<<21,o<128?i:function(h,m,y){var b,A,E=y.buf;if(b=(112&(A=E[y.pos++]))>>4,A<128||(b|=(127&(A=E[y.pos++]))<<3,A<128)||(b|=(127&(A=E[y.pos++]))<<10,A<128)||(b|=(127&(A=E[y.pos++]))<<17,A<128)||(b|=(127&(A=E[y.pos++]))<<24,A<128)||(b|=(1&(A=E[y.pos++]))<<31,A<128))return function fd(s,i,o){return o?4294967296*i+(s>>>0):4294967296*(i>>>0)+(s>>>0)}(h,b,m);throw new Error("Expected varint not more than 10 bytes")}(i|=(15&(o=c[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var s=this.readVarint()+this.pos,i=this.pos;return this.pos=s,s-i>=12&&H_?H_.decode(this.buf.subarray(i,s)):function(o,c,h){for(var m="",y=c;y<h;){var b,A,E,P=o[y],k=null,R=P>239?4:P>223?3:P>191?2:1;if(y+R>h)break;1===R?P<128&&(k=P):2===R?128==(192&(b=o[y+1]))&&(k=(31&P)<<6|63&b)<=127&&(k=null):3===R?(A=o[y+2],128==(192&(b=o[y+1]))&&128==(192&A)&&((k=(15&P)<<12|(63&b)<<6|63&A)<=2047||k>=55296&&k<=57343)&&(k=null)):4===R&&(A=o[y+2],E=o[y+3],128==(192&(b=o[y+1]))&&128==(192&A)&&128==(192&E)&&((k=(15&P)<<18|(63&b)<<12|(63&A)<<6|63&E)<=65535||k>=1114112)&&(k=null)),null===k?(k=65533,R=1):k>65535&&(k-=65536,m+=String.fromCharCode(k>>>10&1023|55296),k=56320|1023&k),m+=String.fromCharCode(k),y+=R}return m}(this.buf,i,s)},readBytes:function(){var s=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,s);return this.pos=s,i},readPackedVarint:function(s,i){if(this.type!==Jn.Bytes)return s.push(this.readVarint(i));var o=ma(this);for(s=s||[];this.pos<o;)s.push(this.readVarint(i));return s},readPackedSVarint:function(s){if(this.type!==Jn.Bytes)return s.push(this.readSVarint());var i=ma(this);for(s=s||[];this.pos<i;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){if(this.type!==Jn.Bytes)return s.push(this.readBoolean());var i=ma(this);for(s=s||[];this.pos<i;)s.push(this.readBoolean());return s},readPackedFloat:function(s){if(this.type!==Jn.Bytes)return s.push(this.readFloat());var i=ma(this);for(s=s||[];this.pos<i;)s.push(this.readFloat());return s},readPackedDouble:function(s){if(this.type!==Jn.Bytes)return s.push(this.readDouble());var i=ma(this);for(s=s||[];this.pos<i;)s.push(this.readDouble());return s},readPackedFixed32:function(s){if(this.type!==Jn.Bytes)return s.push(this.readFixed32());var i=ma(this);for(s=s||[];this.pos<i;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){if(this.type!==Jn.Bytes)return s.push(this.readSFixed32());var i=ma(this);for(s=s||[];this.pos<i;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){if(this.type!==Jn.Bytes)return s.push(this.readFixed64());var i=ma(this);for(s=s||[];this.pos<i;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){if(this.type!==Jn.Bytes)return s.push(this.readSFixed64());var i=ma(this);for(s=s||[];this.pos<i;)s.push(this.readSFixed64());return s},skip:function(s){var i=7&s;if(i===Jn.Varint)for(;this.buf[this.pos++]>127;);else if(i===Jn.Bytes)this.pos=this.readVarint()+this.pos;else if(i===Jn.Fixed32)this.pos+=4;else{if(i!==Jn.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(s,i){this.writeVarint(s<<3|i)},realloc:function(s){for(var i=this.length||16;i<this.pos+s;)i*=2;if(i!==this.length){var o=new Uint8Array(i);o.set(this.buf),this.buf=o,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),Ya(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),Ya(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),Ya(this.buf,-1&s,this.pos),Ya(this.buf,Math.floor(s*ms),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),Ya(this.buf,-1&s,this.pos),Ya(this.buf,Math.floor(s*ms),this.pos+4),this.pos+=8},writeVarint:function(s){(s=+s||0)>268435455||s<0?function(i,o){var c,h,m,b;if(i>=0?(c=i%4294967296|0,h=i/4294967296|0):(h=~(-i/4294967296),4294967295^(c=~(-i%4294967296))?c=c+1|0:(c=0,h=h+1|0)),i>=0x10000000000000000||i<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),m=c,(b=o).buf[b.pos++]=127&m|128,m>>>=7,b.buf[b.pos++]=127&m|128,m>>>=7,b.buf[b.pos++]=127&m|128,m>>>=7,b.buf[b.pos++]=127&m|128,b.buf[b.pos]=127&(m>>>=7),function(m,y){var b=(7&m)<<4;y.buf[y.pos++]|=b|((m>>>=3)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m)))))}(h,o)}(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(Boolean(s))},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var i=this.pos;this.pos=function(c,h,m){for(var y,b,A=0;A<h.length;A++){if((y=h.charCodeAt(A))>55295&&y<57344){if(!b){y>56319||A+1===h.length?(c[m++]=239,c[m++]=191,c[m++]=189):b=y;continue}if(y<56320){c[m++]=239,c[m++]=191,c[m++]=189,b=y;continue}y=b-55296<<10|y-56320|65536,b=null}else b&&(c[m++]=239,c[m++]=191,c[m++]=189,b=null);y<128?c[m++]=y:(y<2048?c[m++]=y>>6|192:(y<65536?c[m++]=y>>12|224:(c[m++]=y>>18|240,c[m++]=y>>12&63|128),c[m++]=y>>6&63|128),c[m++]=63&y|128)}return m}(this.buf,s,this.pos);var o=this.pos-i;o>=128&&q_(i,o,this),this.pos=i-1,this.writeVarint(o),this.pos+=o},writeFloat:function(s){this.realloc(4),G_(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),G_(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var i=s.length;this.writeVarint(i),this.realloc(i);for(var o=0;o<i;o++)this.buf[this.pos++]=s[o]},writeRawMessage:function(s,i){this.pos++;var o=this.pos;s(i,this);var c=this.pos-o;c>=128&&q_(o,c,this),this.pos=o-1,this.writeVarint(c),this.pos+=c},writeMessage:function(s,i,o){this.writeTag(s,Jn.Bytes),this.writeRawMessage(i,o)},writePackedVarint:function(s,i){i.length&&this.writeMessage(s,P0,i)},writePackedSVarint:function(s,i){i.length&&this.writeMessage(s,O0,i)},writePackedBoolean:function(s,i){i.length&&this.writeMessage(s,R0,i)},writePackedFloat:function(s,i){i.length&&this.writeMessage(s,Z_,i)},writePackedDouble:function(s,i){i.length&&this.writeMessage(s,k0,i)},writePackedFixed32:function(s,i){i.length&&this.writeMessage(s,L0,i)},writePackedSFixed32:function(s,i){i.length&&this.writeMessage(s,hn,i)},writePackedFixed64:function(s,i){i.length&&this.writeMessage(s,Bt,i)},writePackedSFixed64:function(s,i){i.length&&this.writeMessage(s,W_,i)},writeBytesField:function(s,i){this.writeTag(s,Jn.Bytes),this.writeBytes(i)},writeFixed32Field:function(s,i){this.writeTag(s,Jn.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(s,i){this.writeTag(s,Jn.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(s,i){this.writeTag(s,Jn.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(s,i){this.writeTag(s,Jn.Fixed64),this.writeSFixed64(i)},writeVarintField:function(s,i){this.writeTag(s,Jn.Varint),this.writeVarint(i)},writeSVarintField:function(s,i){this.writeTag(s,Jn.Varint),this.writeSVarint(i)},writeStringField:function(s,i){this.writeTag(s,Jn.Bytes),this.writeString(i)},writeFloatField:function(s,i){this.writeTag(s,Jn.Fixed32),this.writeFloat(i)},writeDoubleField:function(s,i){this.writeTag(s,Jn.Fixed64),this.writeDouble(i)},writeBooleanField:function(s,i){this.writeVarintField(s,Boolean(i))}};class gh{constructor(i,{pixelRatio:o,version:c,stretchX:h,stretchY:m,content:y}){this.paddedRect=i,this.pixelRatio=o,this.stretchX=h,this.stretchY=m,this.content=y,this.version=c}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Pm{constructor(i,o){const c={},h={};this.haveRenderCallbacks=[];const m=[];this.addImages(i,c,m),this.addImages(o,h,m);const{w:y,h:b}=js(m),A=new To({width:y||1,height:b||1});for(const E in i){const P=i[E],k=c[E].paddedRect;To.copy(P.data,A,{x:0,y:0},{x:k.x+1,y:k.y+1},P.data)}for(const E in o){const P=o[E],k=h[E].paddedRect,R=k.x+1,B=k.y+1,N=P.data.width,q=P.data.height;To.copy(P.data,A,{x:0,y:0},{x:R,y:B},P.data),To.copy(P.data,A,{x:0,y:q-1},{x:R,y:B-1},{width:N,height:1}),To.copy(P.data,A,{x:0,y:0},{x:R,y:B+q},{width:N,height:1}),To.copy(P.data,A,{x:N-1,y:0},{x:R-1,y:B},{width:1,height:q}),To.copy(P.data,A,{x:0,y:0},{x:R+N,y:B},{width:1,height:q})}this.image=A,this.iconPositions=c,this.patternPositions=h}addImages(i,o,c){for(const h in i){const m=i[h],y={x:0,y:0,w:m.data.width+2,h:m.data.height+2};c.push(y),o[h]=new gh(y,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(i,o){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(c=>i.hasImage(c)),i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in i.updatedImages)this.patchUpdatedImage(this.iconPositions[c],i.getImage(c),o),this.patchUpdatedImage(this.patternPositions[c],i.getImage(c),o)}patchUpdatedImage(i,o,c){if(!i||!o||i.version===o.version)return;i.version=o.version;const[h,m]=i.tl;c.update(o.data,void 0,{x:h,y:m})}}vt(gh,"ImagePosition"),vt(Pm,"ImageAtlas");const po={horizontal:1,vertical:2,horizontalOnly:3};class Yp{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(i,o){const c=new Yp;return c.scale=i||1,c.fontStack=o,c}static forImage(i){const o=new Yp;return o.imageName=i,o}}class Zc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,o){const c=new Zc;for(let h=0;h<i.sections.length;h++){const m=i.sections[h];m.image?c.addImageSection(m):c.addTextSection(m,o)}return c}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSections(){return this.sections}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(i){this.text=function(o,c){let h="";for(let m=0;m<o.length;m++){const y=o.charCodeAt(m+1)||null,b=o.charCodeAt(m-1)||null;h+=!c&&(y&&ua(y)&&!qc[o[m+1]]||b&&ua(b)&&!qc[o[m-1]])||!qc[o[m]]?o[m]:qc[o[m]]}return h}(this.text,i)}trim(){let i=0;for(let c=0;c<this.text.length&&Wc[this.text.charCodeAt(c)];c++)i++;let o=this.text.length;for(let c=this.text.length-1;c>=0&&c>=i&&Wc[this.text.charCodeAt(c)];c--)o--;this.text=this.text.substring(i,o),this.sectionIndex=this.sectionIndex.slice(i,o)}substring(i,o){const c=new Zc;return c.text=this.text.substring(i,o),c.sectionIndex=this.sectionIndex.slice(i,o),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,o)=>Math.max(i,this.sections[o].scale),0)}addTextSection(i,o){this.text+=i.text,this.sections.push(Yp.forText(i.scale,i.fontStack||o));const c=this.sections.length-1;for(let h=0;h<i.text.length;++h)this.sectionIndex.push(c)}addImageSection(i){const o=i.image?i.image.name:"";if(0===o.length)return void vi("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(Yp.forImage(o)),this.sectionIndex.push(this.sections.length-1)):vi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function X_(s,i,o,c,h,m,y,b,A,E,P,k,R,B,N,q){const Q=Zc.fromFeature(s,h);let se;k===po.vertical&&Q.verticalizePunctuation(R);const{processBidirectionalText:he,processStyledBidirectionalText:ae}=K;if(he&&1===Q.sections.length){se=[];const me=he(Q.toString(),km(Q,E,m,i,c,B,N));for(const De of me){const Pe=new Zc;Pe.text=De,Pe.sections=Q.sections;for(let Fe=0;Fe<De.length;Fe++)Pe.sectionIndex.push(0);se.push(Pe)}}else if(ae){se=[];const me=ae(Q.text,Q.sectionIndex,km(Q,E,m,i,c,B,N));for(const De of me){const Pe=new Zc;Pe.text=De[0],Pe.sectionIndex=De[1],Pe.sections=Q.sections,se.push(Pe)}}else se=function(me,De){const Pe=[],Fe=me.text;let tt=0;for(const Oe of De)Pe.push(me.substring(tt,Oe)),tt=Oe;return tt<Fe.length&&Pe.push(me.substring(tt,Fe.length)),Pe}(Q,km(Q,E,m,i,c,B,N));const de=[],ye={positionedLines:de,text:Q.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:k,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(me,De,Pe,Fe,tt,Oe,Ve,qe,Ue,Qe,Ze,pt){let Xt=0,Kt=0,Ot=0;const ct="right"===qe?1:"left"===qe?0:.5;let dn=!1;for(const Tt of tt){const Cn=Tt.getSections();for(const Xn of Cn){if(Xn.imageName)continue;const $n=De[Xn.fontStack];if($n&&(dn=void 0!==$n.ascender&&void 0!==$n.descender,!dn))break}if(!dn)break}let $t=0;for(const Tt of tt){Tt.trim();const Cn=Tt.getMaxScale(),Xn=24*(Cn-1),$n={positionedGlyphs:[],lineOffset:0};me.positionedLines[$t]=$n;const Gn=$n.positionedGlyphs;let ai=0;if(!Tt.length()){Kt+=Oe,++$t;continue}let fi=0,sr=0;for(let vn=0;vn<Tt.length();vn++){const xi=Tt.getSection(vn),qr=Tt.getSectionIndex(vn),In=Tt.getCharCode(vn);let li=xi.scale,_r=null,mi=null,ki=null,yr=24,ar=0;const vr=!(Ue===po.horizontal||!Ze&&!Ec(In)||Ze&&(Wc[In]||(_t=In,cp(_t)||Fi(_t)||eh(_t)||Ua(_t)||Wu(_t))));if(xi.imageName){const Ir=Fe[xi.imageName];if(!Ir)continue;ki=xi.imageName,me.iconsInText=me.iconsInText||!0,mi=Ir.paddedRect;const xr=Ir.displaySize;li=24*li/pt,_r={width:xr[0],height:xr[1],left:1,top:-3,advance:vr?xr[1]:xr[0],localGlyph:!1},ar=dn?-_r.height*li:24*Cn-17-xr[1]*li,yr=_r.advance;const nl=(vr?xr[0]:xr[1])*li-24*Cn;nl>0&&nl>ai&&(ai=nl)}else{const Ir=Pe[xi.fontStack];if(!Ir)continue;Ir[In]&&(mi=Ir[In]);const xr=De[xi.fontStack];if(!xr)continue;const nl=xr.glyphs[In];if(!nl)continue;if(_r=nl.metrics,yr=8203!==In?24:0,dn){const Hs=void 0!==xr.ascender?Math.abs(xr.ascender):0,Dh=void 0!==xr.descender?Math.abs(xr.descender):0,Td=(Hs+Dh)*li;fi<Td&&(fi=Td,sr=(Hs-Dh)/2*li),ar=-Hs*li}else ar=24*(Cn-li)-17}vr?(me.verticalizable=!0,Gn.push({glyph:In,imageName:ki,x:Xt,y:Kt+ar,vertical:vr,scale:li,localGlyph:_r.localGlyph,fontStack:xi.fontStack,sectionIndex:qr,metrics:_r,rect:mi}),Xt+=yr*li+Qe):(Gn.push({glyph:In,imageName:ki,x:Xt,y:Kt+ar,vertical:vr,scale:li,localGlyph:_r.localGlyph,fontStack:xi.fontStack,sectionIndex:qr,metrics:_r,rect:mi}),Xt+=_r.advance*li+Qe)}0!==Gn.length&&(Ot=Math.max(Xt-Qe,Ot),dn?K_(Gn,ct,ai,sr,Oe*Cn/2):K_(Gn,ct,ai,0,Oe/2)),Xt=0;const Hr=Oe*Cn+ai;$n.lineOffset=Math.max(ai,Xn),Kt+=Hr,++$t}var _t;const Yn=Kt,{horizontalAlign:Un,verticalAlign:pi}=Rm(Ve);(function(Tt,Cn,Xn,$n,Gn,ai){const fi=(Cn-Xn)*Gn,sr=-ai*$n;for(const Hr of Tt)for(const vn of Hr.positionedGlyphs)vn.x+=fi,vn.y+=sr})(me.positionedLines,ct,Un,pi,Ot,Yn),me.top+=-pi*Yn,me.bottom=me.top+Yn,me.left+=-Un*Ot,me.right=me.left+Ot,me.hasBaseline=dn}(ye,i,o,c,se,y,b,A,k,E,R,q),!function(me){for(const De of me)if(0!==De.positionedGlyphs.length)return!1;return!0}(de)&&ye}const Wc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Xp={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Qp(s,i,o,c,h,m){if(i.imageName){const y=c[i.imageName];return y?y.displaySize[0]*i.scale*24/m+h:0}{const y=o[i.fontStack],b=y&&y.glyphs[s];return b?b.metrics.advance*i.scale+h:0}}function Kp(s,i,o,c){const h=Math.pow(s-i,2);return c?s<i?h/2:2*h:h+Math.abs(o)*o}function Om(s,i,o){let c=0;return 10===s&&(c-=1e4),o&&(c+=150),40!==s&&65288!==s||(c+=50),41!==i&&65289!==i||(c+=50),c}function F0(s,i,o,c,h,m){let y=null,b=Kp(i,o,h,m);for(const A of c){const E=Kp(i-A.x,o,h,m)+A.badness;E<=b&&(y=A,b=E)}return{index:s,x:i,priorBreak:y,badness:b}}function Q_(s){return s?Q_(s.priorBreak).concat(s.index):[]}function km(s,i,o,c,h,m,y){if("point"!==m)return[];if(!s)return[];const b=[],A=function(R,B,N,q,Q,se){let he=0;for(let ae=0;ae<R.length();ae++){const de=R.getSection(ae);he+=Qp(R.getCharCode(ae),de,q,Q,B,se)}return he/Math.max(1,Math.ceil(he/N))}(s,i,o,c,h,y),E=s.text.indexOf("\u200b")>=0;let P=0;for(let R=0;R<s.length();R++){const B=s.getSection(R),N=s.getCharCode(R);if(Wc[N]||(P+=Qp(N,B,c,h,i,y)),R<s.length()-1){const q=!((k=N)<11904||!(Rl(k)||Yf(k)||Cc(k)||Zu(k)||ca(k)||Ol(k)||pr(k)||kl(k)||Uo(k)||bc(k)||qu(k)||Ll(k)||up(k)||ja(k)||jo(k)||Vo(k)||Va(k)||th(k)||dp(k)||wc(k)));(Xp[N]||q||B.imageName)&&b.push(F0(R+1,P,A,b,Om(N,s.getCharCode(R+1),q&&E),!1))}}var k;return Q_(F0(s.length(),P,A,b,0,!0))}function Rm(s){let i=.5,o=.5;switch(s){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:i,verticalAlign:o}}function K_(s,i,o,c,h){if(!(i||o||c||h))return;const m=s.length-1,y=s[m],b=(y.x+y.metrics.advance*y.scale)*i;for(let A=0;A<=m;A++)s[A].x-=b,s[A].y+=o+c+h}function J_(s,i,o){const{horizontalAlign:c,verticalAlign:h}=Rm(o),m=i[0]-s.displaySize[0]*c,y=i[1]-s.displaySize[1]*h;return{image:s,top:y,bottom:y+s.displaySize[1],left:m,right:m+s.displaySize[0]}}function B0(s,i,o,c,h,m){const y=s.image;let b;if(y.content){const Q=y.content,se=y.pixelRatio||1;b=[Q[0]/se,Q[1]/se,y.displaySize[0]-Q[2]/se,y.displaySize[1]-Q[3]/se]}const A=i.left*m,E=i.right*m;let P,k,R,B;"width"===o||"both"===o?(B=h[0]+A-c[3],k=h[0]+E+c[1]):(B=h[0]+(A+E-y.displaySize[0])/2,k=B+y.displaySize[0]);const N=i.top*m,q=i.bottom*m;return"height"===o||"both"===o?(P=h[1]+N-c[0],R=h[1]+q+c[2]):(P=h[1]+(N+q-y.displaySize[1])/2,R=P+y.displaySize[1]),{image:y,top:P,right:k,bottom:R,left:B,collisionPadding:b}}class Xa extends dt{constructor(i,o,c,h,m){super(i,o),this.angle=h,this.z=c,void 0!==m&&(this.segment=m)}clone(){return new Xa(this.x,this.y,this.z,this.angle,this.segment)}}function N0(s,i,o,c,h){if(void 0===i.segment)return!0;let m=i,y=i.segment+1,b=0;for(;b>-o/2;){if(y--,y<0)return!1;b-=s[y].dist(m),m=s[y]}b+=s[y].dist(s[y+1]),y++;const A=[];let E=0;for(;b<o/2;){const P=s[y],k=s[y+1];if(!k)return!1;let R=s[y-1].angleTo(P)-P.angleTo(k);for(R=Math.abs((R+3*Math.PI)%(2*Math.PI)-Math.PI),A.push({distance:b,angleDelta:R}),E+=R;b-A[0].distance>c;)E-=A.shift().angleDelta;if(E>h)return!1;y++,b+=P.dist(k)}return!0}function Lm(s){let i=0;for(let o=0;o<s.length-1;o++)i+=s[o].dist(s[o+1]);return i}function zm(s,i,o){return s?.6*i*o:0}function ey(s,i){return Math.max(s?s.right-s.left:0,i?i.right-i.left:0)}function Fm(s,i,o,c,h,m){const y=zm(o,h,m),b=ey(o,c)*m;let A=0;const E=Lm(s)/2;for(let P=0;P<s.length-1;P++){const k=s[P],R=s[P+1],B=k.dist(R);if(A+B>E){const N=(E-A)/B,q=_n(k.x,R.x,N),Q=_n(k.y,R.y,N),se=new Xa(q,Q,0,R.angleTo(k),P);return!y||N0(s,se,b,y,i)?se:void 0}A+=B}}function lw(s,i,o,c,h,m,y,b,A){const E=zm(c,m,y),P=ey(c,h),k=P*y,R=0===s[0].x||s[0].x===A||0===s[0].y||s[0].y===A;return i-k<i/4&&(i=k+i/4),j0(s,R?i/2*b%i:(P/2+2*m)*y*b%i,i,E,o,k,R,!1,A)}function j0(s,i,o,c,h,m,y,b,A){const E=m/2,P=Lm(s);let k=0,R=i-o,B=[];for(let N=0;N<s.length-1;N++){const q=s[N],Q=s[N+1],se=q.dist(Q),he=Q.angleTo(q);for(;R+o<k+se;){R+=o;const ae=(R-k)/se,de=_n(q.x,Q.x,ae),ye=_n(q.y,Q.y,ae);if(de>=0&&de<A&&ye>=0&&ye<A&&R-E>=0&&R+E<=P){const me=new Xa(de,ye,0,he,N);me._round(),c&&!N0(s,me,m,c,h)||B.push(me)}}k+=se}return b||B.length||y||(B=j0(s,k/2,o,c,h,m,y,!0,A)),B}function V0(s,i,o,c,h){const m=[];for(let y=0;y<s.length;y++){const b=s[y];let A;for(let E=0;E<b.length-1;E++){let P=b[E],k=b[E+1];P.x<i&&k.x<i||(P.x<i?P=new dt(i,P.y+(i-P.x)/(k.x-P.x)*(k.y-P.y))._round():k.x<i&&(k=new dt(i,P.y+(i-P.x)/(k.x-P.x)*(k.y-P.y))._round()),P.y<o&&k.y<o||(P.y<o?P=new dt(P.x+(o-P.y)/(k.y-P.y)*(k.x-P.x),o)._round():k.y<o&&(k=new dt(P.x+(o-P.y)/(k.y-P.y)*(k.x-P.x),o)._round()),P.x>=c&&k.x>=c||(P.x>=c?P=new dt(c,P.y+(c-P.x)/(k.x-P.x)*(k.y-P.y))._round():k.x>=c&&(k=new dt(c,P.y+(c-P.x)/(k.x-P.x)*(k.y-P.y))._round()),P.y>=h&&k.y>=h||(P.y>=h?P=new dt(P.x+(h-P.y)/(k.y-P.y)*(k.x-P.x),h)._round():k.y>=h&&(k=new dt(P.x+(h-P.y)/(k.y-P.y)*(k.x-P.x),h)._round()),A&&P.equals(A[A.length-1])||(A=[P],m.push(A)),A.push(k)))))}}return m}vt(Xa,"Anchor");const Jp=1e20;function U0(s,i,o,c,h,m,y,b,A){for(let E=i;E<i+c;E++)$0(s,o*m+E,m,h,y,b,A);for(let E=o;E<o+h;E++)$0(s,E*m+i,1,c,y,b,A)}function $0(s,i,o,c,h,m,y){m[0]=0,y[0]=-Jp,y[1]=Jp,h[0]=s[i];for(let b=1,A=0,E=0;b<c;b++){h[b]=s[i+b*o];const P=b*b;do{const k=m[A];E=(h[b]-h[k]+P-k*k)/(b-k)/2}while(E<=y[A]&&--A>-1);A++,m[A]=b,y[A]=E,y[A+1]=Jp}for(let b=0,A=0;b<c;b++){for(;y[A+1]<b;)A++;const E=m[A],P=b-E;s[i+b*o]=h[E]+P*P}}const ty={none:0,ideographs:1,all:2};class _h{constructor(i,o,c){this.requestManager=i,this.localGlyphMode=o,this.localFontFamily=c,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(i){this.url=i}getGlyphs(i,o){const c=[];for(const h in i)for(const m of i[h])c.push({stack:h,id:m});Ys(c,({stack:h,id:m},y)=>{let b=this.entries[h];b||(b=this.entries[h]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let A=b.glyphs[m];if(void 0!==A)return void y(null,{stack:h,id:m,glyph:A});if(A=this._tinySDF(b,h,m),A)return b.glyphs[m]=A,void y(null,{stack:h,id:m,glyph:A});const E=Math.floor(m/256);if(256*E>65535)return void y(new Error("glyphs > 65535 not supported"));if(b.ranges[E])return void y(null,{stack:h,id:m,glyph:A});let P=b.requests[E];P||(P=b.requests[E]=[],_h.loadGlyphRange(h,E,this.url,this.requestManager,(k,R)=>{if(R){b.ascender=R.ascender,b.descender=R.descender;for(const B in R.glyphs)this._doesCharSupportLocalGlyph(+B)||(b.glyphs[+B]=R.glyphs[+B]);b.ranges[E]=!0}for(const B of P)B(k,R);delete b.requests[E]})),P.push((k,R)=>{k?y(k):R&&y(null,{stack:h,id:m,glyph:R.glyphs[m]||null})})},(h,m)=>{if(h)o(h);else if(m){const y={};for(const{stack:b,id:A,glyph:E}of m)void 0===y[b]&&(y[b]={}),void 0===y[b].glyphs&&(y[b].glyphs={}),y[b].glyphs[A]=E&&{id:E.id,bitmap:E.bitmap.clone(),metrics:E.metrics},y[b].ascender=this.entries[b].ascender,y[b].descender=this.entries[b].descender;o(null,y)}})}_doesCharSupportLocalGlyph(i){return this.localGlyphMode!==ty.none&&(this.localGlyphMode===ty.all?!!this.localFontFamily:!!this.localFontFamily&&(bc(i)||hp(i)||up(i)||Va(i)||kl(i)))}_tinySDF(i,o,c){const h=this.localFontFamily;if(!h||!this._doesCharSupportLocalGlyph(c))return;let m=i.tinySDF;if(!m){let q="400";/bold/i.test(o)?q="900":/medium/i.test(o)?q="500":/light/i.test(o)&&(q="200"),m=i.tinySDF=new _h.TinySDF({fontFamily:h,fontWeight:q,fontSize:48,buffer:6,radius:16}),m.fontWeight=q}if(this.localGlyphs[m.fontWeight][c])return this.localGlyphs[m.fontWeight][c];const y=String.fromCharCode(c),{data:b,width:A,height:E,glyphWidth:P,glyphHeight:k,glyphLeft:R,glyphTop:B,glyphAdvance:N}=m.draw(y);return this.localGlyphs[m.fontWeight][c]={id:c,bitmap:new hi({width:A,height:E},b),metrics:{width:P/2,height:k/2,left:R/2,top:B/2-27,advance:N/2,localGlyph:!0}}}}function G0(s,i,o,c){const h=[],m=s.image,y=m.pixelRatio,b=m.paddedRect.w-2,A=m.paddedRect.h-2,E=s.right-s.left,P=s.bottom-s.top,k=m.stretchX||[[0,b]],R=m.stretchY||[[0,A]],B=(Oe,Ve)=>Oe+Ve[1]-Ve[0],N=k.reduce(B,0),q=R.reduce(B,0),Q=b-N,se=A-q;let he=0,ae=N,de=0,ye=q,me=0,De=Q,Pe=0,Fe=se;if(m.content&&c){const Oe=m.content;he=Bm(k,0,Oe[0]),de=Bm(R,0,Oe[1]),ae=Bm(k,Oe[0],Oe[2]),ye=Bm(R,Oe[1],Oe[3]),me=Oe[0]-he,Pe=Oe[1]-de,De=Oe[2]-Oe[0]-ae,Fe=Oe[3]-Oe[1]-ye}const tt=(Oe,Ve,qe,Ue)=>{const Qe=md(Oe.stretch-he,ae,E,s.left),Ze=ef(Oe.fixed-me,De,Oe.stretch,N),pt=md(Ve.stretch-de,ye,P,s.top),Xt=ef(Ve.fixed-Pe,Fe,Ve.stretch,q),Kt=md(qe.stretch-he,ae,E,s.left),Ot=ef(qe.fixed-me,De,qe.stretch,N),ct=md(Ue.stretch-de,ye,P,s.top),dn=ef(Ue.fixed-Pe,Fe,Ue.stretch,q),$t=new dt(Qe,pt),_t=new dt(Kt,pt),Yn=new dt(Kt,ct),Un=new dt(Qe,ct),pi=new dt(Ze/y,Xt/y),Tt=new dt(Ot/y,dn/y),Cn=i*Math.PI/180;if(Cn){const Gn=Math.sin(Cn),ai=Math.cos(Cn),fi=[ai,-Gn,Gn,ai];$t._matMult(fi),_t._matMult(fi),Un._matMult(fi),Yn._matMult(fi)}const Xn=Oe.stretch+Oe.fixed,$n=Ve.stretch+Ve.fixed;return{tl:$t,tr:_t,bl:Un,br:Yn,tex:{x:m.paddedRect.x+1+Xn,y:m.paddedRect.y+1+$n,w:qe.stretch+qe.fixed-Xn,h:Ue.stretch+Ue.fixed-$n},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:pi,pixelOffsetBR:Tt,minFontScaleX:De/y/E,minFontScaleY:Fe/y/P,isSDF:o}};if(c&&(m.stretchX||m.stretchY)){const Oe=Qa(k,Q,N),Ve=Qa(R,se,q);for(let qe=0;qe<Oe.length-1;qe++){const Ue=Oe[qe],Qe=Oe[qe+1];for(let Ze=0;Ze<Ve.length-1;Ze++)h.push(tt(Ue,Ve[Ze],Qe,Ve[Ze+1]))}}else h.push(tt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:A+1}));return h}function Bm(s,i,o){let c=0;for(const h of s)c+=Math.max(i,Math.min(o,h[1]))-Math.max(i,Math.min(o,h[0]));return c}function Qa(s,i,o){const c=[{fixed:-1,stretch:0}];for(const[h,m]of s){const y=c[c.length-1];c.push({fixed:h-y.stretch,stretch:y.stretch}),c.push({fixed:h-y.stretch,stretch:y.stretch+(m-h)})}return c.push({fixed:i+1,stretch:o}),c}function md(s,i,o,c){return s/i*o+c}function ef(s,i,o,c){return s-i*o/c}function ny(s,i,o,c){const h=i+s.positionedLines[c].lineOffset;return 0===c?o+h/2:o+(h+(i+s.positionedLines[c-1].lineOffset))/2}_h.loadGlyphRange=function(s,i,o,c,h){const m=256*i,y=m+255,b=c.transformRequest(c.normalizeGlyphsURL(o).replace("{fontstack}",s).replace("{range}",`${m}-${y}`),be.Glyphs);Me(b,(A,E)=>{if(A)h(A);else if(E){const P={},k=new pd(E).readFields(Y_,{});for(const R of k.glyphs)P[R.id]=R;h(null,{glyphs:P,ascender:k.ascender,descender:k.descender})}})},_h.TinySDF=class{constructor({fontSize:s=24,buffer:i=3,radius:o=8,cutoff:c=.25,fontFamily:h="sans-serif",fontWeight:m="normal",fontStyle:y="normal"}={}){this.buffer=i,this.cutoff=c,this.radius=o;const b=this.size=s+4*i,A=this._createCanvas(b),E=this.ctx=A.getContext("2d",{willReadFrequently:!0});E.font=`${y} ${m} ${s}px ${h}`,E.textBaseline="alphabetic",E.textAlign="left",E.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(s){const i=document.createElement("canvas");return i.width=i.height=s,i}draw(s){const{width:i,actualBoundingBoxAscent:o,actualBoundingBoxDescent:c,actualBoundingBoxLeft:h,actualBoundingBoxRight:m}=this.ctx.measureText(s),y=Math.ceil(o),b=Math.min(this.size-this.buffer,Math.ceil(m-h)),A=Math.min(this.size-this.buffer,y+Math.ceil(c)),E=b+2*this.buffer,P=A+2*this.buffer,k=Math.max(E*P,0),R=new Uint8ClampedArray(k),B={data:R,width:E,height:P,glyphWidth:b,glyphHeight:A,glyphTop:y,glyphLeft:0,glyphAdvance:i};if(0===b||0===A)return B;const{ctx:N,buffer:q,gridInner:Q,gridOuter:se}=this;N.clearRect(q,q,b,A),N.fillText(s,q,q+y);const he=N.getImageData(q,q,b,A);se.fill(Jp,0,k),Q.fill(0,0,k);for(let ae=0;ae<A;ae++)for(let de=0;de<b;de++){const ye=he.data[4*(ae*b+de)+3]/255;if(0===ye)continue;const me=(ae+q)*E+de+q;if(1===ye)se[me]=0,Q[me]=Jp;else{const De=.5-ye;se[me]=De>0?De*De:0,Q[me]=De<0?De*De:0}}U0(se,0,0,E,P,E,this.f,this.v,this.z),U0(Q,q,q,b,A,E,this.f,this.v,this.z);for(let ae=0;ae<k;ae++){const de=Math.sqrt(se[ae])-Math.sqrt(Q[ae]);R[ae]=Math.round(255-255*(de/this.radius+this.cutoff))}return B}};class Nm{constructor(i=[],o=iy){if(this.data=i,this.length=this.data.length,this.compare=o,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(i){this.data.push(i),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const i=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:o,compare:c}=this,h=o[i];for(;i>0;){const m=i-1>>1,y=o[m];if(c(h,y)>=0)break;o[i]=y,i=m}o[i]=h}_down(i){const{data:o,compare:c}=this,h=this.length>>1,m=o[i];for(;i<h;){let y=1+(i<<1),b=o[y];const A=y+1;if(A<this.length&&c(o[A],b)<0&&(y=A,b=o[A]),c(b,m)>=0)break;o[i]=b,i=y}o[i]=m}}function iy(s,i){return s<i?-1:s>i?1:0}function jm(s,i=1,o=!1){let c=1/0,h=1/0,m=-1/0,y=-1/0;const b=s[0];for(let B=0;B<b.length;B++){const N=b[B];(!B||N.x<c)&&(c=N.x),(!B||N.y<h)&&(h=N.y),(!B||N.x>m)&&(m=N.x),(!B||N.y>y)&&(y=N.y)}const A=Math.min(m-c,y-h);let E=A/2;const P=new Nm([],H0);if(0===A)return new dt(c,h);for(let B=c;B<m;B+=A)for(let N=h;N<y;N+=A)P.push(new Xo(B+E,N+E,E,s));let k=function(B){let N=0,q=0,Q=0;const se=B[0];for(let he=0,ae=se.length,de=ae-1;he<ae;de=he++){const ye=se[he],me=se[de],De=ye.x*me.y-me.x*ye.y;q+=(ye.x+me.x)*De,Q+=(ye.y+me.y)*De,N+=3*De}return new Xo(q/N,Q/N,0,B)}(s),R=P.length;for(;P.length;){const B=P.pop();(B.d>k.d||!k.d)&&(k=B,o&&console.log("found best %d after %d probes",Math.round(1e4*B.d)/1e4,R)),B.max-k.d<=i||(E=B.h/2,P.push(new Xo(B.p.x-E,B.p.y-E,E,s)),P.push(new Xo(B.p.x+E,B.p.y-E,E,s)),P.push(new Xo(B.p.x-E,B.p.y+E,E,s)),P.push(new Xo(B.p.x+E,B.p.y+E,E,s)),R+=4)}return o&&(console.log(`num probes: ${R}`),console.log(`best distance: ${k.d}`)),k.p}function H0(s,i){return i.max-s.max}function Xo(s,i,o,c){this.p=new dt(s,i),this.h=o,this.d=function(h,m){let y=!1,b=1/0;for(let A=0;A<m.length;A++){const E=m[A];for(let P=0,k=E.length,R=k-1;P<k;R=P++){const B=E[P],N=E[R];B.y>h.y!=N.y>h.y&&h.x<(N.x-B.x)*(h.y-B.y)/(N.y-B.y)+B.x&&(y=!y),b=Math.min(b,im(h,B,N))}}return(y?1:-1)*Math.sqrt(b)}(this.p,c),this.max=this.d+this.h*Math.SQRT2}const tf=Number.POSITIVE_INFINITY,q0=Math.sqrt(2);function nf(s,i){return i[1]!==tf?function(o,c,h){let m=0,y=0;switch(c=Math.abs(c),h=Math.abs(h),o){case"top-right":case"top-left":case"top":y=h-7;break;case"bottom-right":case"bottom-left":case"bottom":y=7-h}switch(o){case"top-right":case"bottom-right":case"right":m=-c;break;case"top-left":case"bottom-left":case"left":m=c}return[m,y]}(s,i[0],i[1]):function(o,c){let h=0,m=0;c<0&&(c=0);const y=c/q0;switch(o){case"top-right":case"top-left":m=y-7;break;case"bottom-right":case"bottom-left":m=7-y;break;case"bottom":m=7-c;break;case"top":m=c-7}switch(o){case"top-right":case"bottom-right":h=-y;break;case"top-left":case"bottom-left":h=y;break;case"left":h=c;break;case"right":h=-c}return[h,m]}(s,i[0])}function Z0(s,i,o,c,h,m,y,b,A,E){s.createArrays(),s.tilePixelRatio=zt/(512*s.overscaling),s.compareText={},s.iconsNeedLinear=!1;const P=s.layers[0].layout,k=s.layers[0]._unevaluatedLayout._values,R={};if("composite"===s.textSizeData.kind){const{minZoom:q,maxZoom:Q}=s.textSizeData;R.compositeTextSizes=[k["text-size"].possiblyEvaluate(new J(q),b),k["text-size"].possiblyEvaluate(new J(Q),b)]}if("composite"===s.iconSizeData.kind){const{minZoom:q,maxZoom:Q}=s.iconSizeData;R.compositeIconSizes=[k["icon-size"].possiblyEvaluate(new J(q),b),k["icon-size"].possiblyEvaluate(new J(Q),b)]}R.layoutTextSize=k["text-size"].possiblyEvaluate(new J(A+1),b),R.layoutIconSize=k["icon-size"].possiblyEvaluate(new J(A+1),b),R.textMaxSize=k["text-size"].possiblyEvaluate(new J(18),b);const B="map"===P.get("text-rotation-alignment")&&"point"!==P.get("symbol-placement"),N=P.get("text-size");for(const q of s.features){const Q=P.get("text-font").evaluate(q,{},b).join(","),se=N.evaluate(q,{},b),he=R.layoutTextSize.evaluate(q,{},b),ae=(R.layoutIconSize.evaluate(q,{},b),{horizontal:{},vertical:void 0}),de=q.text;let ye,me=[0,0];if(de){const Fe=de.toString(),tt=24*P.get("text-letter-spacing").evaluate(q,{},b),Oe=24*P.get("text-line-height").evaluate(q,{},b),Ve=fp(Fe)?tt:0,qe=P.get("text-anchor").evaluate(q,{},b),Ue=P.get("text-variable-anchor");if(!Ue){const Ot=P.get("text-radial-offset").evaluate(q,{},b);me=Ot?nf(qe,[24*Ot,tf]):P.get("text-offset").evaluate(q,{},b).map(ct=>24*ct)}let Qe=B?"center":P.get("text-justify").evaluate(q,{},b);const Ze=P.get("symbol-placement"),pt="point"===Ze,Xt="point"===Ze?24*P.get("text-max-width").evaluate(q,{},b):0,Kt=Ot=>{s.allowVerticalPlacement&&Ac(Fe)&&(ae.vertical=X_(de,i,o,h,Q,Xt,Oe,qe,Ot,Ve,me,po.vertical,!0,Ze,he,se))};if(!B&&Ue){const Ot="auto"===Qe?Ue.map(dn=>rf(dn)):[Qe];let ct=!1;for(let dn=0;dn<Ot.length;dn++){const $t=Ot[dn];if(!ae.horizontal[$t])if(ct)ae.horizontal[$t]=ae.horizontal[0];else{const _t=X_(de,i,o,h,Q,Xt,Oe,"center",$t,Ve,me,po.horizontal,!1,Ze,he,se);_t&&(ae.horizontal[$t]=_t,ct=1===_t.positionedLines.length)}}Kt("left")}else{if("auto"===Qe&&(Qe=rf(qe)),pt||P.get("text-writing-mode").indexOf("horizontal")>=0||!Ac(Fe)){const Ot=X_(de,i,o,h,Q,Xt,Oe,qe,Qe,Ve,me,po.horizontal,!1,Ze,he,se);Ot&&(ae.horizontal[Qe]=Ot)}Kt("point"===Ze?"left":Qe)}}let De=!1;if(q.icon&&q.icon.name){const Fe=c[q.icon.name];Fe&&(ye=J_(h[q.icon.name],P.get("icon-offset").evaluate(q,{},b),P.get("icon-anchor").evaluate(q,{},b)),De=Fe.sdf,void 0===s.sdfIcons?s.sdfIcons=Fe.sdf:s.sdfIcons!==Fe.sdf&&vi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Fe.pixelRatio!==s.pixelRatio||0!==P.get("icon-rotate").constantOr(1))&&(s.iconsNeedLinear=!0))}const Pe=Yc(ae.horizontal)||ae.vertical;s.iconsInText||(s.iconsInText=!!Pe&&Pe.iconsInText),(Pe||ye)&&W0(s,q,ae,ye,c,R,he,0,me,De,y,b,E)}m&&s.generateCollisionDebugBuffers(A,s.collisionBoxArray)}function rf(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function W0(s,i,o,c,h,m,y,b,A,E,P,k,R){let B=m.textMaxSize.evaluate(i,{},k);void 0===B&&(B=y);const N=s.layers[0].layout,q=N.get("icon-offset").evaluate(i,{},k),Q=Yc(o.horizontal)||o.vertical,se="globe"===R.name,he=y/24,ae=s.tilePixelRatio*B/24,de=(Ve=s.overscaling,s.zoom>18&&Ve>2&&(Ve>>=1),Math.max(zt/(512*Ve),1)*N.get("symbol-spacing")),ye=N.get("text-padding")*s.tilePixelRatio,me=N.get("icon-padding")*s.tilePixelRatio,De=ln(N.get("text-max-angle")),Pe="map"===N.get("text-rotation-alignment")&&"point"!==N.get("symbol-placement"),Fe="map"===N.get("icon-rotation-alignment")&&"point"!==N.get("symbol-placement"),tt=N.get("symbol-placement"),Oe=de/2;var Ve;const qe=N.get("icon-text-fit");let Ue;c&&"none"!==qe&&(s.allowVerticalPlacement&&o.vertical&&(Ue=B0(c,o.vertical,qe,N.get("icon-text-fit-padding"),q,he)),Q&&(c=B0(c,Q,qe,N.get("icon-text-fit-padding"),q,he)));const Qe=(Ze,pt,Xt)=>{if(pt.x<0||pt.x>=zt||pt.y<0||pt.y>=zt)return;let Kt=null;if(se){const{x:Ot,y:ct,z:dn}=R.projectTilePoint(pt.x,pt.y,Xt);Kt={anchor:new Xa(Ot,ct,dn,0,void 0),up:R.upVector(Xt,pt.x,pt.y)}}!function(Ot,ct,dn,$t,_t,Yn,Un,pi,Tt,Cn,Xn,$n,Gn,ai,fi,sr,Hr,vn,xi,qr,In,li,_r,mi,ki){const yr=Ot.addToLineVertexArray(ct,$t);let ar,vr,Ir,xr,nl,Hs,Dh,Td=0,Dy=0,cg=0,Ih=0,ug=-1,xf=-1;const xa={};let Iy=_p("");const tu=dn?dn.anchor:ct;let dg=0,hg=0;if(void 0===Tt._unevaluatedLayout.getValue("text-radial-offset")?[dg,hg]=Tt.layout.get("text-offset").evaluate(In,{},ki).map(fo=>24*fo):(dg=24*Tt.layout.get("text-radial-offset").evaluate(In,{},ki),hg=tf),Ot.allowVerticalPlacement&&_t.vertical){const fo=_t.vertical;if(fi)Hs=Nl(fo),pi&&(Dh=Nl(pi));else{const Zr=Tt.layout.get("text-rotate").evaluate(In,{},ki)+90;Ir=_d(Cn,tu,ct,Xn,$n,Gn,fo,ai,Zr,sr),pi&&(xr=_d(Cn,tu,ct,Xn,$n,Gn,pi,vn,Zr))}}if(Yn){const fo=Tt.layout.get("icon-rotate").evaluate(In,{},ki),Zr="none"!==Tt.layout.get("icon-text-fit"),bf=G0(Yn,fo,_r,Zr),Ph=pi?G0(pi,fo,_r,Zr):void 0;vr=_d(Cn,tu,ct,Xn,$n,Gn,Yn,vn,fo),Td=4*bf.length;const Oy=Ot.iconSizeData;let Md=null;"source"===Oy.kind?(Md=[Mo*Tt.layout.get("icon-size").evaluate(In,{},ki)],Md[0]>Bl&&vi(`${Ot.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===Oy.kind&&(Md=[Mo*li.compositeIconSizes[0].evaluate(In,{},ki),Mo*li.compositeIconSizes[1].evaluate(In,{},ki)],(Md[0]>Bl||Md[1]>Bl)&&vi(`${Ot.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Ot.addSymbols(Ot.icon,bf,Md,qr,xi,In,!1,dn,ct,yr.lineStartIndex,yr.lineLength,-1,mi,ki),ug=Ot.icon.placedSymbolArray.length-1,Ph&&(Dy=4*Ph.length,Ot.addSymbols(Ot.icon,Ph,Md,qr,xi,In,po.vertical,dn,ct,yr.lineStartIndex,yr.lineLength,-1,mi,ki),xf=Ot.icon.placedSymbolArray.length-1)}for(const fo in _t.horizontal){const Zr=_t.horizontal[fo];ar||(Iy=_p(Zr.text),fi?nl=Nl(Zr):ar=_d(Cn,tu,ct,Xn,$n,Gn,Zr,ai,Tt.layout.get("text-rotate").evaluate(In,{},ki),sr));const bf=1===Zr.positionedLines.length;if(cg+=gd(Ot,dn,ct,Zr,Un,Tt,fi,In,sr,yr,_t.vertical?po.horizontal:po.horizontalOnly,bf?Object.keys(_t.horizontal):[fo],xa,ug,li,mi,ki),bf)break}_t.vertical&&(Ih+=gd(Ot,dn,ct,_t.vertical,Un,Tt,fi,In,sr,yr,po.vertical,["vertical"],xa,xf,li,mi,ki));let il=-1;const pg=(fo,Zr)=>fo?Math.max(fo,Zr):Zr;il=pg(nl,il),il=pg(Hs,il),il=pg(Dh,il);const Py=il>-1?1:0;Ot.glyphOffsetArray.length>=Ja.MAX_GLYPHS&&vi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==In.sortKey&&Ot.addToSortKeyRanges(Ot.symbolInstances.length,In.sortKey),Ot.symbolInstances.emplaceBack(tu.x,tu.y,tu.z,ct.x,ct.y,xa.right>=0?xa.right:-1,xa.center>=0?xa.center:-1,xa.left>=0?xa.left:-1,xa.vertical>=0?xa.vertical:-1,ug,xf,Iy,void 0!==ar?ar:Ot.collisionBoxArray.length,void 0!==ar?ar+1:Ot.collisionBoxArray.length,void 0!==Ir?Ir:Ot.collisionBoxArray.length,void 0!==Ir?Ir+1:Ot.collisionBoxArray.length,void 0!==vr?vr:Ot.collisionBoxArray.length,void 0!==vr?vr+1:Ot.collisionBoxArray.length,xr||Ot.collisionBoxArray.length,xr?xr+1:Ot.collisionBoxArray.length,Xn,cg,Ih,Td,Dy,Py,0,dg,hg,il)}(s,pt,Kt,Ze,o,c,h,Ue,s.layers[0],s.collisionBoxArray,i.index,i.sourceLayerIndex,s.index,ye,Pe,A,0,me,Fe,q,i,m,E,P,k)};if("line"===tt)for(const Ze of V0(i.geometry,0,0,zt,zt)){const pt=lw(Ze,de,De,o.vertical||Q,c,24,ae,s.overscaling,zt);for(const Xt of pt){const Kt=Q;Kt&&yh(s,Kt.text,Oe,Xt)||Qe(Ze,Xt,k)}}else if("line-center"===tt){for(const Ze of i.geometry)if(Ze.length>1){const pt=Fm(Ze,De,o.vertical||Q,c,24,ae);pt&&Qe(Ze,pt,k)}}else if("Polygon"===i.type)for(const Ze of _m(i.geometry,0)){const pt=jm(Ze,16);Qe(Ze[0],new Xa(pt.x,pt.y,0,0,void 0),k)}else if("LineString"===i.type)for(const Ze of i.geometry)Qe(Ze,new Xa(Ze[0].x,Ze[0].y,0,0,void 0),k);else if("Point"===i.type)for(const Ze of i.geometry)for(const pt of Ze)Qe([pt],new Xa(pt.x,pt.y,0,0,void 0),k)}const Bl=32640;function gd(s,i,o,c,h,m,y,b,A,E,P,k,R,B,N,q,Q){const se=function(de,ye,me,De,Pe,Fe,tt,Oe){const Ve=[];if(0===ye.positionedLines.length)return Ve;const qe=De.layout.get("text-rotate").evaluate(Fe,{})*Math.PI/180,Ue=function(Kt){const Ot=Kt[0],ct=Kt[1],dn=Ot*ct;return dn>0?[Ot,-ct]:dn<0?[-Ot,ct]:0===Ot?[ct,Ot]:[ct,-Ot]}(me);let Qe=Math.abs(ye.top-ye.bottom);for(const Kt of ye.positionedLines)Qe-=Kt.lineOffset;const Ze=ye.positionedLines.length,pt=Qe/Ze;let Xt=ye.top-me[1];for(let Kt=0;Kt<Ze;++Kt){const Ot=ye.positionedLines[Kt];Xt=ny(ye,pt,Xt,Kt);for(const ct of Ot.positionedGlyphs){if(!ct.rect)continue;const dn=ct.rect||{};let $t=4,_t=!0,Yn=1,Un=0;if(ct.imageName){const mi=tt[ct.imageName];if(!mi)continue;if(mi.sdf){vi("SDF images are not supported in formatted text and will be ignored.");continue}_t=!1,Yn=mi.pixelRatio,$t=1/Yn}const pi=(Pe||Oe)&&ct.vertical,Tt=ct.metrics.advance*ct.scale/2,Cn=ct.metrics,Xn=ct.rect;if(null===Xn)continue;Oe&&ye.verticalizable&&(Un=ct.imageName?Tt-ct.metrics.width*ct.scale/2:0);const $n=Pe?[ct.x+Tt,ct.y]:[0,0];let Gn=[0,0],ai=[0,0],fi=!1;Pe||(pi?(ai=[ct.x+Tt+Ue[0],ct.y+Ue[1]-Un],fi=!0):Gn=[ct.x+Tt+me[0],ct.y+me[1]-Un]);const sr=Xn.w*ct.scale/(Yn*(ct.localGlyph?2:1)),Hr=Xn.h*ct.scale/(Yn*(ct.localGlyph?2:1));let vn,xi,qr,In;if(pi){const mi=ct.y-Xt,ki=new dt(-Tt,Tt-mi),yr=-Math.PI/2,ar=new dt(...ai);vn=new dt(-Tt+Gn[0],Gn[1]),vn._rotateAround(yr,ki)._add(ar),vn.x+=-mi+Tt,vn.y-=(Cn.left-$t)*ct.scale;const vr=ct.imageName?Cn.advance*ct.scale:24*ct.scale,Ir=String.fromCharCode(ct.glyph);$_(Ir)?vn.x+=(1-$t)*ct.scale:aw(Ir)?vn.x+=vr-Cn.height*ct.scale+(-$t-1)*ct.scale:vn.x+=ct.imageName||Cn.width+2*$t===Xn.w&&Cn.height+2*$t===Xn.h?(vr-Hr)/2:(vr-(Cn.height+2*$t)*ct.scale)/2,xi=new dt(vn.x,vn.y-sr),qr=new dt(vn.x+Hr,vn.y),In=new dt(vn.x+Hr,vn.y-sr)}else{const mi=(Cn.left-$t)*ct.scale-Tt+Gn[0],ki=(-Cn.top-$t)*ct.scale+Gn[1],yr=mi+sr,ar=ki+Hr;vn=new dt(mi,ki),xi=new dt(yr,ki),qr=new dt(mi,ar),In=new dt(yr,ar)}if(qe){let mi;mi=Pe?new dt(0,0):fi?new dt(Ue[0],Ue[1]):new dt(me[0],me[1]),vn._rotateAround(qe,mi),xi._rotateAround(qe,mi),qr._rotateAround(qe,mi),In._rotateAround(qe,mi)}const li=new dt(0,0),_r=new dt(0,0);Ve.push({tl:vn,tr:xi,bl:qr,br:In,tex:dn,writingMode:ye.writingMode,glyphOffset:$n,sectionIndex:ct.sectionIndex,isSDF:_t,pixelOffsetTL:li,pixelOffsetBR:_r,minFontScaleX:0,minFontScaleY:0})}}return Ve}(0,c,A,m,y,b,h,s.allowVerticalPlacement),he=s.textSizeData;let ae=null;"source"===he.kind?(ae=[Mo*m.layout.get("text-size").evaluate(b,{},Q)],ae[0]>Bl&&vi(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===he.kind&&(ae=[Mo*N.compositeTextSizes[0].evaluate(b,{},Q),Mo*N.compositeTextSizes[1].evaluate(b,{},Q)],(ae[0]>Bl||ae[1]>Bl)&&vi(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),s.addSymbols(s.text,se,ae,A,y,b,P,i,o,E.lineStartIndex,E.lineLength,B,q,Q);for(const de of k)R[de]=s.text.placedSymbolArray.length-1;return 4*se.length}function Yc(s){for(const i in s)return s[i];return null}function _d(s,i,o,c,h,m,y,b,A,E){let P=y.top,k=y.bottom,R=y.left,B=y.right;const N=y.collisionPadding;if(N&&(R-=N[0],P-=N[1],B+=N[2],k+=N[3]),A){const q=new dt(R,P),Q=new dt(B,P),se=new dt(R,k),he=new dt(B,k),ae=ln(A);let de=new dt(0,0);E&&(de=new dt(E[0],E[1])),q._rotateAround(ae,de),Q._rotateAround(ae,de),se._rotateAround(ae,de),he._rotateAround(ae,de),R=Math.min(q.x,Q.x,se.x,he.x),B=Math.max(q.x,Q.x,se.x,he.x),P=Math.min(q.y,Q.y,se.y,he.y),k=Math.max(q.y,Q.y,se.y,he.y)}return s.emplaceBack(i.x,i.y,i.z,o.x,o.y,R,P,B,k,b,c,h,m),s.length-1}function Nl(s){s.collisionPadding&&(s.top-=s.collisionPadding[1],s.bottom+=s.collisionPadding[3]);const i=s.bottom-s.top;return i>0?Math.max(10,i):null}function yh(s,i,o,c){const h=s.compareText;if(i in h){const m=h[i];for(let y=m.length-1;y>=0;y--)if(c.dist(m[y])<o)return!0}else h[i]=[];return h[i].push(c),!1}const yd=He([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:ry}=yd,Vm=He([{name:"a_pos_3",components:3,type:"Int16"}]);var vd=He([{name:"a_pos",type:"Int16",components:2}]);const Vs=zt/Math.PI/2,vh=2*jr(1,0)*Vs*Math.PI,Xc=[64,32,16],So=-Vs,Us=Vs,oy=[new Ur([So,So,So],[Us,Us,Us]),new Ur([So,So,So],[0,0,Us]),new Ur([0,So,So],[Us,0,Us]),new Ur([So,0,So],[0,Us,Us]),new Ur([0,0,So],[Us,Us,Us])];function Y0(s,i,o,c=!0){const h=Bs([],s._camera.position,s.worldSize),m=[i,o,1,1];sd(m,m,s.pixelMatrixInverse),cm(m,m,1/m[3]);const y=Vr([],co([],m,h)),b=s.globeMatrix,A=[b[12],b[13],b[14]],E=co([],A,h),P=Tp(E),k=Vr([],E),R=s.worldSize/(2*Math.PI),B=Ns(k,y),N=Math.asin(R/P);if(N<Math.acos(B)){if(!c)return null;const tt=[],Oe=[];Bs(tt,y,P/B),Vr(Oe,co(Oe,tt,E)),Vr(y,zc(y,E,Bs(y,Oe,Math.tan(N)*P)))}const q=[];new lh(h,y).closestPointOnSphere(A,R,q);const Q=Vr([],Es(b,0)),se=Vr([],Es(b,1)),he=Vr([],Es(b,2)),ae=Ns(Q,q),de=Ns(se,q),ye=Ns(he,q),me=cr(Math.asin(-de/R));let De=cr(Math.atan2(ae,ye));De=s.center.lng+function(tt,Oe){const Ve=(Oe-tt+180)%360-180;return Ve<-180?Ve+360:Ve}(s.center.lng,De);const Pe=Ls(De),Fe=Zt(Ha(me),0,1);return new zl(Pe,Fe)}class sy{constructor(i,o,c){this.a=co([],i,c),this.b=co([],o,c),this.center=c;const h=Vr([],this.a),m=Vr([],this.b);this.angle=Math.acos(Ns(h,m))}}function of(s,i){if(0===s.angle)return null;let o;return o=0===s.a[i]?1/s.angle*.5*Math.PI:1/s.angle*Math.atan(s.b[i]/s.a[i]/Math.sin(s.angle)-1/Math.tan(s.angle)),o<0||o>1?null:function(c,h,m,y){const b=Math.sin(m);return c*(Math.sin((1-y)*m)/b)+h*(Math.sin(y*m)/b)}(s.a[i],s.b[i],s.angle,Zt(o,0,1))+s.center[i]}function ga(s){if(s.z<=1)return oy[s.z+2*s.y+s.x];const i=$m(Gr(s));return Ur.fromPoints(i)}function Um(s,i){const o=Ch(i.zoom);if(0===o)return ga(s);const c=Gr(s),h=$m(c),m=Ls(c.getWest())*i.worldSize,y=Ls(c.getEast())*i.worldSize,b=Ha(c.getNorth())*i.worldSize,A=Ha(c.getSouth())*i.worldSize,E=[m,b,0],P=[y,b,0],k=[m,A,0],R=[y,A,0],B=Ap([],i.globeMatrix);return Ai(E,E,B),Ai(P,P,B),Ai(k,k,B),Ai(R,R,B),h[0]=Oa(h[0],k,o),h[1]=Oa(h[1],R,o),h[2]=Oa(h[2],P,o),h[3]=Oa(h[3],E,o),Ur.fromPoints(h)}function ay(s,i,o,c,h){for(const m of o)Ai(m,m,c),Bs(m,m,h),Mp(s,s,m),sm(i,i,m)}function Gr({x:s,y:i,z:o}){const c=1/(1<<o),h=new kn(Zo(s*c),gr((i+1)*c)),m=new kn(Zo((s+1)*c),gr(i*c));return new fa(h,m)}function $m(s){const i=ln(s.getNorth()),o=ln(s.getSouth()),c=Math.cos(i),h=Math.cos(o),m=Math.sin(i),y=Math.sin(o),b=s.getWest(),A=s.getEast();return[xd(h,y,b),xd(h,y,A),xd(c,m,A),xd(c,m,b)]}function xd(s,i,o,c=Vs){return o=ln(o),[s*Math.sin(o)*c,-i*c,s*Math.cos(o)*c]}function Gm(s,i,o){return xd(Math.cos(ln(s)),Math.sin(ln(s)),i,o)}function sf(s,i,o,c){const h=1<<o.z,m=(s/zt+o.x)/h;return Gm(gr((i/zt+o.y)/h),Zo(m),c)}function xh({min:s,max:i}){return 16383/Math.max(i[0]-s[0],i[1]-s[1],i[2]-s[2])}const Q0=new Float64Array(16);function bh(s){const i=xh(s),o=d_(Q0,[i,i,i]);return od(o,o,((c=[])[0]=-(h=s.min)[0],c[1]=-h[1],c[2]=-h[2],c));var c,h}function wh(s){const i=(c=s.min,(o=Q0)[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=c[0],o[13]=c[1],o[14]=c[2],o[15]=1,o);var o,c;const h=1/xh(s);return Rc(i,i,[h,h,h])}function Hm(s,i,o,c,h){const m=function(A){const E=zt/(2*Math.PI);return A/(2*Math.PI)/E}(o),y=[s,i,-o/(2*Math.PI)],b=Fs(new Float64Array(16));return od(b,b,y),Rc(b,b,[m,m,m]),om(b,b,ln(-h)),Ep(b,b,ln(-c)),b}function Ch(s){return es(5,6,s)}function ly(s,i){const o=Gm(i.lat,i.lng);return m=(c=f_([],function(B){const N=Gm(B._center.lat,B._center.lng);let q=am([],ah(0,1,0),N);const Q=h_([],-B.angle,N);q=Ai(q,q,Q),h_(Q,-B._pitch,q);const se=Vr([],N);return Bs(se,se,B.cameraToCenterDistance/B.pixelsPerMeter*vh),Ai(se,se,Q),zc([],N,se)}(s),o))[0],y=c[1],b=c[2],A=(h=o)[0],E=h[1],P=h[2],R=(k=Math.sqrt(m*m+y*y+b*b)*Math.sqrt(A*A+E*E+P*P))&&Ns(c,h)/k,Math.acos(Math.min(Math.max(R,-1),1));var c,h,m,y,b,A,E,P,k,R}const cy=ln(85),uy=Math.cos(cy),K0=Math.sin(cy);function qm(s,i){const o=s.fovAboveCenter,c=s.elevation?s.elevation.getMinElevationBelowMSL()*i:0,h=(s._camera.position[2]*s.worldSize-c)/Math.cos(s._pitch),m=Math.sin(o)*h/Math.sin(Math.max(Math.PI/2-s._pitch-o,.01)),y=Math.sin(s._pitch)*m+h;return Math.min(1.01*y,h*(1/s._horizonShift))}function Qc(s,i){if(!i.isReprojectedInTileSpace)return{scale:1<<s.z,x:s.x,y:s.y,x2:s.x+1,y2:s.y+1,projection:i};const o=Math.pow(2,-s.z),c=s.x*o,h=(s.x+1)*o,m=s.y*o,y=(s.y+1)*o,b=Zo(c),A=Zo(h),E=gr(m),P=gr(y),k=i.project(b,E),R=i.project(A,E),B=i.project(A,P),N=i.project(b,P);let q=Math.min(k.x,R.x,B.x,N.x),Q=Math.min(k.y,R.y,B.y,N.y),se=Math.max(k.x,R.x,B.x,N.x),he=Math.max(k.y,R.y,B.y,N.y);const ae=o/16;function de(me,De,Pe,Fe,tt,Oe){const Ve=(Pe+tt)/2,qe=(Fe+Oe)/2,Ue=i.project(Zo(Ve),gr(qe)),Qe=Math.max(0,q-Ue.x,Q-Ue.y,Ue.x-se,Ue.y-he);q=Math.min(q,Ue.x),se=Math.max(se,Ue.x),Q=Math.min(Q,Ue.y),he=Math.max(he,Ue.y),Qe>ae&&(de(me,Ue,Pe,Fe,Ve,qe),de(Ue,De,Ve,qe,tt,Oe))}de(k,R,c,m,h,m),de(R,B,h,m,h,y),de(B,N,h,y,c,y),de(N,k,c,y,c,m),q-=ae,Q-=ae,se+=ae,he+=ae;const ye=1/Math.max(se-q,he-Q);return{scale:ye,x:q*ye,y:Q*ye,x2:se*ye,y2:he*ye,projection:i}}const J0=Fs(new Float32Array(16));class Ka{constructor(i){this.spec=i,this.name=i.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(i,o){return{x:0,y:0,z:0}}unproject(i,o){return new kn(0,0)}projectTilePoint(i,o,c){return{x:i,y:o,z:0}}locationPoint(i,o,c=!0){return i._coordinatePoint(i.locationCoordinate(o),c)}pixelsPerMeter(i,o){return jr(1,i)*o}pixelSpaceConversion(i,o,c){return 1}farthestPixelDistance(i){return qm(i,i.pixelsPerMeter)}pointCoordinate(i,o,c,h){const m=i.horizonLineFromTop(!1),y=new dt(o,Math.max(m,c));return i.rayIntersectionCoordinate(i.pointRayIntersection(y,h))}pointCoordinate3D(i,o,c){const h=new dt(o,c);if(i.elevation)return i.elevation.pointCoordinate(h);{const m=this.pointCoordinate(i,h.x,h.y,0);return[m.x,m.y,m.z]}}isPointAboveHorizon(i,o){if(i.elevation)return!this.pointCoordinate3D(i,o.x,o.y);const c=i.horizonLineFromTop();return o.y<c}createInversionMatrix(i,o){return J0}createTileMatrix(i,o,c){let h,m,y;const b=c.canonical,A=Fs(new Float64Array(16));if(this.isReprojectedInTileSpace){const E=Qc(b,this);h=1,m=E.x+c.wrap*E.scale,y=E.y,Rc(A,A,[h/E.scale,h/E.scale,i.pixelsPerMeter/o])}else h=o/i.zoomScale(b.z),m=(b.x+Math.pow(2,b.z)*c.wrap)*h,y=b.y*h;return od(A,A,[m,y,0]),Rc(A,A,[h/zt,h/zt,1]),A}upVector(i,o,c){return[0,0,1]}upVectorScale(i,o,c){return{metersToTile:1}}}class dy extends Ka{constructor(i){super(i),this.range=[4,7],this.center=i.center||[-96,37.5];const[o,c]=this.parallels=i.parallels||[29.5,45.5],h=Math.sin(ln(o));this.n=(h+Math.sin(ln(c)))/2,this.c=1+h*(2*this.n-h),this.r0=Math.sqrt(this.c)/this.n}project(i,o){const{n:c,c:h,r0:m}=this,y=ln(i-this.center[0]),b=ln(o),A=Math.sqrt(h-2*c*Math.sin(b))/c;return{x:A*Math.sin(y*c),y:A*Math.cos(y*c)-m,z:0}}unproject(i,o){const{n:c,c:h,r0:m}=this,y=m+o;let b=Math.atan2(i,Math.abs(y))*Math.sign(y);y*c<0&&(b-=Math.PI*Math.sign(i)*Math.sign(y));const A=ln(this.center[0])*c;b=ts(b,-Math.PI-A,Math.PI-A);const E=cr(b/c)+this.center[0],P=Math.asin(Zt((h-(i*i+y*y)*c*c)/(2*c),-1,1)),k=Zt(cr(P),-85.051129,zs);return new kn(E,k)}}const Ah=1.340264,Do=-.081106,Kc=893e-6,Eh=.003796,af=Math.sqrt(3)/2;class cw extends Ka{project(i,o){o=o/180*Math.PI,i=i/180*Math.PI;const c=Math.asin(af*Math.sin(o)),h=c*c,m=h*h*h;return{x:.5*(i*Math.cos(c)/(af*(Ah+3*Do*h+m*(7*Kc+9*Eh*h)))/Math.PI+.5),y:1-.5*(c*(Ah+Do*h+m*(Kc+Eh*h))/Math.PI+1),z:0}}unproject(i,o){i=(2*i-.5)*Math.PI;let c=o=(2*(1-o)-1)*Math.PI,h=c*c,m=h*h*h;for(let P,k,R,B=0;B<12&&(k=c*(Ah+Do*h+m*(Kc+Eh*h))-o,R=Ah+3*Do*h+m*(7*Kc+9*Eh*h),P=k/R,c=Zt(c-P,-Math.PI/3,Math.PI/3),h=c*c,m=h*h*h,!(Math.abs(P)<1e-12));++B);const y=af*i*(Ah+3*Do*h+m*(7*Kc+9*Eh*h))/Math.cos(c),b=Math.asin(Math.sin(c)/af),A=Zt(180*y/Math.PI,-180,180),E=Zt(180*b/Math.PI,-85.051129,zs);return new kn(A,E)}}class hy extends Ka{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0}project(i,o){return{x:.5+i/360,y:.5-o/360,z:0}}unproject(i,o){const c=360*(i-.5),h=Zt(360*(.5-o),-85.051129,zs);return new kn(c,h)}}const bd=Math.PI/2;function lf(s){return Math.tan((bd+s)/2)}class ex extends Ka{constructor(i){super(i),this.center=i.center||[0,30];const[o,c]=this.parallels=i.parallels||[30,30],h=ln(o),m=ln(c),y=Math.cos(h);this.n=h===m?Math.sin(h):Math.log(y/Math.cos(m))/Math.log(lf(m)/lf(h)),this.f=y*Math.pow(lf(h),this.n)/this.n}project(i,o){o=ln(o),i=ln(i-this.center[0]);const c=1e-6,{n:h,f:m}=this;m>0?o<-bd+c&&(o=-bd+c):o>bd-c&&(o=bd-c);const y=m/Math.pow(lf(o),h),b=y*Math.sin(h*i),A=m-y*Math.cos(h*i);return{x:.5*(b/Math.PI+.5),y:1-.5*(A/Math.PI+.5),z:0}}unproject(i,o){i=(2*i-.5)*Math.PI,o=(2*(1-o)-.5)*Math.PI;const{n:c,f:h}=this,m=h-o,y=Math.sign(m),b=Math.sign(c)*Math.sqrt(i*i+m*m);let A=Math.atan2(i,Math.abs(m))*y;m*c<0&&(A-=Math.PI*Math.sign(i)*y);const E=Zt(cr(A/c)+this.center[0],-180,180),P=Zt(cr(2*Math.atan(Math.pow(h/b,1/c))-bd),-85.051129,zs);return new kn(E,P)}}class cf extends Ka{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(i,o){return{x:Ls(i),y:Ha(o),z:0}}unproject(i,o){const c=Zo(i),h=gr(o);return new kn(c,h)}}const py=ln(zs);class tx extends Ka{project(i,o){const c=(o=ln(o))*o,h=c*c;return{x:.5*((i=ln(i))*(.8707-.131979*c+h*(h*(.003971*c-.001529*h)-.013791))/Math.PI+.5),y:1-.5*(o*(1.007226+c*(.015085+h*(.028874*c-.044475-.005916*h)))/Math.PI+1),z:0}}unproject(i,o){i=(2*i-.5)*Math.PI;let c=o=(2*(1-o)-1)*Math.PI,h=25,m=0,y=c*c;do{y=c*c;const E=y*y;m=(c*(1.007226+y*(.015085+E*(.028874*y-.044475-.005916*E)))-o)/(1.007226+y*(.045255+E*(.259866*y-.311325-.005916*11*E))),c=Zt(c-m,-py,py)}while(Math.abs(m)>1e-6&&--h>0);y=c*c;const b=Zt(cr(i/(.8707+y*(y*(y*y*y*(.003971-.001529*y)-.013791)-.131979))),-180,180),A=cr(c);return new kn(b,A)}}const Th=ln(zs);class Zm extends Ka{project(i,o){o=ln(o),i=ln(i);const c=Math.cos(o),h=2/Math.PI,m=Math.acos(c*Math.cos(i/2)),y=Math.sin(m)/m,b=.5*(i*h+2*c*Math.sin(i/2)/y)||0,A=.5*(o+Math.sin(o)/y)||0;return{x:.5*(b/Math.PI+.5),y:1-.5*(A/Math.PI+1),z:0}}unproject(i,o){let c=i=(2*i-.5)*Math.PI,h=o=(2*(1-o)-1)*Math.PI,m=25;const y=1e-6;let b=0,A=0;do{const E=Math.cos(h),P=Math.sin(h),k=2*P*E,R=P*P,B=E*E,N=Math.cos(c/2),q=Math.sin(c/2),Q=2*N*q,se=q*q,he=1-B*N*N,ae=he?1/he:0,de=he?Math.acos(E*N)*Math.sqrt(1/he):0,ye=.5*(2*de*E*q+2*c/Math.PI)-i,me=.5*(de*P+h)-o,De=.5*ae*(B*se+de*E*N*R)+1/Math.PI,Pe=ae*(Q*k/4-de*P*q),Fe=.125*ae*(k*q-de*P*B*Q),tt=.5*ae*(R*N+de*se*E)+.5,Oe=Pe*Fe-tt*De;b=(me*Pe-ye*tt)/Oe,A=(ye*Fe-me*De)/Oe,c=Zt(c-b,-Math.PI,Math.PI),h=Zt(h-A,-Th,Th)}while((Math.abs(b)>y||Math.abs(A)>y)&&--m>0);return new kn(cr(c),cr(h))}}class fy extends Ka{constructor(i){super(i),this.center=i.center||[0,0],this.parallels=i.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ln(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(i,o){const{scale:c,cosPhi:h}=this;return{x:ln(i)*h*c+.5,y:-Math.sin(ln(o))/h*c+.5,z:0}}unproject(i,o){const{scale:c,cosPhi:h}=this,m=-(o-.5)/c,y=Zt(cr((i-.5)/c)/h,-180,180),b=Math.asin(Zt(m*h,-1,1)),A=Zt(cr(b),-85.051129,zs);return new kn(y,A)}}class Wm extends cf{constructor(i){super(i),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug","custom"],this.range=[3,5]}projectTilePoint(i,o,c){const h=sf(i,o,c);return Ai(h,h,bh(ga(c))),{x:h[0],y:h[1],z:h[2]}}locationPoint(i,o){const c=Gm(o.lat,o.lng),h=Vr([],c),m=i.elevation?i.elevation.getAtPointOrZero(i.locationCoordinate(o),i._centerAltitude):i._centerAltitude;Sp(c,c,h,jr(1,0)*zt*m);const y=Fs(new Float64Array(16));return kc(y,i.pixelMatrix,i.globeMatrix),Ai(c,c,y),new dt(c[0],c[1])}pixelsPerMeter(i,o){return jr(1,0)*o}pixelSpaceConversion(i,o,c){const h=_n(jr(1,45)*o,jr(1,i)*o,c);return this.pixelsPerMeter(i,o)/h}createTileMatrix(i,o,c){const h=wh(ga(c.canonical));return kc(new Float64Array(16),i.globeMatrix,h)}createInversionMatrix(i,o){const{center:c}=i,h=bh(ga(o));return Ep(h,h,ln(c.lng)),om(h,h,ln(c.lat)),Rc(h,h,[i._pixelsPerMercatorPixel,i._pixelsPerMercatorPixel,1]),Float32Array.from(h)}pointCoordinate(i,o,c,h){return Y0(i,o,c,!0)||new zl(0,0)}pointCoordinate3D(i,o,c){const h=this.pointCoordinate(i,o,c,0);return[h.x,h.y,h.z]}isPointAboveHorizon(i,o){return!Y0(i,o.x,o.y,!1)}farthestPixelDistance(i){const o=function(h,m){const y=h.cameraToCenterDistance,b=h._centerAltitude*m,A=h._camera,E=h._camera.forward(),P=zc([],Bs([],E,-y),[0,0,b]),k=h.worldSize/(2*Math.PI),R=[0,0,-k],B=h.width/h.height,N=Math.tan(h.fovAboveCenter),q=Bs([],A.up(),N),Q=Bs([],A.right(),N*B),se=Vr([],zc([],zc([],E,q),Q)),he=[];let ae;if(new lh(P,se).closestPointOnSphere(R,k,he)){const de=zc([],he,R),ye=co([],de,P);ae=Math.cos(h.fovAboveCenter)*Tp(ye)}else{const de=co([],P,R),ye=co([],R,P);Vr(ye,ye);const me=Tp(de)-k;ae=Math.sqrt(me*(me+2*k));const De=Math.acos(ae/(k+me))-Math.acos(Ns(E,ye));ae*=Math.cos(De)}return 1.01*ae}(i,this.pixelsPerMeter(i.center.lat,i.worldSize)),c=Ch(i.zoom);if(c>0){const h=qm(i,jr(1,i.center.lat)*i.worldSize),m=i.worldSize/(2*Math.PI),y=Math.max(i.width,i.height)/i.worldSize*Math.PI;return _n(o,h+m*(1-Math.cos(y)),Math.pow(c,10))}return o}upVector(i,o,c){return sf(o,c,i,1)}upVectorScale(i){return{metersToTile:vh*xh(ga(i))}}}function uf(s){const i=s.parallels,o=!!i&&Math.abs(i[0]+i[1])<.01;switch(s.name){case"mercator":return new cf(s);case"equirectangular":return new hy(s);case"naturalEarth":return new tx(s);case"equalEarth":return new cw(s);case"winkelTripel":return new Zm(s);case"albers":return o?new fy(s):new dy(s);case"lambertConformalConic":return o?new fy(s):new ex(s);case"globe":return new Wm(s)}throw new Error(`Invalid projection name: ${s.name}`)}const my=Wa.VectorTileFeature.types,uw=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ym(s,i,o,c,h,m,y,b,A,E,P,k,R){const B=b?Math.min(Bl,Math.round(b[0])):0,N=b?Math.min(Bl,Math.round(b[1])):0;s.emplaceBack(i,o,Math.round(32*c),Math.round(32*h),m,y,(B<<1)+(A?1:0),N,16*E,16*P,256*k,256*R)}function wd(s,i,o,c,h,m,y){s.emplaceBack(i,o,c,h,m,y)}function Xm(s,i,o,c,h){s.emplaceBack(i,o,c,h),s.emplaceBack(i,o,c,h),s.emplaceBack(i,o,c,h),s.emplaceBack(i,o,c,h)}function nx(s){for(const i of s.sections)if(d(i.text))return!0;return!1}class df{constructor(i){this.layoutVertexArray=new Kn,this.indexArray=new on,this.programConfigurations=i,this.segments=new Hi,this.dynamicLayoutVertexArray=new un,this.opacityVertexArray=new Dn,this.placedSymbolArray=new Tc,this.globeExtVertexArray=new di}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(i,o,c,h){this.isEmpty()||(c&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Tm.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,qp.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,uw,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,N_.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||h)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}vt(df,"SymbolBuffers");class hf{constructor(i,o,c){this.layoutVertexArray=new i,this.layoutAttributes=o,this.indexArray=new c,this.segments=new Hi,this.collisionVertexArray=new ni,this.collisionVertexArrayExt=new si}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,Zp.members,!0),this.collisionVertexBufferExt=i.createVertexBuffer(this.collisionVertexArrayExt,j_.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}vt(hf,"CollisionBuffers");class Ja{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(y=>y.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Fs([]),this.placementViewportMatrix=Fs([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Mm(this.zoom,o["text-size"]),this.iconSizeData=Mm(this.zoom,o["icon-size"]);const c=this.layers[0].layout,h=c.get("symbol-sort-key"),m=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==m&&void 0!==h.constantOr(1),this.sortFeaturesByY=("viewport-y"===m||"auto"===m&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(y=>po[y]),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=i.sourceID,this.projection=i.projection}createArrays(){this.text=new df(new Qu(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new df(new Qu(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new Mc,this.lineVertexArray=new $v,this.symbolInstances=new gp}calculateGlyphDependencies(i,o,c,h,m){for(let y=0;y<i.length;y++)if(o[i.charCodeAt(y)]=!0,h&&m){const b=qc[i.charAt(y)];b&&(o[b.charCodeAt(0)]=!0)}}populate(i,o,c,h){const m=this.layers[0],y=m.layout,b="globe"===this.projection.name,A=y.get("text-font"),E=y.get("text-field"),P=y.get("icon-image"),k=("constant"!==E.value.kind||E.value.value instanceof Kr&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&("constant"!==A.value.kind||A.value.value.length>0),R="constant"!==P.value.kind||!!P.value.value||Object.keys(P.parameters).length>0,B=y.get("symbol-sort-key");if(this.features=[],!k&&!R)return;const N=o.iconDependencies,q=o.glyphDependencies,Q=o.availableImages,se=new J(this.zoom);for(const{feature:he,id:ae,index:de,sourceLayerIndex:ye}of i){const me=m._featureFilter.needGeometry,De=Dc(he,me);if(!m._featureFilter.filter(se,De,c))continue;if(me||(De.geometry=Wo(he,c,h)),b&&1!==he.type&&c.z<=5){const Oe=De.geometry,Ve=.98078528056;for(let qe=0;qe<Oe.length;qe++)Oe[qe]=Kv(Oe[qe],Ue=>Ue,(Ue,Qe)=>Ns(sf(Ue.x,Ue.y,c,1),sf(Qe.x,Qe.y,c,1))<Ve)}let Pe,Fe;if(k){const Oe=m.getValueAndResolveTokens("text-field",De,c,Q),Ve=Kr.factory(Oe);nx(Ve)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===W()||this.hasRTLText&&K.isParsed())&&(Pe=U_(Ve,m,De))}if(R){const Oe=m.getValueAndResolveTokens("icon-image",De,c,Q);Fe=Oe instanceof Lr?Oe:Lr.fromString(Oe)}if(!Pe&&!Fe)continue;const tt=this.sortFeaturesByKey?B.evaluate(De,{},c):void 0;if(this.features.push({id:ae,text:Pe,icon:Fe,index:de,sourceLayerIndex:ye,geometry:De.geometry,properties:he.properties,type:my[he.type],sortKey:tt}),Fe&&(N[Fe.name]=!0),Pe){const Oe=A.evaluate(De,{},c).join(","),Ve="map"===y.get("text-rotation-alignment")&&"point"!==y.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(po.vertical)>=0;for(const qe of Pe.sections)if(qe.image)N[qe.image.name]=!0;else{const Ue=Ac(Pe.toString()),Qe=qe.fontStack||Oe,Ze=q[Qe]=q[Qe]||{};this.calculateGlyphDependencies(qe.text,Ze,Ve,this.allowVerticalPlacement,Ue)}}}"line"===y.get("symbol-placement")&&(this.features=function(he){const ae={},de={},ye=[];let me=0;function De(Oe){ye.push(he[Oe]),me++}function Pe(Oe,Ve,qe){const Ue=de[Oe];return delete de[Oe],de[Ve]=Ue,ye[Ue].geometry[0].pop(),ye[Ue].geometry[0]=ye[Ue].geometry[0].concat(qe[0]),Ue}function Fe(Oe,Ve,qe){const Ue=ae[Ve];return delete ae[Ve],ae[Oe]=Ue,ye[Ue].geometry[0].shift(),ye[Ue].geometry[0]=qe[0].concat(ye[Ue].geometry[0]),Ue}function tt(Oe,Ve,qe){const Ue=qe?Ve[0][Ve[0].length-1]:Ve[0][0];return`${Oe}:${Ue.x}:${Ue.y}`}for(let Oe=0;Oe<he.length;Oe++){const Ve=he[Oe],qe=Ve.geometry,Ue=Ve.text?Ve.text.toString():null;if(!Ue){De(Oe);continue}const Qe=tt(Ue,qe),Ze=tt(Ue,qe,!0);if(Qe in de&&Ze in ae&&de[Qe]!==ae[Ze]){const pt=Fe(Qe,Ze,qe),Xt=Pe(Qe,Ze,ye[pt].geometry);delete ae[Qe],delete de[Ze],de[tt(Ue,ye[Xt].geometry,!0)]=Xt,ye[pt].geometry=null}else Qe in de?Pe(Qe,Ze,qe):Ze in ae?Fe(Qe,Ze,qe):(De(Oe),ae[Qe]=me-1,de[Ze]=me-1)}return ye.filter(Oe=>Oe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((he,ae)=>he.sortKey-ae.sortKey)}update(i,o,c,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,o,this.layers,c,h),this.icon.programConfigurations.updatePaintArrays(i,o,this.layers,c,h))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=uf(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,o){const c=this.lineVertexArray.length,h=i.segment;if(void 0!==h){let m=i.dist(o[h+1]),y=i.dist(o[h]);const b={};for(let A=h+1;A<o.length;A++)b[A]={x:o[A].x,y:o[A].y,tileUnitDistanceFromAnchor:m},A<o.length-1&&(m+=o[A+1].dist(o[A]));for(let A=h||0;A>=0;A--)b[A]={x:o[A].x,y:o[A].y,tileUnitDistanceFromAnchor:y},A>0&&(y+=o[A-1].dist(o[A]));for(let A=0;A<o.length;A++){const E=b[A];this.lineVertexArray.emplaceBack(E.x,E.y,E.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(i,o,c,h,m,y,b,A,E,P,k,R,B,N){const q=i.indexArray,Q=i.layoutVertexArray,se=i.globeExtVertexArray,he=i.segments.prepareSegment(4*o.length,Q,q,this.canOverlap?y.sortKey:void 0),ae=this.glyphOffsetArray.length,de=he.vertexLength,ye=this.allowVerticalPlacement&&b===po.vertical?Math.PI/2:0,me=y.text&&y.text.sections;for(let Pe=0;Pe<o.length;Pe++){const{tl:Fe,tr:tt,bl:Oe,br:Ve,tex:qe,pixelOffsetTL:Ue,pixelOffsetBR:Qe,minFontScaleX:Ze,minFontScaleY:pt,glyphOffset:Xt,isSDF:Kt,sectionIndex:Ot}=o[Pe],ct=he.vertexLength,dn=Xt[1];if(Ym(Q,E.x,E.y,Fe.x,dn+Fe.y,qe.x,qe.y,c,Kt,Ue.x,Ue.y,Ze,pt),Ym(Q,E.x,E.y,tt.x,dn+tt.y,qe.x+qe.w,qe.y,c,Kt,Qe.x,Ue.y,Ze,pt),Ym(Q,E.x,E.y,Oe.x,dn+Oe.y,qe.x,qe.y+qe.h,c,Kt,Ue.x,Qe.y,Ze,pt),Ym(Q,E.x,E.y,Ve.x,dn+Ve.y,qe.x+qe.w,qe.y+qe.h,c,Kt,Qe.x,Qe.y,Ze,pt),A){const $t=A.anchor,_t=A.up;wd(se,$t.x,$t.y,$t.z,_t[0],_t[1],_t[2]),wd(se,$t.x,$t.y,$t.z,_t[0],_t[1],_t[2]),wd(se,$t.x,$t.y,$t.z,_t[0],_t[1],_t[2]),wd(se,$t.x,$t.y,$t.z,_t[0],_t[1],_t[2]),Xm(i.dynamicLayoutVertexArray,$t.x,$t.y,$t.z,ye)}else Xm(i.dynamicLayoutVertexArray,E.x,E.y,E.z,ye);q.emplaceBack(ct,ct+1,ct+2),q.emplaceBack(ct+1,ct+2,ct+3),he.vertexLength+=4,he.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Xt[0]),Pe!==o.length-1&&Ot===o[Pe+1].sectionIndex||i.programConfigurations.populatePaintArrays(Q.length,y,y.index,{},B,N,me&&me[Ot])}const De=A?A.anchor:E;i.placedSymbolArray.emplaceBack(De.x,De.y,De.z,E.x,E.y,ae,this.glyphOffsetArray.length-ae,de,P,k,E.segment,c?c[0]:0,c?c[1]:0,h[0],h[1],b,0,!1,0,R,0)}_commitLayoutVertex(i,o,c,h,m,y,b){i.emplaceBack(o,c,h,m,y,Math.round(b.x),Math.round(b.y))}_addCollisionDebugVertices(i,o,c,h,m,y,b){const A=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),E=A.vertexLength,P=b.tileAnchorX,k=b.tileAnchorY;for(let B=0;B<4;B++)c.collisionVertexArray.emplaceBack(0,0,0,0);c.collisionVertexArrayExt.emplaceBack(o,-i.padding,-i.padding),c.collisionVertexArrayExt.emplaceBack(o,i.padding,-i.padding),c.collisionVertexArrayExt.emplaceBack(o,i.padding,i.padding),c.collisionVertexArrayExt.emplaceBack(o,-i.padding,i.padding),this._commitLayoutVertex(c.layoutVertexArray,h,m,y,P,k,new dt(i.x1,i.y1)),this._commitLayoutVertex(c.layoutVertexArray,h,m,y,P,k,new dt(i.x2,i.y1)),this._commitLayoutVertex(c.layoutVertexArray,h,m,y,P,k,new dt(i.x2,i.y2)),this._commitLayoutVertex(c.layoutVertexArray,h,m,y,P,k,new dt(i.x1,i.y2)),A.vertexLength+=4;const R=c.indexArray;R.emplaceBack(E,E+1),R.emplaceBack(E+1,E+2),R.emplaceBack(E+2,E+3),R.emplaceBack(E+3,E),A.primitiveLength+=4}_addTextDebugCollisionBoxes(i,o,c,h,m,y){for(let b=h;b<m;b++){const A=c.get(b),E=this.getSymbolInstanceTextSize(i,y,o,b);this._addCollisionDebugVertices(A,E,this.textCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,y)}}_addIconDebugCollisionBoxes(i,o,c,h,m,y){for(let b=h;b<m;b++){const A=c.get(b),E=this.getSymbolInstanceIconSize(i,o,b);this._addCollisionDebugVertices(A,E,this.iconCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,y)}}generateCollisionDebugBuffers(i,o){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new hf($o,Wp.members,mr),this.iconCollisionBox=new hf($o,Wp.members,mr);const c=hd(this.iconSizeData,i),h=hd(this.textSizeData,i);for(let m=0;m<this.symbolInstances.length;m++){const y=this.symbolInstances.get(m);this._addTextDebugCollisionBoxes(h,i,o,y.textBoxStartIndex,y.textBoxEndIndex,y),this._addTextDebugCollisionBoxes(h,i,o,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._addIconDebugCollisionBoxes(c,i,o,y.iconBoxStartIndex,y.iconBoxEndIndex,y),this._addIconDebugCollisionBoxes(c,i,o,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y)}}getSymbolInstanceTextSize(i,o,c,h){const m=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:h),y=fh(this.textSizeData,i,m)/24;return this.tilePixelRatio*y}getSymbolInstanceIconSize(i,o,c){const h=this.icon.placedSymbolArray.get(c),m=fh(this.iconSizeData,i,h);return this.tilePixelRatio*m}_commitDebugCollisionVertexUpdate(i,o,c){i.emplaceBack(o,-c,-c),i.emplaceBack(o,c,-c),i.emplaceBack(o,c,c),i.emplaceBack(o,-c,c)}_updateTextDebugCollisionBoxes(i,o,c,h,m,y){for(let b=h;b<m;b++){const A=c.get(b),E=this.getSymbolInstanceTextSize(i,y,o,b);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,E,A.padding)}}_updateIconDebugCollisionBoxes(i,o,c,h,m){for(let y=h;y<m;y++){const b=c.get(y),A=this.getSymbolInstanceIconSize(i,o,y);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,A,b.padding)}}updateCollisionDebugBuffers(i,o){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const c=hd(this.iconSizeData,i),h=hd(this.textSizeData,i);for(let m=0;m<this.symbolInstances.length;m++){const y=this.symbolInstances.get(m);this._updateTextDebugCollisionBoxes(h,i,o,y.textBoxStartIndex,y.textBoxEndIndex,y),this._updateTextDebugCollisionBoxes(h,i,o,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._updateIconDebugCollisionBoxes(c,i,o,y.iconBoxStartIndex,y.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(c,i,o,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(i,o,c,h,m,y,b,A,E){const P={};for(let k=o;k<c;k++){const R=i.get(k);P.textBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,padding:R.padding,projectedAnchorX:R.projectedAnchorX,projectedAnchorY:R.projectedAnchorY,projectedAnchorZ:R.projectedAnchorZ,tileAnchorX:R.tileAnchorX,tileAnchorY:R.tileAnchorY},P.textFeatureIndex=R.featureIndex;break}for(let k=h;k<m;k++){const R=i.get(k);P.verticalTextBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,padding:R.padding,projectedAnchorX:R.projectedAnchorX,projectedAnchorY:R.projectedAnchorY,projectedAnchorZ:R.projectedAnchorZ,tileAnchorX:R.tileAnchorX,tileAnchorY:R.tileAnchorY},P.verticalTextFeatureIndex=R.featureIndex;break}for(let k=y;k<b;k++){const R=i.get(k);P.iconBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,padding:R.padding,projectedAnchorX:R.projectedAnchorX,projectedAnchorY:R.projectedAnchorY,projectedAnchorZ:R.projectedAnchorZ,tileAnchorX:R.tileAnchorX,tileAnchorY:R.tileAnchorY},P.iconFeatureIndex=R.featureIndex;break}for(let k=A;k<E;k++){const R=i.get(k);P.verticalIconBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,padding:R.padding,projectedAnchorX:R.projectedAnchorX,projectedAnchorY:R.projectedAnchorY,projectedAnchorZ:R.projectedAnchorZ,tileAnchorX:R.tileAnchorX,tileAnchorY:R.tileAnchorY},P.verticalIconFeatureIndex=R.featureIndex;break}return P}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const c=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,o){const c=i.placedSymbolArray.get(o),h=c.vertexStartIndex+4*c.numGlyphs;for(let m=c.vertexStartIndex;m<h;m+=4)i.indexArray.emplaceBack(m,m+1,m+2),i.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const o=Math.sin(i),c=Math.cos(i),h=[],m=[],y=[];for(let b=0;b<this.symbolInstances.length;++b){y.push(b);const A=this.symbolInstances.get(b);h.push(0|Math.round(o*A.tileAnchorX+c*A.tileAnchorY)),m.push(A.featureIndex)}return y.sort((b,A)=>h[b]-h[A]||m[A]-m[b]),y}addToSortKeyRanges(i,o){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===o?c.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const c=this.symbolInstances.get(o);this.featureSortOrder.push(c.featureIndex),[c.rightJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.leftJustifiedTextSymbolIndex].forEach((h,m,y)=>{h>=0&&y.indexOf(h)===m&&this.addIndicesForPlacedSymbol(this.text,h)}),c.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,c.verticalPlacedTextSymbolIndex),c.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.placedIconSymbolIndex),c.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}vt(Ja,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Ja.MAX_GLYPHS=65535,Ja.addDynamicAttributes=Xm;const gy=new je({"symbol-placement":new _e(Re.layout_symbol["symbol-placement"]),"symbol-spacing":new _e(Re.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new _e(Re.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ce(Re.layout_symbol["symbol-sort-key"]),"symbol-z-order":new _e(Re.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new _e(Re.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new _e(Re.layout_symbol["icon-ignore-placement"]),"icon-optional":new _e(Re.layout_symbol["icon-optional"]),"icon-rotation-alignment":new _e(Re.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ce(Re.layout_symbol["icon-size"]),"icon-text-fit":new _e(Re.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new _e(Re.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ce(Re.layout_symbol["icon-image"]),"icon-rotate":new Ce(Re.layout_symbol["icon-rotate"]),"icon-padding":new _e(Re.layout_symbol["icon-padding"]),"icon-keep-upright":new _e(Re.layout_symbol["icon-keep-upright"]),"icon-offset":new Ce(Re.layout_symbol["icon-offset"]),"icon-anchor":new Ce(Re.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new _e(Re.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new _e(Re.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new _e(Re.layout_symbol["text-rotation-alignment"]),"text-field":new Ce(Re.layout_symbol["text-field"]),"text-font":new Ce(Re.layout_symbol["text-font"]),"text-size":new Ce(Re.layout_symbol["text-size"]),"text-max-width":new Ce(Re.layout_symbol["text-max-width"]),"text-line-height":new Ce(Re.layout_symbol["text-line-height"]),"text-letter-spacing":new Ce(Re.layout_symbol["text-letter-spacing"]),"text-justify":new Ce(Re.layout_symbol["text-justify"]),"text-radial-offset":new Ce(Re.layout_symbol["text-radial-offset"]),"text-variable-anchor":new _e(Re.layout_symbol["text-variable-anchor"]),"text-anchor":new Ce(Re.layout_symbol["text-anchor"]),"text-max-angle":new _e(Re.layout_symbol["text-max-angle"]),"text-writing-mode":new _e(Re.layout_symbol["text-writing-mode"]),"text-rotate":new Ce(Re.layout_symbol["text-rotate"]),"text-padding":new _e(Re.layout_symbol["text-padding"]),"text-keep-upright":new _e(Re.layout_symbol["text-keep-upright"]),"text-transform":new Ce(Re.layout_symbol["text-transform"]),"text-offset":new Ce(Re.layout_symbol["text-offset"]),"text-allow-overlap":new _e(Re.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new _e(Re.layout_symbol["text-ignore-placement"]),"text-optional":new _e(Re.layout_symbol["text-optional"])});var pf={paint:new je({"icon-opacity":new Ce(Re.paint_symbol["icon-opacity"]),"icon-color":new Ce(Re.paint_symbol["icon-color"]),"icon-halo-color":new Ce(Re.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ce(Re.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ce(Re.paint_symbol["icon-halo-blur"]),"icon-translate":new _e(Re.paint_symbol["icon-translate"]),"icon-translate-anchor":new _e(Re.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ce(Re.paint_symbol["text-opacity"]),"text-color":new Ce(Re.paint_symbol["text-color"],{runtimeType:wn,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new Ce(Re.paint_symbol["text-halo-color"]),"text-halo-width":new Ce(Re.paint_symbol["text-halo-width"]),"text-halo-blur":new Ce(Re.paint_symbol["text-halo-blur"]),"text-translate":new _e(Re.paint_symbol["text-translate"]),"text-translate-anchor":new _e(Re.paint_symbol["text-translate-anchor"])}),layout:gy};class _a{constructor(i){this.type=i.property.overrides?i.property.overrides.runtimeType:Si,this.defaultValue=i}evaluate(i){if(i.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(i.formattedSection))return o.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}vt(_a,"FormatSectionOverride",{omit:["defaultValue"]});class Jc extends fs{constructor(i){super(i,pf)}recalculate(i,o){super.recalculate(i,o),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const h=[];for(const m of c)h.indexOf(m)<0&&h.push(m);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(i,o,c,h){const m=this.layout.get(i).evaluate(o,{},c,h),y=this._unevaluatedLayout._values[i];return y.isDataDriven()||Yd(y.value)||!m?m:(b=o.properties,m.replace(/{([^{}]+)}/g,(E,P)=>P in b?String(b[P]):""));var b}createBucket(i){return new Ja(i)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const i of pf.paint.overridableProperties){if(!Jc.hasPaintOverride(this.layout,i))continue;const o=this.paint.get(i),c=new _a(o),h=new tp(c,o.property.specification);let m=null;m="constant"===o.value.kind||"source"===o.value.kind?new Fu("source",h):new Fa("composite",h,o.value.zoomStops,o.value._interpolationType),this.paint._values[i]=new pe(o.property,m,o.parameters)}}_handleOverridablePaintPropertyUpdate(i,o,c){return!(!this.layout||o.isDataDriven()||c.isDataDriven())&&Jc.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,o){const c=i.get("text-field"),h=pf.paint.properties[o];let m=!1;const y=b=>{for(const A of b)if(h.overrides&&h.overrides.hasOverride(A))return void(m=!0)};if("constant"===c.value.kind&&c.value.value instanceof Kr)y(c.value.value.sections);else if("source"===c.value.kind){const b=E=>{m||(E instanceof Su&&Di(E.value)===Ql?y(E.value.sections):E instanceof tr?y(E.sections):E.eachChild(b))},A=c.value;A._styleExpression&&b(A._styleExpression.expression)}return m}getProgramConfiguration(i){return new qo(this,i)}}var ix={paint:new je({"background-color":new _e(Re.paint_background["background-color"]),"background-pattern":new Je(Re.paint_background["background-pattern"]),"background-opacity":new _e(Re.paint_background["background-opacity"])})},rx={paint:new je({"raster-opacity":new _e(Re.paint_raster["raster-opacity"]),"raster-hue-rotate":new _e(Re.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new _e(Re.paint_raster["raster-brightness-min"]),"raster-brightness-max":new _e(Re.paint_raster["raster-brightness-max"]),"raster-saturation":new _e(Re.paint_raster["raster-saturation"]),"raster-contrast":new _e(Re.paint_raster["raster-contrast"]),"raster-resampling":new _e(Re.paint_raster["raster-resampling"]),"raster-fade-duration":new _e(Re.paint_raster["raster-fade-duration"])})};class dw extends fs{constructor(i){super(i,{}),this.implementation=i}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)}onRemove(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)}}var Qm={paint:new je({"sky-type":new _e(Re.paint_sky["sky-type"]),"sky-atmosphere-sun":new _e(Re.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new _e(Re.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new _e(Re.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new _e(Re.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ee(Re.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new _e(Re.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new _e(Re.paint_sky["sky-atmosphere-color"]),"sky-opacity":new _e(Re.paint_sky["sky-opacity"])})};function ff(s,i,o){const c=[0,0,1],h=a0([]);return Ip(h,h,o?-ln(s)+Math.PI:ln(s)),Dp(h,h,-ln(i)),lm(c,c,h),Vr(c,c)}const Km={circle:class extends fs{constructor(s){super(s,r0)}createBucket(s){return new td(s)}queryRadius(s){const i=s;return rd("circle-radius",this,i)+rd("circle-stroke-width",this,i)+Pc(this.paint.get("circle-translate"))}queryIntersectsFeature(s,i,o,c,h,m,y,b){const A=Oc(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,s.pixelToTileUnitsFactor),E=this.paint.get("circle-radius").evaluate(i,o)+this.paint.get("circle-stroke-width").evaluate(i,o);return v_(s,c,m,y,b,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),A,E)}getProgramIds(){return["circle"]}getProgramConfiguration(s){return new qo(this,s)}},heatmap:class extends fs{createBucket(s){return new ch(s)}constructor(s){super(s,u0),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){"heatmap-color"===s&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=ad({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(s){return rd("heatmap-radius",this,s)}queryIntersectsFeature(s,i,o,c,h,m,y,b){const A=this.paint.get("heatmap-radius").evaluate(i,o);return v_(s,c,m,y,b,!0,!0,new dt(0,0),A)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(s){return new qo(this,s)}},hillshade:class extends fs{constructor(s){super(s,C_)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends fs{constructor(s){super(s,x0)}getProgramIds(){const s=this.paint.get("fill-pattern"),i=s&&s.constantOr(1),o=[i?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(i&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getProgramConfiguration(s){return new qo(this,s)}recalculate(s,i){super.recalculate(s,i);const o=this.paint._values["fill-outline-color"];"constant"===o.value.kind&&void 0===o.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new Bp(s)}queryRadius(){return Pc(this.paint.get("fill-translate"))}queryIntersectsFeature(s,i,o,c,h,m){return!s.queryGeometry.isAboveHorizon&&a_(wp(s.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,s.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}},"fill-extrusion":class extends fs{constructor(s){super(s,M0)}createBucket(s){return new Vc(s)}queryRadius(){return Pc(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(s){return new qo(this,s)}queryIntersectsFeature(s,i,o,c,h,m,y,b,A){const E=Oc(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,s.pixelToTileUnitsFactor),P=this.paint.get("fill-extrusion-height").evaluate(i,o),k=this.paint.get("fill-extrusion-base").evaluate(i,o),R=[0,0],B=b&&m.elevation,N=m.elevation?m.elevation.exaggeration():1,q=s.tile.getBucket(this);if(B&&q instanceof Vc){const he=q.centroidVertexArray,ae=A+1;if(ae<he.length){const de=he.get(ae);R[0]=de.a_centroid_pos0,R[1]=de.a_centroid_pos1}}if(0===R[0]&&1===R[1])return!1;"globe"===m.projection.name&&(c=P_([c],[new dt(0,0),new dt(zt,zt)],s.tileID.canonical).map(he=>he.polygon).flat());const Q=(ae=c,de=k,ye=P,me=E,De=y,Pe=B?b:null,Fe=R,tt=N,Oe=m.center.lat,"globe"===(he=m).projection.name?function(qe,Ue,Qe,Ze,pt,Xt,Kt,Ot,ct,dn,$t){const _t=[],Yn=[],Un=qe.projection.upVectorScale($t,qe.center.lat,qe.worldSize).metersToTile,pi=[0,0,0,1],Tt=[0,0,0,1],Cn=($n,Gn,ai,fi)=>{$n[0]=Gn,$n[1]=ai,$n[2]=fi,$n[3]=1},Xn=Up();Qe>0&&(Qe+=Xn),Ze+=Xn;for(const $n of Ue){const Gn=[],ai=[];for(const fi of $n){const sr=fi.x+pt.x,Hr=fi.y+pt.y,vn=qe.projection.projectTilePoint(sr,Hr,$t),xi=qe.projection.upVector($t,fi.x,fi.y);let qr=Qe,In=Ze;if(Kt){const li=R_(sr,Hr,Qe,Ze,Kt,Ot,ct,dn);qr+=li.base,In+=li.top}0!==Qe?Cn(pi,vn.x+xi[0]*Un*qr,vn.y+xi[1]*Un*qr,vn.z+xi[2]*Un*qr):Cn(pi,vn.x,vn.y,vn.z),Cn(Tt,vn.x+xi[0]*Un*In,vn.y+xi[1]*Un*In,vn.z+xi[2]*Un*In),Ai(pi,pi,Xt),Ai(Tt,Tt,Xt),Gn.push(Hp(pi)),ai.push(Hp(Tt))}_t.push(Gn),Yn.push(ai)}return[_t,Yn]}(he,ae,de,ye,me,De,Pe,Fe,tt,Oe,s.tileID.canonical):Pe?function(qe,Ue,Qe,Ze,pt,Xt,Kt,Ot,ct){const dn=[],$t=[],_t=[0,0,0,1];for(const Yn of qe){const Un=[],pi=[];for(const Tt of Yn){const Cn=Tt.x+Ze.x,Xn=Tt.y+Ze.y,$n=R_(Cn,Xn,Ue,Qe,Xt,Kt,Ot,ct);_t[0]=Cn,_t[1]=Xn,_t[2]=$n.base,_t[3]=1,sd(_t,_t,pt),_t[3]=Math.max(_t[3],1e-5);const Gn=Hp([_t[0]/_t[3],_t[1]/_t[3],_t[2]/_t[3]]);_t[0]=Cn,_t[1]=Xn,_t[2]=$n.top,_t[3]=1,sd(_t,_t,pt),_t[3]=Math.max(_t[3],1e-5);const ai=Hp([_t[0]/_t[3],_t[1]/_t[3],_t[2]/_t[3]]);Un.push(Gn),pi.push(ai)}dn.push(Un),$t.push(pi)}return[dn,$t]}(ae,de,ye,me,De,Pe,Fe,tt,Oe):function(qe,Ue,Qe,Ze,pt){const Xt=[],Kt=[],Ot=pt[8]*Ue,ct=pt[9]*Ue,dn=pt[10]*Ue,$t=pt[11]*Ue,_t=pt[8]*Qe,Yn=pt[9]*Qe,Un=pt[10]*Qe,pi=pt[11]*Qe;for(const Tt of qe){const Cn=[],Xn=[];for(const $n of Tt){const Gn=$n.x+Ze.x,ai=$n.y+Ze.y,fi=pt[0]*Gn+pt[4]*ai+pt[12],sr=pt[1]*Gn+pt[5]*ai+pt[13],Hr=pt[2]*Gn+pt[6]*ai+pt[14],vn=pt[3]*Gn+pt[7]*ai+pt[15],xi=fi+Ot,qr=sr+ct,In=Hr+dn,li=Math.max(vn+$t,1e-5),_r=fi+_t,mi=sr+Yn,ki=Hr+Un,yr=Math.max(vn+pi,1e-5),ar=new dt(xi/li,qr/li);ar.z=In/li,Cn.push(ar);const vr=new dt(_r/yr,mi/yr);vr.z=ki/yr,Xn.push(vr)}Xt.push(Cn),Kt.push(Xn)}return[Xt,Kt]}(ae,de,ye,me,De)),se=s.queryGeometry;var he,ae,de,ye,me,De,Pe,Fe,tt,Oe;return function(he,ae,de){let ye=1/0;a_(de,ae)&&(ye=Gp(de,ae[0]));for(let me=0;me<ae.length;me++){const De=ae[me],Pe=he[me];for(let Fe=0;Fe<De.length-1;Fe++){const tt=De[Fe],Oe=[tt,De[Fe+1],Pe[Fe+1],Pe[Fe],tt];nm(de,Oe)&&(ye=Math.min(ye,Gp(de,Oe)))}}return ye!==1/0&&ye}(Q[0],Q[1],se.isPointQuery()?se.screenBounds:se.screenGeometry)}},line:class extends fs{constructor(s){super(s,Cm),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(s){if("line-gradient"===s){const i=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=i._styleExpression&&i._styleExpression.expression instanceof rc,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(s,i){super.recalculate(s,i),this.paint._values["line-floorwidth"]=Am.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new Hc(s)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(s){return new qo(this,s)}queryRadius(s){const i=s,o=Em(rd("line-width",this,i),rd("line-gap-width",this,i)),c=rd("line-offset",this,i);return o/2+Math.abs(c)+Pc(this.paint.get("line-translate"))}queryIntersectsFeature(s,i,o,c,h,m){if(s.queryGeometry.isAboveHorizon)return!1;const y=wp(s.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,s.pixelToTileUnitsFactor),b=s.pixelToTileUnitsFactor/2*Em(this.paint.get("line-width").evaluate(i,o),this.paint.get("line-gap-width").evaluate(i,o)),A=this.paint.get("line-offset").evaluate(i,o);return A&&(c=function(E,P){const k=[],R=new dt(0,0);for(let B=0;B<E.length;B++){const N=E[B],q=[];for(let Q=0;Q<N.length;Q++){const se=N[Q-1],he=N[Q],ae=N[Q+1],de=0===Q?R:he.sub(se)._unit()._perp(),ye=Q===N.length-1?R:ae.sub(he)._unit()._perp(),me=de._add(ye)._unit();me._mult(1/(me.x*ye.x+me.y*ye.y)),q.push(me._mult(P)._add(he))}k.push(q)}return k}(c,A*s.pixelToTileUnitsFactor)),function(E,P,k){for(let R=0;R<P.length;R++){const B=P[R];if(E.length>=3)for(let N=0;N<B.length;N++)if(id(E,B[N]))return!0;if(nd(E,B,k))return!0}return!1}(y,c,b)}isTileClipped(){return!0}},symbol:Jc,background:class extends fs{constructor(s){super(s,ix)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends fs{constructor(s){super(s,rx)}getProgramIds(){return["raster"]}},sky:class extends fs{constructor(s){super(s,Qm),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){"sky-gradient"===s?this._updateColorRamp():"sky-atmosphere-sun"!==s&&"sky-atmosphere-halo-color"!==s&&"sky-atmosphere-color"!==s&&"sky-atmosphere-sun-intensity"!==s||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=ad({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(s){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const i=s.style.light.properties.get("position");return this._lightPosition.azimuthal!==i.azimuthal||this._lightPosition.polar!==i.polar}return!1}getCenter(s,i){if("atmosphere"===this.paint.get("sky-type")){const c=this.paint.get("sky-atmosphere-sun"),h=!c,m=s.style.light,y=m.properties.get("position");return h&&"viewport"===m.properties.get("anchor")&&vi("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),h?ff(y.azimuthal,90-y.polar,i):ff(c[0],90-c[1],i)}const o=this.paint.get("sky-gradient-center");return ff(o[0],90-o[1],i)}is3D(){return!1}isSky(){return!0}markSkyboxValid(s){this._skyboxInvalidated=!1,this._lightPosition=s.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const s=this.paint.get("sky-type");return"atmosphere"===s?["skyboxCapture","skybox"]:"gradient"===s?["skyboxGradient"]:null}}};class el{constructor(i,o,c,h){this.context=i,this.format=c,this.texture=i.gl.createTexture(),this.update(o,h)}update(i,o,c){const{width:h,height:m}=i,{context:y}=this,{gl:b}=y,{HTMLImageElement:A,HTMLCanvasElement:E,HTMLVideoElement:P,ImageData:k,ImageBitmap:R}=ot;if(b.bindTexture(b.TEXTURE_2D,this.texture),y.pixelStoreUnpackFlipY.set(!1),y.pixelStoreUnpack.set(1),y.pixelStoreUnpackPremultiplyAlpha.set(this.format===b.RGBA&&(!o||!1!==o.premultiply)),c||this.size&&this.size[0]===h&&this.size[1]===m){const{x:B,y:N}=c||{x:0,y:0};i instanceof A||i instanceof E||i instanceof P||i instanceof k||R&&i instanceof R?b.texSubImage2D(b.TEXTURE_2D,0,B,N,b.RGBA,b.UNSIGNED_BYTE,i):b.texSubImage2D(b.TEXTURE_2D,0,B,N,h,m,b.RGBA,b.UNSIGNED_BYTE,i.data)}else this.size=[h,m],i instanceof A||i instanceof E||i instanceof P||i instanceof k||R&&i instanceof R?b.texImage2D(b.TEXTURE_2D,0,this.format,this.format,b.UNSIGNED_BYTE,i):b.texImage2D(b.TEXTURE_2D,0,this.format,h,m,0,this.format,b.UNSIGNED_BYTE,i.data);this.useMipmap=Boolean(o&&o.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&b.generateMipmap(b.TEXTURE_2D)}bind(i,o){const{context:c}=this,{gl:h}=c;h.bindTexture(h.TEXTURE_2D,this.texture),i!==this.filter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,i),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap?i===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_NEAREST:i),this.filter=i),o!==this.wrap&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,o),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class Jm{constructor(i,o){this.width=i,this.height=o,this.nextRow=0,this.image=new hi({width:i,height:o}),this.positions={},this.uploaded=!1}getDash(i,o){const c=this.getKey(i,o);return this.positions[c]}trim(){const i=this.width,o=this.height=hl(this.nextRow);this.image.resize({width:i,height:o})}getKey(i,o){return i.join(",")+o}getDashRanges(i,o,c){const h=[];let m=i.length%2==1?-i[i.length-1]*c:0,y=i[0]*c,b=!0;h.push({left:m,right:y,isDash:b,zeroLength:0===i[0]});let A=i[0];for(let E=1;E<i.length;E++){b=!b;const P=i[E];m=A*c,A+=P,y=A*c,h.push({left:m,right:y,isDash:b,zeroLength:0===P})}return h}addRoundDash(i,o,c){const h=o/2;for(let m=-c;m<=c;m++){const y=this.width*(this.nextRow+c+m);let b=0,A=i[b];for(let E=0;E<this.width;E++){E/A.right>1&&(A=i[++b]);const P=Math.abs(E-A.left),k=Math.abs(E-A.right),R=Math.min(P,k);let B;const N=m/c*(h+1);if(A.isDash){const q=h-Math.abs(N);B=Math.sqrt(R*R+q*q)}else B=h-Math.sqrt(R*R+N*N);this.image.data[y+E]=Math.max(0,Math.min(255,B+128))}}}addRegularDash(i,o){for(let A=i.length-1;A>=0;--A){const E=i[A],P=i[A+1];E.zeroLength?i.splice(A,1):P&&P.isDash===E.isDash&&(P.left=E.left,i.splice(A,1))}const c=i[0],h=i[i.length-1];c.isDash===h.isDash&&(c.left=h.left-this.width,h.right=c.right+this.width);const m=this.width*this.nextRow;let y=0,b=i[y];for(let A=0;A<this.width;A++){A/b.right>1&&(b=i[++y]);const E=Math.abs(A-b.left),P=Math.abs(A-b.right),k=Math.min(E,P);this.image.data[m+A]=Math.max(0,Math.min(255,(b.isDash?k:-k)+o+128))}}addDash(i,o){const c=this.getKey(i,o);if(this.positions[c])return this.positions[c];const h="round"===o,m=h?7:0,y=2*m+1;if(this.nextRow+y>this.height)return vi("LineAtlas out of space"),null;0===i.length&&i.push(1);let b=0;for(let P=0;P<i.length;P++)i[P]<0&&(vi("Negative value is found in line dasharray, replacing values with 0"),i[P]=0),b+=i[P];if(0!==b){const P=this.width/b,k=this.getDashRanges(i,this.width,P);h?this.addRoundDash(k,P,m):this.addRegularDash(k,"square"===o?.5*P:0)}const A=this.nextRow+m;this.nextRow+=y;const E={tl:[A,m],br:[b,0]};return this.positions[c]=E,E}}vt(Jm,"LineAtlas");class eg{constructor(i){this._callback=i,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class _y{constructor(){this.tasks={},this.taskQueue=[],ns(["process"],this),this.invoker=new eg(this.process),this.nextId=0}add(i,o){const c=this.nextId++,h=function({type:m,isSymbolTile:y,zoom:b}){return b=b||0,"message"===m?0:"maybePrepare"!==m||y?"parseTile"!==m||y?"parseTile"===m&&y?300-b:"maybePrepare"===m&&y?400-b:500:200-b:100-b}(o);if(0===h){bi();try{i()}finally{}return{cancel:()=>{}}}return this.tasks[c]={fn:i,metadata:o,priority:h,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){bi();try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const i=this.pick();if(null===i)return;const o=this.tasks[i];if(delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let i=null,o=1/0;for(let h=0;h<this.taskQueue.length;h++){const m=this.tasks[this.taskQueue[h]];m.priority<o&&(o=m.priority,i=h)}if(null===i)return null;const c=this.taskQueue[i];return this.taskQueue.splice(i,1),c}remove(){this.invoker.remove()}}class tg{constructor(i){this._stringToNumber={},this._numberToString=[];for(let o=0;o<i.length;o++){const c=i[o];this._stringToNumber[c]=o,this._numberToString[o]=c}}encode(i){return this._stringToNumber[i]}decode(i){return this._numberToString[i]}}const yy=["tile","layer","source","sourceLayer","state"];class vy{constructor(i,o,c,h,m){this.type="Feature",this._vectorTileFeature=i,this._z=o,this._x=c,this._y=h,this.properties=i.properties,this.id=m}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={type:"Feature",geometry:this.geometry,properties:this.properties};void 0!==this.id&&(i.id=this.id);for(const o of yy)void 0!==this[o]&&(i[o]=this[o]);return i}}const jl=new Uint16Array(8184);for(let s=0;s<2046;s++){let i=s+2,o=0,c=0,h=0,m=0,y=0,b=0;for(1&i?h=m=y=32:o=c=b=32;(i>>=1)>1;){const E=o+h>>1,P=c+m>>1;1&i?(h=o,m=c,o=y,c=b):(o=h,c=m,h=y,m=b),y=E,b=P}const A=4*s;jl[A+0]=o,jl[A+1]=c,jl[A+2]=h,jl[A+3]=m}const $s=new Uint16Array(2178),Qo=new Uint8Array(1089),Mh=new Uint16Array(1089);function xy(s){return 0===s?-.03125:32===s?.03125:0}var by=He([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const eu={type:2,extent:zt,loadGeometry:()=>[[new dt(0,0),new dt(8193,0),new dt(8193,8193),new dt(0,8193),new dt(0,0)]]};class ng{constructor(i,o,c,h,m){this.tileID=i,this.uid=ws(),this.uses=0,this.tileSize=o,this.tileZoom=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=m,this.expiredRequestCount=0,this.state="loading",h&&h.transform&&(this.projection=h.transform.projection)}registerFadeDuration(i){const o=i+this.timeAdded;o<ko.now()||this.fadeEndTime&&o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=Qc(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(i,o,c){if(this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(h,m){const y={};if(!m)return y;for(const b of h){const A=b.layerIds.map(E=>m.getLayer(E)).filter(Boolean);if(0!==A.length){b.layers=A,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(E=>A.filter(P=>P.id===E)[0]));for(const E of A)y[E.id]=b}}return y}(i.buckets,o.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const m=this.buckets[h];if(m instanceof Ja){if(this.hasSymbolBuckets=!0,!c)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const m=this.buckets[h];if(m instanceof Ja&&m.hasRTLText){this.hasRTLText=!0,K.isLoading()||K.isLoaded()||"deferred"!==W()||ne();break}}this.queryPadding=0;for(const h in this.buckets){const m=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(h).queryRadius(m))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage),i.lineAtlas&&(this.lineAtlas=i.lineAtlas)}else this.collisionBoxArray=new lo}unloadVectorData(){if(this.hasData()){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(i){return this.buckets[i.id]}upload(i){for(const c in this.buckets){const h=this.buckets[c];h.uploadPending()&&h.upload(i)}const o=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new el(i,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new el(i,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new el(i,this.lineAtlas.image,o.ALPHA),this.lineAtlas.uploaded=!0)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,o,c,h,m,y,b,A){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:h,pixelPosMatrix:b,transform:y,params:m,tileTransform:this.tileTransform},i,o,c):{}}querySourceFeatures(i,o){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const h=c.loadVTLayers(),m=o?o.sourceLayer:"",y=h._geojsonTileLayer||h[m];if(!y)return;const b=Ba(o&&o.filter),{z:A,x:E,y:P}=this.tileID.canonical,k={z:A,x:E,y:P};for(let R=0;R<y.length;R++){const B=y.feature(R);if(b.needGeometry){const Q=Dc(B,!0);if(!b.filter(new J(this.tileID.overscaledZ),Q,this.tileID.canonical))continue}else if(!b.filter(new J(this.tileID.overscaledZ),B))continue;const N=c.getId(B,m),q=new vy(B,A,E,P,N);q.tile=k,i.push(q)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const o=this.expirationTime;if(i.cacheControl){const c=is(i.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const c=Date.now();let h=!1;if(this.expirationTime>c)h=!1;else if(o)if(this.expirationTime<o)h=!0;else{const m=this.expirationTime-o;m?this.expirationTime=c+Math.max(m,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(i,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(i).length||!o)return;const c=this.latestFeatureIndex.loadVTLayers(),h=o.style.listImages();for(const m in this.buckets){if(!o.style.hasLayer(m))continue;const y=this.buckets[m],b=y.layers[0].sourceLayer||"_geojsonTileLayer",A=c[b],E=i[b];if(!A||!E||0===Object.keys(E).length)continue;if(y.update(E,A,h,this.imageAtlas&&this.imageAtlas.patternPositions||{}),y instanceof Hc||y instanceof Bp){const k=o.style._getSourceCache(y.layers[0].source);o._terrain&&o._terrain.enabled&&k&&y.programConfigurations.needsUpload&&o._terrain._clearRenderCacheForTile(k.id,this.tileID)}const P=o&&o.style&&o.style.getLayer(m);P&&(this.queryPadding=Math.max(this.queryPadding,P.queryRadius(y)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ko.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=ko.now()+i}setTexture(i,o){const c=o.context,h=c.gl;this.texture=o.getTileTexture(i.width),this.texture?this.texture.update(i,{useMipmap:!0}):(this.texture=new el(c,i,h.RGBA,{useMipmap:!0}),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),c.extTextureFilterAnisotropic&&h.texParameterf(h.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax))}setDependencies(i,o){const c={};for(const h of o)c[h]=!0;this.dependencies[i]=c}hasDependency(i,o){for(const c of i){const h=this.dependencies[c];if(h)for(const m of o)if(h[m])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(i,o){if(!o||"mercator"===o.name||this._tileDebugBuffer)return;const c=Wo(eu,this.tileID.canonical,this.tileTransform)[0],h=new lt,m=new da;for(let y=0;y<c.length;y++){const{x:b,y:A}=c[y];h.emplaceBack(b,A),m.emplaceBack(y)}m.emplaceBack(0),this._tileDebugIndexBuffer=i.createIndexBuffer(m),this._tileDebugBuffer=i.createVertexBuffer(h,vd.members),this._tileDebugSegments=Hi.simpleSegment(0,0,h.length,m.length)}_makeTileBoundsBuffers(i,o){if(this._tileBoundsBuffer||!o||"mercator"===o.name)return;const c=Wo(eu,this.tileID.canonical,this.tileTransform)[0];let h,m;if(this.isRaster){const y=function(b,A){const E=Qc(b,A),P=Math.pow(2,b.z);for(let Q=0;Q<33;Q++)for(let se=0;se<33;se++){const he=Zo((b.x+(se+xy(se))/32)/P),ae=gr((b.y+(Q+xy(Q))/32)/P),de=A.project(he,ae),ye=33*Q+se;$s[2*ye+0]=Math.round((de.x*E.scale-E.x)*zt),$s[2*ye+1]=Math.round((de.y*E.scale-E.y)*zt)}Qo.fill(0),Mh.fill(0);for(let Q=2045;Q>=0;Q--){const se=4*Q,he=jl[se+0],ae=jl[se+1],de=jl[se+2],ye=jl[se+3],me=he+de>>1,De=ae+ye>>1,Pe=me+De-ae,Fe=De+he-me,tt=33*ae+he,Oe=33*ye+de,Ve=33*De+me,qe=Math.hypot(($s[2*tt+0]+$s[2*Oe+0])/2-$s[2*Ve+0],($s[2*tt+1]+$s[2*Oe+1])/2-$s[2*Ve+1])>=16;if(Qo[Ve]=Qo[Ve]||(qe?1:0),Q<1022){const Ue=33*(ae+Fe>>1)+(he+Pe>>1),Qe=33*(ye+Fe>>1)+(de+Pe>>1);Qo[Ve]=Qo[Ve]||Qo[Ue]||Qo[Qe]}}const k=new Lt,R=new on;let B=0;function N(Q,se){const he=33*se+Q;return 0===Mh[he]&&(k.emplaceBack($s[2*he+0],$s[2*he+1],Q*zt/32,se*zt/32),Mh[he]=++B),Mh[he]-1}function q(Q,se,he,ae,de,ye){const me=Q+he>>1,De=se+ae>>1;if(Math.abs(Q-de)+Math.abs(se-ye)>1&&Qo[33*De+me])q(de,ye,Q,se,me,De),q(he,ae,de,ye,me,De);else{const Pe=N(Q,se),Fe=N(he,ae),tt=N(de,ye);R.emplaceBack(Pe,Fe,tt)}}return q(0,0,32,32,32,0),q(32,32,0,0,0,32),{vertices:k,indices:R}}(this.tileID.canonical,o);h=y.vertices,m=y.indices}else{h=new Lt,m=new on;for(const{x:b,y:A}of c)h.emplaceBack(b,A,0,0);const y=Op(h.int16,void 0,4);for(let b=0;b<y.length;b+=3)m.emplaceBack(y[b],y[b+1],y[b+2])}this._tileBoundsBuffer=i.createVertexBuffer(h,by.members),this._tileBoundsIndexBuffer=i.createIndexBuffer(m),this._tileBoundsSegments=Hi.simpleSegment(0,0,h.length,m.length)}_makeGlobeTileDebugBuffers(i,o){const c=o.projection;if(!c||"globe"!==c.name||o.freezeTileCoverage)return;const h=this.tileID.canonical,m=bh(Um(h,o)),y=Ch(o.zoom);let b;y>0&&(b=Ap(new Float64Array(16),o.globeMatrix));const A=(h.x+.5)/(1<<h.z)-Ls(o.center.lng);let E=0;A>.5?E=-1:A<-.5&&(E=1),this._makeGlobeTileDebugBorderBuffer(i,h,o,m,b,y,E),this._makeGlobeTileDebugTextBuffer(i,h,o,m,b,y,E)}_globePoint(i,o,c,h,m,y,b,A){let E=sf(i,o,c);if(y){const P=1<<c.z,k=[((i/zt+c.x)/P+A)*h,(o/zt+c.y)/P*h,0];Ai(k,k,y),E=Oa(E,k,b)}return Ai(E,E,m)}_makeGlobeTileDebugBorderBuffer(i,o,c,h,m,y,b){const A=new lt,E=new da,P=new wt,k=(B,N,q,Q,se)=>{const he=(q-B)/(se-1),ae=(Q-N)/(se-1),de=A.length;for(let ye=0;ye<se;ye++){const me=B+ye*he,De=N+ye*ae;A.emplaceBack(me,De);const Pe=this._globePoint(me,De,o,c.worldSize,h,m,y,b);P.emplaceBack(Pe[0],Pe[1],Pe[2]),E.emplaceBack(de+ye)}},R=zt;k(0,0,R,0,16),k(R,0,R,R,16),k(R,R,0,R,16),k(0,R,0,0,16),this._tileDebugIndexBuffer=i.createIndexBuffer(E),this._tileDebugBuffer=i.createVertexBuffer(A,vd.members),this._globeTileDebugBorderBuffer=i.createVertexBuffer(P,Vm.members),this._tileDebugSegments=Hi.simpleSegment(0,0,A.length,E.length)}_makeGlobeTileDebugTextBuffer(i,o,c,h,m,y,b){const A=new lt,E=new on,P=new wt,k=25;E.reserve(32),A.reserve(k),P.reserve(k);const R=(B,N)=>k*B+N;for(let B=0;B<k;B++){const N=2048*B;for(let q=0;q<k;q++){const Q=2048*q;A.emplaceBack(Q,N);const se=this._globePoint(Q,N,o,c.worldSize,h,m,y,b);P.emplaceBack(se[0],se[1],se[2])}}for(let B=0;B<4;B++)for(let N=0;N<4;N++){const q=R(B,N),Q=R(B,N+1),se=R(B+1,N),he=R(B+1,N+1);E.emplaceBack(q,Q,se),E.emplaceBack(se,Q,he)}this._tileDebugTextIndexBuffer=i.createIndexBuffer(E),this._tileDebugTextBuffer=i.createVertexBuffer(A,vd.members),this._globeTileDebugTextBuffer=i.createVertexBuffer(P,Vm.members),this._tileDebugTextSegments=Hi.simpleSegment(0,0,k,32)}}class ox{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,o,c){const h=String(o);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][h]=this.stateChanges[i][h]||{},ji(this.stateChanges[i][h],c),null===this.deletedStates[i]){this.deletedStates[i]={};for(const m in this.state[i])m!==h&&(this.deletedStates[i][m]=null)}else if(this.deletedStates[i]&&null===this.deletedStates[i][h]){this.deletedStates[i][h]={};for(const m in this.state[i][h])c[m]||(this.deletedStates[i][h][m]=null)}else for(const m in c)this.deletedStates[i]&&this.deletedStates[i][h]&&null===this.deletedStates[i][h][m]&&delete this.deletedStates[i][h][m]}removeFeatureState(i,o,c){if(null===this.deletedStates[i])return;const h=String(o);if(this.deletedStates[i]=this.deletedStates[i]||{},c&&void 0!==o)null!==this.deletedStates[i][h]&&(this.deletedStates[i][h]=this.deletedStates[i][h]||{},this.deletedStates[i][h][c]=null);else if(void 0!==o)if(this.stateChanges[i]&&this.stateChanges[i][h])for(c in this.deletedStates[i][h]={},this.stateChanges[i][h])this.deletedStates[i][h][c]=null;else this.deletedStates[i][h]=null;else this.deletedStates[i]=null}getState(i,o){const c=String(o),h=ji({},(this.state[i]||{})[c],(this.stateChanges[i]||{})[c]);if(null===this.deletedStates[i])return{};if(this.deletedStates[i]){const m=this.deletedStates[i][o];if(null===m)return{};for(const y in m)delete h[y]}return h}initializeTileState(i,o){i.setFeatureState(this.state,o)}coalesceChanges(i,o){const c={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const m={};for(const y in this.stateChanges[h])this.state[h][y]||(this.state[h][y]={}),ji(this.state[h][y],this.stateChanges[h][y]),m[y]=this.state[h][y];c[h]=m}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const m={};if(null===this.deletedStates[h])for(const y in this.state[h])m[y]={},this.state[h][y]={};else for(const y in this.deletedStates[h]){if(null===this.deletedStates[h][y])this.state[h][y]={};else for(const b of Object.keys(this.deletedStates[h][y]))delete this.state[h][y][b];m[y]=this.state[h][y]}c[h]=c[h]||{},ji(c[h],m)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(c).length)for(const h in i)i[h].setFeatureState(c,o)}}class wy{constructor(i){this.size=i,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(i,o){const c=this.toIdx(i,o);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(i,o){return this.leaves[this.toIdx(i,o)]}toIdx(i,o){return o*this.size+i}}function Cy(s,i,o,c){let h=0,m=Number.MAX_VALUE;for(let y=0;y<3;y++)if(Math.abs(c[y])<1e-15){if(o[y]<s[y]||o[y]>i[y])return null}else{const b=1/c[y];let A=(s[y]-o[y])*b,E=(i[y]-o[y])*b;if(A>E){const P=A;A=E,E=P}if(A>h&&(h=A),E<m&&(m=E),h>m)return null}return h}function Po(s,i,o,c,h,m,y,b,A,E,P){const k=c-s,R=h-i,B=m-o,N=y-s,q=b-i,Q=A-o,se=P[1]*Q-P[2]*q,he=P[2]*N-P[0]*Q,ae=P[0]*q-P[1]*N,de=k*se+R*he+B*ae;if(Math.abs(de)<1e-15)return null;const ye=1/de,me=E[0]-s,De=E[1]-i,Pe=E[2]-o,Fe=(me*se+De*he+Pe*ae)*ye;if(Fe<0||Fe>1)return null;const tt=De*B-Pe*R,Oe=Pe*k-me*B,Ve=me*R-De*k,qe=(P[0]*tt+P[1]*Oe+P[2]*Ve)*ye;return qe<0||Fe+qe>1?null:(N*tt+q*Oe+Q*Ve)*ye}function mf(s,i,o){return(s-i)/(o-i)}function ig(s,i,o,c,h,m,y,b,A){const E=1<<o,P=m-c,k=y-h,R=(s+1)/E*P+c,B=(i+0)/E*k+h,N=(i+1)/E*k+h;b[0]=(s+0)/E*P+c,b[1]=B,A[0]=R,A[1]=N}class rg{constructor(i){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=i,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=function(m){const y=Math.ceil(Math.log2(m.dim/8)),b=[];let A=Math.ceil(Math.pow(2,y));const E=1/A,P=(B,N,q,Q,se)=>{const he=Q?1:0,ae=(B+1)*q-he,de=N*q,ye=(N+1)*q-he;se[0]=B*q,se[1]=de,se[2]=ae,se[3]=ye};let k=new wy(A);const R=[];for(let B=0;B<A*A;B++){P(B%A,Math.floor(B/A),E,!1,R);const N=tl(R[0],R[1],m),q=tl(R[2],R[1],m),Q=tl(R[2],R[3],m),se=tl(R[0],R[3],m);k.minimums.push(Math.min(N,q,Q,se)),k.maximums.push(Math.max(N,q,Q,se)),k.leaves.push(1)}for(b.push(k),A/=2;A>=1;A/=2){const B=b[b.length-1];k=new wy(A);for(let N=0;N<A*A;N++){P(N%A,Math.floor(N/A),2,!0,R);const q=B.getElevation(R[0],R[1]),Q=B.getElevation(R[2],R[1]),se=B.getElevation(R[2],R[3]),he=B.getElevation(R[0],R[3]),ae=B.isLeaf(R[0],R[1]),de=B.isLeaf(R[2],R[1]),ye=B.isLeaf(R[2],R[3]),me=B.isLeaf(R[0],R[3]),De=Math.min(q.min,Q.min,se.min,he.min),Pe=Math.max(q.max,Q.max,se.max,he.max),Fe=ae&&de&&ye&&me;k.maximums.push(Pe),k.minimums.push(De),k.leaves.push(Pe-De<=5&&Fe?1:0)}b.push(k)}return b}(this.dem),c=o.length-1,h=o[c];this._addNode(h.minimums[0],h.maximums[0],h.leaves[0]),this._construct(o,0,0,c,0)}raycastRoot(i,o,c,h,m,y,b=1){return Cy([i,o,-100],[c,h,this.maximums[0]*b],m,y)}raycast(i,o,c,h,m,y,b=1){if(!this.nodeCount)return null;const A=this.raycastRoot(i,o,c,h,m,y,b);if(null==A)return null;const E=[],P=[],k=[],R=[],B=[{idx:0,t:A,nodex:0,nodey:0,depth:0}];for(;B.length>0;){const{idx:N,t:q,nodex:Q,nodey:se,depth:he}=B.pop();if(this.leaves[N]){ig(Q,se,he,i,o,c,h,k,R);const de=1<<he,ye=(Q+0)/de,me=(Q+1)/de,De=(se+0)/de,Pe=(se+1)/de,Fe=tl(ye,De,this.dem)*b,tt=tl(me,De,this.dem)*b,Oe=tl(me,Pe,this.dem)*b,Ve=tl(ye,Pe,this.dem)*b,qe=Po(k[0],k[1],Fe,R[0],k[1],tt,R[0],R[1],Oe,m,y),Ue=Po(R[0],R[1],Oe,k[0],R[1],Ve,k[0],k[1],Fe,m,y),Qe=Math.min(null!==qe?qe:Number.MAX_VALUE,null!==Ue?Ue:Number.MAX_VALUE);if(Qe!==Number.MAX_VALUE)return Qe;{const Ze=Sp([],m,y,q);if(og(Fe,tt,Ve,Oe,mf(Ze[0],k[0],R[0]),mf(Ze[1],k[1],R[1]))>=Ze[2])return q}continue}let ae=0;for(let de=0;de<this._siblingOffset.length;de++){ig((Q<<1)+this._siblingOffset[de][0],(se<<1)+this._siblingOffset[de][1],he+1,i,o,c,h,k,R),k[2]=-100,R[2]=this.maximums[this.childOffsets[N]+de]*b;const ye=Cy(k,R,m,y);if(null!=ye){const me=ye;E[de]=me;let De=!1;for(let Pe=0;Pe<ae&&!De;Pe++)me>=E[P[Pe]]&&(P.splice(Pe,0,de),De=!0);De||(P[ae]=de),ae++}}for(let de=0;de<ae;de++){const ye=P[de];B.push({idx:this.childOffsets[N]+ye,t:E[ye],nodex:(Q<<1)+this._siblingOffset[ye][0],nodey:(se<<1)+this._siblingOffset[ye][1],depth:he+1})}}return null}_addNode(i,o,c){return this.minimums.push(i),this.maximums.push(o),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(i,o,c,h,m){if(1===i[h].isLeaf(o,c))return;this.childOffsets[m]||(this.childOffsets[m]=this.nodeCount);const y=h-1,b=i[y];let A=0,E=0;for(let P=0;P<this._siblingOffset.length;P++){const k=2*o+this._siblingOffset[P][0],R=2*c+this._siblingOffset[P][1],B=b.getElevation(k,R),N=b.isLeaf(k,R),q=this._addNode(B.min,B.max,N);N&&(A|=1<<P),E||(E=q)}for(let P=0;P<this._siblingOffset.length;P++)A&1<<P||this._construct(i,2*o+this._siblingOffset[P][0],2*c+this._siblingOffset[P][1],y,E+P)}}function og(s,i,o,c,h,m){return _n(_n(s,o,m),_n(i,c,m),h)}function tl(s,i,o){const c=o.dim,h=Zt(s*c-.5,0,c-1),m=Zt(i*c-.5,0,c-1),y=Math.floor(h),b=Math.floor(m),A=Math.min(y+1,c-1),E=Math.min(b+1,c-1);return og(o.get(y,b),o.get(A,b),o.get(y,E),o.get(A,E),h-y,m-b)}const Ay={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class gf{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(i,o,c,h=!1,m=!1){if(this.uid=i,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(c&&"mapbox"!==c&&"terrarium"!==c)return vi(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const y=this.dim=o.height-2,b=new Uint32Array(o.data.buffer);if(this.pixels=new Uint8Array(o.data.buffer),this.encoding=c||"mapbox",this.borderReady=h,!h){for(let A=0;A<y;A++)b[this._idx(-1,A)]=b[this._idx(0,A)],b[this._idx(y,A)]=b[this._idx(y-1,A)],b[this._idx(A,-1)]=b[this._idx(A,0)],b[this._idx(A,y)]=b[this._idx(A,y-1)];b[this._idx(-1,-1)]=b[this._idx(0,0)],b[this._idx(y,-1)]=b[this._idx(y-1,0)],b[this._idx(-1,y)]=b[this._idx(0,y-1)],b[this._idx(y,y)]=b[this._idx(y-1,y-1)],m&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new rg(this)}get(i,o,c=!1){c&&(i=Zt(i,-1,this.dim),o=Zt(o,-1,this.dim));const h=4*this._idx(i,o);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(this.pixels[h],this.pixels[h+1],this.pixels[h+2])}static getUnpackVector(i){return Ay[i]}get unpackVector(){return Ay[this.encoding]}_idx(i,o){if(i<-1||i>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(i+1)}_unpackMapbox(i,o,c){return(256*i*256+256*o+c)/10-1e4}_unpackTerrarium(i,o,c){return 256*i+o+c/256-32768}static pack(i,o){const c=[0,0,0,0],h=gf.getUnpackVector(o);let m=Math.floor((i+h[3])/h[2]);return c[2]=m%256,m=Math.floor(m/256),c[1]=m%256,m=Math.floor(m/256),c[0]=m,c}getPixels(){return new To({width:this.stride,height:this.stride},this.pixels)}backfillBorder(i,o,c){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let h=o*this.dim,m=o*this.dim+this.dim,y=c*this.dim,b=c*this.dim+this.dim;switch(o){case-1:h=m-1;break;case 1:m=h+1}switch(c){case-1:y=b-1;break;case 1:b=y+1}const A=-o*this.dim,E=-c*this.dim;for(let P=y;P<b;P++)for(let k=h;k<m;k++){const R=4*this._idx(k,P),B=4*this._idx(k+A,P+E);this.pixels[R+0]=i.pixels[B+0],this.pixels[R+1]=i.pixels[B+1],this.pixels[R+2]=i.pixels[B+2],this.pixels[R+3]=i.pixels[B+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}vt(gf,"DEMData"),vt(rg,"DemMinMaxQuadTree",{omit:["dem"]});class sx{constructor(i,o){this.max=i,this.onRemove=o,this.reset()}reset(){for(const i in this.data)for(const o of this.data[i])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(i,o,c){const h=i.wrapped().key;void 0===this.data[h]&&(this.data[h]=[]);const m={value:o,timeout:void 0};if(void 0!==c&&(m.timeout=setTimeout(()=>{this.remove(i,m)},c)),this.data[h].push(m),this.order.push(h),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const o=this.data[i].shift();return o.timeout&&clearTimeout(o.timeout),0===this.data[i].length&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),o.value}getByKey(i){const o=this.data[i];return o?o[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,o){if(!this.has(i))return this;const c=i.wrapped().key,h=void 0===o?0:this.data[c].indexOf(o),m=this.data[c][h];return this.data[c].splice(h,1),m.timeout&&clearTimeout(m.timeout),0===this.data[c].length&&delete this.data[c],this.onRemove(m.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(i){const o=[];for(const c in this.data)for(const h of this.data[c])i(h.value)||o.push(h);for(const c of o)this.remove(c.value.tileID,c)}}class Cd{constructor(i,o,c){this.func=i,this.mask=o,this.range=c}}Cd.ReadOnly=!1,Cd.ReadWrite=!0,Cd.disabled=new Cd(519,Cd.ReadOnly,[0,1]);class Ey{constructor(i,o,c,h,m,y){this.test=i,this.ref=o,this.mask=c,this.fail=h,this.depthFail=m,this.pass=y}}Ey.disabled=new Ey({func:519,mask:0},0,0,7680,7680,7680);class Gs{constructor(i,o,c){this.blendFunction=i,this.blendColor=o,this.mask=c}}Gs.Replace=[1,0],Gs.disabled=new Gs(Gs.Replace,qn.transparent,[!1,!1,!1,!1]),Gs.unblended=new Gs(Gs.Replace,qn.transparent,[!0,!0,!0,!0]),Gs.alphaBlended=new Gs([1,771],qn.transparent,[!0,!0,!0,!0]);class va{constructor(i,o,c){this.enable=i,this.mode=o,this.frontFace=c}}va.disabled=new va(!1,1029,2305),va.backCCW=new va(!0,1029,2305),va.backCW=new va(!0,1029,2304),va.frontCW=new va(!0,1028,2304),va.frontCCW=new va(!0,1028,2305);class Ad extends Rt{constructor(i,o,c){super(),this.id=i,this._onlySymbols=c,o.on("data",h=>{"source"===h.dataType&&"metadata"===h.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===h.dataType&&"content"===h.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),o.on("error",()=>{this._sourceErrored=!0}),this._source=o,this._tiles={},this._cache=new sx(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=o.minTileCacheSize,this._maxTileCacheSize=o.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new ox,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(i){this.map=i,this._minTileCacheSize=void 0===this._minTileCacheSize&&i?i._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&i?i._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const i in this._tiles){const o=this._tiles[i];if("loaded"!==o.state&&"errored"!==o.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(i,o){return i.isSymbolTile=this._onlySymbols,this._source.loadTile(i,o)}_unloadTile(i){if(this._source.unloadTile)return this._source.unloadTile(i,()=>{})}_abortTile(i){if(this._source.abortTile)return this._source.abortTile(i,()=>{})}serialize(){return this._source.serialize()}prepare(i){if(this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._source.prepareTile)for(const o in this._tiles){const c=this._tiles[o];this._source.prepareTile(c)&&this.map.painter.terrain&&this.map.painter.terrain._clearRenderCacheForTile(this.id,c.tileID),c.upload(i),c.prepare(this.map.style.imageManager)}else for(const o in this._tiles){const c=this._tiles[o];c.upload(i),c.prepare(this.map.style.imageManager)}}getIds(){return Xs(this._tiles).map(i=>i.tileID).sort(yf).map(i=>i.key)}getRenderableIds(i){const o=[];for(const c in this._tiles)this._isIdRenderable(+c,i)&&o.push(this._tiles[c]);return i?o.sort((c,h)=>{const m=c.tileID,y=h.tileID,b=new dt(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),A=new dt(y.canonical.x,y.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-y.overscaledZ||A.y-b.y||A.x-b.x}).map(c=>c.tileID.key):o.map(c=>c.tileID).sort(yf).map(c=>c.key)}hasRenderableParent(i){const o=this.findLoadedParent(i,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(i,o){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(o||!this._tiles[i].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)"errored"!==this._tiles[i].state&&this._reloadTile(+i,"reloading")}}_reloadTile(i,o){const c=this._tiles[i];c&&("loading"!==c.state&&(c.state=o),this._loadTile(c,this._tileLoaded.bind(this,c,i,o)))}_tileLoaded(i,o,c,h){if(h)if(i.state="errored",404!==h.status)this._source.fire(new zn(h,{tile:i}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const m=this.map.painter.terrain;this.update(this.transform,m.getScaledDemTileSize(),!0),m.resetTileLookupCache(this.id)}else this.update(this.transform);else i.timeAdded=ko.now(),"expired"===c&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(o,i),"raster-dem"===this._source.type&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),this._source.fire(new Mn("data",{dataType:"source",tile:i,coord:i.tileID,sourceCacheId:this.id}))}_backfillDEM(i){const o=this.getRenderableIds();for(let h=0;h<o.length;h++){const m=o[h];if(i.neighboringTiles&&i.neighboringTiles[m]){const y=this.getTileByID(m);c(i,y),c(y,i)}}function c(h,m){if(!h.dem||h.dem.borderReady)return;h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0;let y=m.tileID.canonical.x-h.tileID.canonical.x;const b=m.tileID.canonical.y-h.tileID.canonical.y,A=Math.pow(2,h.tileID.canonical.z),E=m.tileID.key;0===y&&0===b||Math.abs(b)>1||(Math.abs(y)>1&&(1===Math.abs(y+A)?y+=A:1===Math.abs(y-A)&&(y-=A)),m.dem&&h.dem&&(h.dem.backfillBorder(m.dem,y,b),h.neighboringTiles&&h.neighboringTiles[E]&&(h.neighboringTiles[E].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,o,c,h){for(const m in this._tiles){let y=this._tiles[m];if(h[m]||!y.hasData()||y.tileID.overscaledZ<=o||y.tileID.overscaledZ>c)continue;let b=y.tileID;for(;y&&y.tileID.overscaledZ>o+1;){const E=y.tileID.scaledTo(y.tileID.overscaledZ-1);y=this._tiles[E.key],y&&y.hasData()&&(b=E)}let A=b;for(;A.overscaledZ>o;)if(A=A.scaledTo(A.overscaledZ-1),i[A.key]){h[b.key]=b;break}}}findLoadedParent(i,o){if(i.key in this._loadedParentTiles){const c=this._loadedParentTiles[i.key];return c&&c.tileID.overscaledZ>=o?c:null}for(let c=i.overscaledZ-1;c>=o;c--){const h=i.scaledTo(c),m=this._getLoadedTile(h);if(m)return m}}_getLoadedTile(i){const o=this._tiles[i.key];return o&&o.hasData()?o:this._cache.getByKey(this._source.reparseOverscaled?i.wrapped().key:i.canonical.key)}updateCacheSize(i,o){o=o||this._source.tileSize;const c=Math.ceil(i.width/o)+1,h=Math.ceil(i.height/o)+1,m=Math.floor(c*h*5),y="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,m):m,b="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(b)}handleWrapJump(i){const o=Math.round((i-(void 0===this._prevLng?i:this._prevLng))/360);if(this._prevLng=i,o){const c={};for(const h in this._tiles){const m=this._tiles[h];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+o),c[m.tileID.key]=m}this._tiles=c;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(+h,this._tiles[h])}}update(i,o,c){if(this.transform=i,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!c)return;let h;this.updateCacheSize(i,o),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(b=>new Dr(b.canonical.z,b.wrap,b.canonical.z,b.canonical.x,b.canonical.y)):(h=i.coveringTiles({tileSize:o||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(h=h.filter(b=>this._source.hasTile(b)))):h=[];const m=this._updateRetainedTiles(h);if(Ty(this._source.type)&&0!==h.length){const b={},A={},E=Object.keys(m);for(const k of E){const R=m[k],B=this._tiles[k];if(!B||B.fadeEndTime&&B.fadeEndTime<=ko.now())continue;const N=this.findLoadedParent(R,Math.max(R.overscaledZ-Ad.maxOverzooming,this._source.minzoom));N&&(this._addTile(N.tileID),b[N.tileID.key]=N.tileID),A[k]=R}const P=h[h.length-1].overscaledZ;for(const k in this._tiles){const R=this._tiles[k];if(m[k]||!R.hasData())continue;let B=R.tileID;for(;B.overscaledZ>P;){B=B.scaledTo(B.overscaledZ-1);const N=this._tiles[B.key];if(N&&N.hasData()&&A[B.key]){m[k]=R.tileID;break}}}for(const k in b)m[k]||(this._coveredTiles[k]=!0,m[k]=b[k])}for(const b in m)this._tiles[b].clearFadeHold();const y=function(b,A){const E=[];for(const P in b)P in A||E.push(P);return E}(this._tiles,m);for(const b of y){const A=this._tiles[b];A.hasSymbolBuckets&&!A.holdingForFade()?A.setHoldDuration(this.map._fadeDuration):A.hasSymbolBuckets&&!A.symbolFadeFinished()||this._removeTile(+b)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(+i)}_updateRetainedTiles(i){const o={};if(0===i.length)return o;const c={},h=i.reduce((E,P)=>Math.min(E,P.overscaledZ),1/0),m=i[0].overscaledZ,y=Math.max(m-Ad.maxOverzooming,this._source.minzoom),b=Math.max(m+Ad.maxUnderzooming,this._source.minzoom),A={};for(const E of i){const P=this._addTile(E);o[E.key]=E,P.hasData()||h<this._source.maxzoom&&(A[E.key]=E)}this._retainLoadedChildren(A,h,b,o);for(const E of i){let P=this._tiles[E.key];if(P.hasData())continue;if(E.canonical.z>=this._source.maxzoom){const R=E.children(this._source.maxzoom)[0],B=this.getTile(R);if(B&&B.hasData()){o[R.key]=R;continue}}else{const R=E.children(this._source.maxzoom);if(o[R[0].key]&&o[R[1].key]&&o[R[2].key]&&o[R[3].key])continue}let k=P.wasRequested();for(let R=E.overscaledZ-1;R>=y;--R){const B=E.scaledTo(R);if(c[B.key]||(c[B.key]=!0,P=this.getTile(B),!P&&k&&(P=this._addTile(B)),P&&(o[B.key]=B,k=P.wasRequested(),P.hasData())))break}}return o}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const o=[];let c,h=this._tiles[i].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){c=this._loadedParentTiles[h.key];break}o.push(h.key);const m=h.scaledTo(h.overscaledZ-1);if(c=this._getLoadedTile(m),c)break;h=m}for(const m of o)this._loadedParentTiles[m]=c}}_addTile(i){let o=this._tiles[i.key];if(o)return this._source.prepareTile&&this._source.prepareTile(o),o;o=this._cache.getAndRemove(i),o&&(this._setTileReloadTimer(i.key,o),o.tileID=i,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,o)));const c=Boolean(o);if(!c){const h=this.map?this.map.painter:null;o=new ng(i,this._source.tileSize*i.overscaleFactor(),this.transform.tileZoom,h,this._isRaster),this._source.prepareTile&&this._source.prepareTile(o)||this._loadTile(o,this._tileLoaded.bind(this,o,i.key,o.state))}return o?(o.uses++,this._tiles[i.key]=o,c||this._source.fire(new Mn("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o):null}_setTileReloadTimer(i,o){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const c=o.getExpiryTimeout();c&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},c))}_removeTile(i){const o=this._tiles[i];o&&(o.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),o.uses>0||(o.hasData()&&"reloading"!==o.state?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(+i);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(i,o,c){const h=[],m=this.transform;if(!m)return h;const y="globe"===m.projection.name,b=Ls(m.center.lng);for(const A in this._tiles){const E=this._tiles[A];if(c&&E.clearQueryDebugViz(),E.holdingForFade())continue;let P;if(y){const k=E.tileID.canonical;if(0===k.z){const R=[Math.abs(Zt(b,...Ed(k,-1))-b),Math.abs(Zt(b,...Ed(k,1))-b)];P=[0,2*R.indexOf(Math.min(...R))-1]}else{const R=[Math.abs(Zt(b,...Ed(k,-1))-b),Math.abs(Zt(b,...Ed(k,0))-b),Math.abs(Zt(b,...Ed(k,1))-b)];P=[R.indexOf(Math.min(...R))-1]}}else P=[0];for(const k of P){const R=i.containsTile(E,m,o,k);R&&h.push(R)}}return h}getVisibleCoordinates(i){const o=this.getRenderableIds(i).map(c=>this._tiles[c].tileID);for(const c of o)c.projMatrix=this.transform.calculateProjMatrix(c.toUnwrapped());return o}hasTransition(){if(this._source.hasTransition())return!0;if(Ty(this._source.type))for(const i in this._tiles){const o=this._tiles[i];if(void 0!==o.fadeEndTime&&o.fadeEndTime>=ko.now())return!0}return!1}setFeatureState(i,o,c){this._state.updateState(i=i||"_geojsonTileLayer",o,c)}removeFeatureState(i,o,c){this._state.removeFeatureState(i=i||"_geojsonTileLayer",o,c)}getFeatureState(i,o){return this._state.getState(i=i||"_geojsonTileLayer",o)}setDependencies(i,o,c){const h=this._tiles[i];h&&h.setDependencies(o,c)}reloadTilesForDependencies(i,o){for(const c in this._tiles)this._tiles[c].hasDependency(i,o)&&this._reloadTile(+c,"reloading");this._cache.filter(c=>!c.hasDependency(i,o))}_preloadTiles(i,o){const c=new Map,h=Array.isArray(i)?i:[i],m=this.map.painter.terrain,y=this.usedForTerrain&&m?m.getScaledDemTileSize():this._source.tileSize;for(const b of h){const A=b.coveringTiles({tileSize:y,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const E of A)c.set(E.key,E);this.usedForTerrain&&b.updateElevation(!1)}Ys(Array.from(c.values()),(b,A)=>{const E=new ng(b,this._source.tileSize*b.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(E,P=>{"raster-dem"===this._source.type&&E.dem&&this._backfillDEM(E),A(P,E)})},o)}}function yf(s,i){const o=Math.abs(2*s.wrap)-+(s.wrap<0),c=Math.abs(2*i.wrap)-+(i.wrap<0);return s.overscaledZ-i.overscaledZ||c-o||i.canonical.y-s.canonical.y||i.canonical.x-s.canonical.x}function Ty(s){return"raster"===s||"image"===s||"video"===s}function Ed(s,i){const o=1<<s.z;return[s.x/o+i,(s.x+1)/o+i]}Ad.maxOverzooming=10,Ad.maxUnderzooming=3;class Sh{constructor(i,o,c){this._demTile=i,this._dem=this._demTile.dem,this._scale=o,this._offset=c}static create(i,o,c){const h=c||i.findDEMTileFor(o);if(!h||!h.dem)return;const m=h.dem,y=h.tileID,b=1<<o.canonical.z-y.canonical.z;return new Sh(h,h.tileSize/zt/b,[(o.canonical.x/b-y.canonical.x)*m.dim,(o.canonical.y/b-y.canonical.y)*m.dim])}tileCoordToPixel(i,o){const c=o*this._scale+this._offset[1],h=Math.floor(i*this._scale+this._offset[0]),m=Math.floor(c);return new dt(h,m)}getElevationAt(i,o,c,h){const m=i*this._scale+this._offset[0],y=o*this._scale+this._offset[1],b=Math.floor(m),A=Math.floor(y),E=this._dem;return h=!!h,c?_n(_n(E.get(b,A,h),E.get(b,A+1,h),y-A),_n(E.get(b+1,A,h),E.get(b+1,A+1,h),y-A),m-b):E.get(b,A,h)}getElevationAtPixel(i,o,c){return this._dem.get(i,o,!!c)}getMeterToDEM(i){return(1<<this._demTile.tileID.canonical.z)*jr(1,i)*this._dem.stride}}class ax{constructor(i,o){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new xc(zt,16,0),this.featureIndexArray=new Bn,this.promoteId=o}insert(i,o,c,h,m,y=0){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,h,m,y);const A=this.grid;for(let E=0;E<o.length;E++){const P=o[E],k=[1/0,1/0,-1/0,-1/0];for(let R=0;R<P.length;R++){const B=P[R];k[0]=Math.min(k[0],B.x),k[1]=Math.min(k[1],B.y),k[2]=Math.max(k[2],B.x),k[3]=Math.max(k[3],B.y)}k[0]<zt&&k[1]<zt&&k[2]>=0&&k[3]>=0&&A.insert(b,k[0],k[1],k[2],k[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Wa.VectorTile(new pd(this.rawTileData)).layers,this.sourceLayerCoder=new tg(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const i in this.vtLayers)this.vtFeatures[i]=[]}return this.vtLayers}query(i,o,c,h){this.loadVTLayers();const m=i.params||{},y=Ba(m.filter),b=i.tileResult,A=i.transform,E=b.bufferedTilespaceBounds,P=this.grid.query(E.min.x,E.min.y,E.max.x,E.max.y,(N,q,Q,se)=>u_(b.bufferedTilespaceGeometry,N,q,Q,se));P.sort(hw);let k=null;A.elevation&&P.length>0&&(k=Sh.create(A.elevation,this.tileID));const R={};let B;for(let N=0;N<P.length;N++){const q=P[N];if(q===B)continue;B=q;const Q=this.featureIndexArray.get(q);let se=null;this.loadMatchingFeature(R,Q,y,m.layers,m.availableImages,o,c,h,(he,ae,de,ye=0)=>(se||(se=Wo(he,this.tileID.canonical,i.tileTransform)),ae.queryIntersectsFeature(b,he,de,se,this.z,i.transform,i.pixelPosMatrix,k,ye)))}return R}loadMatchingFeature(i,o,c,h,m,y,b,A,E){const{featureIndex:P,bucketIndex:k,sourceLayerIndex:R,layoutVertexArrayOffset:B}=o,N=this.bucketLayerIDs[k];if(h&&!function(he,ae){for(let de=0;de<he.length;de++)if(ae.indexOf(he[de])>=0)return!0;return!1}(h,N))return;const q=this.sourceLayerCoder.decode(R),Q=this.vtLayers[q].feature(P);if(c.needGeometry){const he=Dc(Q,!0);if(!c.filter(new J(this.tileID.overscaledZ),he,this.tileID.canonical))return}else if(!c.filter(new J(this.tileID.overscaledZ),Q))return;const se=this.getId(Q,q);for(let he=0;he<N.length;he++){const ae=N[he];if(h&&h.indexOf(ae)<0)continue;const de=y[ae];if(!de)continue;let ye={};void 0!==se&&A&&(ye=A.getState(de.sourceLayer||"_geojsonTileLayer",se));const me=ji({},b[ae]);me.paint=_s(me.paint,de.paint,Q,ye,m),me.layout=_s(me.layout,de.layout,Q,ye,m);const De=!E||E(Q,de,ye,B);if(!De)continue;const Pe=new vy(Q,this.z,this.x,this.y,se);Pe.layer=me;let Fe=i[ae];void 0===Fe&&(Fe=i[ae]=[]),Fe.push({featureIndex:P,feature:Pe,intersectionZ:De})}}lookupSymbolFeatures(i,o,c,h,m,y,b,A){const E={};this.loadVTLayers();const P=Ba(m);for(const k of i)this.loadMatchingFeature(E,{bucketIndex:c,sourceLayerIndex:h,featureIndex:k,layoutVertexArrayOffset:0},P,y,b,A,o);return E}loadFeature(i){const{featureIndex:o,sourceLayerIndex:c}=i;this.loadVTLayers();const h=this.sourceLayerCoder.decode(c),m=this.vtFeatures[h];if(m[o])return m[o];const y=this.vtLayers[h].feature(o);return m[o]=y,y}hasLayer(i){for(const o of this.bucketLayerIDs)for(const c of o)if(i===c)return!0;return!1}getId(i,o){let c=i.id;return this.promoteId&&(c=i.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[o]],"boolean"==typeof c&&(c=Number(c))),c}}function _s(s,i,o,c,h){return Cs(s,(m,y)=>{const b=i instanceof ve?i.get(y):null;return b&&b.evaluate?b.evaluate(o,c,h):b})}function hw(s,i){return i-s}vt(ax,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class lx{constructor(i){const o={},c=[];for(const b in i){const A=i[b],E=o[b]={};for(const P in A.glyphs){const k=A.glyphs[+P];if(!k||0===k.bitmap.width||0===k.bitmap.height)continue;const R=k.metrics.localGlyph?2:1,B={x:0,y:0,w:k.bitmap.width+2*R,h:k.bitmap.height+2*R};c.push(B),E[P]=B}}const{w:h,h:m}=js(c),y=new hi({width:h||1,height:m||1});for(const b in i){const A=i[b];for(const E in A.glyphs){const P=A.glyphs[+E];if(!P||0===P.bitmap.width||0===P.bitmap.height)continue;const k=o[b][E],R=P.metrics.localGlyph?2:1;hi.copy(P.bitmap,y,{x:0,y:0},{x:k.x+R,y:k.y+R},P.bitmap)}}this.image=y,this.positions=o}}vt(lx,"GlyphAtlas");class My{constructor(i){this.tileID=new Dr(i.tileID.overscaledZ,i.tileID.wrap,i.tileID.canonical.z,i.tileID.canonical.x,i.tileID.canonical.y),this.tileZoom=i.tileZoom,this.uid=i.uid,this.zoom=i.zoom,this.canonical=i.tileID.canonical,this.pixelRatio=i.pixelRatio,this.tileSize=i.tileSize,this.source=i.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=i.showCollisionBoxes,this.collectResourceTiming=!!i.collectResourceTiming,this.returnDependencies=!!i.returnDependencies,this.promoteId=i.promoteId,this.enableTerrain=!!i.enableTerrain,this.isSymbolTile=i.isSymbolTile,this.tileTransform=Qc(i.tileID.canonical,i.projection),this.projection=i.projection}parse(i,o,c,h,m){this.status="parsing",this.data=i,this.collisionBoxArray=new lo;const y=new tg(Object.keys(i.layers).sort()),b=new ax(this.tileID,this.promoteId);b.bucketLayerIDs=[];const A={},E=new Jm(256,256),P={featureIndex:b,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:E,availableImages:c},k=o.familiesBySource[this.source];for(const ye in k){const me=i.layers[ye];if(!me)continue;let De=!1,Pe=!1;for(const Oe of k[ye])"symbol"===Oe[0].type?De=!0:Pe=!0;if(!0===this.isSymbolTile&&!De||!1===this.isSymbolTile&&!Pe)continue;1===me.version&&vi(`Vector tile source "${this.source}" layer "${ye}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Fe=y.encode(ye),tt=[];for(let Oe=0;Oe<me.length;Oe++){const Ve=me.feature(Oe),qe=b.getId(Ve,ye);tt.push({feature:Ve,id:qe,index:Oe,sourceLayerIndex:Fe})}for(const Oe of k[ye]){const Ve=Oe[0];void 0!==this.isSymbolTile&&"symbol"===Ve.type!==this.isSymbolTile||Ve.minzoom&&this.zoom<Math.floor(Ve.minzoom)||Ve.maxzoom&&this.zoom>=Ve.maxzoom||"none"!==Ve.visibility&&(vf(Oe,this.zoom,c),(A[Ve.id]=Ve.createBucket({index:b.bucketLayerIDs.length,layers:Oe,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Fe,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:c})).populate(tt,P,this.tileID.canonical,this.tileTransform),b.bucketLayerIDs.push(Oe.map(qe=>qe.id)))}}let R,B,N,q;E.trim();const Q={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},se=Cs(P.glyphDependencies,ye=>Object.keys(ye).map(Number));Object.keys(se).length?h.send("getGlyphs",{uid:this.uid,stacks:se},(ye,me)=>{R||(R=ye,B=me,de.call(this))},void 0,!1,Q):B={};const he=Object.keys(P.iconDependencies);he.length?h.send("getImages",{icons:he,source:this.source,tileID:this.tileID,type:"icons"},(ye,me)=>{R||(R=ye,N=me,de.call(this))},void 0,!1,Q):N={};const ae=Object.keys(P.patternDependencies);function de(){if(R)return m(R);if(B&&N&&q){const ye=new lx(B),me=new Pm(N,q);for(const De in A){const Pe=A[De];Pe instanceof Ja?(vf(Pe.layers,this.zoom,c),Z0(Pe,B,ye.positions,N,me.iconPositions,this.showCollisionBoxes,c,this.tileID.canonical,this.tileZoom,this.projection)):Pe.hasPattern&&(Pe instanceof Hc||Pe instanceof Bp||Pe instanceof Vc)&&(vf(Pe.layers,this.zoom,c),Pe.addFeatures(P,this.tileID.canonical,me.patternPositions,c,this.tileTransform))}this.status="done",m(null,{buckets:Xs(A).filter(De=>!De.isEmpty()),featureIndex:b,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ye.image,lineAtlas:E,imageAtlas:me,glyphMap:this.returnDependencies?B:null,iconMap:this.returnDependencies?N:null,glyphPositions:this.returnDependencies?ye.positions:null})}}ae.length?h.send("getImages",{icons:ae,source:this.source,tileID:this.tileID,type:"patterns"},(ye,me)=>{R||(R=ye,q=me,de.call(this))},void 0,!1,Q):q={},de.call(this)}}function vf(s,i,o){const c=new J(i);for(const h of s)h.recalculate(c,o)}class lg{constructor(i){this.entries={},this.scheduler=i}request(i,o,c,h){const m=this.entries[i]=this.entries[i]||{callbacks:[]};if(m.result){const[y,b]=m.result;return this.scheduler?this.scheduler.add(()=>{h(y,b)},o):h(y,b),()=>{}}return m.callbacks.push(h),m.cancel||(m.cancel=c((y,b)=>{m.result=[y,b];for(const A of m.callbacks)this.scheduler?this.scheduler.add(()=>{A(y,b)},o):A(y,b);setTimeout(()=>delete this.entries[i],3e3)})),()=>{m.result||(m.callbacks=m.callbacks.filter(y=>y!==h),m.callbacks.length||(m.cancel(),delete this.entries[i]))}}}function Sy(s,i,o){const c=JSON.stringify(s.request);return s.data&&(this.deduped.entries[c]={result:[null,s.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:s.isSymbolTile,zoom:s.tileZoom},h=>{const m=Me(s.request,(y,b,A,E)=>{y?h(y):b&&h(null,{vectorTile:o?void 0:new Wa.VectorTile(new pd(b)),rawData:b,cacheControl:A,expires:E})});return()=>{m.cancel(),h()}},i)}p.ARRAY_TYPE=Sr,p.AUTH_ERR_MSG=Vi,p.Aabb=Ur,p.Actor=class{constructor(s,i,o){this.target=s,this.parent=i,this.mapId=o,this.callbacks={},this.cancelCallbacks={},ns(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=bi()?s:ot,this.scheduler=new _y}send(s,i,o,c,h=!1,m){const y=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(o.metadata=m,this.callbacks[y]=o);const b=wi(this.globalScope)?void 0:[];return this.target.postMessage({id:y,type:s,hasCallback:!!o,targetMapId:c,mustQueue:h,sourceMapId:this.mapId,data:Pl(i,b)},b),{cancel:()=>{o&&delete this.callbacks[y],this.target.postMessage({id:y,type:"<cancel>",targetMapId:c,sourceMapId:this.mapId})}}}receive(s){const i=s.data,o=i.id;if(o&&(!i.targetMapId||this.mapId===i.targetMapId))if("<cancel>"===i.type){const c=this.cancelCallbacks[o];delete this.cancelCallbacks[o],c&&c.cancel()}else if(i.mustQueue||bi()){const c=this.callbacks[o];this.cancelCallbacks[o]=this.scheduler.add(()=>this.processTask(o,i),c&&c.metadata||{type:"message"})}else this.processTask(o,i)}processTask(s,i){if("<response>"===i.type){const o=this.callbacks[s];delete this.callbacks[s],o&&(i.error?o(it(i.error)):o(null,it(i.data)))}else{const o=wi(this.globalScope)?void 0:[],c=i.hasCallback?(m,y)=>{delete this.cancelCallbacks[s],this.target.postMessage({id:s,type:"<response>",sourceMapId:this.mapId,error:m?Pl(m):null,data:Pl(y,o)},o)}:m=>{},h=it(i.data);if(this.parent[i.type])this.parent[i.type](i.sourceMapId,h,c);else if(this.parent.getWorkerSource){const m=i.type.split(".");this.parent.getWorkerSource(i.sourceMapId,m[0],h.source)[m[1]](h,c)}else c(new Error(`Could not find function ${i.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},p.CanonicalTileID=$p,p.Color=qn,p.ColorMode=Gs,p.CullFaceMode=va,p.DEMData=gf,p.DataConstantProperty=_e,p.DedupedRequest=lg,p.DepthMode=Cd,p.EXTENT=zt,p.Elevation=class{isDataAvailableAtPoint(s){const i=this._source();if(!i||s.y<0||s.y>1)return!1;const o=i.getSource().maxzoom,c=1<<o,h=Math.floor(s.x),m=Math.floor((s.x-h)*c),y=Math.floor(s.y*c),b=this.findDEMTileFor(new Dr(o,h,o,m,y));return!(!b||!b.dem)}getAtPointOrZero(s,i=0){return this.getAtPoint(s,i)||0}getAtPoint(s,i,o=!0){null==i&&(i=null);const c=this._source();if(!c||s.y<0||s.y>1)return i;const h=c.getSource().maxzoom,m=1<<h,y=Math.floor(s.x),b=s.x-y,A=new Dr(h,y,h,Math.floor(b*m),Math.floor(s.y*m)),E=this.findDEMTileFor(A);if(!E||!E.dem)return i;const P=E.dem,k=1<<E.tileID.canonical.z,R=(b*k-E.tileID.canonical.x)*P.dim,B=(s.y*k-E.tileID.canonical.y)*P.dim,N=Math.floor(R),q=Math.floor(B);return(o?this.exaggeration():1)*_n(_n(P.get(N,q),P.get(N,q+1),B-q),_n(P.get(N+1,q),P.get(N+1,q+1),B-q),R-N)}getAtTileOffset(s,i,o){const c=1<<s.canonical.z;return this.getAtPointOrZero(new zl(s.wrap+(s.canonical.x+i/zt)/c,(s.canonical.y+o/zt)/c))}getAtTileOffsetFunc(s,i,o,c){return h=>{const m=this.getAtTileOffset(s,h.x,h.y),y=c.upVector(s.canonical,h.x,h.y);return Bs(y,y,m*c.upVectorScale(s.canonical,i,o).metersToTile),y}}getForTilePoints(s,i,o,c){const h=Sh.create(this,s,c);return!!h&&(i.forEach(m=>{m[2]=this.exaggeration()*h.getElevationAt(m[0],m[1],o)}),!0)}getMinMaxForTile(s){const i=this.findDEMTileFor(s);if(!i||!i.dem)return null;const o=i.dem.tree,c=i.tileID,h=1<<s.canonical.z-c.canonical.z;let m=s.canonical.x/h-c.canonical.x,y=s.canonical.y/h-c.canonical.y,b=0;for(let A=0;A<s.canonical.z-c.canonical.z&&!o.leaves[b];A++){m*=2,y*=2;const E=2*Math.floor(y)+Math.floor(m);b=o.childOffsets[b]+E,m%=1,y%=1}return{min:this.exaggeration()*o.minimums[b],max:this.exaggeration()*o.maximums[b]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(s,i,o){throw new Error("Pure virtual method called.")}pointCoordinate(s){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(s){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},p.ErrorEvent=zn,p.EvaluationParameters=J,p.Event=Mn,p.Evented=Rt,p.FillExtrusionBucket=Vc,p.Frustum=y_,p.FrustumCorners=__,p.GLOBE_METERS_TO_ECEF=vh,p.GLOBE_RADIUS=Vs,p.GLOBE_SCALE_MATCH_LATITUDE=45,p.GLOBE_ZOOM_THRESHOLD_MAX=6,p.GLOBE_ZOOM_THRESHOLD_MIN=5,p.GlobeSharedBuffers=class{constructor(s){this._createGrid(s),this._createPoles(s)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const s of this._poleSegments)s.destroy();for(const s of this._gridSegments)s.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const s of this._wireframeSegments)s.destroy()}}_createGrid(s){const i=new lt,o=new on,c=65;for(let h=0;h<c;h++)for(let m=0;m<c;m++)i.emplaceBack(m,h);this._gridSegments=[];for(let h=0,m=0;h<Xc.length;h++){const y=Xc[h];for(let A=0;A<y;A++)for(let E=0;E<64;E++){const P=A*c+E;o.emplaceBack(P+1,P,P+c),o.emplaceBack(P+c,P+c+1,P+1)}const b=64*y*2;this._gridSegments.push(Hi.simpleSegment(0,m,(y+1)*c,b)),m+=b}this._gridBuffer=s.createVertexBuffer(i,vd.members),this._gridIndexBuffer=s.createIndexBuffer(o,!0)}_createPoles(s){const i=new on;for(let h=0;h<=64;h++)i.emplaceBack(0,h+1,h+2);this._poleIndexBuffer=s.createIndexBuffer(i,!0);const o=new Ni,c=new Ni;this._poleSegments=[];for(let h=0,m=0;h<5;h++){const y=360/(1<<h);o.emplaceBack(0,-Vs,0,.5,0),c.emplaceBack(0,-Vs,0,.5,1);for(let b=0;b<=64;b++){const A=b/64,E=_n(0,y,A),[P,k,R]=xd(uy,K0,E,Vs);o.emplaceBack(P,k,R,A,0),c.emplaceBack(P,k,R,A,1)}this._poleSegments.push(Hi.simpleSegment(m,0,66,64)),m+=66}this._poleNorthVertexBuffer=s.createVertexBuffer(o,ry,!1),this._poleSouthVertexBuffer=s.createVertexBuffer(c,ry,!1)}getGridBuffers(s){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments[s]]}getPoleBuffers(s){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[s]]}getWirefameBuffers(s,i){if(!this._wireframeSegments){const o=new mr,c=64,h=c+1;this._wireframeSegments=[];for(let m=0,y=0;m<Xc.length;m++){const b=Xc[m];for(let E=0;E<b;E++)for(let P=0;P<c;P++){const k=E*h+P;o.emplaceBack(k,k+1),o.emplaceBack(k,k+h),o.emplaceBack(k,k+h+1)}const A=b*c*3;this._wireframeSegments.push(Hi.simpleSegment(0,y,(b+1)*h,A)),y+=A}this._wireframeIndexBuffer=s.createIndexBuffer(o)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[i]]}},p.GlyphManager=_h,p.ImagePosition=gh,p.LineAtlas=Jm,p.LngLat=kn,p.LngLatBounds=fa,p.LocalGlyphMode=ty,p.MAX_MERCATOR_LATITUDE=zs,p.MercatorCoordinate=zl,p.ONE_EM=24,p.OverscaledTileID=Dr,p.Properties=je,p.RGBAImage=To,p.Ray=lh,p.RequestManager=class{constructor(s,i,o){this._transformRequestFn=s,this._customAccessToken=i,this._silenceAuthErrors=!!o,this._createSkuToken()}_createSkuToken(){const s=function(){let i="";for(let o=0;o<10;o++)i+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",yu,i].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(s,i){return this._transformRequestFn&&this._transformRequestFn(s,i)||{url:s}}normalizeStyleURL(s,i){if(!ss(s))return s;const o=vo(s);return o.path=`/styles/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||i)}normalizeGlyphsURL(s,i){if(!ss(s))return s;const o=vo(s);return o.path=`/fonts/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||i)}normalizeSourceURL(s,i,o,c){if(!ss(s))return s;const h=vo(s);return h.path=`/v4/${h.authority}.json`,h.params.push("secure"),o&&h.params.push(`language=${o}`),c&&h.params.push(`worldview=${c}`),this._makeAPIURL(h,this._customAccessToken||i)}normalizeSpriteURL(s,i,o,c){const h=vo(s);return ss(s)?(h.path=`/styles/v1${h.path}/sprite${i}${o}`,this._makeAPIURL(h,this._customAccessToken||c)):(h.path+=`${i}${o}`,Ds(h))}normalizeTileURL(s,i,o){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!ss(s))return s;const c=vo(s);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${i||o&&"raster"!==c.authority&&512===o?"@2x":""}${Ss.supported?".webp":"$1"}`),"raster"===c.authority?c.path=`/${bn.RASTER_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${bn.TILE_URL_VERSION}${c.path}`);const h=this._customAccessToken||function(m){for(const y of m){const b=y.match(/^access_token=(.*)$/);if(b)return b[1]}return null}(c.params)||bn.ACCESS_TOKEN;return bn.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,h)}canonicalizeTileURL(s,i){const o=vo(s);if(!o.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!o.path.match(/\.[\w]+$/))return s;let c="mapbox://";o.path.match(/^\/raster\/v1\//)?c+=`raster/${o.path.replace(`/${bn.RASTER_URL_PREFIX}/`,"")}`:c+=`tiles/${o.path.replace(`/${bn.TILE_URL_VERSION}/`,"")}`;let h=o.params;return i&&(h=h.filter(m=>!m.match(/^access_token=/))),h.length&&(c+=`?${h.join("&")}`),c}canonicalizeTileset(s,i){const o=!!i&&ss(i),c=[];for(const h of s.tiles||[])_l(h)?c.push(this.canonicalizeTileURL(h,o)):c.push(h);return c}_makeAPIURL(s,i){const o="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",c=vo(bn.API_URL);if(s.protocol=c.protocol,s.authority=c.authority,"http"===s.protocol){const h=s.params.indexOf("secure");h>=0&&s.params.splice(h,1)}if("/"!==c.path&&(s.path=`${c.path}${s.path}`),!bn.REQUIRE_ACCESS_TOKEN)return Ds(s);if(i=i||bn.ACCESS_TOKEN,!this._silenceAuthErrors){if(!i)throw new Error(`An API access token is required to use Mapbox GL. ${o}`);if("s"===i[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${o}`)}return s.params=s.params.filter(h=>-1===h.indexOf("access_token")),s.params.push(`access_token=${i||""}`),Ds(s)}},p.ResourceType=be,p.SegmentVector=Hi,p.SourceCache=Ad,p.StencilMode=Ey,p.StructArrayLayout1ui2=da,p.StructArrayLayout2f1f2i16=hs,p.StructArrayLayout2i4=lt,p.StructArrayLayout2ui4=mr,p.StructArrayLayout3f12=si,p.StructArrayLayout3ui6=on,p.StructArrayLayout4i8=Lt,p.StructArrayLayout5f20=Ni,p.Texture=el,p.Tile=ng,p.Transitionable=re,p.Uniform1f=Ho,p.Uniform1i=class extends Xi{constructor(s){super(s),this.current=0}set(s,i,o){this.fetchUniformLocation(s,i)&&this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},p.Uniform2f=class extends Xi{constructor(s){super(s),this.current=[0,0]}set(s,i,o){this.fetchUniformLocation(s,i)&&(o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1])))}},p.Uniform3f=class extends Xi{constructor(s){super(s),this.current=[0,0,0]}set(s,i,o){this.fetchUniformLocation(s,i)&&(o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2])))}},p.Uniform4f=Qf,p.UniformColor=ih,p.UniformMatrix2f=class extends Xi{constructor(s){super(s),this.current=Wv}set(s,i,o){if(this.fetchUniformLocation(s,i))for(let c=0;c<4;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix2fv(this.location,!1,o);break}}},p.UniformMatrix3f=class extends Xi{constructor(s){super(s),this.current=e_}set(s,i,o){if(this.fetchUniformLocation(s,i))for(let c=0;c<9;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}},p.UniformMatrix4f=class extends Xi{constructor(s){super(s),this.current=rh}set(s,i,o){if(this.fetchUniformLocation(s,i)){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let c=1;c<16;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}}},p.UnwrappedTileID=k_,p.ValidationError=mt,p.VectorTileWorkerSource=class extends Rt{constructor(s,i,o,c,h){super(),this.actor=s,this.layerIndex=i,this.availableImages=o,this.loadVectorData=h||Sy,this.loading={},this.loaded={},this.deduped=new lg(s.scheduler),this.isSpriteLoaded=c,this.scheduler=s.scheduler}loadTile(s,i){const o=s.uid,c=s&&s.request,h=c&&c.collectResourceTiming,m=this.loading[o]=new My(s);m.abort=this.loadVectorData(s,(y,b)=>{const A=!this.loading[o];if(delete this.loading[o],A||y||!b)return m.status="done",A||(this.loaded[o]=m),i(y);const E=b.rawData,P={};b.expires&&(P.expires=b.expires),b.cacheControl&&(P.cacheControl=b.cacheControl),m.vectorTile=b.vectorTile||new Wa.VectorTile(new pd(E));const k=()=>{m.parse(m.vectorTile,this.layerIndex,this.availableImages,this.actor,(R,B)=>{if(R||!B)return i(R);const N={};if(h){const q=Ts(c);q.length>0&&(N.resourceTiming=JSON.parse(JSON.stringify(q)))}i(null,ji({rawTileData:E.slice(0)},B,P,N))})};this.isSpriteLoaded?k():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(k,{type:"parseTile",isSymbolTile:s.isSymbolTile,zoom:s.tileZoom}):k()}),this.loaded=this.loaded||{},this.loaded[o]=m})}reloadTile(s,i){const o=this.loaded,c=s.uid,h=this;if(o&&o[c]){const m=o[c];m.showCollisionBoxes=s.showCollisionBoxes,m.enableTerrain=!!s.enableTerrain,m.projection=s.projection,m.tileTransform=Qc(s.tileID.canonical,s.projection);const y=(b,A)=>{const E=m.reloadCallback;E&&(delete m.reloadCallback,m.parse(m.vectorTile,h.layerIndex,this.availableImages,h.actor,E)),i(b,A)};"parsing"===m.status?m.reloadCallback=y:"done"===m.status&&(m.vectorTile?m.parse(m.vectorTile,this.layerIndex,this.availableImages,this.actor,y):y())}}abortTile(s,i){const o=s.uid,c=this.loading[o];c&&(c.abort&&c.abort(),delete this.loading[o]),i()}removeTile(s,i){const o=this.loaded,c=s.uid;o&&o[c]&&delete o[c],i()}},p.WritingMode=po,p.ZoomHistory=Tn,p.add=zc,p.addDynamicAttributes=Xm,p.adjoint=function(s,i){var o=i[0],c=i[1],h=i[2],m=i[3],y=i[4],b=i[5],A=i[6],E=i[7],P=i[8];return s[0]=y*P-b*E,s[1]=h*E-c*P,s[2]=c*b-h*y,s[3]=b*A-m*P,s[4]=o*P-h*A,s[5]=h*m-o*b,s[6]=m*E-y*A,s[7]=c*A-o*E,s[8]=o*y-c*m,s},p.asyncAll=Ys,p.bezier=bs,p.bindAll=ns,p.boundsAttributes=by,p.bufferConvexPolygon=function(s,i){const o=[];for(let c=0;c<s.length;c++){const h=ts(c-1,-1,s.length-1),m=ts(c+1,-1,s.length-1),y=s[c],b=s[m],A=s[h].sub(y).unit(),E=b.sub(y).unit(),P=E.angleWithSep(A.x,A.y),k=A.add(E).unit().mult(-1*i/Math.sin(P/2));o.push(y.add(k))}return o},p.cacheEntryPossiblyAdded=function(s){ue++,ue>Xl&&(s.getActor().send("enforceCacheSizeLimit",yl),ue=0)},p.calculateGlobeLabelMatrix=function(s,i){const{x:o,y:c}=s.point,h=Hm(o,c,s.worldSize/s._pixelsPerMercatorPixel,0,0);return kc(h,h,wh(ga(i)))},p.calculateGlobeMatrix=function(s){const{x:i,y:o}=s.point,{lng:c,lat:h}=s._center;return Hm(i,o,s.worldSize,c,h)},p.calculateGlobeMercatorMatrix=function(s){const i=s.pixelsPerMeter,o=i/jr(1,s.center.lat),c=Fs(new Float64Array(16));return od(c,c,[s.point.x,s.point.y,0]),Rc(c,c,[o,o,i]),Float32Array.from(c)},p.circumferenceAtLatitude=em,p.clamp=Zt,p.clearTileCache=function(s){const i=le(),o=[];for(const c in Ar)i&&o.push(i.delete(c)),delete Ar[c];s&&Promise.all(o).catch(s).then(()=>s())},p.clipLine=V0,p.clone=function(s){var i=new Sr(16);return i[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],i[4]=s[4],i[5]=s[5],i[6]=s[6],i[7]=s[7],i[8]=s[8],i[9]=s[9],i[10]=s[10],i[11]=s[11],i[12]=s[12],i[13]=s[13],i[14]=s[14],i[15]=s[15],i},p.clone$1=Hn,p.collisionCircleLayout=V_,p.config=bn,p.conjugate=function(s,i){return s[0]=-i[0],s[1]=-i[1],s[2]=-i[2],s[3]=i[3],s},p.create=function(){var s=new Sr(16);return Sr!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},p.create$1=Cp,p.createExpression=hc,p.createLayout=He,p.createStyleLayer=function(s){return"custom"===s.type?new dw(s):new Km[s.type](s)},p.cross=am,p.degToRad=ln,p.distance=function(s,i){return Math.hypot(i[0]-s[0],i[1]-s[1],i[2]-s[2])},p.div=function(s,i,o){return s[0]=i[0]/o[0],s[1]=i[1]/o[1],s[2]=i[2]/o[2],s},p.dot=Ns,p.ease=_o,p.easeCubicInOut=ql,p.emitValidationErrors=Gu,p.endsWith=yo,p.enforceCacheSizeLimit=function(s){for(const i in Ar)V(i),Ar[i].then(o=>{o.keys().then(c=>{for(let h=0;h<c.length-s;h++)o.delete(c[h])})})},p.evaluateSizeForFeature=fh,p.evaluateSizeForZoom=hd,p.evaluateVariableOffset=nf,p.evented=U,p.exactEquals=function(s,i){return s[0]===i[0]&&s[1]===i[1]&&s[2]===i[2]&&s[3]===i[3]},p.exactEquals$1=function(s,i){return s[0]===i[0]&&s[1]===i[1]&&s[2]===i[2]},p.exported=ko,p.exported$1=Ss,p.extend=ji,p.extend$1=Xr,p.fillExtrusionHeightLift=Up,p.filterObject=Qs,p.fromMat4=function(s,i){return s[0]=i[0],s[1]=i[1],s[2]=i[2],s[3]=i[4],s[4]=i[5],s[5]=i[6],s[6]=i[8],s[7]=i[9],s[8]=i[10],s},p.fromQuat=function(s,i){var o=i[0],c=i[1],h=i[2],m=i[3],y=o+o,b=c+c,A=h+h,E=o*y,P=c*y,k=c*b,R=h*y,B=h*b,N=h*A,q=m*y,Q=m*b,se=m*A;return s[0]=1-k-N,s[1]=P+se,s[2]=R-Q,s[3]=0,s[4]=P-se,s[5]=1-E-N,s[6]=B+q,s[7]=0,s[8]=R+Q,s[9]=B-q,s[10]=1-E-k,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},p.fromRotation=function(s,i){var o=Math.sin(i),c=Math.cos(i);return s[0]=c,s[1]=o,s[2]=0,s[3]=-o,s[4]=c,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},p.fromScaling=d_,p.furthestTileCorner=function(s){const i=Math.round((s+45+360)%360/90)%4;return mu[i]},p.getAABBPointSquareDist=function(s,i,o){let c=0;for(let h=0;h<2;++h){const m=o?o[h]:0;s[h]>m&&(c+=(s[h]-m)*(s[h]-m)),i[h]<m&&(c+=(m-i[h])*(m-i[h]))}return c},p.getAnchorAlignment=Rm,p.getAnchorJustification=rf,p.getBounds=function(s){let i=1/0,o=1/0,c=-1/0,h=-1/0;for(const m of s)i=Math.min(i,m.x),o=Math.min(o,m.y),c=Math.max(c,m.x),h=Math.max(h,m.y);return{min:new dt(i,o),max:new dt(c,h)}},p.getColumn=Es,p.getGridMatrix=function(s,i,o){const c=i.getNorth(),h=i.getSouth(),m=i.getWest(),y=.015625;return[0,(i.getEast()-m)*y,1<<s.z,(h-c)/Xc[o],0,s.y,c,m,y]},p.getImage=Nt,p.getJSON=function(s,i){return we(ji(s,{type:"json"}),i)},p.getLatitudinalLod=function(s){const i=80.051129;s=Zt(s,-80.051129,i)/i*90;const o=Math.pow(Math.abs(Math.sin(ln(s))),3);return Math.round(o*(Xc.length-1))},p.getMapSessionAPI=Au,p.getPerformanceMeasurement=Ts,p.getProjection=uf,p.getRTLTextPluginStatus=W,p.getReferrer=Ae,p.getTilePoint=function(s,{x:i,y:o},c=0){return new dt(((i-c)*s.scale-s.x)*zt,(o*s.scale-s.y)*zt)},p.getTileVec3=function(s,i,o=0){return ah(((i.x-o)*s.scale-s.x)*zt,(i.y*s.scale-s.y)*zt,Jt(i.z,i.y))},p.getVideo=function(s,i){const o=ot.document.createElement("video");o.muted=!0,o.onloadstart=function(){i(null,o)};for(let c=0;c<s.length;c++){const h=ot.document.createElement("source");Xe(s[c])||(o.crossOrigin="Anonymous"),h.src=s[c],o.appendChild(h)}return{cancel:()=>{}}},p.globeCenterToScreenPoint=function(s){const i=[0,0,0],o=Fs(new Float64Array(16));return kc(o,s.pixelMatrix,s.globeMatrix),Ai(i,i,o),new dt(i[0],i[1])},p.globeDenormalizeECEF=wh,p.globeECEFOrigin=function(s,i){const o=[0,0,0];return Ai(o,o,bh(ga(i.canonical))),Ai(o,o,s),o},p.globeNormalizeECEF=bh,p.globePixelsToTileUnits=function(s,i){return zt/(512*Math.pow(2,s))*xh(ga(i))},p.globePoleMatrixForTile=function(s,i,o){const c=Fs(new Float64Array(16)),h=(i/(1<<s)-.5)*Math.PI*2;return Ep(c,o.globeMatrix,h),Float32Array.from(c)},p.globeTileBounds=ga,p.globeTiltAtLngLat=ly,p.globeToMercatorTransition=Ch,p.globeUseCustomAntiAliasing=function(s,i,o){const c=Ch(o.zoom),h=s.style.map._antialias,m=!!i.extStandardDerivatives,y=i.extStandardDerivativesForceOff||s.terrain&&s.terrain.exaggeration()>0;return 0===c&&!h&&!y&&m},p.identity=Fs,p.identity$1=a0,p.invert=Ap,p.isFullscreen=function(){return!!ot.document.fullscreenElement||!!ot.document.webkitFullscreenElement},p.isLngLatBehindGlobe=function(s,i){return ly(s,i)>Math.PI/2*1.01},p.isMapAuthenticated=function(s){return Is.has(s)},p.isMapboxURL=ss,p.isSafariWithAntialiasingBug=function(s){const i=s.navigator?s.navigator.userAgent:null;return!!wi(s)&&i&&(i.match("Version/15.4")||i.match("Version/15.5")||i.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},p.latFromMercatorY=gr,p.len=g_,p.length=Tp,p.length$1=function(s){return Math.hypot(s[0],s[1],s[2],s[3])},p.loadVectorTile=Sy,p.makeRequest=we,p.mapValue=function(s,i,o,c,h){return Zt((s-i)/(o-i)*(h-c)+c,c,h)},p.mercatorScale=r_,p.mercatorXfromLng=Ls,p.mercatorYfromLat=Ha,p.mercatorZfromAltitude=jr,p.mul=Fl,p.mul$1=m_,p.multiply=kc,p.multiply$1=function(s,i,o){var c=i[0],h=i[1],m=i[2],y=i[3],b=i[4],A=i[5],E=i[6],P=i[7],k=i[8],R=o[0],B=o[1],N=o[2],q=o[3],Q=o[4],se=o[5],he=o[6],ae=o[7],de=o[8];return s[0]=R*c+B*y+N*E,s[1]=R*h+B*b+N*P,s[2]=R*m+B*A+N*k,s[3]=q*c+Q*y+se*E,s[4]=q*h+Q*b+se*P,s[5]=q*m+Q*A+se*k,s[6]=he*c+ae*y+de*E,s[7]=he*h+ae*b+de*P,s[8]=he*m+ae*A+de*k,s},p.multiply$2=o0,p.nextPowerOfTwo=hl,p.normalize=Vr,p.normalize$1=function(s,i){var o=i[0],c=i[1],h=i[2],m=i[3],y=o*o+c*c+h*h+m*m;return y>0&&(y=1/Math.sqrt(y)),s[0]=o*y,s[1]=c*y,s[2]=h*y,s[3]=m*y,s},p.number=_n,p.ortho=function(s,i,o,c,h,m,y){var b=1/(i-o),A=1/(c-h),E=1/(m-y);return s[0]=-2*b,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*A,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*E,s[11]=0,s[12]=(i+o)*b,s[13]=(h+c)*A,s[14]=(y+m)*E,s[15]=1,s},p.pbf=pd,p.perspective=function(s,i,o,c,h){var m,y=1/Math.tan(i/2);return s[0]=y/o,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=y,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,null!=h&&h!==1/0?(s[10]=(h+c)*(m=1/(c-h)),s[14]=2*h*c*m):(s[10]=-1,s[14]=-2*c),s},p.pick=function(s,i){const o={};for(let c=0;c<i.length;c++){const h=i[c];h in s&&(o[h]=s[h])}return o},p.plugin=K,p.pointGeometry=dt,p.polygonContainsPoint=id,p.polygonIntersectsBox=u_,p.polygonIntersectsPolygon=nm,p.polygonizeBounds=function(s,i,o=0,c=!0){const h=new dt(o,o),m=s.sub(h),y=i.add(h),b=[m,new dt(y.x,m.y),y,new dt(m.x,y.y)];return c&&b.push(m.clone()),b},p.posAttributes=vd,p.postMapLoadEvent=Wl,p.postTurnstileEvent=wu,p.potpack=js,p.prevPowerOfTwo=function(s){return s<=1?1:Math.pow(2,Math.floor(Math.log(s)/Math.LN2))},p.radToDeg=cr,p.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],p.registerForPluginStateChange=function(s){return s({pluginStatus:D,pluginURL:O}),U.on("pluginStateChange",s),s},p.removeAuthState=function(s){Is.delete(s)},p.renderColorRamp=ad,p.resample=o_,p.rotateX=om,p.rotateX$1=Dp,p.rotateY=Ep,p.rotateY$1=Ip,p.rotateZ=function(s,i,o){var c=Math.sin(o),h=Math.cos(o),m=i[0],y=i[1],b=i[2],A=i[3],E=i[4],P=i[5],k=i[6],R=i[7];return i!==s&&(s[8]=i[8],s[9]=i[9],s[10]=i[10],s[11]=i[11],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[0]=m*h+E*c,s[1]=y*h+P*c,s[2]=b*h+k*c,s[3]=A*h+R*c,s[4]=E*h-m*c,s[5]=P*h-y*c,s[6]=k*h-b*c,s[7]=R*h-A*c,s},p.rotateZ$1=function(s,i,o){o*=.5;var c=i[0],h=i[1],m=i[2],y=i[3],b=Math.sin(o),A=Math.cos(o);return s[0]=c*A+h*b,s[1]=h*A-c*b,s[2]=m*A+y*b,s[3]=y*A-m*b,s},p.scale=Rc,p.scale$1=cm,p.scale$2=Bs,p.scaleAndAdd=Sp,p.setCacheLimits=function(s,i){yl=s,Xl=i},p.setColumn=function(s,i,o){s[4*i+0]=o[0],s[4*i+1]=o[1],s[4*i+2]=o[2],s[4*i+3]=o[3]},p.setRTLTextPlugin=function(s,i,o=!1){if(D===g||D===x||D===C)throw new Error("setRTLTextPlugin cannot be called multiple times.");O=ko.resolveURL(s),D=g,M=i,F(),o||ne()},p.smoothstep=es,p.spec=Re,p.storeAuthState=function(s,i){i?Is.add(s):Is.delete(s)},p.sub=co,p.subtract=f_,p.symbolSize=I0,p.tileAABB=function(s,i,o,c,h,m,y,b,A){if("globe"===A.name)return function X0(s,i,o){const c=i/s.worldSize,h=Number.MAX_VALUE,m=[-h,-h,-h],y=[h,h,h],b=s.globeMatrix;if(o.z<=1)return ay(y,m,ga(o).getCorners(),b,c),new Ur(y,m);const A=Gr(o),E=$m(A);if(ay(y,m,E,b,c),A.contains(s.center)){m[2]=0;const De=s.point,Pe=[De.x*c,De.y*c,0];return Mp(y,y,Pe),sm(m,m,Pe),new Ur(y,m)}const P=[b[12]*c,b[13]*c,b[14]*c],k=A.getCenter(),R=Zt(s.center.lat,-85.051129,zs),B=Zt(k.lat,-85.051129,zs),N=Ls(s.center.lng),q=Ha(R);let Q=N-Ls(k.lng);const se=q-Ha(B);Q>.5?Q-=1:Q<-.5&&(Q+=1);let he=0;Math.abs(Q)>Math.abs(se)?he=Q>=0?1:3:(he=se>=0?0:2,Sp(P,P,[b[4]*c,b[5]*c,b[6]*c],-Math.sin(ln(se>=0?A.getSouth():A.getNorth()))*Vs));const ae=E[he],de=E[(he+1)%4],ye=new sy(ae,de,P),me=[of(ye,0)||ae[0],of(ye,1)||ae[1],of(ye,2)||ae[2]];return y[2]=Math.min(ae[2],de[2]),Mp(y,y,me),sm(m,m,me),new Ur(y,m)}(s,i,new $p(o,c,h));const E=Qc({z:o,x:c,y:h},A);return new Ur([(m+E.x/E.scale)*i,i*(E.y/E.scale),y],[(m+E.x2/E.scale)*i,i*(E.y2/E.scale),b])},p.tileCornersToBounds=Gr,p.tileTransform=Qc,p.transformMat3=function(s,i,o){var c=i[0],h=i[1],m=i[2];return s[0]=c*o[0]+h*o[3]+m*o[6],s[1]=c*o[1]+h*o[4]+m*o[7],s[2]=c*o[2]+h*o[5]+m*o[8],s},p.transformMat4=Ai,p.transformMat4$1=sd,p.transformQuat=lm,p.transitionTileAABBinECEF=Um,p.translate=od,p.transpose=function(s,i){if(s===i){var o=i[1],c=i[2],h=i[5];s[1]=i[3],s[2]=i[6],s[3]=o,s[5]=i[7],s[6]=c,s[7]=h}else s[0]=i[0],s[1]=i[3],s[2]=i[6],s[3]=i[1],s[4]=i[4],s[5]=i[7],s[6]=i[2],s[7]=i[5],s[8]=i[8];return s},p.triggerPluginCompletionEvent=z,p.uniqueId=ws,p.updateGlobeVertexNormal=function(s,i,o,c,h){const m=5*i+2;s.float32[m+0]=o,s.float32[m+1]=c,s.float32[m+2]=h},p.validateCustomStyleLayer=function(s){const i=[],o=s.id;return void 0===o&&i.push({message:`layers.${o}: missing required property "id"`}),void 0===s.render&&i.push({message:`layers.${o}: missing required method "render"`}),s.renderingMode&&"2d"!==s.renderingMode&&"3d"!==s.renderingMode&&i.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),i},p.validateFilter=s=>Gt(oi(s)),p.validateFog=s=>Gt(Nr(s)),p.validateLayer=s=>Gt(Kd(s)),p.validateLight=s=>Gt(Vu(s)),p.validateSource=s=>Gt(ap(s)),p.validateStyle=No,p.validateTerrain=s=>Gt(Rs(s)),p.values=Xs,p.vectorTile=Wa,p.version="2.10.0",p.warnOnce=vi,p.window=ot,p.wrap=ts}),Fd(0,function(p){function ot(le){if("number"==typeof le||"boolean"==typeof le||"string"==typeof le||null==le)return JSON.stringify(le);if(Array.isArray(le)){let H="[";for(const oe of le)H+=`${ot(oe)},`;return`${H}]`}let V="{";for(const H of Object.keys(le).sort())V+=`${H}:${ot(le[H])},`;return`${V}}`}function Ws(le){let V="";for(const H of p.refProperties)V+=`/${ot(le[H])}`;return V}class kr{constructor(V){this.keyCache={},V&&this.replace(V)}replace(V){this._layerConfigs={},this._layers={},this.update(V,[])}update(V,H){for(const ue of V)this._layerConfigs[ue.id]=ue,(this._layers[ue.id]=p.createStyleLayer(ue)).compileFilter(),this.keyCache[ue.id]&&delete this.keyCache[ue.id];for(const ue of H)delete this.keyCache[ue],delete this._layerConfigs[ue],delete this._layers[ue];this.familiesBySource={};const oe=function(ue,be){const Te={};for(let we=0;we<ue.length;we++){const Me=be&&be[ue[we].id]||Ws(ue[we]);be&&(be[ue[we].id]=Me);let Ye=Te[Me];Ye||(Ye=Te[Me]=[]),Ye.push(ue[we])}const Ae=[];for(const we in Te)Ae.push(Te[we]);return Ae}(p.values(this._layerConfigs),this.keyCache);for(const ue of oe){const be=ue.map(st=>this._layers[st.id]),Te=be[0];if("none"===Te.visibility)continue;const Ae=Te.source||"";let we=this.familiesBySource[Ae];we||(we=this.familiesBySource[Ae]={});const Me=Te.sourceLayer||"_geojsonTileLayer";let Ye=we[Me];Ye||(Ye=we[Me]=[]),Ye.push(be)}}}class dt{loadTile(V,H){const{uid:oe,encoding:ue,rawImageData:be,padding:Te,buildQuadTree:Ae}=V,we=p.window.ImageBitmap&&be instanceof p.window.ImageBitmap?this.getImageData(be,Te):be;H(null,new p.DEMData(oe,we,ue,Te<1,Ae))}getImageData(V,H){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(V.width,V.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=V.width,this.offscreenCanvas.height=V.height,this.offscreenCanvasContext.drawImage(V,0,0,V.width,V.height);const oe=this.offscreenCanvasContext.getImageData(-H,-H,V.width+2*H,V.height+2*H);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),oe}}var Qt=function le(V,H){var oe,ue=V&&V.type;if("FeatureCollection"===ue)for(oe=0;oe<V.features.length;oe++)le(V.features[oe],H);else if("GeometryCollection"===ue)for(oe=0;oe<V.geometries.length;oe++)le(V.geometries[oe],H);else if("Feature"===ue)le(V.geometry,H);else if("Polygon"===ue)Cr(V.coordinates,H);else if("MultiPolygon"===ue)for(oe=0;oe<V.coordinates.length;oe++)Cr(V.coordinates[oe],H);return V};function Cr(le,V){if(0!==le.length){Oo(le[0],V);for(var H=1;H<le.length;H++)Oo(le[H],!V)}}function Oo(le,V){for(var H=0,oe=0,ue=0,be=le.length,Te=be-1;ue<be;Te=ue++){var Ae=(le[ue][0]-le[Te][0])*(le[Te][1]+le[ue][1]),we=H+Ae;oe+=Math.abs(H)>=Math.abs(Ae)?H-we+Ae:Ae-we+H,H=we}H+oe>=0!=!!V&&le.reverse()}const ln=p.vectorTile.VectorTileFeature.prototype.toGeoJSON;class cr{constructor(V){this._feature=V,this.extent=p.EXTENT,this.type=V.type,this.properties=V.tags,"id"in V&&!isNaN(V.id)&&(this.id=parseInt(V.id,10))}loadGeometry(){if(1===this._feature.type){const V=[];for(const H of this._feature.geometry)V.push([new p.pointGeometry(H[0],H[1])]);return V}{const V=[];for(const H of this._feature.geometry){const oe=[];for(const ue of H)oe.push(new p.pointGeometry(ue[0],ue[1]));V.push(oe)}return V}}toGeoJSON(V,H,oe){return ln.call(this,V,H,oe)}}class mu{constructor(V){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=p.EXTENT,this.length=V.length,this._features=V}feature(V){return new cr(this._features[V])}}var ql=p.vectorTile.VectorTileFeature,bs=_o;function _o(le,V){this.options=V||{},this.features=le,this.length=le.length}function Zt(le,V){this.id="number"==typeof le.id?le.id:void 0,this.type=le.type,this.rawGeometry=1===le.type?[le.geometry]:le.geometry,this.properties=le.tags,this.extent=V||4096}_o.prototype.feature=function(le){return new Zt(this.features[le],this.options.extent)},Zt.prototype.loadGeometry=function(){var le=this.rawGeometry;this.geometry=[];for(var V=0;V<le.length;V++){for(var H=le[V],oe=[],ue=0;ue<H.length;ue++)oe.push(new p.pointGeometry(H[ue][0],H[ue][1]));this.geometry.push(oe)}return this.geometry},Zt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var le=this.geometry,V=1/0,H=-1/0,oe=1/0,ue=-1/0,be=0;be<le.length;be++)for(var Te=le[be],Ae=0;Ae<Te.length;Ae++){var we=Te[Ae];V=Math.min(V,we.x),H=Math.max(H,we.x),oe=Math.min(oe,we.y),ue=Math.max(ue,we.y)}return[V,oe,H,ue]},Zt.prototype.toGeoJSON=ql.prototype.toGeoJSON;var es=Ys,ts=bs;function Ys(le){var V=new p.pbf;return function(H,oe){for(var ue in H.layers)oe.writeMessage(3,Xs,H.layers[ue])}(le,V),V.finish()}function Xs(le,V){var H;V.writeVarintField(15,le.version||1),V.writeStringField(1,le.name||""),V.writeVarintField(5,le.extent||4096);var oe={keys:[],values:[],keycache:{},valuecache:{}};for(H=0;H<le.length;H++)oe.feature=le.feature(H),V.writeMessage(2,ji,oe);var ue=oe.keys;for(H=0;H<ue.length;H++)V.writeStringField(3,ue[H]);var be=oe.values;for(H=0;H<be.length;H++)V.writeMessage(4,gu,be[H])}function ji(le,V){var H=le.feature;void 0!==H.id&&V.writeVarintField(1,H.id),V.writeMessage(2,Ma,le),V.writeVarintField(3,H.type),V.writeMessage(4,hl,H)}function Ma(le,V){var H=le.feature,oe=le.keys,ue=le.values,be=le.keycache,Te=le.valuecache;for(var Ae in H.properties){var we=H.properties[Ae],Me=be[Ae];if(null!==we){void 0===Me&&(oe.push(Ae),be[Ae]=Me=oe.length-1),V.writeVarint(Me);var Ye=typeof we;"string"!==Ye&&"boolean"!==Ye&&"number"!==Ye&&(we=JSON.stringify(we));var st=Ye+":"+we,Xe=Te[st];void 0===Xe&&(ue.push(we),Te[st]=Xe=ue.length-1),V.writeVarint(Xe)}}}function ws(le,V){return(V<<3)+(7&le)}function dl(le){return le<<1^le>>31}function hl(le,V){for(var H=le.loadGeometry(),oe=le.type,ue=0,be=0,Te=H.length,Ae=0;Ae<Te;Ae++){var we=H[Ae],Me=1;1===oe&&(Me=we.length),V.writeVarint(ws(1,Me));for(var Ye=3===oe?we.length-1:we.length,st=0;st<Ye;st++){1===st&&1!==oe&&V.writeVarint(ws(2,Ye-1));var Xe=we[st].x-ue,St=we[st].y-be;V.writeVarint(dl(Xe)),V.writeVarint(dl(St)),ue+=Xe,be+=St}3===oe&&V.writeVarint(ws(7,1))}}function gu(le,V){var H=typeof le;"string"===H?V.writeStringField(1,le):"boolean"===H?V.writeBooleanField(7,le):"number"===H&&(le%1!=0?V.writeDoubleField(3,le):le<0?V.writeSVarintField(6,le):V.writeVarintField(5,le))}function ns(le,V,H,oe,ue,be){if(ue-oe<=H)return;const Te=oe+ue>>1;yo(le,V,Te,oe,ue,be%2),ns(le,V,H,oe,Te-1,be+1),ns(le,V,H,Te+1,ue,be+1)}function yo(le,V,H,oe,ue,be){for(;ue>oe;){if(ue-oe>600){const Me=ue-oe+1,Ye=H-oe+1,st=Math.log(Me),Xe=.5*Math.exp(2*st/3),St=.5*Math.sqrt(st*Xe*(Me-Xe)/Me)*(Ye-Me/2<0?-1:1);yo(le,V,H,Math.max(oe,Math.floor(H-Ye*Xe/Me+St)),Math.min(ue,Math.floor(H+(Me-Ye)*Xe/Me+St)),be)}const Te=V[2*H+be];let Ae=oe,we=ue;for(Cs(le,V,oe,H),V[2*ue+be]>Te&&Cs(le,V,oe,ue);Ae<we;){for(Cs(le,V,Ae,we),Ae++,we--;V[2*Ae+be]<Te;)Ae++;for(;V[2*we+be]>Te;)we--}V[2*oe+be]===Te?Cs(le,V,oe,we):(we++,Cs(le,V,we,ue)),we<=H&&(oe=we+1),H<=we&&(ue=we-1)}}function Cs(le,V,H,oe){Qs(le,H,oe),Qs(V,2*H,2*oe),Qs(V,2*H+1,2*oe+1)}function Qs(le,V,H){const oe=le[V];le[V]=le[H],le[H]=oe}function Hn(le,V,H,oe){const ue=le-H,be=V-oe;return ue*ue+be*be}es.fromVectorTileJs=Ys,es.fromGeojsonVt=function(le,V){V=V||{};var H={};for(var oe in le)H[oe]=new bs(le[oe].features,V),H[oe].name=oe,H[oe].version=V.version,H[oe].extent=V.extent;return Ys({layers:H})},es.GeoJSONWrapper=ts;const pl=le=>le[0],vi=le=>le[1];class ur{constructor(V,H=pl,oe=vi,ue=64,be=Float64Array){this.nodeSize=ue,this.points=V;const Te=V.length<65536?Uint16Array:Uint32Array,Ae=this.ids=new Te(V.length),we=this.coords=new be(2*V.length);for(let Me=0;Me<V.length;Me++)Ae[Me]=Me,we[2*Me]=H(V[Me]),we[2*Me+1]=oe(V[Me]);ns(Ae,we,ue,0,Ae.length-1,0)}range(V,H,oe,ue){return function(be,Te,Ae,we,Me,Ye,st){const Xe=[0,be.length-1,0],St=[];let Ft,Pt;for(;Xe.length;){const Nt=Xe.pop(),tn=Xe.pop(),Ln=Xe.pop();if(tn-Ln<=st){for(let Rt=Ln;Rt<=tn;Rt++)Ft=Te[2*Rt],Pt=Te[2*Rt+1],Ft>=Ae&&Ft<=Me&&Pt>=we&&Pt<=Ye&&St.push(be[Rt]);continue}const Mn=Math.floor((Ln+tn)/2);Ft=Te[2*Mn],Pt=Te[2*Mn+1],Ft>=Ae&&Ft<=Me&&Pt>=we&&Pt<=Ye&&St.push(be[Mn]);const zn=(Nt+1)%2;(0===Nt?Ae<=Ft:we<=Pt)&&(Xe.push(Ln),Xe.push(Mn-1),Xe.push(zn)),(0===Nt?Me>=Ft:Ye>=Pt)&&(Xe.push(Mn+1),Xe.push(tn),Xe.push(zn))}return St}(this.ids,this.coords,V,H,oe,ue,this.nodeSize)}within(V,H,oe){return function(ue,be,Te,Ae,we,Me){const Ye=[0,ue.length-1,0],st=[],Xe=we*we;for(;Ye.length;){const St=Ye.pop(),Ft=Ye.pop(),Pt=Ye.pop();if(Ft-Pt<=Me){for(let zn=Pt;zn<=Ft;zn++)Hn(be[2*zn],be[2*zn+1],Te,Ae)<=Xe&&st.push(ue[zn]);continue}const Nt=Math.floor((Pt+Ft)/2),tn=be[2*Nt],Ln=be[2*Nt+1];Hn(tn,Ln,Te,Ae)<=Xe&&st.push(ue[Nt]);const Mn=(St+1)%2;(0===St?Te-we<=tn:Ae-we<=Ln)&&(Ye.push(Pt),Ye.push(Nt-1),Ye.push(Mn)),(0===St?Te+we>=tn:Ae+we>=Ln)&&(Ye.push(Nt+1),Ye.push(Ft),Ye.push(Mn))}return st}(this.ids,this.coords,V,H,oe,this.nodeSize)}}const As={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:le=>le},bi=Math.fround||(is=new Float32Array(1),le=>(is[0]=+le,is[0]));var is;class rs{constructor(V){this.options=Ks(Object.create(As),V),this.trees=new Array(this.options.maxZoom+1)}load(V){const{log:H,minZoom:oe,maxZoom:ue,nodeSize:be}=this.options;H&&console.time("total time");const Te=`prepare ${V.length} points`;H&&console.time(Te),this.points=V;let Ae=[];for(let we=0;we<V.length;we++)V[we].geometry&&Ae.push(Mi(V[we],we));this.trees[ue+1]=new ur(Ae,ml,Ms,be,Float32Array),H&&console.timeEnd(Te);for(let we=ue;we>=oe;we--){const Me=+Date.now();Ae=this._cluster(Ae,we),this.trees[we]=new ur(Ae,ml,Ms,be,Float32Array),H&&console.log("z%d: %d clusters in %dms",we,Ae.length,+Date.now()-Me)}return H&&console.timeEnd("total time"),this}getClusters(V,H){let oe=((V[0]+180)%360+360)%360-180;const ue=Math.max(-90,Math.min(90,V[1]));let be=180===V[2]?180:((V[2]+180)%360+360)%360-180;const Te=Math.max(-90,Math.min(90,V[3]));if(V[2]-V[0]>=360)oe=-180,be=180;else if(oe>be){const Ye=this.getClusters([oe,ue,180,Te],H),st=this.getClusters([-180,ue,be,Te],H);return Ye.concat(st)}const Ae=this.trees[this._limitZoom(H)],we=Ae.range(Ts(oe),fl(Te),Ts(be),fl(ue)),Me=[];for(const Ye of we){const st=Ae.points[Ye];Me.push(st.numPoints?Es(st):this.points[st.index])}return Me}getChildren(V){const H=this._getOriginId(V),oe=this._getOriginZoom(V),ue="No cluster with the specified id.",be=this.trees[oe];if(!be)throw new Error(ue);const Te=be.points[H];if(!Te)throw new Error(ue);const Ae=this.options.radius/(this.options.extent*Math.pow(2,oe-1)),we=be.within(Te.x,Te.y,Ae),Me=[];for(const Ye of we){const st=be.points[Ye];st.parentId===V&&Me.push(st.numPoints?Es(st):this.points[st.index])}if(0===Me.length)throw new Error(ue);return Me}getLeaves(V,H,oe){const ue=[];return this._appendLeaves(ue,V,H=H||10,oe=oe||0,0),ue}getTile(V,H,oe){const ue=this.trees[this._limitZoom(V)],be=Math.pow(2,V),{extent:Te,radius:Ae}=this.options,we=Ae/Te,Me=(oe-we)/be,Ye=(oe+1+we)/be,st={features:[]};return this._addTileFeatures(ue.range((H-we)/be,Me,(H+1+we)/be,Ye),ue.points,H,oe,be,st),0===H&&this._addTileFeatures(ue.range(1-we/be,Me,1,Ye),ue.points,be,oe,be,st),H===be-1&&this._addTileFeatures(ue.range(0,Me,we/be,Ye),ue.points,-1,oe,be,st),st.features.length?st:null}getClusterExpansionZoom(V){let H=this._getOriginZoom(V)-1;for(;H<=this.options.maxZoom;){const oe=this.getChildren(V);if(H++,1!==oe.length)break;V=oe[0].properties.cluster_id}return H}_appendLeaves(V,H,oe,ue,be){const Te=this.getChildren(H);for(const Ae of Te){const we=Ae.properties;if(we&&we.cluster?be+we.point_count<=ue?be+=we.point_count:be=this._appendLeaves(V,we.cluster_id,oe,ue,be):be<ue?be++:V.push(Ae),V.length===oe)break}return be}_addTileFeatures(V,H,oe,ue,be,Te){for(const Ae of V){const we=H[Ae],Me=we.numPoints;let Ye,st,Xe;if(Me)Ye=Qn(we),st=we.x,Xe=we.y;else{const Pt=this.points[we.index];Ye=Pt.properties,st=Ts(Pt.geometry.coordinates[0]),Xe=fl(Pt.geometry.coordinates[1])}const St={type:1,geometry:[[Math.round(this.options.extent*(st*be-oe)),Math.round(this.options.extent*(Xe*be-ue))]],tags:Ye};let Ft;Me?Ft=we.id:this.options.generateId?Ft=we.index:this.points[we.index].id&&(Ft=this.points[we.index].id),void 0!==Ft&&(St.id=Ft),Te.features.push(St)}}_limitZoom(V){return Math.max(this.options.minZoom,Math.min(+V,this.options.maxZoom+1))}_cluster(V,H){const oe=[],{radius:ue,extent:be,reduce:Te,minPoints:Ae}=this.options,we=ue/(be*Math.pow(2,H));for(let Me=0;Me<V.length;Me++){const Ye=V[Me];if(Ye.zoom<=H)continue;Ye.zoom=H;const st=this.trees[H+1],Xe=st.within(Ye.x,Ye.y,we),St=Ye.numPoints||1;let Ft=St;for(const Pt of Xe){const Nt=st.points[Pt];Nt.zoom>H&&(Ft+=Nt.numPoints||1)}if(Ft>St&&Ft>=Ae){let Pt=Ye.x*St,Nt=Ye.y*St,tn=Te&&St>1?this._map(Ye,!0):null;const Ln=(Me<<5)+(H+1)+this.points.length;for(const Mn of Xe){const zn=st.points[Mn];if(zn.zoom<=H)continue;zn.zoom=H;const Rt=zn.numPoints||1;Pt+=zn.x*Rt,Nt+=zn.y*Rt,zn.parentId=Ln,Te&&(tn||(tn=this._map(Ye,!0)),Te(tn,this._map(zn)))}Ye.parentId=Ln,oe.push(wi(Pt/Ft,Nt/Ft,Ln,Ft,tn))}else if(oe.push(Ye),Ft>1)for(const Pt of Xe){const Nt=st.points[Pt];Nt.zoom<=H||(Nt.zoom=H,oe.push(Nt))}}return oe}_getOriginId(V){return V-this.points.length>>5}_getOriginZoom(V){return(V-this.points.length)%32}_map(V,H){if(V.numPoints)return H?Ks({},V.properties):V.properties;const oe=this.points[V.index].properties,ue=this.options.map(oe);return H&&ue===oe?Ks({},ue):ue}}function wi(le,V,H,oe,ue){return{x:bi(le),y:bi(V),zoom:1/0,id:H,parentId:-1,numPoints:oe,properties:ue}}function Mi(le,V){const[H,oe]=le.geometry.coordinates;return{x:bi(Ts(H)),y:bi(fl(oe)),zoom:1/0,index:V,parentId:-1}}function Es(le){return{type:"Feature",id:le.id,properties:Qn(le),geometry:{type:"Point",coordinates:[(V=le.x,360*(V-.5)),xn(le.y)]}};var V}function Qn(le){const V=le.numPoints,H=V>=1e4?`${Math.round(V/1e3)}k`:V>=1e3?Math.round(V/100)/10+"k":V;return Ks(Ks({},le.properties),{cluster:!0,cluster_id:le.id,point_count:V,point_count_abbreviated:H})}function Ts(le){return le/360+.5}function fl(le){const V=Math.sin(le*Math.PI/180),H=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return H<0?0:H>1?1:H}function xn(le){const V=(180-360*le)*Math.PI/180;return 360*Math.atan(Math.exp(V))/Math.PI-90}function Ks(le,V){for(const H in V)le[H]=V[H];return le}function ml(le){return le.x}function Ms(le){return le.y}function ko(le,V,H,oe){for(var ue,be=oe,Te=H-V>>1,Ae=H-V,we=le[V],Me=le[V+1],Ye=le[H],st=le[H+1],Xe=V+3;Xe<H;Xe+=3){var St=gl(le[Xe],le[Xe+1],we,Me,Ye,st);if(St>be)ue=Xe,be=St;else if(St===be){var Ft=Math.abs(Xe-Te);Ft<Ae&&(ue=Xe,Ae=Ft)}}be>oe&&(ue-V>3&&ko(le,V,ue,oe),le[ue+2]=be,H-ue>3&&ko(le,ue,H,oe))}function gl(le,V,H,oe,ue,be){var Te=ue-H,Ae=be-oe;if(0!==Te||0!==Ae){var we=((le-H)*Te+(V-oe)*Ae)/(Te*Te+Ae*Ae);we>1?(H=ue,oe=be):we>0&&(H+=Te*we,oe+=Ae*we)}return(Te=le-H)*Te+(Ae=V-oe)*Ae}function bn(le,V,H,oe){var ue={id:void 0===le?null:le,type:V,geometry:H,tags:oe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(be){var Te=be.geometry,Ae=be.type;if("Point"===Ae||"MultiPoint"===Ae||"LineString"===Ae)Ss(be,Te);else if("Polygon"===Ae||"MultiLineString"===Ae)for(var we=0;we<Te.length;we++)Ss(be,Te[we]);else if("MultiPolygon"===Ae)for(we=0;we<Te.length;we++)for(var Me=0;Me<Te[we].length;Me++)Ss(be,Te[we][Me])}(ue),ue}function Ss(le,V){for(var H=0;H<V.length;H+=3)le.minX=Math.min(le.minX,V[H]),le.minY=Math.min(le.minY,V[H+1]),le.maxX=Math.max(le.maxX,V[H]),le.maxY=Math.max(le.maxY,V[H+1])}function Js(le,V,H,oe){if(V.geometry){var ue=V.geometry.coordinates,be=V.geometry.type,Te=Math.pow(H.tolerance/((1<<H.maxZoom)*H.extent),2),Ae=[],we=V.id;if(H.promoteId?we=V.properties[H.promoteId]:H.generateId&&(we=oe||0),"Point"===be)os(ue,Ae);else if("MultiPoint"===be)for(var Me=0;Me<ue.length;Me++)os(ue[Me],Ae);else if("LineString"===be)Sa(ue,Ae,Te,!1);else if("MultiLineString"===be){if(H.lineMetrics){for(Me=0;Me<ue.length;Me++)Sa(ue[Me],Ae=[],Te,!1),le.push(bn(we,"LineString",Ae,V.properties));return}Zl(ue,Ae,Te,!1)}else if("Polygon"===be)Zl(ue,Ae,Te,!0);else{if("MultiPolygon"!==be){if("GeometryCollection"===be){for(Me=0;Me<V.geometry.geometries.length;Me++)Js(le,{id:we,geometry:V.geometry.geometries[Me],properties:V.properties},H,oe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Me=0;Me<ue.length;Me++){var Ye=[];Zl(ue[Me],Ye,Te,!0),Ae.push(Ye)}}le.push(bn(we,be,Ae,V.properties))}}function os(le,V){V.push(_u(le[0])),V.push(yu(le[1])),V.push(0)}function Sa(le,V,H,oe){for(var ue,be,Te=0,Ae=0;Ae<le.length;Ae++){var we=_u(le[Ae][0]),Me=yu(le[Ae][1]);V.push(we),V.push(Me),V.push(0),Ae>0&&(Te+=oe?(ue*Me-we*be)/2:Math.sqrt(Math.pow(we-ue,2)+Math.pow(Me-be,2))),ue=we,be=Me}var Ye=V.length-3;V[2]=1,ko(V,0,Ye,H),V[Ye+2]=1,V.size=Math.abs(Te),V.start=0,V.end=V.size}function Zl(le,V,H,oe){for(var ue=0;ue<le.length;ue++){var be=[];Sa(le[ue],be,H,oe),V.push(be)}}function _u(le){return le/360+.5}function yu(le){var V=Math.sin(le*Math.PI/180),H=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return H<0?0:H>1?1:H}function Vi(le,V,H,oe,ue,be,Te,Ae){if(oe/=V,be>=(H/=V)&&Te<oe)return le;if(Te<H||be>=oe)return null;for(var we=[],Me=0;Me<le.length;Me++){var Ye=le[Me],st=Ye.geometry,Xe=Ye.type,St=0===ue?Ye.minX:Ye.minY,Ft=0===ue?Ye.maxX:Ye.maxY;if(St>=H&&Ft<oe)we.push(Ye);else if(!(Ft<H||St>=oe)){var Pt=[];if("Point"===Xe||"MultiPoint"===Xe)ss(st,Pt,H,oe,ue);else if("LineString"===Xe)_l(st,Pt,H,oe,ue,!1,Ae.lineMetrics);else if("MultiLineString"===Xe)vo(st,Pt,H,oe,ue,!1);else if("Polygon"===Xe)vo(st,Pt,H,oe,ue,!0);else if("MultiPolygon"===Xe)for(var Nt=0;Nt<st.length;Nt++){var tn=[];vo(st[Nt],tn,H,oe,ue,!0),tn.length&&Pt.push(tn)}if(Pt.length){if(Ae.lineMetrics&&"LineString"===Xe){for(Nt=0;Nt<Pt.length;Nt++)we.push(bn(Ye.id,Xe,Pt[Nt],Ye.tags));continue}"LineString"!==Xe&&"MultiLineString"!==Xe||(1===Pt.length?(Xe="LineString",Pt=Pt[0]):Xe="MultiLineString"),"Point"!==Xe&&"MultiPoint"!==Xe||(Xe=3===Pt.length?"Point":"MultiPoint"),we.push(bn(Ye.id,Xe,Pt,Ye.tags))}}}return we.length?we:null}function ss(le,V,H,oe,ue){for(var be=0;be<le.length;be+=3){var Te=le[be+ue];Te>=H&&Te<=oe&&(V.push(le[be]),V.push(le[be+1]),V.push(le[be+2]))}}function _l(le,V,H,oe,ue,be,Te){for(var Ae,we,Me=vu(le),Ye=0===ue?Bd:xu,st=le.start,Xe=0;Xe<le.length-3;Xe+=3){var St=le[Xe],Ft=le[Xe+1],Pt=le[Xe+2],Nt=le[Xe+3],tn=le[Xe+4],Ln=0===ue?St:Ft,Mn=0===ue?Nt:tn,zn=!1;Te&&(Ae=Math.sqrt(Math.pow(St-Nt,2)+Math.pow(Ft-tn,2))),Ln<H?Mn>H&&(we=Ye(Me,St,Ft,Nt,tn,H),Te&&(Me.start=st+Ae*we)):Ln>oe?Mn<oe&&(we=Ye(Me,St,Ft,Nt,tn,oe),Te&&(Me.start=st+Ae*we)):Ds(Me,St,Ft,Pt),Mn<H&&Ln>=H&&(we=Ye(Me,St,Ft,Nt,tn,H),zn=!0),Mn>oe&&Ln<=oe&&(we=Ye(Me,St,Ft,Nt,tn,oe),zn=!0),!be&&zn&&(Te&&(Me.end=st+Ae*we),V.push(Me),Me=vu(le)),Te&&(st+=Ae)}var Rt=le.length-3;St=le[Rt],Ft=le[Rt+1],Pt=le[Rt+2],(Ln=0===ue?St:Ft)>=H&&Ln<=oe&&Ds(Me,St,Ft,Pt),Rt=Me.length-3,be&&Rt>=3&&(Me[Rt]!==Me[0]||Me[Rt+1]!==Me[1])&&Ds(Me,Me[0],Me[1],Me[2]),Me.length&&V.push(Me)}function vu(le){var V=[];return V.size=le.size,V.start=le.start,V.end=le.end,V}function vo(le,V,H,oe,ue,be){for(var Te=0;Te<le.length;Te++)_l(le[Te],V,H,oe,ue,be,!1)}function Ds(le,V,H,oe){le.push(V),le.push(H),le.push(oe)}function Bd(le,V,H,oe,ue,be){var Te=(be-V)/(oe-V);return le.push(be),le.push(H+(ue-H)*Te),le.push(1),Te}function xu(le,V,H,oe,ue,be){var Te=(be-H)/(ue-H);return le.push(V+(oe-V)*Te),le.push(be),le.push(1),Te}function bu(le,V){for(var H=[],oe=0;oe<le.length;oe++){var ue,be=le[oe],Te=be.type;if("Point"===Te||"MultiPoint"===Te||"LineString"===Te)ue=wu(be.geometry,V);else if("MultiLineString"===Te||"Polygon"===Te){ue=[];for(var Ae=0;Ae<be.geometry.length;Ae++)ue.push(wu(be.geometry[Ae],V))}else if("MultiPolygon"===Te)for(ue=[],Ae=0;Ae<be.geometry.length;Ae++){for(var we=[],Me=0;Me<be.geometry[Ae].length;Me++)we.push(wu(be.geometry[Ae][Me],V));ue.push(we)}H.push(bn(be.id,Te,ue,be.tags))}return H}function wu(le,V){var H=[];H.size=le.size,void 0!==le.start&&(H.start=le.start,H.end=le.end);for(var oe=0;oe<le.length;oe+=3)H.push(le[oe]+V,le[oe+1],le[oe+2]);return H}function Cu(le,V){if(le.transformed)return le;var H,oe,ue,be=1<<le.z,Te=le.x,Ae=le.y;for(H=0;H<le.features.length;H++){var we=le.features[H],Me=we.geometry,Ye=we.type;if(we.geometry=[],1===Ye)for(oe=0;oe<Me.length;oe+=2)we.geometry.push(Wl(Me[oe],Me[oe+1],V,be,Te,Ae));else for(oe=0;oe<Me.length;oe++){var st=[];for(ue=0;ue<Me[oe].length;ue+=2)st.push(Wl(Me[oe][ue],Me[oe][ue+1],V,be,Te,Ae));we.geometry.push(st)}}return le.transformed=!0,le}function Wl(le,V,H,oe,ue,be){return[Math.round(H*(le*oe-ue)),Math.round(H*(V*oe-be))]}function Yl(le,V,H,oe,ue){for(var be=V===ue.maxZoom?0:ue.tolerance/((1<<V)*ue.extent),Te={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:H,y:oe,z:V,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ae=0;Ae<le.length;Ae++){Te.numFeatures++,Au(Te,le[Ae],be,ue);var we=le[Ae].minX,Me=le[Ae].minY,Ye=le[Ae].maxX,st=le[Ae].maxY;we<Te.minX&&(Te.minX=we),Me<Te.minY&&(Te.minY=Me),Ye>Te.maxX&&(Te.maxX=Ye),st>Te.maxY&&(Te.maxY=st)}return Te}function Au(le,V,H,oe){var ue=V.geometry,be=V.type,Te=[];if("Point"===be||"MultiPoint"===be)for(var Ae=0;Ae<ue.length;Ae+=3)Te.push(ue[Ae]),Te.push(ue[Ae+1]),le.numPoints++,le.numSimplified++;else if("LineString"===be)Is(Te,ue,le,H,!1,!1);else if("MultiLineString"===be||"Polygon"===be)for(Ae=0;Ae<ue.length;Ae++)Is(Te,ue[Ae],le,H,"Polygon"===be,0===Ae);else if("MultiPolygon"===be)for(var we=0;we<ue.length;we++){var Me=ue[we];for(Ae=0;Ae<Me.length;Ae++)Is(Te,Me[Ae],le,H,!0,0===Ae)}if(Te.length){var Ye=V.tags||null;if("LineString"===be&&oe.lineMetrics){for(var st in Ye={},V.tags)Ye[st]=V.tags[st];Ye.mapbox_clip_start=ue.start/ue.size,Ye.mapbox_clip_end=ue.end/ue.size}var Xe={geometry:Te,type:"Polygon"===be||"MultiPolygon"===be?3:"LineString"===be||"MultiLineString"===be?2:1,tags:Ye};null!==V.id&&(Xe.id=V.id),le.features.push(Xe)}}function Is(le,V,H,oe,ue,be){var Te=oe*oe;if(oe>0&&V.size<(ue?Te:oe))H.numPoints+=V.length/3;else{for(var Ae=[],we=0;we<V.length;we+=3)(0===oe||V[we+2]>Te)&&(H.numSimplified++,Ae.push(V[we]),Ae.push(V[we+1])),H.numPoints++;ue&&function(Me,Ye){for(var st=0,Xe=0,St=Me.length,Ft=St-2;Xe<St;Ft=Xe,Xe+=2)st+=(Me[Xe]-Me[Ft])*(Me[Xe+1]+Me[Ft+1]);if(st>0===Ye)for(Xe=0,St=Me.length;Xe<St/2;Xe+=2){var Pt=Me[Xe],Nt=Me[Xe+1];Me[Xe]=Me[St-2-Xe],Me[Xe+1]=Me[St-1-Xe],Me[St-2-Xe]=Pt,Me[St-1-Xe]=Nt}}(Ae,be),le.push(Ae)}}function as(le,V){var H=(V=this.options=function(ue,be){for(var Te in be)ue[Te]=be[Te];return ue}(Object.create(this.options),V)).debug;if(H&&console.time("preprocess data"),V.maxZoom<0||V.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(V.promoteId&&V.generateId)throw new Error("promoteId and generateId cannot be used together.");var ue,be,Te,Ae,we,Me,oe=function(ue,be){var Te=[];if("FeatureCollection"===ue.type)for(var Ae=0;Ae<ue.features.length;Ae++)Js(Te,ue.features[Ae],be,Ae);else Js(Te,"Feature"===ue.type?ue:{geometry:ue},be);return Te}(le,V);this.tiles={},this.tileCoords=[],H&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",V.indexMaxZoom,V.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(ue=oe,be=V,Te=be.buffer/be.extent,Ae=ue,we=Vi(ue,1,-1-Te,Te,0,-1,2,be),Me=Vi(ue,1,1-Te,2+Te,0,-1,2,be),(we||Me)&&(Ae=Vi(ue,1,-Te,1+Te,0,-1,2,be)||[],we&&(Ae=bu(we,1).concat(Ae)),Me&&(Ae=Ae.concat(bu(Me,-1)))),oe=Ae).length&&this.splitTile(oe,0,0,0),H&&(oe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function yl(le,V,H){return 32*((1<<le)*H+V)+le}function Xl(le,V){const H=le.tileID.canonical;if(!this._geoJSONIndex)return V(null,null);const oe=this._geoJSONIndex.getTile(H.z,H.x,H.y);if(!oe)return V(null,null);const ue=new mu(oe.features);let be=es(ue);0===be.byteOffset&&be.byteLength===be.buffer.byteLength||(be=new Uint8Array(be)),V(null,{vectorTile:ue,rawData:be.buffer})}as.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},as.prototype.splitTile=function(le,V,H,oe,ue,be,Te){for(var Ae=[le,V,H,oe],we=this.options,Me=we.debug;Ae.length;){oe=Ae.pop(),H=Ae.pop(),V=Ae.pop(),le=Ae.pop();var Ye=1<<V,st=yl(V,H,oe),Xe=this.tiles[st];if(!Xe&&(Me>1&&console.time("creation"),Xe=this.tiles[st]=Yl(le,V,H,oe,we),this.tileCoords.push({z:V,x:H,y:oe}),Me)){Me>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",V,H,oe,Xe.numFeatures,Xe.numPoints,Xe.numSimplified),console.timeEnd("creation"));var St="z"+V;this.stats[St]=(this.stats[St]||0)+1,this.total++}if(Xe.source=le,ue){if(V===we.maxZoom||V===ue)continue;var Ft=1<<ue-V;if(H!==Math.floor(be/Ft)||oe!==Math.floor(Te/Ft))continue}else if(V===we.indexMaxZoom||Xe.numPoints<=we.indexMaxPoints)continue;if(Xe.source=null,0!==le.length){Me>1&&console.time("clipping");var Pt,Nt,tn,Ln,Mn,zn,Rt=.5*we.buffer/we.extent,Re=.5-Rt,Xr=.5+Rt,yi=1+Rt;Pt=Nt=tn=Ln=null,Mn=Vi(le,Ye,H-Rt,H+Xr,0,Xe.minX,Xe.maxX,we),zn=Vi(le,Ye,H+Re,H+yi,0,Xe.minX,Xe.maxX,we),le=null,Mn&&(Pt=Vi(Mn,Ye,oe-Rt,oe+Xr,1,Xe.minY,Xe.maxY,we),Nt=Vi(Mn,Ye,oe+Re,oe+yi,1,Xe.minY,Xe.maxY,we),Mn=null),zn&&(tn=Vi(zn,Ye,oe-Rt,oe+Xr,1,Xe.minY,Xe.maxY,we),Ln=Vi(zn,Ye,oe+Re,oe+yi,1,Xe.minY,Xe.maxY,we),zn=null),Me>1&&console.timeEnd("clipping"),Ae.push(Pt||[],V+1,2*H,2*oe),Ae.push(Nt||[],V+1,2*H,2*oe+1),Ae.push(tn||[],V+1,2*H+1,2*oe),Ae.push(Ln||[],V+1,2*H+1,2*oe+1)}}},as.prototype.getTile=function(le,V,H){var oe=this.options,ue=oe.extent,be=oe.debug;if(le<0||le>24)return null;var Te=1<<le,Ae=yl(le,V=(V%Te+Te)%Te,H);if(this.tiles[Ae])return Cu(this.tiles[Ae],ue);be>1&&console.log("drilling down to z%d-%d-%d",le,V,H);for(var we,Me=le,Ye=V,st=H;!we&&Me>0;)Me--,Ye=Math.floor(Ye/2),st=Math.floor(st/2),we=this.tiles[yl(Me,Ye,st)];return we&&we.source?(be>1&&console.log("found parent tile z%d-%d-%d",Me,Ye,st),be>1&&console.time("drilling down"),this.splitTile(we.source,Me,Ye,st,le,V,H),be>1&&console.timeEnd("drilling down"),this.tiles[Ae]?Cu(this.tiles[Ae],ue):null):null};class Ar extends p.VectorTileWorkerSource{constructor(V,H,oe,ue,be){super(V,H,oe,ue,Xl),be&&(this.loadGeoJSON=be)}loadData(V,H){const oe=V&&V.request,ue=oe&&oe.collectResourceTiming;this.loadGeoJSON(V,(be,Te)=>{if(be||!Te)return H(be);if("object"!=typeof Te)return H(new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`));{Qt(Te,!0);try{if(V.filter){const we=p.createExpression(V.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===we.result)throw new Error(we.value.map(Ye=>`${Ye.key}: ${Ye.message}`).join(", "));const Me=Te.features.filter(Ye=>we.value.evaluate({zoom:0},Ye));Te={type:"FeatureCollection",features:Me}}this._geoJSONIndex=V.cluster?new rs(function({superclusterOptions:we,clusterProperties:Me}){if(!Me||!we)return we;const Ye={},st={},Xe={accumulated:null,zoom:0},St={properties:null},Ft=Object.keys(Me);for(const Pt of Ft){const[Nt,tn]=Me[Pt],Ln=p.createExpression(tn),Mn=p.createExpression("string"==typeof Nt?[Nt,["accumulated"],["get",Pt]]:Nt);Ye[Pt]=Ln.value,st[Pt]=Mn.value}return we.map=Pt=>{St.properties=Pt;const Nt={};for(const tn of Ft)Nt[tn]=Ye[tn].evaluate(Xe,St);return Nt},we.reduce=(Pt,Nt)=>{St.properties=Nt;for(const tn of Ft)Xe.accumulated=Pt[tn],Pt[tn]=st[tn].evaluate(Xe,St)},we}(V)).load(Te.features):new as(we=Te,V.geojsonVtOptions)}catch(we){return H(we)}this.loaded={};const Ae={};if(ue){const we=p.getPerformanceMeasurement(oe);we&&(Ae.resourceTiming={},Ae.resourceTiming[V.source]=JSON.parse(JSON.stringify(we)))}H(null,Ae)}var we})}reloadTile(V,H){const oe=this.loaded;return oe&&oe[V.uid]?super.reloadTile(V,H):this.loadTile(V,H)}loadGeoJSON(V,H){if(V.request)p.getJSON(V.request,H);else{if("string"!=typeof V.data)return H(new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`));try{return H(null,JSON.parse(V.data))}catch(oe){return H(new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(V,H){try{H(null,this._geoJSONIndex.getClusterExpansionZoom(V.clusterId))}catch(oe){H(oe)}}getClusterChildren(V,H){try{H(null,this._geoJSONIndex.getChildren(V.clusterId))}catch(oe){H(oe)}}getClusterLeaves(V,H){try{H(null,this._geoJSONIndex.getLeaves(V.clusterId,V.limit,V.offset))}catch(oe){H(oe)}}}class vl{constructor(V){this.self=V,this.actor=new p.Actor(V,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=p.getProjection({name:"mercator"}),this.workerSourceTypes={vector:p.VectorTileWorkerSource,geojson:Ar},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(H,oe)=>{if(this.workerSourceTypes[H])throw new Error(`Worker source with name "${H}" already registered.`);this.workerSourceTypes[H]=oe},this.self.registerRTLTextPlugin=H=>{if(p.plugin.isParsed())throw new Error("RTL text plugin already registered.");p.plugin.applyArabicShaping=H.applyArabicShaping,p.plugin.processBidirectionalText=H.processBidirectionalText,p.plugin.processStyledBidirectionalText=H.processStyledBidirectionalText}}clearCaches(V,H,oe){delete this.layerIndexes[V],delete this.availableImages[V],delete this.workerSources[V],delete this.demWorkerSources[V],oe()}checkIfReady(V,H,oe){oe()}setReferrer(V,H){this.referrer=H}spriteLoaded(V,H){this.isSpriteLoaded[V]=H;for(const oe in this.workerSources[V]){const ue=this.workerSources[V][oe];for(const be in ue)ue[be]instanceof p.VectorTileWorkerSource&&(ue[be].isSpriteLoaded=H,ue[be].fire(new p.Event("isSpriteLoaded")))}}setImages(V,H,oe){this.availableImages[V]=H;for(const ue in this.workerSources[V]){const be=this.workerSources[V][ue];for(const Te in be)be[Te].availableImages=H}oe()}enableTerrain(V,H,oe){this.terrain=H,oe()}setProjection(V,H){this.projections[V]=p.getProjection(H)}setLayers(V,H,oe){this.getLayerIndex(V).replace(H),oe()}updateLayers(V,H,oe){this.getLayerIndex(V).update(H.layers,H.removedIds),oe()}loadTile(V,H,oe){const ue=this.enableTerrain?p.extend({enableTerrain:this.terrain},H):H;ue.projection=this.projections[V]||this.defaultProjection,this.getWorkerSource(V,H.type,H.source).loadTile(ue,oe)}loadDEMTile(V,H,oe){const ue=this.enableTerrain?p.extend({buildQuadTree:this.terrain},H):H;this.getDEMWorkerSource(V,H.source).loadTile(ue,oe)}reloadTile(V,H,oe){const ue=this.enableTerrain?p.extend({enableTerrain:this.terrain},H):H;ue.projection=this.projections[V]||this.defaultProjection,this.getWorkerSource(V,H.type,H.source).reloadTile(ue,oe)}abortTile(V,H,oe){this.getWorkerSource(V,H.type,H.source).abortTile(H,oe)}removeTile(V,H,oe){this.getWorkerSource(V,H.type,H.source).removeTile(H,oe)}removeSource(V,H,oe){if(!this.workerSources[V]||!this.workerSources[V][H.type]||!this.workerSources[V][H.type][H.source])return;const ue=this.workerSources[V][H.type][H.source];delete this.workerSources[V][H.type][H.source],void 0!==ue.removeSource?ue.removeSource(H,oe):oe()}loadWorkerSource(V,H,oe){try{this.self.importScripts(H.url),oe()}catch(ue){oe(ue.toString())}}syncRTLPluginState(V,H,oe){try{p.plugin.setState(H);const ue=p.plugin.getPluginURL();if(p.plugin.isLoaded()&&!p.plugin.isParsed()&&null!=ue){this.self.importScripts(ue);const be=p.plugin.isParsed();oe(be?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ue}`),be)}}catch(ue){oe(ue.toString())}}getAvailableImages(V){let H=this.availableImages[V];return H||(H=[]),H}getLayerIndex(V){let H=this.layerIndexes[V];return H||(H=this.layerIndexes[V]=new kr),H}getWorkerSource(V,H,oe){return this.workerSources[V]||(this.workerSources[V]={}),this.workerSources[V][H]||(this.workerSources[V][H]={}),this.workerSources[V][H][oe]||(this.workerSources[V][H][oe]=new this.workerSourceTypes[H]({send:(ue,be,Te,Ae,we,Me)=>{this.actor.send(ue,be,Te,V,we,Me)},scheduler:this.actor.scheduler},this.getLayerIndex(V),this.getAvailableImages(V),this.isSpriteLoaded[V])),this.workerSources[V][H][oe]}getDEMWorkerSource(V,H){return this.demWorkerSources[V]||(this.demWorkerSources[V]={}),this.demWorkerSources[V][H]||(this.demWorkerSources[V][H]=new dt),this.demWorkerSources[V][H]}enforceCacheSizeLimit(V,H){p.enforceCacheSizeLimit(H)}getWorkerPerformanceMetrics(V,H,oe){oe(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new vl(self)),vl}),Fd(0,function(p){function ot(f,a){if(Array.isArray(f)){if(!Array.isArray(a)||f.length!==a.length)return!1;for(let d=0;d<f.length;d++)if(!ot(f[d],a[d]))return!1;return!0}if("object"==typeof f&&null!==f&&null!==a){if("object"!=typeof a||Object.keys(f).length!==Object.keys(a).length)return!1;for(const d in f)if(!ot(f[d],a[d]))return!1;return!0}return f===a}var Ws=kr;function kr(f){return a=f,!("undefined"==typeof window||"undefined"==typeof document||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var g,x,C=new Blob([""],{type:"text/javascript"}),M=URL.createObjectURL(C);try{x=new Worker(M),g=!0}catch(D){g=!1}return x&&x.terminate(),URL.revokeObjectURL(M),g}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var g=document.createElement("canvas");g.width=g.height=1;var x=g.getContext("2d");if(!x)return!1;var C=x.getImageData(0,0,1,1);return C&&C.width===g.width}()||(void 0===dt[d=a&&a.failIfMajorPerformanceCaveat]&&(dt[d]=function(g){var x,M,D,O,C=(M=g,D=document.createElement("canvas"),(O=Object.create(kr.webGLContextAttributes)).failIfMajorPerformanceCaveat=M,D.getContext("webgl",O)||D.getContext("experimental-webgl",O));if(!C)return!1;try{x=C.createShader(C.VERTEX_SHADER)}catch(M){return!1}return!(!x||C.isContextLost())&&(C.shaderSource(x,"void main() {}"),C.compileShader(x),!0===C.getShaderParameter(x,C.COMPILE_STATUS))}(d)),!dt[d]||document.documentMode));var a,d}var dt={};function Qt(f,a,d){const g=p.window.document.createElement(f);return void 0!==a&&(g.className=a),d&&d.appendChild(g),g}function Cr(f,a,d){const g=p.window.document.createElementNS("http://www.w3.org/2000/svg",f);for(const x of Object.keys(a))g.setAttributeNS(null,x,a[x]);return d&&d.appendChild(g),g}kr.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Oo=p.window.document&&p.window.document.documentElement.style,ln=Oo&&void 0!==Oo.userSelect?"userSelect":"WebkitUserSelect";let cr;function mu(){Oo&&ln&&(cr=Oo[ln],Oo[ln]="none")}function ql(){Oo&&ln&&(Oo[ln]=cr)}function bs(f){f.preventDefault(),f.stopPropagation(),p.window.removeEventListener("click",bs,!0)}function _o(){p.window.addEventListener("click",bs,!0),p.window.setTimeout(()=>{p.window.removeEventListener("click",bs,!0)},0)}function Zt(f,a){const d=f.getBoundingClientRect();return Ys(f,d,a)}function es(f,a){const d=f.getBoundingClientRect(),g=[];for(let x=0;x<a.length;x++)g.push(Ys(f,d,a[x]));return g}function ts(f){return void 0!==p.window.InstallTrigger&&2===f.button&&f.ctrlKey&&p.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:f.button}function Ys(f,a,d){const g=f.offsetWidth===a.width?1:f.offsetWidth/a.width;return new p.pointGeometry((d.clientX-a.left)*g,(d.clientY-a.top)*g)}function Xs(f,a){var d=a[0],g=a[1],x=a[2],C=a[3],M=d*C-x*g;return M?(f[0]=C*(M=1/M),f[1]=-g*M,f[2]=-x*M,f[3]=d*M,f):null}function ji(f){const{userImage:a}=f;return!!(a&&a.render&&a.render())&&(f.data.replace(new Uint8Array(a.data.buffer)),!0)}class Ma extends p.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new p.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(a){if(this.loaded!==a&&(this.loaded=a,a)){for(const{ids:d,callback:g}of this.requestors)this._notify(d,g);this.requestors=[]}}hasImage(a){return!!this.getImage(a)}getImage(a){return this.images[a]}addImage(a,d){this._validate(a,d)&&(this.images[a]=d)}_validate(a,d){let g=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new p.ErrorEvent(new Error(`Image "${a}" has invalid "stretchX" value`))),g=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new p.ErrorEvent(new Error(`Image "${a}" has invalid "stretchY" value`))),g=!1),this._validateContent(d.content,d)||(this.fire(new p.ErrorEvent(new Error(`Image "${a}" has invalid "content" value`))),g=!1),g}_validateStretch(a,d){if(!a)return!0;let g=0;for(const x of a){if(x[0]<g||x[1]<x[0]||d<x[1])return!1;g=x[1]}return!0}_validateContent(a,d){return!(a&&(4!==a.length||a[0]<0||d.data.width<a[0]||a[1]<0||d.data.height<a[1]||a[2]<0||d.data.width<a[2]||a[3]<0||d.data.height<a[3]||a[2]<a[0]||a[3]<a[1]))}updateImage(a,d){d.version=this.images[a].version+1,this.images[a]=d,this.updatedImages[a]=!0}removeImage(a){const d=this.images[a];delete this.images[a],delete this.patterns[a],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(a,d){let g=!0;if(!this.isLoaded())for(const x of a)this.images[x]||(g=!1);this.isLoaded()||g?this._notify(a,d):this.requestors.push({ids:a,callback:d})}_notify(a,d){const g={};for(const x of a){this.images[x]||this.fire(new p.Event("styleimagemissing",{id:x}));const C=this.images[x];C?g[x]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:Boolean(C.userImage&&C.userImage.render)}:p.warnOnce(`Image "${x}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}d(null,g)}getPixelSize(){const{width:a,height:d}=this.atlasImage;return{width:a,height:d}}getPattern(a){const d=this.patterns[a],g=this.getImage(a);if(!g)return null;if(d&&d.position.version===g.version)return d.position;if(d)d.position.version=g.version;else{const x={w:g.data.width+2,h:g.data.height+2,x:0,y:0},C=new p.ImagePosition(x,g);this.patterns[a]={bin:x,position:C}}return this._updatePatternAtlas(),this.patterns[a].position}bind(a){const d=a.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new p.Texture(a,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const a=[];for(const C in this.patterns)a.push(this.patterns[C].bin);const{w:d,h:g}=p.potpack(a),x=this.atlasImage;x.resize({width:d||1,height:g||1});for(const C in this.patterns){const{bin:M}=this.patterns[C],D=M.x+1,O=M.y+1,z=this.images[C].data,F=z.width,U=z.height;p.RGBAImage.copy(z,x,{x:0,y:0},{x:D,y:O},{width:F,height:U}),p.RGBAImage.copy(z,x,{x:0,y:U-1},{x:D,y:O-1},{width:F,height:1}),p.RGBAImage.copy(z,x,{x:0,y:0},{x:D,y:O+U},{width:F,height:1}),p.RGBAImage.copy(z,x,{x:F-1,y:0},{x:D-1,y:O},{width:1,height:U}),p.RGBAImage.copy(z,x,{x:0,y:0},{x:D+F,y:O},{width:1,height:U})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(a){for(const d of a){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const g=this.images[d];ji(g)&&this.updateImage(d,g)}}}const ws=new p.Properties({anchor:new p.DataConstantProperty(p.spec.light.anchor),position:new class{constructor(){this.specification=p.spec.light.position}possiblyEvaluate(f,a){return function([d,g,x]){const C=p.degToRad(g+90),M=p.degToRad(x);return{x:d*Math.cos(C)*Math.sin(M),y:d*Math.sin(C)*Math.sin(M),z:d*Math.cos(M),azimuthal:g,polar:x}}(f.expression.evaluate(a))}interpolate(f,a,d){return{x:p.number(f.x,a.x,d),y:p.number(f.y,a.y,d),z:p.number(f.z,a.z,d),azimuthal:p.number(f.azimuthal,a.azimuthal,d),polar:p.number(f.polar,a.polar,d)}}},color:new p.DataConstantProperty(p.spec.light.color),intensity:new p.DataConstantProperty(p.spec.light.intensity)}),dl="-transition";class hl extends p.Evented{constructor(a){super(),this._transitionable=new p.Transitionable(ws),this.setLight(a),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(a,d={}){if(!this._validate(p.validateLight,a,d))for(const g in a){const x=a[g];p.endsWith(g,dl)?this._transitionable.setTransition(g.slice(0,-dl.length),x):this._transitionable.setValue(g,x)}}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,d,g){return(!g||!1!==g.validate)&&p.emitValidationErrors(this,a.call(p.validateStyle,p.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:p.spec})))}}const gu=new p.Properties({source:new p.DataConstantProperty(p.spec.terrain.source),exaggeration:new p.DataConstantProperty(p.spec.terrain.exaggeration)}),ns="-transition";class yo extends p.Evented{constructor(a,d){super(),this._transitionable=new p.Transitionable(gu),this.set(a),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=d}get(){return this._transitionable.serialize()}set(a){for(const d in a){const g=a[d];p.endsWith(d,ns)?this._transitionable.setTransition(d.slice(0,-ns.length),g):this._transitionable.setValue(d,g)}}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}}function Cs(f,a,d,g){const x=p.smoothstep(45,65,d),[C,M]=Qs(f,g),D=p.length(a);let O=1-Math.min(1,Math.exp((D-C)/(M-C)*-6));return O*=O*O,O=Math.min(1,1.00747*O),O*x*f.alpha}function Qs(f,a){const d=.5/Math.tan(.5*a);return[f.range[0]+d,f.range[1]+d]}const Hn=new p.Properties({range:new p.DataConstantProperty(p.spec.fog.range),color:new p.DataConstantProperty(p.spec.fog.color),"high-color":new p.DataConstantProperty(p.spec.fog["high-color"]),"space-color":new p.DataConstantProperty(p.spec.fog["space-color"]),"horizon-blend":new p.DataConstantProperty(p.spec.fog["horizon-blend"]),"star-intensity":new p.DataConstantProperty(p.spec.fog["star-intensity"])}),pl="-transition";class vi extends p.Evented{constructor(a,d){super(),this._transitionable=new p.Transitionable(Hn),this.set(a),this._transitioning=this._transitionable.untransitioned(),this._transform=d}get state(){const a=this._transform,d="globe"===a.projection.name,g=p.globeToMercatorTransition(a.zoom),x=this.properties.get("range"),C=[.5,3];return{range:d?[p.number(C[0],x[0],g),p.number(C[1],x[1],g)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(a,d={}){if(!this._validate(p.validateFog,a,d)){for(const g of Object.keys(p.spec.fog))a&&void 0===a[g]&&(a[g]=p.spec.fog[g].default);for(const g in a){const x=a[g];p.endsWith(g,pl)?this._transitionable.setTransition(g.slice(0,-pl.length),x):this._transitionable.setValue(g,x)}}}getOpacity(a){if(!this._transform.projection.supportsFog)return 0;const d=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:p.smoothstep(45,65,a))*d.a}getOpacityAtLatLng(a,d){return this._transform.projection.supportsFog?function(g,x,C){const M=p.MercatorCoordinate.fromLngLat(x),D=C.elevation?C.elevation.getAtPointOrZero(M):0,O=[M.x,M.y,D];return p.transformMat4(O,O,C.mercatorFogMatrix),Cs(g,O,C.pitch,C._fov)}(this.state,a,d):0}getFovAdjustedRange(a){return this._transform.projection.supportsFog?Qs(this.state,a):[0,1]}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,d,g){return(!g||!1!==g.validate)&&p.emitValidationErrors(this,a.call(p.validateStyle,p.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:p.spec})))}}class ur{constructor(a,d){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=p.uniqueId();const g=this.workerPool.acquire(this.id);for(let x=0;x<g.length;x++){const C=new ur.Actor(g[x],d,this.id);C.name=`Worker ${x}`,this.actors.push(C)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(a,d,g){p.asyncAll(this.actors,(x,C)=>{x.send(a,d,C)},g=g||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(a=>{a.remove()}),this.actors=[],this.workerPool.release(this.id)}}function As(f,a,d){return a*(p.EXTENT/(f.tileSize*Math.pow(2,d-f.tileID.overscaledZ)))}ur.Actor=p.Actor;class bi{constructor(a,d,g,x){this.screenBounds=a,this.cameraPoint=d,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=g,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,x)}static createFromScreenPoints(a,d){let g,x;if(a instanceof p.pointGeometry||"number"==typeof a[0]){const C=p.pointGeometry.convert(a);g=[p.pointGeometry.convert(a)],x=d.isPointAboveHorizon(C)}else{const C=p.pointGeometry.convert(a[0]),M=p.pointGeometry.convert(a[1]);g=[C,M],x=p.polygonizeBounds(C,M).every(D=>d.isPointAboveHorizon(D))}return new bi(g,d.getCameraPoint(),x,d)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(a){return p.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],a)}bufferedCameraGeometry(a){const d=this.screenBounds[0],g=1===this.screenBounds.length?this.screenBounds[0].add(new p.pointGeometry(1,1)):this.screenBounds[1],x=p.polygonizeBounds(d,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>d.x&&this.cameraPoint.x<g.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?x[2]=this.cameraPoint:this.cameraPoint.x<=d.x&&(x[3]=this.cameraPoint)),p.bufferConvexPolygon(x,a)}bufferedCameraGeometryGlobe(a){const d=this.screenBounds[0],g=1===this.screenBounds.length?this.screenBounds[0].add(new p.pointGeometry(1,1)):this.screenBounds[1],x=p.polygonizeBounds(d,g,a),C=this.cameraPoint.clone();switch(3*((C.y>d.y)+(C.y>g.y))+((C.x>d.x)+(C.x>g.x))){case 0:x[0]=C,x[4]=C.clone();break;case 1:x.splice(1,0,C);break;case 2:x[1]=C;break;case 3:x.splice(4,0,C);break;case 5:x.splice(2,0,C);break;case 6:x[3]=C;break;case 7:x.splice(3,0,C);break;case 8:x[2]=C}return x}containsTile(a,d,g,x=0){const C=a.queryPadding/d._pixelsPerMercatorPixel+1,M=g?this._bufferedCameraMercator(C,d):this._bufferedScreenMercator(C,d);let D=a.tileID.wrap+(M.unwrapped?x:0);const O=M.polygon.map(te=>p.getTilePoint(a.tileTransform,te,D));if(!p.polygonIntersectsBox(O,0,0,p.EXTENT,p.EXTENT))return;D=a.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const z=this.screenGeometryMercator.polygon.map(te=>p.getTileVec3(a.tileTransform,te,D)),F=z.map(te=>new p.pointGeometry(te[0],te[1])),U=d.getFreeCameraOptions().position||new p.MercatorCoordinate(0,0,0),W=p.getTileVec3(a.tileTransform,U,D),ne=z.map(te=>{const X=p.sub(te,te,W);return p.normalize(X,X),new p.Ray(W,X)}),K=As(a,1,d.zoom)*d._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:F,tilespaceRays:ne,bufferedTilespaceGeometry:O,bufferedTilespaceBounds:(J=p.getBounds(O),J.min.x=p.clamp(J.min.x,0,p.EXTENT),J.min.y=p.clamp(J.min.y,0,p.EXTENT),J.max.x=p.clamp(J.max.x,0,p.EXTENT),J.max.y=p.clamp(J.max.y,0,p.EXTENT),J),tile:a,tileID:a.tileID,pixelToTileUnitsFactor:K};var J}_bufferedScreenMercator(a,d){const g=wi(a);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{let x;return x="globe"===d.projection.name?this._projectAndResample(this.bufferedScreenGeometry(a),d):{polygon:this.bufferedScreenGeometry(a).map(C=>d.pointCoordinate3D(C)),unwrapped:!0},this._screenRaycastCache[g]=x,x}}_bufferedCameraMercator(a,d){const g=wi(a);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{let x;return x="globe"===d.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(a),d):{polygon:this.bufferedCameraGeometry(a).map(C=>d.pointCoordinate3D(C)),unwrapped:!0},this._cameraRaycastCache[g]=x,x}}_projectAndResample(a,d){const g=function(C,M){const D=p.multiply([],M.pixelMatrix,M.globeMatrix),O=[0,-p.GLOBE_RADIUS,0,1],z=[0,p.GLOBE_RADIUS,0,1],F=[0,0,0,1];p.transformMat4$1(O,O,D),p.transformMat4$1(z,z,D),p.transformMat4$1(F,F,D);const U=new p.pointGeometry(O[0]/O[3],O[1]/O[3]),W=new p.pointGeometry(z[0]/z[3],z[1]/z[3]),ne=p.polygonContainsPoint(C,U)&&O[3]<F[3],K=p.polygonContainsPoint(C,W)&&z[3]<F[3];if(!ne&&!K)return null;const J=function(ve,_e,Ce){for(let Se=1;Se<ve.length;Se++){const Je=rs(_e.pointCoordinate3D(ve[Se-1]).x),Ee=rs(_e.pointCoordinate3D(ve[Se]).x);if(Ce<0){if(Je<Ee)return{idx:Se,t:-Je/(Ee-1-Je)}}else if(Ee<Je)return{idx:Se,t:(1-Je)/(Ee+1-Je)}}return null}(C,M,ne?-1:1);if(!J)return null;const{idx:te,t:X}=J;let re=te>1?is(C.slice(0,te),M):[],ie=te<C.length?is(C.slice(te),M):[];re=re.map(ve=>new p.pointGeometry(rs(ve.x),ve.y)),ie=ie.map(ve=>new p.pointGeometry(rs(ve.x),ve.y));const xe=[...re];0===xe.length&&xe.push(ie[ie.length-1]);const ge=p.number(xe[xe.length-1].y,(0===ie.length?re[0]:ie[0]).y,X);let pe;return pe=ne?[new p.pointGeometry(0,ge),new p.pointGeometry(0,0),new p.pointGeometry(1,0),new p.pointGeometry(1,ge)]:[new p.pointGeometry(1,ge),new p.pointGeometry(1,1),new p.pointGeometry(0,1),new p.pointGeometry(0,ge)],xe.push(...pe),0===ie.length?xe.push(re[0]):xe.push(...ie),{polygon:xe.map(ve=>new p.MercatorCoordinate(ve.x,ve.y)),unwrapped:!1}}(a,d);if(g)return g;const x=function(C,M){let D=!1,O=-1/0,z=0;for(let U=0;U<C.length-1;U++)C[U].x>O&&(O=C[U].x,z=U);for(let U=0;U<C.length-1;U++){const W=(z+U)%(C.length-1),ne=C[W],K=C[W+1];Math.abs(ne.x-K.x)>.5&&(ne.x<K.x?(ne.x+=1,0===W&&(C[C.length-1].x+=1)):(K.x+=1,W+1===C.length-1&&(C[0].x+=1)),D=!0)}const F=p.mercatorXfromLng(M.center.lng);return D&&F<Math.abs(F-1)&&C.forEach(U=>{U.x-=1}),{polygon:C,unwrapped:D}}(is(a,d).map(C=>new p.pointGeometry(rs(C.x),C.y)),d);return{polygon:x.polygon.map(C=>new p.MercatorCoordinate(C.x,C.y)),unwrapped:x.unwrapped}}}function is(f,a){return p.resample(f,d=>{const g=a.pointCoordinate3D(d);d.x=g.x,d.y=g.y},1/256)}function rs(f){return f<0?1+f%1:f%1}function wi(f){return 100*f|0}function Mi(f,a,d,g,x){const C=function(M,D){if(M)return x(M);if(D){const O=p.pick(p.extend(D,f),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);D.vector_layers&&(O.vectorLayers=D.vector_layers,O.vectorLayerIds=O.vectorLayers.map(z=>z.id)),D.language_options&&(O.languageOptions=D.language_options),D.language&&D.language[D.id]&&(O.language=D.language[D.id]),D.worldview_options&&(O.worldviewOptions=D.worldview_options),D.worldview?O.worldview=D.worldview[D.id]:D.worldview_default&&(O.worldview=D.worldview_default),O.tiles=a.canonicalizeTileset(O,f.url),x(null,O)}};return f.url?p.getJSON(a.transformRequest(a.normalizeSourceURL(f.url,null,d,g),p.ResourceType.Source),C):p.exported.frame(()=>C(null,f))}class Es{constructor(a,d,g){this.bounds=p.LngLatBounds.convert(this.validateBounds(a)),this.minzoom=d||0,this.maxzoom=g||24}validateBounds(a){return Array.isArray(a)&&4===a.length?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]}contains(a){const d=Math.pow(2,a.z),g=Math.floor(p.mercatorXfromLng(this.bounds.getWest())*d),x=Math.floor(p.mercatorYfromLat(this.bounds.getNorth())*d),C=Math.ceil(p.mercatorXfromLng(this.bounds.getEast())*d),M=Math.ceil(p.mercatorYfromLat(this.bounds.getSouth())*d);return a.x>=g&&a.x<C&&a.y>=x&&a.y<M}}class Qn{constructor(a,d,g){this.context=a;const x=a.gl;this.buffer=x.createBuffer(),this.dynamicDraw=Boolean(g),this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||d.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(a){const d=this.context.gl;this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ts={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class fl{constructor(a,d,g,x){this.length=d.length,this.attributes=g,this.itemSize=d.bytesPerElement,this.dynamicDraw=x,this.context=a;const C=a.gl;this.buffer=C.createBuffer(),a.bindVertexBuffer.set(this.buffer),C.bufferData(C.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||d.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(a){const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,a.arrayBuffer)}enableAttributes(a,d){for(let g=0;g<this.attributes.length;g++){const x=d.attributes[this.attributes[g].name];void 0!==x&&a.enableVertexAttribArray(x)}}setVertexAttribPointers(a,d,g){for(let x=0;x<this.attributes.length;x++){const C=this.attributes[x],M=d.attributes[C.name];void 0!==M&&a.vertexAttribPointer(M,C.components,a[Ts[C.type]],!1,this.itemSize,C.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class xn{constructor(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(a){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ks extends xn{getDefault(){return p.Color.transparent}set(a){const d=this.current;(a.r!==d.r||a.g!==d.g||a.b!==d.b||a.a!==d.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class ml extends xn{getDefault(){return 1}set(a){(a!==this.current||this.dirty)&&(this.gl.clearDepth(a),this.current=a,this.dirty=!1)}}class Ms extends xn{getDefault(){return 0}set(a){(a!==this.current||this.dirty)&&(this.gl.clearStencil(a),this.current=a,this.dirty=!1)}}class ko extends xn{getDefault(){return[!0,!0,!0,!0]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||a[2]!==d[2]||a[3]!==d[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class gl extends xn{getDefault(){return!0}set(a){(a!==this.current||this.dirty)&&(this.gl.depthMask(a),this.current=a,this.dirty=!1)}}class bn extends xn{getDefault(){return 255}set(a){(a!==this.current||this.dirty)&&(this.gl.stencilMask(a),this.current=a,this.dirty=!1)}}class Ss extends xn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(a){const d=this.current;(a.func!==d.func||a.ref!==d.ref||a.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)}}class Js extends xn{getDefault(){const a=this.gl;return[a.KEEP,a.KEEP,a.KEEP]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||a[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)}}class os extends xn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=a,this.dirty=!1}}class Sa extends xn{getDefault(){return[0,1]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)}}class Zl extends xn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=a,this.dirty=!1}}class _u extends xn{getDefault(){return this.gl.LESS}set(a){(a!==this.current||this.dirty)&&(this.gl.depthFunc(a),this.current=a,this.dirty=!1)}}class yu extends xn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.BLEND):d.disable(d.BLEND),this.current=a,this.dirty=!1}}class Vi extends xn{getDefault(){const a=this.gl;return[a.ONE,a.ZERO]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(a[0],a[1]),this.current=a,this.dirty=!1)}}class ss extends xn{getDefault(){return p.Color.transparent}set(a){const d=this.current;(a.r!==d.r||a.g!==d.g||a.b!==d.b||a.a!==d.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class _l extends xn{getDefault(){return this.gl.FUNC_ADD}set(a){(a!==this.current||this.dirty)&&(this.gl.blendEquation(a),this.current=a,this.dirty=!1)}}class vu extends xn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=a,this.dirty=!1}}class vo extends xn{getDefault(){return this.gl.BACK}set(a){(a!==this.current||this.dirty)&&(this.gl.cullFace(a),this.current=a,this.dirty=!1)}}class Ds extends xn{getDefault(){return this.gl.CCW}set(a){(a!==this.current||this.dirty)&&(this.gl.frontFace(a),this.current=a,this.dirty=!1)}}class Bd extends xn{getDefault(){return null}set(a){(a!==this.current||this.dirty)&&(this.gl.useProgram(a),this.current=a,this.dirty=!1)}}class xu extends xn{getDefault(){return this.gl.TEXTURE0}set(a){(a!==this.current||this.dirty)&&(this.gl.activeTexture(a),this.current=a,this.dirty=!1)}}class bu extends xn{getDefault(){const a=this.gl;return[0,0,a.drawingBufferWidth,a.drawingBufferHeight]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||a[2]!==d[2]||a[3]!==d[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class wu extends xn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,a),this.current=a,this.dirty=!1}}class Cu extends xn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class Wl extends xn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,a),this.current=a,this.dirty=!1}}class Yl extends xn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class Au extends xn{getDefault(){return null}set(a){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class Is extends xn{constructor(a){super(a),this.vao=a.extVertexArrayObject}getDefault(){return null}set(a){this.vao&&(a!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(a),this.current=a,this.dirty=!1)}}class as extends xn{getDefault(){return 4}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}}class yl extends xn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}}class Xl extends xn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}}class Ar extends xn{constructor(a,d){super(a),this.context=a,this.parent=d}getDefault(){return null}}class vl extends Ar{setDirty(){this.dirty=!0}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}}class le extends Ar{attachment(){return this.gl.DEPTH_ATTACHMENT}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,this.attachment(),d.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class V extends le{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class H{constructor(a,d,g,x){this.context=a,this.width=d,this.height=g;const C=this.framebuffer=a.gl.createFramebuffer();this.colorAttachment=new vl(a,C),x&&(this.depthAttachment=new le(a,C))}destroy(){const a=this.context.gl,d=this.colorAttachment.get();if(d&&a.deleteTexture(d),this.depthAttachment){const g=this.depthAttachment.get();g&&a.deleteRenderbuffer(g)}a.deleteFramebuffer(this.framebuffer)}}class oe{constructor(a){this.gl=a,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Ks(this),this.clearDepth=new ml(this),this.clearStencil=new Ms(this),this.colorMask=new ko(this),this.depthMask=new gl(this),this.stencilMask=new bn(this),this.stencilFunc=new Ss(this),this.stencilOp=new Js(this),this.stencilTest=new os(this),this.depthRange=new Sa(this),this.depthTest=new Zl(this),this.depthFunc=new _u(this),this.blend=new yu(this),this.blendFunc=new Vi(this),this.blendColor=new ss(this),this.blendEquation=new _l(this),this.cullFace=new vu(this),this.cullFaceSide=new vo(this),this.frontFace=new Ds(this),this.program=new Bd(this),this.activeTexture=new xu(this),this.viewport=new bu(this),this.bindFramebuffer=new wu(this),this.bindRenderbuffer=new Cu(this),this.bindTexture=new Wl(this),this.bindVertexBuffer=new Yl(this),this.bindElementBuffer=new Au(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Is(this),this.pixelStoreUnpack=new as(this),this.pixelStoreUnpackPremultiplyAlpha=new yl(this),this.pixelStoreUnpackFlipY=new Xl(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extTextureHalfFloat=a.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(a.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=a.getExtension("OES_standard_derivatives"),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(a,d){return new Qn(this,a,d)}createVertexBuffer(a,d,g){return new fl(this,a,d,g)}createRenderbuffer(a,d,g){const x=this.gl,C=x.createRenderbuffer();return this.bindRenderbuffer.set(C),x.renderbufferStorage(x.RENDERBUFFER,a,d,g),this.bindRenderbuffer.set(null),C}createFramebuffer(a,d,g){return new H(this,a,d,g)}clear({color:a,depth:d,stencil:g}){const x=this.gl;let C=0;a&&(C|=x.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),void 0!==d&&(C|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),void 0!==g&&(C|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),x.clear(C)}setCullFace(a){!1===a.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))}setDepthMode(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)}setStencilMode(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)}setColorMode(a){ot(a.blendFunction,p.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(a.blendFunction),this.blendColor.set(a.blendColor)),this.colorMask.set(a.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class ue extends p.Evented{constructor(a,d,g,x){super(),this.id=a,this.dispatcher=g,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=p.extend({type:"raster"},d),p.extend(this,p.pick(d,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Mi(this._options,this.map._requestManager,null,null,(a,d)=>{this._tileJSONRequest=null,this._loaded=!0,a?this.fire(new p.ErrorEvent(a)):d&&(p.extend(this,d),d.bounds&&(this.tileBounds=new Es(d.bounds,this.minzoom,this.maxzoom)),p.postTurnstileEvent(d.tiles),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(a){this.map=a,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return p.extend({},this._options)}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}loadTile(a,d){const g=p.exported.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);a.request=p.getImage(this.map._requestManager.transformRequest(x,p.ResourceType.Tile),(C,M,D,O)=>(delete a.request,a.aborted?(a.state="unloaded",d(null)):C?(a.state="errored",d(C)):M?(this.map._refreshExpiredTiles&&a.setExpiryData({cacheControl:D,expires:O}),a.setTexture(M,this.map.painter),a.state="loaded",p.cacheEntryPossiblyAdded(this.dispatcher),void d(null)):d(null)))}static loadTileData(a,d,g){a.setTexture(d,g)}static unloadTileData(a,d){a.texture&&d.saveTileTexture(a.texture)}abortTile(a,d){a.request&&(a.request.cancel(),delete a.request),d()}unloadTile(a,d){a.texture&&this.map.painter.saveTileTexture(a.texture),d()}hasTransition(){return!1}}let be;function Te(f,a,d,g,x,C,M,D){const O=[f,d,x,a,g,C,1,1,1],z=[M,D,1],F=p.adjoint([],O),[U,W,ne]=p.transformMat3(z,z,p.transpose(F,F));return p.multiply$1(O,[U,0,0,0,W,0,0,0,ne],O)}class Ae extends p.Evented{constructor(a,d,g,x){super(),this.id=a,this.dispatcher=g,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(x),this.options=d}load(a,d){this._loaded=d||!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this.url=this.options.url,p.getImage(this.map._requestManager.transformRequest(this.url,p.ResourceType.Image),(g,x)=>{if(this._loaded=!0,g)this.fire(new p.ErrorEvent(g));else if(x){const{HTMLImageElement:C}=p.window;this.image=x instanceof C?p.exported.getImageData(x):x,this.width=this.image.width,this.height=this.image.height,a&&(this.coordinates=a),this._finishLoading()}})}loaded(){return this._loaded}updateImage(a){return this.image&&a.url?(this.options.url=a.url,this.load(a.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(a){this.map=a,this.load()}onRemove(){this.texture&&this.texture.destroy()}setCoordinates(a){this.coordinates=a,this._boundsArray=void 0;const d=a.map(p.MercatorCoordinate.fromLngLat);return this.tileID=function(g){let x=1/0,C=1/0,M=-1/0,D=-1/0;for(const U of g)x=Math.min(x,U.x),C=Math.min(C,U.y),M=Math.max(M,U.x),D=Math.max(D,U.y);const O=Math.max(M-x,D-C),z=Math.max(0,Math.floor(-Math.log(O)/Math.LN2)),F=Math.pow(2,z);return new p.CanonicalTileID(z,Math.floor((x+M)/2*F),Math.floor((C+D)/2*F))}(d),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(a){for(const O in this.tiles){const z=this.tiles[O];"loaded"!==z.state&&(z.state="loaded",z.texture=this.texture)}if(this._boundsArray)return;const d=p.tileTransform(this.tileID,this.map.transform.projection),[g,x,C,M]=this.coordinates.map(O=>{const z=d.projection.project(O[0],O[1]);return p.getTilePoint(d,z)._round()});this.perspectiveTransform=function(O,z,F,U,W,ne,K,J,te,X){const re=Te(0,0,O,0,0,z,O,z),ie=Te(F,U,W,ne,K,J,te,X);return p.multiply$1(ie,p.adjoint(re,re),ie),[ie[6]/ie[8]*O/p.EXTENT,ie[7]/ie[8]*z/p.EXTENT]}(this.width,this.height,g.x,g.y,x.x,x.y,M.x,M.y,C.x,C.y);const D=this._boundsArray=new p.StructArrayLayout4i8;D.emplaceBack(g.x,g.y,0,0),D.emplaceBack(x.x,x.y,p.EXTENT,0),D.emplaceBack(M.x,M.y,0,p.EXTENT),D.emplaceBack(C.x,C.y,p.EXTENT,p.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=a.createVertexBuffer(D,p.boundsAttributes.members),this.boundsSegments=p.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const a=this.map.painter.context,d=a.gl;this.texture?this.texture.update(this.image):(this.texture=new p.Texture(a,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE)),this._prepareData(a)}loadTile(a,d){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[String(a.tileID.wrap)]=a,a.buckets={},d(null)):(a.state="errored",d(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const we={vector:class extends p.Evented{constructor(f,a,d,g){if(super(),this.id=f,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,p.extend(this,p.pick(a,["url","scheme","tileSize","promoteId"])),this._options=p.extend({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(g),this._tileWorkers={},this._deduped=new p.DedupedRequest}load(f){this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"}));const a=this.language||this.map._language,d=this.worldview||this.map._worldview;this._tileJSONRequest=Mi(this._options,this.map._requestManager,a,d,(g,x)=>{this._tileJSONRequest=null,this._loaded=!0,g?(a&&console.warn(`Ensure that your requested language string is a valid BCP-47 code. Found: ${a}`),d&&2!==d.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${d}`),this.fire(new p.ErrorEvent(g))):x&&(p.extend(this,x),x.bounds&&(this.tileBounds=new Es(x.bounds,this.minzoom,this.maxzoom)),p.postTurnstileEvent(x.tiles,this.map._requestManager._customAccessToken),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"}))),f&&f(g)})}loaded(){return this._loaded}hasTile(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)}onAdd(f){this.map=f,this.load()}setSourceProperty(f){this._tileJSONRequest&&this._tileJSONRequest.cancel(),f(),this.load(()=>{const a=this.map.style._getSourceCaches(this.id);for(const d of a)d.clearTiles()})}setTiles(f){return this.setSourceProperty(()=>{this._options.tiles=f}),this}setUrl(f){return this.setSourceProperty(()=>{this.url=f,this._options.url=f}),this}_setLanguage(f){return f===this.language||this.setSourceProperty(()=>{this.language=f}),this}_setWorldview(f){return f===this.worldview?this:this.worldviewOptions&&f&&!this.worldviewOptions[f]?(console.warn(`Vector tile source "${this.id}" does not support worldview "${f}".`),this):(this.setSourceProperty(()=>{this.worldview=f}),this)}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return p.extend({},this._options)}loadTile(f,a){const d=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme)),g={request:this.map._requestManager.transformRequest(d,p.ResourceType.Tile),data:void 0,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,tileSize:this.tileSize*f.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:p.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:f.isSymbolTile};if(g.request.collectResourceTiming=this._collectResourceTiming,f.actor&&"expired"!==f.state)"loading"===f.state?f.reloadCallback=a:f.request=f.actor.send("reloadTile",g,x.bind(this));else if(f.actor=this._tileWorkers[d]=this._tileWorkers[d]||this.dispatcher.getActor(),this.dispatcher.ready)f.request=f.actor.send("loadTile",g,x.bind(this),void 0,!0);else{const C=p.loadVectorTile.call({deduped:this._deduped},g,(M,D)=>{M||!D?x.call(this,M):(g.data={cacheControl:D.cacheControl,expires:D.expires,rawData:D.rawData.slice(0)},f.actor&&f.actor.send("loadTile",g,x.bind(this),void 0,!0))},!0);f.request={cancel:C}}function x(C,M){return delete f.request,f.aborted?a(null):C&&404!==C.status?a(C):(M&&M.resourceTiming&&(f.resourceTiming=M.resourceTiming),this.map._refreshExpiredTiles&&M&&f.setExpiryData(M),f.loadVectorData(M,this.map.painter),p.cacheEntryPossiblyAdded(this.dispatcher),a(null),void(f.reloadCallback&&(this.loadTile(f,f.reloadCallback),f.reloadCallback=null)))}}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.actor&&f.actor.send("abortTile",{uid:f.uid,type:this.type,source:this.id})}unloadTile(f){f.unloadVectorData(),f.actor&&f.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:ue,"raster-dem":class extends ue{constructor(f,a,d,g){super(f,a,d,g),this.type="raster-dem",this.maxzoom=22,this._options=p.extend({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox"}loadTile(f,a){const d=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(x,C){x&&(f.state="errored",a(x)),C&&(f.dem=C,f.dem.onDeserialize(),f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0,f.state="loaded",a(null))}f.request=p.getImage(this.map._requestManager.transformRequest(d,p.ResourceType.Tile),function(x,C,M,D){if(delete f.request,f.aborted)f.state="unloaded",a(null);else if(x)f.state="errored",a(x);else if(C){this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:M,expires:D});const O=p.window.ImageBitmap&&C instanceof p.window.ImageBitmap&&(null==be&&(be=p.window.OffscreenCanvas&&new p.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof p.window.createImageBitmap),be),z=1-(C.width-p.prevPowerOfTwo(C.width))/2;z<1||f.neighboringTiles||(f.neighboringTiles=this._getNeighboringTiles(f.tileID));const F=O?C:p.exported.getImageData(C,z),U={uid:f.uid,coord:f.tileID,source:this.id,rawImageData:F,encoding:this.encoding,padding:z};f.actor&&"expired"!==f.state||(f.actor=this.dispatcher.getActor(),f.actor.send("loadDEMTile",U,g.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(f){const a=f.canonical,d=Math.pow(2,a.z),g=(a.x-1+d)%d,x=0===a.x?f.wrap-1:f.wrap,C=(a.x+1+d)%d,M=a.x+1===d?f.wrap+1:f.wrap,D={};return D[new p.OverscaledTileID(f.overscaledZ,x,a.z,g,a.y).key]={backfilled:!1},D[new p.OverscaledTileID(f.overscaledZ,M,a.z,C,a.y).key]={backfilled:!1},a.y>0&&(D[new p.OverscaledTileID(f.overscaledZ,x,a.z,g,a.y-1).key]={backfilled:!1},D[new p.OverscaledTileID(f.overscaledZ,f.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},D[new p.OverscaledTileID(f.overscaledZ,M,a.z,C,a.y-1).key]={backfilled:!1}),a.y+1<d&&(D[new p.OverscaledTileID(f.overscaledZ,x,a.z,g,a.y+1).key]={backfilled:!1},D[new p.OverscaledTileID(f.overscaledZ,f.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},D[new p.OverscaledTileID(f.overscaledZ,M,a.z,C,a.y+1).key]={backfilled:!1}),D}unloadTile(f){f.demTexture&&this.map.painter.saveTileTexture(f.demTexture),f.fbo&&(f.fbo.destroy(),delete f.fbo),f.dem&&delete f.dem,delete f.neighboringTiles,f.state="unloaded"}},geojson:class extends p.Evented{constructor(f,a,d,g){super(),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(g),this._data=a.data,this._options=p.extend({},a),this._collectResourceTiming=a.collectResourceTiming,void 0!==a.maxzoom&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const x=p.EXTENT/this.tileSize;this.workerOptions=p.extend({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(void 0!==a.buffer?a.buffer:128)*x,tolerance:(void 0!==a.tolerance?a.tolerance:.375)*x,extent:p.EXTENT,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:void 0!==a.clusterMaxZoom?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:p.EXTENT,radius:(void 0!==a.clusterRadius?a.clusterRadius:50)*x,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions)}onAdd(f){this.map=f,this.setData(this._data)}setData(f){return this._data=f,this._updateWorkerData(),this}getClusterExpansionZoom(f,a){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id},a),this}getClusterChildren(f,a){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id},a),this}getClusterLeaves(f,a,d,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:f,limit:a,offset:d},g),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new p.Event("dataloading",{dataType:"source"})),this._loaded=!1;const f=p.extend({},this.workerOptions),a=this._data;"string"==typeof a?(f.request=this.map._requestManager.transformRequest(p.exported.resolveURL(a),p.ResourceType.Source),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(a),this._pendingLoad=this.actor.send(`${this.type}.loadData`,f,(d,g)=>{if(this._loaded=!0,this._pendingLoad=null,d)this.fire(new p.ErrorEvent(d));else{const x={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&g&&g.resourceTiming&&g.resourceTiming[this.id]&&(x.resourceTiming=g.resourceTiming[this.id]),this.fire(new p.Event("data",x)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(f,a){const d=f.actor?"reloadTile":"loadTile";f.actor=this.actor,f.request=this.actor.send(d,{type:this.type,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:p.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(g,x)=>(delete f.request,f.unloadVectorData(),f.aborted?a(null):g?a(g):(f.loadVectorData(x,this.map.painter,"reloadTile"===d),a(null))),void 0,"loadTile"===d)}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0}unloadTile(f){f.unloadVectorData(),this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return p.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ae{constructor(f,a,d,g){super(f,a,d,g),this.roundZoom=!0,this.type="video",this.options=a}load(){this._loaded=!1;const f=this.options;this.urls=[];for(const a of f.urls)this.urls.push(this.map._requestManager.transformRequest(a,p.ResourceType.Source).url);p.getVideo(this.urls,(a,d)=>{this._loaded=!0,a?this.fire(new p.ErrorEvent(a)):d&&(this.video=d,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(f){if(this.video){const a=this.video.seekable;f<a.start(0)||f>a.end(0)?this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=f}}getVideo(){return this.video}onAdd(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const f=this.map.painter.context,a=f.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new p.Texture(f,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(f)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ae,canvas:class extends Ae{constructor(f,a,d,g){super(f,a,d,g),a.coordinates?Array.isArray(a.coordinates)&&4===a.coordinates.length&&!a.coordinates.some(x=>!Array.isArray(x)||2!==x.length||x.some(C=>"number"!=typeof C))||this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${f}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${f}`,null,'missing required property "coordinates"'))),a.animate&&"boolean"!=typeof a.animate&&this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${f}`,null,'optional "animate" property must be a boolean value'))),a.canvas?"string"==typeof a.canvas||a.canvas instanceof p.window.HTMLCanvasElement||this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${f}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${f}`,null,'missing required property "canvas"'))),this.options=a,this.animate=void 0===a.animate||a.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof p.window.HTMLCanvasElement?this.options.canvas:p.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new p.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const a=this.map.painter.context;this.texture?(f||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new p.Texture(a,this.canvas,a.gl.RGBA,{premultiply:!0}),this._prepareData(a)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const f of[this.canvas.width,this.canvas.height])if(isNaN(f)||f<=0)return!0;return!1}},custom:class extends p.Evented{constructor(f,a,d,g){super(),this.id=f,this.type="custom",this._dataType="raster",this._dispatcher=d,this._implementation=a,this.setEventedParent(g),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new p.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new p.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Es(this._implementation.bounds,this.minzoom,this.maxzoom)),a.update=this._update.bind(this),a.coveringTiles=this._coveringTiles.bind(this),p.extend(this,p.pick(a,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return p.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(f){this._map=f,this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(f),this.load()}onRemove(f){this._implementation.onRemove&&this._implementation.onRemove(f)}hasTile(f){if(this._implementation.hasTile){const{x:a,y:d,z:g}=f.canonical;return this._implementation.hasTile({x:a,y:d,z:g})}return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,a){const{x:d,y:g,z:x}=f.tileID.canonical,C=new p.window.AbortController,M=this._implementation.loadTile({x:d,y:g,z:x},{signal:C.signal});if(!M)return this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",a(null);M.cancel=()=>C.abort(),f.request=M.then(function(D){return delete f.request,f.aborted?(f.state="unloaded",a(null)):D?(O=D)instanceof p.window.ImageData||O instanceof p.window.ImageBitmap||O instanceof p.window.HTMLCanvasElement?(this.loadTileData(f,D),f.state="loaded",void a(null)):(f.state="errored",a(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`))):(this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",a(null));var O}.bind(this)).catch(D=>{20!==D.code&&(f.state="errored",a(D))})}loadTileData(f,a){ue.loadTileData(f,a,this._map.painter)}unloadTileData(f){ue.unloadTileData(f,this._map.painter)}prepareTile(f){if(!this._implementation.prepareTile)return null;const{x:a,y:d,z:g}=f.tileID.canonical,x=this._implementation.prepareTile({x:a,y:d,z:g});return x?(this.loadTileData(f,x),f.state="loaded",x):null}unloadTile(f,a){if(this.unloadTileData(f),this._implementation.unloadTile){const{x:d,y:g,z:x}=f.tileID.canonical;this._implementation.unloadTile({x:d,y:g,z:x})}a()}abortTile(f,a){f.request&&f.request.cancel&&(f.request.cancel(),delete f.request),a()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(f=>({x:f.canonical.x,y:f.canonical.y,z:f.canonical.z}))}_update(){this.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Me=function(f,a,d,g){const x=new we[a.type](f,a,d,g);if(x.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${x.id}`);return p.bindAll(["load","abort","unload","serialize","prepare"],x),x};function Ye(f,a){const d=p.identity([]);return p.scale(d,d,[.5*f.width,.5*-f.height,1]),p.translate(d,d,[1,-1,0]),p.multiply(d,d,f.calculateProjMatrix(a.toUnwrapped())),Float32Array.from(d)}function st(f,a,d,g,x,C,M,D=!1){const O=f.tilesIn(g,M,D);O.sort(St);const z=[];for(const U of O)z.push({wrappedTileID:U.tile.tileID.wrapped().key,queryResults:U.tile.queryRenderedFeatures(a,d,f._state,U,x,C,Ye(f.transform,U.tile.tileID),D)});const F=function(U){const W={},ne={};for(const K of U){const J=K.queryResults,te=K.wrappedTileID,X=ne[te]=ne[te]||{};for(const re in J){const ie=J[re],xe=X[re]=X[re]||{},ge=W[re]=W[re]||[];for(const pe of ie)xe[pe.featureIndex]||(xe[pe.featureIndex]=!0,ge.push(pe))}}return W}(z);for(const U in F)F[U].forEach(W=>{const ne=W.feature,K=ne.layer;K&&"background"!==K.type&&"sky"!==K.type&&(ne.source=K.source,K["source-layer"]&&(ne.sourceLayer=K["source-layer"]),ne.state=void 0!==ne.id?f.getFeatureState(K["source-layer"],ne.id):{})});return F}function Xe(f,a){const d=f.getRenderableIds().map(C=>f.getTileByID(C)),g=[],x={};for(let C=0;C<d.length;C++){const M=d[C],D=M.tileID.canonical.key;x[D]||(x[D]=!0,M.querySourceFeatures(g,a))}return g}function St(f,a){const d=f.tileID,g=a.tileID;return d.overscaledZ-g.overscaledZ||d.canonical.y-g.canonical.y||d.wrap-g.wrap||d.canonical.x-g.canonical.x}function Ft(){return null!=ua.workerClass?new ua.workerClass:new p.window.Worker(ua.workerUrl)}const Pt="mapboxgl_preloaded_worker_pool";class Nt{constructor(){this.active={}}acquire(a){if(!this.workers)for(this.workers=[];this.workers.length<Nt.workerCount;)this.workers.push(new Ft);return this.active[a]=!0,this.workers.slice()}release(a){delete this.active[a],0===this.numActive()&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Pt]}numActive(){return Object.keys(this.active).length}}let tn;function Ln(){return tn||(tn=new Nt),tn}function Mn(f,a){const d={};for(const g in f)"ref"!==g&&(d[g]=f[g]);return p.refProperties.forEach(g=>{g in a&&(d[g]=a[g])}),d}function zn(f){f=f.slice();const a=Object.create(null);for(let d=0;d<f.length;d++)a[f[d].id]=f[d];for(let d=0;d<f.length;d++)"ref"in f[d]&&(f[d]=Mn(f[d],a[f[d].ref]));return f}Nt.workerCount=2;const Rt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Re(f,a,d){d.push({command:Rt.addSource,args:[f,a[f]]})}function Xr(f,a,d){a.push({command:Rt.removeSource,args:[f]}),d[f]=!0}function yi(f,a,d,g){Xr(f,d,g),Re(f,a,d)}function ea(f,a,d){let g;for(g in f[d])if(f[d].hasOwnProperty(g)&&"data"!==g&&!ot(f[d][g],a[d][g]))return!1;for(g in a[d])if(a[d].hasOwnProperty(g)&&"data"!==g&&!ot(f[d][g],a[d][g]))return!1;return!0}function Eu(f,a,d,g,x,C){let M;for(M in a=a||{},f=f||{})f.hasOwnProperty(M)&&(ot(f[M],a[M])||d.push({command:C,args:[g,M,a[M],x]}));for(M in a)a.hasOwnProperty(M)&&!f.hasOwnProperty(M)&&(ot(f[M],a[M])||d.push({command:C,args:[g,M,a[M],x]}))}function xo(f){return f.id}function Tu(f,a){return f[a.id]=a,f}class Vf{constructor(a,d){this.reset(a,d)}reset(a,d){this.points=a||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(a){if(1===this.points.length)return this.points[0];a=p.clamp(a,0,1);let d=1,g=this._distances[d];const x=a*this.paddedLength+this.padding;for(;g<x&&d<this._distances.length;)g=this._distances[++d];const C=d-1,M=this._distances[C],D=g-M,O=D>0?(x-M)/D:0;return this.points[C].mult(1-O).add(this.points[d].mult(O))}}class Si{constructor(a,d,g){const x=this.boxCells=[],C=this.circleCells=[];this.xCellCount=Math.ceil(a/g),this.yCellCount=Math.ceil(d/g);for(let M=0;M<this.xCellCount*this.yCellCount;M++)x.push([]),C.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=d,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(a,d,g,x,C){this._forEachCell(d,g,x,C,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(d),this.bboxes.push(g),this.bboxes.push(x),this.bboxes.push(C)}insertCircle(a,d,g,x){this._forEachCell(d-x,g-x,d+x,g+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(d),this.circles.push(g),this.circles.push(x)}_insertBoxCell(a,d,g,x,C,M){this.boxCells[C].push(M)}_insertCircleCell(a,d,g,x,C,M){this.circleCells[C].push(M)}_query(a,d,g,x,C,M){if(g<0||a>this.width||x<0||d>this.height)return!C&&[];const D=[];if(a<=0&&d<=0&&this.width<=g&&this.height<=x){if(C)return!0;for(let O=0;O<this.boxKeys.length;O++)D.push({key:this.boxKeys[O],x1:this.bboxes[4*O],y1:this.bboxes[4*O+1],x2:this.bboxes[4*O+2],y2:this.bboxes[4*O+3]});for(let O=0;O<this.circleKeys.length;O++){const z=this.circles[3*O],F=this.circles[3*O+1],U=this.circles[3*O+2];D.push({key:this.circleKeys[O],x1:z-U,y1:F-U,x2:z+U,y2:F+U})}return M?D.filter(M):D}return this._forEachCell(a,d,g,x,this._queryCell,D,{hitTest:C,seenUids:{box:{},circle:{}}},M),C?D.length>0:D}_queryCircle(a,d,g,x,C){const M=a-g,D=a+g,O=d-g,z=d+g;if(D<0||M>this.width||z<0||O>this.height)return!x&&[];const F=[];return this._forEachCell(M,O,D,z,this._queryCellCircle,F,{hitTest:x,circle:{x:a,y:d,radius:g},seenUids:{box:{},circle:{}}},C),x?F.length>0:F}query(a,d,g,x,C){return this._query(a,d,g,x,!1,C)}hitTest(a,d,g,x,C){return this._query(a,d,g,x,!0,C)}hitTestCircle(a,d,g,x){return this._queryCircle(a,d,g,!0,x)}_queryCell(a,d,g,x,C,M,D,O){const z=D.seenUids,F=this.boxCells[C];if(null!==F){const W=this.bboxes;for(const ne of F)if(!z.box[ne]){z.box[ne]=!0;const K=4*ne;if(a<=W[K+2]&&d<=W[K+3]&&g>=W[K+0]&&x>=W[K+1]&&(!O||O(this.boxKeys[ne]))){if(D.hitTest)return M.push(!0),!0;M.push({key:this.boxKeys[ne],x1:W[K],y1:W[K+1],x2:W[K+2],y2:W[K+3]})}}}const U=this.circleCells[C];if(null!==U){const W=this.circles;for(const ne of U)if(!z.circle[ne]){z.circle[ne]=!0;const K=3*ne;if(this._circleAndRectCollide(W[K],W[K+1],W[K+2],a,d,g,x)&&(!O||O(this.circleKeys[ne]))){if(D.hitTest)return M.push(!0),!0;{const J=W[K],te=W[K+1],X=W[K+2];M.push({key:this.circleKeys[ne],x1:J-X,y1:te-X,x2:J+X,y2:te+X})}}}}}_queryCellCircle(a,d,g,x,C,M,D,O){const z=D.circle,F=D.seenUids,U=this.boxCells[C];if(null!==U){const ne=this.bboxes;for(const K of U)if(!F.box[K]){F.box[K]=!0;const J=4*K;if(this._circleAndRectCollide(z.x,z.y,z.radius,ne[J+0],ne[J+1],ne[J+2],ne[J+3])&&(!O||O(this.boxKeys[K])))return M.push(!0),!0}}const W=this.circleCells[C];if(null!==W){const ne=this.circles;for(const K of W)if(!F.circle[K]){F.circle[K]=!0;const J=3*K;if(this._circlesCollide(ne[J],ne[J+1],ne[J+2],z.x,z.y,z.radius)&&(!O||O(this.circleKeys[K])))return M.push(!0),!0}}}_forEachCell(a,d,g,x,C,M,D,O){const z=this._convertToXCellCoord(a),F=this._convertToYCellCoord(d),U=this._convertToXCellCoord(g),W=this._convertToYCellCoord(x);for(let ne=z;ne<=U;ne++)for(let K=F;K<=W;K++)if(C.call(this,a,d,g,x,this.xCellCount*K+ne,M,D,O))return}_convertToXCellCoord(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))}_convertToYCellCoord(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))}_circlesCollide(a,d,g,x,C,M){const D=x-a,O=C-d,z=g+M;return z*z>D*D+O*O}_circleAndRectCollide(a,d,g,x,C,M,D){const O=(M-x)/2,z=Math.abs(a-(x+O));if(z>O+g)return!1;const F=(D-C)/2,U=Math.abs(d-(C+F));if(U>F+g)return!1;if(z<=O||U<=F)return!0;const W=z-O,ne=U-F;return W*W+ne*ne<=g*g}}const gt=Math.tan(85*Math.PI/180);function cn(f,a,d,g,x,C,M){const D=p.create();if(d)if("globe"===C.name){const O=p.calculateGlobeLabelMatrix(x,a);p.multiply(D,D,O)}else{const O=Xs([],M);D[0]=O[0],D[1]=O[1],D[4]=O[2],D[5]=O[3],g||p.rotateZ(D,D,x.angle)}else p.multiply(D,x.labelPlaneMatrix,f);return D}function rn(f,a,d,g,x,C,M){const D=cn(f,a,d,g,x,C,M);return"globe"===C.name&&d||(D[2]=D[6]=D[10]=D[14]=0),D}function wn(f,a,d,g,x,C,M){if(d){if("globe"===C.name){const D=cn(f,a,d,g,x,C,M);return p.invert(D,D),p.multiply(D,f,D),D}{const D=p.clone(f),O=p.identity([]);return O[0]=M[0],O[1]=M[1],O[4]=M[2],O[5]=M[3],p.multiply(D,D,O),g||p.rotateZ(D,D,-x.angle),D}}return x.glCoordMatrix}function Qr(f,a,d=0){const g=[f.x,f.y,d,1];d?p.transformMat4$1(g,g,a):Rr(g,g,a);const x=g[3];return{point:[g[0]/x,g[1]/x,g[2]/x],signedDistanceFromCamera:x}}function Ct(f,a){const d=[f[0],f[1],f[2],1];p.transformMat4$1(d,d,a);const g=d[3];return{point:[d[0]/g,d[1]/g,d[2]/g],signedDistanceFromCamera:g}}function Da(f,a){return Math.min(.5+f/a*.5,1.5)}function Ql(f,a){const d=f[0]/f[3],g=f[1]/f[3];return d>=-a[0]&&d<=a[0]&&g>=-a[1]&&g<=a[1]}function Ia(f,a,d,g,x,C,M,D,O,z){const F=d.transform,U=g?f.textSizeData:f.iconSizeData,W=p.evaluateSizeForZoom(U,d.transform.zoom),ne="globe"===F.projection.name,K=[256/d.width*2+1,256/d.height*2+1],J=g?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;J.clear();let te=null;ne&&(te=g?f.text.globeExtVertexArray:f.icon.globeExtVertexArray);const X=f.lineVertexArray,re=g?f.text.placedSymbolArray:f.icon.placedSymbolArray,ie=d.transform.width/d.transform.height;let xe=!1;for(let ge=0;ge<re.length;ge++){const pe=re.get(ge);if(pe.writingMode!==p.WritingMode.vertical||xe||0!==ge&&re.get(ge-1).writingMode===p.WritingMode.horizontal||(xe=!0),(pe.hidden||pe.writingMode===p.WritingMode.vertical)&&!xe){ta(pe.numGlyphs,J);continue}xe=!1;const ve=new p.pointGeometry(pe.tileAnchorX,pe.tileAnchorY),_e=O?O(ve):[0,0,0],Ce=F.projection.projectTilePoint(ve.x,ve.y,z.canonical),Se=[Ce.x+_e[0],Ce.y+_e[1],Ce.z+_e[2]],Je=[...Se,1];if(p.transformMat4$1(Je,Je,a),!Ql(Je,K)){ta(pe.numGlyphs,J);continue}const Ee=Da(d.transform.cameraToCenterDistance,Je[3]),je=p.evaluateSizeForFeature(U,W,pe),Ge=M?je/Ee:je*Ee,at=Qr(new p.pointGeometry(Se[0],Se[1]),x,Se[2]);if(at.signedDistanceFromCamera<=0){ta(pe.numGlyphs,J);continue}let ke={};const et=M?null:O,He=Uf(pe,Ge,!1,D,a,x,C,f.glyphOffsetArray,X,J,te,at.point,ve,ke,ie,et,F.projection,z,M);xe=He.useVertical,et&&He.needsFlipping&&(ke={}),(He.notEnoughRoom||xe||He.needsFlipping&&Uf(pe,Ge,!0,D,a,x,C,f.glyphOffsetArray,X,J,te,at.point,ve,ke,ie,et,F.projection,z,M).notEnoughRoom)&&ta(pe.numGlyphs,J)}g?(f.text.dynamicLayoutVertexBuffer.updateData(J),te&&f.text.globeExtVertexBuffer.updateData(te)):(f.icon.dynamicLayoutVertexBuffer.updateData(J),te&&f.icon.globeExtVertexBuffer.updateData(te))}function Ut(f,a,d,g,x,C,M,D,O,z,F,U,W,ne,K,J){const te=D.glyphStartIndex+D.numGlyphs,X=D.lineStartIndex,re=D.lineStartIndex+D.lineLength,ie=a.getoffsetX(D.glyphStartIndex),xe=a.getoffsetX(te-1),ge=qt(f*ie,d,g,x,C,M,D.segment,X,re,O,z,F,U,W,!0,ne,K,J);if(!ge)return null;const pe=qt(f*xe,d,g,x,C,M,D.segment,X,re,O,z,F,U,W,!0,ne,K,J);return pe?{first:ge,last:pe}:null}function ci(f,a,d,g){return f.writingMode===p.WritingMode.horizontal&&Math.abs(d.y-a.y)>Math.abs(d.x-a.x)*g?{useVertical:!0}:f.writingMode===p.WritingMode.vertical?a.y<d.y?{needsFlipping:!0}:null:0!==f.flipState&&function(x,C,M){const D=(C.x-x.x)*M;return 0===D||Math.abs((C.y-x.y)/D)>gt}(a,d,g)?1===f.flipState?{needsFlipping:!0}:null:a.x>d.x?{needsFlipping:!0}:null}function Uf(f,a,d,g,x,C,M,D,O,z,F,U,W,ne,K,J,te,X,re){const ie=a/24,xe=f.lineOffsetX*ie,ge=f.lineOffsetY*ie;let pe;if(f.numGlyphs>1){const ve=f.glyphStartIndex+f.numGlyphs,_e=f.lineStartIndex,Ce=f.lineStartIndex+f.lineLength,Se=Ut(ie,D,xe,ge,d,U,W,f,O,C,ne,J,!1,te,X,re);if(!Se)return{notEnoughRoom:!0};const Je=Ct(Se.first.point,M).point,Ee=Ct(Se.last.point,M).point,je=new p.pointGeometry(Je[0],Je[1]),Ge=new p.pointGeometry(Ee[0],Ee[1]);if(g&&!d){const at=ci(f,je,Ge,K);if(f.flipState=at&&at.needsFlipping?1:2,at)return at}pe=[Se.first];for(let at=f.glyphStartIndex+1;at<ve-1;at++)pe.push(qt(ie*D.getoffsetX(at),xe,ge,d,U,W,f.segment,_e,Ce,O,C,ne,J,!1,!1,te,X,re));pe.push(Se.last)}else{if(g&&!d){const _e=Qr(W,x).point,Ce=f.lineStartIndex+f.segment+1,Se=new p.pointGeometry(O.getx(Ce),O.gety(Ce)),Je=Qr(Se,x),Ee=Je.signedDistanceFromCamera>0?Je.point:xl(W,Se,_e,1,x,void 0,te,X.canonical),je=ci(f,new p.pointGeometry(_e[0],_e[1]),new p.pointGeometry(Ee[0],Ee[1]),K);if(f.flipState=je&&je.needsFlipping?1:2,je)return je}const ve=qt(ie*D.getoffsetX(f.glyphStartIndex),xe,ge,d,U,W,f.segment,f.lineStartIndex,f.lineStartIndex+f.lineLength,O,C,ne,J,!1,!1,te,X,re);if(!ve)return{notEnoughRoom:!0};pe=[ve]}if(F)for(const ve of pe)p.updateGlobeVertexNormal(F,z.length+0,ve.up[0],ve.up[1],ve.up[2]),p.updateGlobeVertexNormal(F,z.length+1,ve.up[0],ve.up[1],ve.up[2]),p.updateGlobeVertexNormal(F,z.length+2,ve.up[0],ve.up[1],ve.up[2]),p.updateGlobeVertexNormal(F,z.length+3,ve.up[0],ve.up[1],ve.up[2]),p.addDynamicAttributes(z,ve.point[0],ve.point[1],ve.point[2],ve.angle);else for(const ve of pe)p.addDynamicAttributes(z,ve.point[0],ve.point[1],ve.point[2],ve.angle);return{}}function En(f,a,d,g,x){const C=g.projectTilePoint(f.x,f.y,a);if(!x)return Qr(C,d,C.z);const M=x(f);return Qr(new p.pointGeometry(C.x+M[0],C.y+M[1]),d,C.z+M[2])}function xl(f,a,d,g,x,C,M,D){const O=En(f.add(f.sub(a)._unit()),D,x,M,C).point,z=p.sub([],d,O);return p.scaleAndAdd([],d,z,g/p.length(z))}function qt(f,a,d,g,x,C,M,D,O,z,F,U,W,ne,K,J,te,X){const re=g?f-a:f+a;let ie=re>0?1:-1,xe=0;g&&(ie*=-1,xe=Math.PI),ie<0&&(xe+=Math.PI);let ge=ie>0?D+M:D+M+1,pe=x,ve=x,_e=0,Ce=0;const Se=Math.abs(re),Je=[],Ee=[];let je=C;const Ge=()=>{const Et=ge-ie;return 0===_e?C:new p.pointGeometry(z.getx(Et),z.gety(Et))},at=()=>xl(Ge(),je,ve,Se-_e+1,F,W,J,te.canonical);for(;_e+Ce<=Se;){if(ge+=ie,ge<D||ge>=O)return null;if(ve=pe,Je.push(pe),ne&&Ee.push(je||Ge()),pe=U[ge],void 0===pe){je=new p.pointGeometry(z.getx(ge),z.gety(ge));const Et=En(je,te.canonical,F,J,W);pe=Et.signedDistanceFromCamera>0?U[ge]=Et.point:at()}else je=null;_e+=Ce,Ce=p.distance(ve,pe)}je=je||new p.pointGeometry(z.getx(ge),z.gety(ge));const ke=Ge();K&&W&&(U[ge]=pe=void 0===U[ge]?pe:at(),Ce=p.distance(ve,pe));const et=(Se-_e)/Ce,He=je.sub(ke).mult(et)._add(ke),ht=p.sub([],pe,ve),lt=p.scaleAndAdd([],ve,ht,et);let wt=[0,0,1],Lt=ht[0],jt=ht[1];if(X&&(wt=J.upVector(te.canonical,He.x,He.y),0!==wt[0]||0!==wt[1]||1!==wt[2])){const Et=[1,0,0],Wt=[0,1,0];Et[0]=wt[2],Et[1]=0,Et[2]=-wt[0],p.cross(Wt,wt,Et),p.normalize(Et,Et),p.normalize(Wt,Wt),Lt=p.dot(ht,Et),jt=p.dot(ht,Wt)}if(d){const Et=p.cross([],wt,ht);p.normalize(Et,Et),p.scaleAndAdd(lt,lt,Et,d*ie)}const un=xe+Math.atan2(jt,Lt);return Je.push(lt),ne&&Ee.push(He),{point:lt,angle:un,path:Je,tilePath:Ee,up:wt}}const Ui=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ta(f,a){for(let d=0;d<f;d++){const g=a.length;a.resize(g+4),a.float32.set(Ui,4*g)}}function Rr(f,a,d){const g=a[0],x=a[1];return f[0]=d[0]*g+d[4]*x+d[12],f[1]=d[1]*g+d[5]*x+d[13],f[3]=d[3]*g+d[7]*x+d[15],f}const qn=100;class bl{constructor(a,d,g=new Si(a.width+200,a.height+200,25),x=new Si(a.width+200,a.height+200,25)){this.transform=a,this.grid=g,this.ignoredGrid=x,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+qn,this.screenBottomBoundary=a.height+qn,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200,this.fogState=d}placeCollisionBox(a,d,g,x,C,M,D,O){let z=g.projectedAnchorX,F=g.projectedAnchorY,U=g.projectedAnchorZ;const W=g.elevation,ne=g.tileID;if(W&&ne){const ge=a.getProjection().upVector(ne.canonical,g.tileAnchorX,g.tileAnchorY),pe=a.getProjection().upVectorScale(ne.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;z+=ge[0]*W*pe,F+=ge[1]*W*pe,U+=ge[2]*W*pe}const K=this.projectAndGetPerspectiveRatio(D,[z,F,U],g.tileID,"globe"===a.projection.name||!!W||this.transform.pitch>0,a.getProjection()),J=M*K.perspectiveRatio,te=(g.x1*d+x.x-g.padding)*J+K.point.x,X=(g.y1*d+x.y-g.padding)*J+K.point.y,re=(g.x2*d+x.x+g.padding)*J+K.point.x,ie=(g.y2*d+x.y+g.padding)*J+K.point.y,xe=K.perspectiveRatio<=.55||K.occluded;return!this.isInsideGrid(te,X,re,ie)||!C&&this.grid.hitTest(te,X,re,ie,O)||xe?{box:[],offscreen:!1,occluded:K.occluded}:{box:[te,X,re,ie],offscreen:this.isOffscreen(te,X,re,ie),occluded:!1}}placeCollisionCircles(a,d,g,x,C,M,D,O,z,F,U,W,ne,K,J){const te=[],X=this.transform.elevation,re=X?X.getAtTileOffsetFunc(J,this.transform.center.lat,this.transform.worldSize,a.getProjection()):ke=>[0,0,0],ie=new p.pointGeometry(g.tileAnchorX,g.tileAnchorY),xe=a.getProjection().projectTilePoint(g.tileAnchorX,g.tileAnchorY,J.canonical),ge=re(ie),pe=[xe.x+ge[0],xe.y+ge[1],xe.z+ge[2]],ve="globe"===a.projection.name,_e=this.projectAndGetPerspectiveRatio(D,[pe[0],pe[1],pe[2]],J,ve||!!X||this.transform.pitch>0,a.getProjection()),{perspectiveRatio:Ce}=_e,Se=(U?M/Ce:M*Ce)/p.ONE_EM,Je=Qr(new p.pointGeometry(pe[0],pe[1]),O,pe[2]).point,Ee=_e.signedDistanceFromCamera>0?Ut(Se,C,g.lineOffsetX*Se,g.lineOffsetY*Se,!1,Je,ie,g,x,O,{},X&&!U?re:null,U&&!!X,a.getProjection(),J,U):null;let je=!1,Ge=!1,at=!0;if(Ee&&!_e.occluded){const ke=.5*ne*Ce+K,et=new p.pointGeometry(-100,-100),He=new p.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),ht=new Vf,lt=Ee.first,wt=Ee.last;let Lt=[];for(let Et=lt.path.length-1;Et>=1;Et--)Lt.push(lt.path[Et]);for(let Et=1;Et<wt.path.length;Et++)Lt.push(wt.path[Et]);const jt=2.5*ke;if(z){const Et=Lt.map(X&&!ve?(Wt,pn)=>{const Kn=re(pn<lt.path.length-1?lt.tilePath[lt.path.length-1-pn]:wt.tilePath[pn-lt.path.length+2]);return Wt[2]=Kn[2],Ct(Wt,z)}:Wt=>Ct(Wt,z));Lt=Et.some(Wt=>Wt.signedDistanceFromCamera<=0)?[]:Et.map(Wt=>Wt.point)}let un=[];if(Lt.length>0){const Et=Lt.map(Dn=>new p.pointGeometry(Dn[0],Dn[1]));let Wt=1/0,pn=-1/0,Kn=1/0,di=-1/0;for(let Dn=0;Dn<Et.length;Dn++)Wt=Math.min(Wt,Et[Dn].x),Kn=Math.min(Kn,Et[Dn].y),pn=Math.max(pn,Et[Dn].x),di=Math.max(di,Et[Dn].y);un=Wt>=et.x&&pn<=He.x&&Kn>=et.y&&di<=He.y?[Et]:pn<et.x||Wt>He.x||di<et.y||Kn>He.y?[]:p.clipLine([Et],et.x,et.y,He.x,He.y)}for(const Et of un){ht.reset(Et,.25*ke);let Wt=0;Wt=ht.length<=.5*ke?1:Math.ceil(ht.paddedLength/jt)+1;for(let pn=0;pn<Wt;pn++){const Kn=pn/Math.max(Wt-1,1),di=ht.lerp(Kn),Dn=di.x+qn,Bi=di.y+qn;te.push(Dn,Bi,ke,0);const $o=Dn-ke,hs=Bi-ke,ni=Dn+ke,si=Bi+ke;if(at=at&&this.isOffscreen($o,hs,ni,si),Ge=Ge||this.isInsideGrid($o,hs,ni,si),!d&&this.grid.hitTestCircle(Dn,Bi,ke,W)&&(je=!0,!F))return{circles:[],offscreen:!1,collisionDetected:je,occluded:!1}}}}return{circles:!F&&je||!Ge?[]:te,offscreen:at,collisionDetected:je,occluded:_e.occluded}}queryRenderedSymbols(a){if(0===a.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const d=[];let g=1/0,x=1/0,C=-1/0,M=-1/0;for(const F of a){const U=new p.pointGeometry(F.x+qn,F.y+qn);g=Math.min(g,U.x),x=Math.min(x,U.y),C=Math.max(C,U.x),M=Math.max(M,U.y),d.push(U)}const D=this.grid.query(g,x,C,M).concat(this.ignoredGrid.query(g,x,C,M)),O={},z={};for(const F of D){const U=F.key;if(void 0===O[U.bucketInstanceId]&&(O[U.bucketInstanceId]={}),O[U.bucketInstanceId][U.featureIndex])continue;const W=[new p.pointGeometry(F.x1,F.y1),new p.pointGeometry(F.x2,F.y1),new p.pointGeometry(F.x2,F.y2),new p.pointGeometry(F.x1,F.y2)];p.polygonIntersectsPolygon(d,W)&&(O[U.bucketInstanceId][U.featureIndex]=!0,void 0===z[U.bucketInstanceId]&&(z[U.bucketInstanceId]=[]),z[U.bucketInstanceId].push(U.featureIndex))}return z}insertCollisionBox(a,d,g,x,C){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:x,collisionGroupID:C},a[0],a[1],a[2],a[3])}insertCollisionCircles(a,d,g,x,C){const M=d?this.ignoredGrid:this.grid,D={bucketInstanceId:g,featureIndex:x,collisionGroupID:C};for(let O=0;O<a.length;O+=4)M.insertCircle(D,a[O],a[O+1],a[O+2])}projectAndGetPerspectiveRatio(a,d,g,x,C){const M=[d[0],d[1],d[2],1];let D=!1;if(d[2]||this.transform.pitch>0){p.transformMat4$1(M,M,a);const O="globe"===C.name;this.fogState&&g&&!O&&(D=function(z,F,U,W,ne,K){const J=K.calculateFogTileMatrix(ne),te=[F,U,W];return p.transformMat4(te,te,J),Cs(z,te,K.pitch,K._fov)}(this.fogState,d[0],d[1],d[2],g.toUnwrapped(),this.transform)>.9)}else Rr(M,M,a);return{point:new p.pointGeometry((M[0]/M[3]+1)/2*this.transform.width+qn,(-M[1]/M[3]+1)/2*this.transform.height+qn),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(C)/M[3]*.5,1.5),signedDistanceFromCamera:M[3],occluded:x&&M[2]>M[3]||D}}isOffscreen(a,d,g,x){return g<qn||a>=this.screenRightBoundary||x<qn||d>this.screenBottomBoundary}isInsideGrid(a,d,g,x){return g>=0&&a<this.gridRightBoundary&&x>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const a=p.identity([]);return p.translate(a,a,[-100,-100,0]),a}}function er(f,a,d){const g=a.createTileMatrix(f,f.worldSize,d.toUnwrapped());return p.multiply(new Float32Array(16),f.projMatrix,g)}function Kr(f,a,d){if(a.projection.name===d.projection.name)return f.projMatrix;const g=d.clone();return g.setProjection(a.projection),er(g,a.getProjection(),f)}function Lr(f,a,d){return a.name===d.projection.name?f.projMatrix:er(d,a,f)}class Hh{constructor(a,d,g,x){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?d:-d))):x&&g?1:0,this.placed=g}isHidden(){return 0===this.opacity&&!this.placed}}class dr{constructor(a,d,g,x,C,M=!1){this.text=new Hh(a?a.text:null,d,g,C),this.icon=new Hh(a?a.icon:null,d,x,C),this.clipped=M}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Di{constructor(a,d,g,x=!1){this.text=a,this.icon=d,this.skipFade=g,this.clipped=x}}class Mu{constructor(){this.invProjMatrix=p.create(),this.viewportMatrix=p.create(),this.circles=[]}}class qh{constructor(a,d,g,x,C){this.bucketInstanceId=a,this.featureIndex=d,this.sourceLayerIndex=g,this.bucketIndex=x,this.tileID=C}}class Su{constructor(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}}get(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){const d=++this.maxGroupID;this.collisionGroups[a]={ID:d,predicate:g=>g.collisionGroupID===d}}return this.collisionGroups[a]}}function Zi(f,a,d,g,x){const{horizontalAlign:C,verticalAlign:M}=p.getAnchorAlignment(f),D=-(C-.5)*a,O=-(M-.5)*d,z=p.evaluateVariableOffset(f,g);return new p.pointGeometry(D+z[0]*x,O+z[1]*x)}function Du(f,a,d,g,x){const C=new p.pointGeometry(f,a);return d&&C._rotate(g?x:-x),C}class Nd{constructor(a,d,g,x,C){this.transform=a.clone(),this.projection=a.projection.name,this.collisionIndex=new bl(this.transform,C),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new Su(g),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(a,d,g,x){const C=g.getBucket(d),M=g.latestFeatureIndex;if(!C||!M||d.id!==C.layerIds[0])return;const D=C.layers[0].layout,O=g.collisionBoxArray,z=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),F=g.tileSize/p.EXTENT,U=g.tileID.toUnwrapped();this.transform.setProjection(C.projection);const W=(ne=g.tileID,K=C.getProjection(),J=this.transform,K.name===this.projection?J.calculateProjMatrix(ne.toUnwrapped()):er(J,K,ne));var ne,K,J;const te="map"===D.get("text-pitch-alignment"),X="map"===D.get("text-rotation-alignment");d.compileFilter();const re=d.dynamicFilter(),ie=d.dynamicFilterNeedsFeature(),xe=this.transform.calculatePixelsToTileUnitsMatrix(g),ge=rn(W,g.tileID.canonical,te,X,this.transform,C.getProjection(),xe);let pe=null;if(te){const Ce=wn(W,g.tileID.canonical,te,X,this.transform,C.getProjection(),xe);pe=p.multiply([],this.transform.labelPlaneMatrix,Ce)}let ve=null;re&&g.latestFeatureIndex&&(ve={unwrappedTileID:U,dynamicFilter:re,dynamicFilterNeedsFeature:ie,featureIndex:g.latestFeatureIndex}),this.retainedQueryData[C.bucketInstanceId]=new qh(C.bucketInstanceId,M,C.sourceLayerIndex,C.index,g.tileID);const _e={bucket:C,layout:D,posMatrix:W,textLabelPlaneMatrix:ge,labelToScreenMatrix:pe,clippingData:ve,scale:z,textPixelRatio:F,holdingForFade:g.holdingForFade(),collisionBoxArray:O,partiallyEvaluatedTextSize:p.evaluateSizeForZoom(C.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:p.evaluateSizeForZoom(C.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(C.sourceID)};if(x)for(const Ce of C.sortKeyRanges){const{sortKey:Se,symbolInstanceStart:Je,symbolInstanceEnd:Ee}=Ce;a.push({sortKey:Se,symbolInstanceStart:Je,symbolInstanceEnd:Ee,parameters:_e})}else a.push({symbolInstanceStart:0,symbolInstanceEnd:C.symbolInstances.length,parameters:_e})}attemptAnchorPlacement(a,d,g,x,C,M,D,O,z,F,U,W,ne,K,J,te,X,re){const ie=[W.textOffset0,W.textOffset1],xe=Zi(a,g,x,ie,C),ge=this.collisionIndex.placeCollisionBox(K,C,d,Du(xe.x,xe.y,M,D,this.transform.angle),U,O,z,F.predicate);if((!te||0!==this.collisionIndex.placeCollisionBox(K,K.getSymbolInstanceIconSize(re,this.transform.zoom,ne),te,Du(xe.x,xe.y,M,D,this.transform.angle),U,O,z,F.predicate).box.length)&&ge.box.length>0){let pe;return this.prevPlacement&&this.prevPlacement.variableOffsets[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID].text&&(pe=this.prevPlacement.variableOffsets[W.crossTileID].anchor),this.variableOffsets[W.crossTileID]={textOffset:ie,width:g,height:x,anchor:a,textScale:C,prevAnchor:pe},this.markUsedJustification(K,a,W,J),K.allowVerticalPlacement&&(this.markUsedOrientation(K,J,W),this.placedOrientations[W.crossTileID]=J),{shift:xe,placedGlyphBoxes:ge}}}placeLayerBucketPart(a,d,g,x){const{bucket:C,layout:M,posMatrix:D,textLabelPlaneMatrix:O,labelToScreenMatrix:z,clippingData:F,textPixelRatio:U,holdingForFade:W,collisionBoxArray:ne,partiallyEvaluatedTextSize:K,partiallyEvaluatedIconSize:J,collisionGroup:te}=a.parameters,X=M.get("text-optional"),re=M.get("icon-optional"),ie=M.get("text-allow-overlap"),xe=M.get("icon-allow-overlap"),ge="map"===M.get("text-rotation-alignment"),pe="map"===M.get("text-pitch-alignment"),ve="none"!==M.get("icon-text-fit"),_e="viewport-y"===M.get("symbol-z-order");this.transform.setProjection(C.projection);let Ce=ie&&(xe||!C.hasIconData()||re),Se=xe&&(ie||!C.hasTextData()||X);!C.collisionArrays&&ne&&C.deserializeCollisionBoxes(ne),g&&x&&C.updateCollisionDebugBuffers(this.transform.zoom,ne);const Je=(Ee,je,Ge)=>{if(F){const ni={zoom:this.transform.zoom,pitch:this.transform.pitch};let si=null;if(F.dynamicFilterNeedsFeature){const on=this.retainedQueryData[C.bucketInstanceId];si=F.featureIndex.loadFeature({featureIndex:Ee.featureIndex,bucketIndex:on.bucketIndex,sourceLayerIndex:on.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,F.dynamicFilter)(ni,si,this.retainedQueryData[C.bucketInstanceId].tileID.canonical,new p.pointGeometry(Ee.tileAnchorX,Ee.tileAnchorY),this.transform.calculateDistanceTileData(F.unwrappedTileID)))return this.placements[Ee.crossTileID]=new Di(!1,!1,!1,!0),void(d[Ee.crossTileID]=!0)}if(d[Ee.crossTileID])return;if(W)return void(this.placements[Ee.crossTileID]=new Di(!1,!1,!1));let at=!1,ke=!1,et=!0,He=!1,ht=!1,lt=null,wt={box:null,offscreen:null,occluded:null},Lt={box:null,offscreen:null,occluded:null},jt=null,un=null,Et=null,Wt=0,pn=0,Kn=0;Ge.textFeatureIndex?Wt=Ge.textFeatureIndex:Ee.useRuntimeCollisionCircles&&(Wt=Ee.featureIndex),Ge.verticalTextFeatureIndex&&(pn=Ge.verticalTextFeatureIndex);const di=ni=>{ni.tileID=this.retainedQueryData[C.bucketInstanceId].tileID,(this.transform.elevation||ni.elevation)&&(ni.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[C.bucketInstanceId].tileID,ni.tileAnchorX,ni.tileAnchorY):0)},Dn=Ge.textBox;if(Dn){di(Dn);const ni=on=>{let Pi=p.WritingMode.horizontal;if(C.allowVerticalPlacement&&!on&&this.prevPlacement){const fr=this.prevPlacement.placedOrientations[Ee.crossTileID];fr&&(this.placedOrientations[Ee.crossTileID]=fr,Pi=fr,this.markUsedOrientation(C,Pi,Ee))}return Pi},si=(on,Pi)=>{if(C.allowVerticalPlacement&&Ee.numVerticalGlyphVertices>0&&Ge.verticalTextBox){for(const fr of C.writingModes)if(fr===p.WritingMode.vertical?(wt=Pi(),Lt=wt):wt=on(),wt&&wt.box&&wt.box.length)break}else wt=on()};if(M.get("text-variable-anchor")){let on=M.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ee.crossTileID]){const Fn=this.prevPlacement.variableOffsets[Ee.crossTileID];on.indexOf(Fn.anchor)>0&&(on=on.filter(Ni=>Ni!==Fn.anchor),on.unshift(Fn.anchor))}const Pi=(Fn,Ni,$a)=>{const mr=C.getSymbolInstanceTextSize(K,Ee,this.transform.zoom,je),da=(Fn.x2-Fn.x1)*mr+2*Fn.padding,Ao=(Fn.y2-Fn.y1)*mr+2*Fn.padding,Ga=ve&&!xe?Ni:null;Ga&&di(Ga);let rr={box:[],offscreen:!1,occluded:!1};const Go=ie?2*on.length:on.length;for(let lo=0;lo<Go;++lo){const ps=this.attemptAnchorPlacement(on[lo%on.length],Fn,da,Ao,mr,ge,pe,U,D,te,lo>=on.length,Ee,je,C,$a,Ga,K,J);if(ps&&(rr=ps.placedGlyphBoxes,rr&&rr.box&&rr.box.length)){at=!0,lt=ps.shift;break}}return rr};si(()=>Pi(Dn,Ge.iconBox,p.WritingMode.horizontal),()=>{const Fn=Ge.verticalTextBox;return Fn&&di(Fn),C.allowVerticalPlacement&&!(wt&&wt.box&&wt.box.length)&&Ee.numVerticalGlyphVertices>0&&Fn?Pi(Fn,Ge.verticalIconBox,p.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),wt&&(at=wt.box,et=wt.offscreen,He=wt.occluded);const fr=ni(wt&&wt.box);if(!at&&this.prevPlacement){const Fn=this.prevPlacement.variableOffsets[Ee.crossTileID];Fn&&(this.variableOffsets[Ee.crossTileID]=Fn,this.markUsedJustification(C,Fn.anchor,Ee,fr))}}else{const on=(Pi,fr)=>{const Fn=C.getSymbolInstanceTextSize(K,Ee,this.transform.zoom,je),Ni=this.collisionIndex.placeCollisionBox(C,Fn,Pi,new p.pointGeometry(0,0),ie,U,D,te.predicate);return Ni&&Ni.box&&Ni.box.length&&(this.markUsedOrientation(C,fr,Ee),this.placedOrientations[Ee.crossTileID]=fr),Ni};si(()=>on(Dn,p.WritingMode.horizontal),()=>{const Pi=Ge.verticalTextBox;return C.allowVerticalPlacement&&Ee.numVerticalGlyphVertices>0&&Pi?(di(Pi),on(Pi,p.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),ni(wt&&wt.box&&wt.box.length)}}if(jt=wt,at=jt&&jt.box&&jt.box.length>0,et=jt&&jt.offscreen,He=jt&&jt.occluded,Ee.useRuntimeCollisionCircles){const ni=C.text.placedSymbolArray.get(Ee.centerJustifiedTextSymbolIndex>=0?Ee.centerJustifiedTextSymbolIndex:Ee.verticalPlacedTextSymbolIndex),si=p.evaluateSizeForFeature(C.textSizeData,K,ni),on=M.get("text-padding");un=this.collisionIndex.placeCollisionCircles(C,ie,ni,C.lineVertexArray,C.glyphOffsetArray,si,D,O,z,g,pe,te.predicate,Ee.collisionCircleDiameter*si/p.ONE_EM,on,this.retainedQueryData[C.bucketInstanceId].tileID),at=ie||un.circles.length>0&&!un.collisionDetected,et=et&&un.offscreen,He=un.occluded}if(Ge.iconFeatureIndex&&(Kn=Ge.iconFeatureIndex),Ge.iconBox){const ni=si=>{di(si);const on=ve&&lt?Du(lt.x,lt.y,ge,pe,this.transform.angle):new p.pointGeometry(0,0),Pi=C.getSymbolInstanceIconSize(J,this.transform.zoom,je);return this.collisionIndex.placeCollisionBox(C,Pi,si,on,xe,U,D,te.predicate)};Lt&&Lt.box&&Lt.box.length&&Ge.verticalIconBox?(Et=ni(Ge.verticalIconBox),ke=Et.box.length>0):(Et=ni(Ge.iconBox),ke=Et.box.length>0),et=et&&Et.offscreen,ht=Et.occluded}const Bi=X||0===Ee.numHorizontalGlyphVertices&&0===Ee.numVerticalGlyphVertices,$o=re||0===Ee.numIconVertices;if(Bi||$o?$o?Bi||(ke=ke&&at):at=ke&&at:ke=at=ke&&at,at&&jt&&jt.box&&this.collisionIndex.insertCollisionBox(jt.box,M.get("text-ignore-placement"),C.bucketInstanceId,Lt&&Lt.box&&pn?pn:Wt,te.ID),ke&&Et&&this.collisionIndex.insertCollisionBox(Et.box,M.get("icon-ignore-placement"),C.bucketInstanceId,Kn,te.ID),un&&(at&&this.collisionIndex.insertCollisionCircles(un.circles,M.get("text-ignore-placement"),C.bucketInstanceId,Wt,te.ID),g)){const ni=C.bucketInstanceId;let si=this.collisionCircleArrays[ni];void 0===si&&(si=this.collisionCircleArrays[ni]=new Mu);for(let on=0;on<un.circles.length;on+=4)si.circles.push(un.circles[on+0]),si.circles.push(un.circles[on+1]),si.circles.push(un.circles[on+2]),si.circles.push(un.collisionDetected?1:0)}const hs="globe"!==C.projection.name;Ce=Ce&&(hs||!He),Se=Se&&(hs||!ht),this.placements[Ee.crossTileID]=new Di(at||Ce,ke||Se,et||C.justReloaded),d[Ee.crossTileID]=!0};if(_e){const Ee=C.getSortedSymbolIndexes(this.transform.angle);for(let je=Ee.length-1;je>=0;--je){const Ge=Ee[je];Je(C.symbolInstances.get(Ge),Ge,C.collisionArrays[Ge])}}else for(let Ee=a.symbolInstanceStart;Ee<a.symbolInstanceEnd;Ee++)Je(C.symbolInstances.get(Ee),Ee,C.collisionArrays[Ee]);if(g&&C.bucketInstanceId in this.collisionCircleArrays){const Ee=this.collisionCircleArrays[C.bucketInstanceId];p.invert(Ee.invProjMatrix,D),Ee.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(a,d,g,x){let C;C=x===p.WritingMode.vertical?g.verticalPlacedTextSymbolIndex:{left:g.leftJustifiedTextSymbolIndex,center:g.centerJustifiedTextSymbolIndex,right:g.rightJustifiedTextSymbolIndex}[p.getAnchorJustification(d)];const M=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex,g.verticalPlacedTextSymbolIndex];for(const D of M)D>=0&&(a.text.placedSymbolArray.get(D).crossTileID=C>=0&&D!==C?0:g.crossTileID)}markUsedOrientation(a,d,g){const x=d===p.WritingMode.horizontal||d===p.WritingMode.horizontalOnly?d:0,C=d===p.WritingMode.vertical?d:0,M=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex];for(const D of M)a.text.placedSymbolArray.get(D).placedOrientation=x;g.verticalPlacedTextSymbolIndex&&(a.text.placedSymbolArray.get(g.verticalPlacedTextSymbolIndex).placedOrientation=C)}commit(a){this.commitTime=a,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let g=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const x=d?d.symbolFadeChange(a):1,C=d?d.opacities:{},M=d?d.variableOffsets:{},D=d?d.placedOrientations:{};for(const O in this.placements){const z=this.placements[O],F=C[O];F?(this.opacities[O]=new dr(F,x,z.text,z.icon,null,z.clipped),g=g||z.text!==F.text.placed||z.icon!==F.icon.placed):(this.opacities[O]=new dr(null,x,z.text,z.icon,z.skipFade,z.clipped),g=g||z.text||z.icon)}for(const O in C){const z=C[O];if(!this.opacities[O]){const F=new dr(z,x,!1,!1);F.isHidden()||(this.opacities[O]=F,g=g||z.text.placed||z.icon.placed)}}for(const O in M)this.variableOffsets[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.variableOffsets[O]=M[O]);for(const O in D)this.placedOrientations[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.placedOrientations[O]=D[O]);g?this.lastPlacementChangeTime=a:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:a)}updateLayerOpacities(a,d){const g={};for(const x of d){const C=x.getBucket(a);C&&x.latestFeatureIndex&&a.id===C.layerIds[0]&&this.updateBucketOpacities(C,g,x.collisionBoxArray)}}updateBucketOpacities(a,d,g){a.hasTextData()&&a.text.opacityVertexArray.clear(),a.hasIconData()&&a.icon.opacityVertexArray.clear(),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexArray.clear(),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexArray.clear();const x=a.layers[0].layout,C=!!a.layers[0].dynamicFilter(),M=new dr(null,0,!1,!1,!0),D=x.get("text-allow-overlap"),O=x.get("icon-allow-overlap"),z=x.get("text-variable-anchor"),F="map"===x.get("text-rotation-alignment"),U="map"===x.get("text-pitch-alignment"),W="none"!==x.get("icon-text-fit"),ne=new dr(null,0,D&&(O||!a.hasIconData()||x.get("icon-optional")),O&&(D||!a.hasTextData()||x.get("text-optional")),!0);!a.collisionArrays&&g&&(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData())&&a.deserializeCollisionBoxes(g);const K=(te,X,re)=>{for(let ie=0;ie<X/4;ie++)te.opacityVertexArray.emplaceBack(re)};let J=0;for(let te=0;te<a.symbolInstances.length;te++){const X=a.symbolInstances.get(te),{numHorizontalGlyphVertices:re,numVerticalGlyphVertices:ie,crossTileID:xe}=X;let ge=this.opacities[xe];d[xe]?ge=M:ge||(ge=ne,this.opacities[xe]=ge),d[xe]=!0;const pe=re>0||ie>0,ve=X.numIconVertices>0,_e=this.placedOrientations[X.crossTileID],Ce=_e===p.WritingMode.vertical,Se=_e===p.WritingMode.horizontal||_e===p.WritingMode.horizontalOnly;if(!pe&&!ve||ge.isHidden()||J++,pe){const Je=Li(ge.text);K(a.text,re,Ce?Jr:Je),K(a.text,ie,Se?Jr:Je);const Ee=ge.text.isHidden();[X.rightJustifiedTextSymbolIndex,X.centerJustifiedTextSymbolIndex,X.leftJustifiedTextSymbolIndex].forEach(at=>{at>=0&&(a.text.placedSymbolArray.get(at).hidden=Ee||Ce?1:0)}),X.verticalPlacedTextSymbolIndex>=0&&(a.text.placedSymbolArray.get(X.verticalPlacedTextSymbolIndex).hidden=Ee||Se?1:0);const je=this.variableOffsets[X.crossTileID];je&&this.markUsedJustification(a,je.anchor,X,_e);const Ge=this.placedOrientations[X.crossTileID];Ge&&(this.markUsedJustification(a,"left",X,Ge),this.markUsedOrientation(a,Ge,X))}if(ve){const Je=Li(ge.icon);X.placedIconSymbolIndex>=0&&(K(a.icon,X.numIconVertices,Ce?Jr:Je),a.icon.placedSymbolArray.get(X.placedIconSymbolIndex).hidden=ge.icon.isHidden()),X.verticalPlacedIconSymbolIndex>=0&&(K(a.icon,X.numVerticalIconVertices,Se?Jr:Je),a.icon.placedSymbolArray.get(X.verticalPlacedIconSymbolIndex).hidden=ge.icon.isHidden())}if(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData()){const Je=a.collisionArrays[te];if(Je){let Ee=new p.pointGeometry(0,0),je=!0;if(Je.textBox||Je.verticalTextBox){if(z){const at=this.variableOffsets[xe];at?(Ee=Zi(at.anchor,at.width,at.height,at.textOffset,at.textScale),F&&Ee._rotate(U?this.transform.angle:-this.transform.angle)):je=!1}C&&(je=!ge.clipped),Je.textBox&&Ro(a.textCollisionBox.collisionVertexArray,ge.text.placed,!je||Ce,Ee.x,Ee.y),Je.verticalTextBox&&Ro(a.textCollisionBox.collisionVertexArray,ge.text.placed,!je||Se,Ee.x,Ee.y)}const Ge=je&&Boolean(!Se&&Je.verticalIconBox);Je.iconBox&&Ro(a.iconCollisionBox.collisionVertexArray,ge.icon.placed,Ge,W?Ee.x:0,W?Ee.y:0),Je.verticalIconBox&&Ro(a.iconCollisionBox.collisionVertexArray,ge.icon.placed,!Ge,W?Ee.x:0,W?Ee.y:0)}}}if(a.fullyClipped=0===J,a.sortFeatures(this.transform.angle),this.retainedQueryData[a.bucketInstanceId]&&(this.retainedQueryData[a.bucketInstanceId].featureSortOrder=a.featureSortOrder),a.hasTextData()&&a.text.opacityVertexBuffer&&a.text.opacityVertexBuffer.updateData(a.text.opacityVertexArray),a.hasIconData()&&a.icon.opacityVertexBuffer&&a.icon.opacityVertexBuffer.updateData(a.icon.opacityVertexArray),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexBuffer&&a.iconCollisionBox.collisionVertexBuffer.updateData(a.iconCollisionBox.collisionVertexArray),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexBuffer&&a.textCollisionBox.collisionVertexBuffer.updateData(a.textCollisionBox.collisionVertexArray),a.bucketInstanceId in this.collisionCircleArrays){const te=this.collisionCircleArrays[a.bucketInstanceId];a.placementInvProjMatrix=te.invProjMatrix,a.placementViewportMatrix=te.viewportMatrix,a.collisionCircleArray=te.circles,delete this.collisionCircleArrays[a.bucketInstanceId]}}symbolFadeChange(a){return 0===this.fadeDuration?1:(a-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(a){return Math.max(0,(this.transform.zoom-a)/1.5)}hasTransitions(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(a,d){const g=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*g>a}setStale(){this.stale=!0}}function Ro(f,a,d,g,x){f.emplaceBack(a?1:0,d?1:0,g||0,x||0),f.emplaceBack(a?1:0,d?1:0,g||0,x||0),f.emplaceBack(a?1:0,d?1:0,g||0,x||0),f.emplaceBack(a?1:0,d?1:0,g||0,x||0)}const tr=Math.pow(2,25),Zn=Math.pow(2,24),Yg=Math.pow(2,17),Zh=Math.pow(2,16),Kl=Math.pow(2,9),Sn=Math.pow(2,8),$f=Math.pow(2,1);function Li(f){if(0===f.opacity&&!f.placed)return 0;if(1===f.opacity&&f.placed)return 4294967295;const a=f.placed?1:0,d=Math.floor(127*f.opacity);return d*tr+a*Zn+d*Yg+a*Zh+d*Kl+a*Sn+d*$f+a}const Jr=0;class Jl{constructor(a){this._sortAcrossTiles="viewport-y"!==a.layout.get("symbol-z-order")&&void 0!==a.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(a,d,g,x,C){const M=this._bucketParts;for(;this._currentTileIndex<a.length;)if(d.getBucketParts(M,x,a[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,C())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort((D,O)=>D.sortKey-O.sortKey));this._currentPartIndex<M.length;){const D=M[this._currentPartIndex];if(d.placeLayerBucketPart(D,this._seenCrossTileIDs,g,0===D.symbolInstanceStart),this._currentPartIndex++,C())return!0}return!1}}class na{constructor(a,d,g,x,C,M,D,O){this.placement=new Nd(a,C,M,D,O),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(a,d,g){const x=p.exported.now(),C=()=>{const M=p.exported.now()-x;return!this._forceFullPlacement&&M>2};for(;this._currentPlacementIndex>=0;){const M=d[a[this._currentPlacementIndex]],D=this.placement.collisionIndex.transform.zoom;if("symbol"===M.type&&(!M.minzoom||M.minzoom<=D)&&(!M.maxzoom||M.maxzoom>D)){if(this._inProgressLayer||(this._inProgressLayer=new Jl(M)),this._inProgressLayer.continuePlacement(g[M.source],this.placement,this._showCollisionBoxes,M,C))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(a){return this.placement.commit(a),this.placement}}const jd=512/p.EXTENT/2;class ec{constructor(a,d,g){this.tileID=a,this.indexedSymbolInstances={},this.bucketInstanceId=g;for(let x=0;x<d.length;x++){const C=d.get(x),M=C.key;this.indexedSymbolInstances[M]||(this.indexedSymbolInstances[M]=[]),this.indexedSymbolInstances[M].push({crossTileID:C.crossTileID,coord:this.getScaledCoordinates(C,a)})}}getScaledCoordinates(a,d){const g=jd/Math.pow(2,d.canonical.z-this.tileID.canonical.z);return{x:Math.floor((d.canonical.x*p.EXTENT+a.tileAnchorX)*g),y:Math.floor((d.canonical.y*p.EXTENT+a.tileAnchorY)*g)}}findMatches(a,d,g){const x=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let C=0;C<a.length;C++){const M=a.get(C);if(M.crossTileID)continue;const D=this.indexedSymbolInstances[M.key];if(!D)continue;const O=this.getScaledCoordinates(M,d);for(const z of D)if(Math.abs(z.coord.x-O.x)<=x&&Math.abs(z.coord.y-O.y)<=x&&!g[z.crossTileID]){g[z.crossTileID]=!0,M.crossTileID=z.crossTileID;break}}}}class Iu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Vd{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(a){const d=Math.round((a-this.lng)/360);if(0!==d)for(const g in this.indexes){const x=this.indexes[g],C={};for(const M in x){const D=x[M];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+d),C[D.tileID.key]=D}this.indexes[g]=C}this.lng=a}addBucket(a,d,g){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(let C=0;C<d.symbolInstances.length;C++)d.symbolInstances.get(C).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]={});const x=this.usedCrossTileIDs[a.overscaledZ];for(const C in this.indexes){const M=this.indexes[C];if(Number(C)>a.overscaledZ)for(const D in M){const O=M[D];O.tileID.isChildOf(a)&&O.findMatches(d.symbolInstances,a,x)}else{const D=M[a.scaledTo(Number(C)).key];D&&D.findMatches(d.symbolInstances,a,x)}}for(let C=0;C<d.symbolInstances.length;C++){const M=d.symbolInstances.get(C);M.crossTileID||(M.crossTileID=g.generate(),x[M.crossTileID]=!0)}return void 0===this.indexes[a.overscaledZ]&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new ec(a,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(a,d){for(const g in d.indexedSymbolInstances)for(const x of d.indexedSymbolInstances[g])delete this.usedCrossTileIDs[a][x.crossTileID]}removeStaleBuckets(a){let d=!1;for(const g in this.indexes){const x=this.indexes[g];for(const C in x)a[x[C].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,x[C]),delete x[C],d=!0)}return d}}class tc{constructor(){this.layerIndexes={},this.crossTileIDs=new Iu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(a,d,g,x){let C=this.layerIndexes[a.id];void 0===C&&(C=this.layerIndexes[a.id]=new Vd);let M=!1;const D={};"globe"!==x.name&&C.handleWrapJump(g);for(const O of d){const z=O.getBucket(a);z&&a.id===z.layerIds[0]&&(z.bucketInstanceId||(z.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(O.tileID,z,this.crossTileIDs)&&(M=!0),D[z.bucketInstanceId]=!0)}return C.removeStaleBuckets(D)&&(M=!0),M}pruneUnusedLayers(a){const d={};a.forEach(g=>{d[g]=!0});for(const g in this.layerIndexes)d[g]||delete this.layerIndexes[g]}}const Pu=(f,a)=>p.emitValidationErrors(f,a&&a.filter(d=>"source.canvas"!==d.identifier)),nn=p.pick(Rt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Ud=p.pick(Rt,["setCenter","setZoom","setBearing","setPitch"]),Wh={version:8,layers:[],sources:{}},ia={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class eo extends p.Evented{constructor(a,d={}){super(),this.map=a,this.dispatcher=new ur(Ln(),this),this.imageManager=new Ma,this.imageManager.setEventedParent(this),this.glyphManager=new p.GlyphManager(a._requestManager,d.localFontFamily?p.LocalGlyphMode.all:d.localIdeographFontFamily?p.LocalGlyphMode.ideographs:p.LocalGlyphMode.none,d.localFontFamily||d.localIdeographFontFamily),this.lineAtlas=new p.LineAtlas(256,512),this.crossTileSymbolIndex=new tc,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new p.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",p.getReferrer());const g=this;this._rtlTextPluginCallback=eo.registerForPluginStateChange(x=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(C,M)=>{if(p.triggerPluginCompletionEvent(C),M&&M.every(D=>D))for(const D in g._sourceCaches){const O=g._sourceCaches[D],z=O.getSource().type;"vector"!==z&&"geojson"!==z||O.reload()}})}),this.on("data",x=>{if("source"!==x.dataType||"metadata"!==x.sourceDataType)return;const C=this.getSource(x.sourceId);if(C&&C.vectorLayerIds)for(const M in this._layers){const D=this._layers[M];D.source===C.id&&this._validateLayer(D)}})}loadURL(a,d={}){this.fire(new p.Event("dataloading",{dataType:"style"}));const g="boolean"==typeof d.validate?d.validate:!p.isMapboxURL(a);a=this.map._requestManager.normalizeStyleURL(a,d.accessToken);const x=this.map._requestManager.transformRequest(a,p.ResourceType.Style);this._request=p.getJSON(x,(C,M)=>{this._request=null,C?this.fire(new p.ErrorEvent(C)):M&&this._load(M,g)})}loadJSON(a,d={}){this.fire(new p.Event("dataloading",{dataType:"style"})),this._request=p.exported.frame(()=>{this._request=null,this._load(a,!1!==d.validate)})}loadEmpty(){this.fire(new p.Event("dataloading",{dataType:"style"})),this._load(Wh,!1)}_updateLayerCount(a,d){const g=d?1:-1;a.is3D()&&(this._num3DLayers+=g),"circle"===a.type&&(this._numCircleLayers+=g),"symbol"===a.type&&(this._numSymbolLayers+=g)}_load(a,d){if(d&&Pu(this,p.validateStyle(a)))return;this._loaded=!0,this.stylesheet=p.clone$1(a),this._updateMapProjection();for(const x in a.sources)this.addSource(x,a.sources[x],{validate:!1});this._changed=!1,a.sprite?this._loadSprite(a.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(a.glyphs);const g=zn(this.stylesheet.layers);this._order=g.map(x=>x.id),this._layers={},this._serializedLayers={};for(let x of g)x=p.createStyleLayer(x),x.setEventedParent(this,{layer:{id:x.id}}),this._layers[x.id]=x,this._serializedLayers[x.id]=x.serialize(),this._updateLayerCount(x,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new hl(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new p.Event("data",{dataType:"style"})),this.fire(new p.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(a){a?this.stylesheet.projection=a:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(a){this._spriteRequest=function(d,g,x){let C,M,D;const O=p.exported.devicePixelRatio>1?"@2x":"";let z=p.getJSON(g.transformRequest(g.normalizeSpriteURL(d,O,".json"),p.ResourceType.SpriteJSON),(W,ne)=>{z=null,D||(D=W,C=ne,U())}),F=p.getImage(g.transformRequest(g.normalizeSpriteURL(d,O,".png"),p.ResourceType.SpriteImage),(W,ne)=>{F=null,D||(D=W,M=ne,U())});function U(){if(D)x(D);else if(C&&M){const W=p.exported.getImageData(M),ne={};for(const K in C){const{width:J,height:te,x:X,y:re,sdf:ie,pixelRatio:xe,stretchX:ge,stretchY:pe,content:ve}=C[K],_e=new p.RGBAImage({width:J,height:te});p.RGBAImage.copy(W,_e,{x:X,y:re},{x:0,y:0},{width:J,height:te}),ne[K]={data:_e,pixelRatio:xe,sdf:ie,stretchX:ge,stretchY:pe,content:ve}}x(null,ne)}}return{cancel(){z&&(z.cancel(),z=null),F&&(F.cancel(),F=null)}}}(a,this.map._requestManager,(d,g)=>{if(this._spriteRequest=null,d)this.fire(new p.ErrorEvent(d));else if(g)for(const x in g)this.imageManager.addImage(x,g[x]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new p.Event("data",{dataType:"style"}))})}_validateLayer(a){const d=this.getSource(a.source);if(!d)return;const g=a.sourceLayer;g&&("geojson"===d.type||d.vectorLayerIds&&-1===d.vectorLayerIds.indexOf(g))&&this.fire(new p.ErrorEvent(new Error(`Source layer "${g}" does not exist on source "${d.id}" as specified by style layer "${a.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const a in this._sourceCaches)if(!this._sourceCaches[a].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(a){const d=[];for(const g of a){const x=this._layers[g];"custom"!==x.type&&d.push(x.serialize())}return d}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const a in this._sourceCaches)if(this._sourceCaches[a].hasTransition())return!0;for(const a in this._layers)if(this._layers[a].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(a){return!!this.terrain&&ia[a.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(a){if(!this._loaded)return;const d=this._changed;if(this._changed){const x=Object.keys(this._updatedLayers),C=Object.keys(this._removedLayers);(x.length||C.length)&&this._updateWorkerLayers(x,C);for(const M in this._updatedSources){const D=this._updatedSources[M];"reload"===D?this._reloadSource(M):"clear"===D&&this._clearSource(M)}this._updateTilesForChangedImages();for(const M in this._updatedPaintProps)this._layers[M].updateTransitions(a);this.light.updateTransitions(a),this.fog&&this.fog.updateTransitions(a),this._resetUpdates()}const g={};for(const x in this._sourceCaches){const C=this._sourceCaches[x];g[x]=C.used,C.used=!1}for(const x of this._order){const C=this._layers[x];if(C.recalculate(a,this._availableImages),!C.isHidden(a.zoom)){const D=this._getLayerSourceCache(C);D&&(D.used=!0)}const M=this.map.painter;if(M){const D=C.getProgramIds();if(!D)continue;const O=C.getProgramConfiguration(a.zoom);for(const z of D)M.useProgram(z,O)}}for(const x in g){const C=this._sourceCaches[x];g[x]!==C.used&&C.getSource().fire(new p.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:C.getSource().id}))}this.light.recalculate(a),this.terrain&&this.terrain.recalculate(a),this.fog&&this.fog.recalculate(a),this.z=a.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),d&&this.fire(new p.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const a=Object.keys(this._changedImages);if(a.length){for(const d in this._sourceCaches)this._sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],a);this._changedImages={}}}_updateWorkerLayers(a,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(a),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(a){if(this._checkLoaded(),Pu(this,p.validateStyle(a)))return!1;(a=p.clone$1(a)).layers=zn(a.layers);const d=function(x,C){if(!x)return[{command:Rt.setStyle,args:[C]}];let M=[];try{if(!ot(x.version,C.version))return[{command:Rt.setStyle,args:[C]}];ot(x.center,C.center)||M.push({command:Rt.setCenter,args:[C.center]}),ot(x.zoom,C.zoom)||M.push({command:Rt.setZoom,args:[C.zoom]}),ot(x.bearing,C.bearing)||M.push({command:Rt.setBearing,args:[C.bearing]}),ot(x.pitch,C.pitch)||M.push({command:Rt.setPitch,args:[C.pitch]}),ot(x.sprite,C.sprite)||M.push({command:Rt.setSprite,args:[C.sprite]}),ot(x.glyphs,C.glyphs)||M.push({command:Rt.setGlyphs,args:[C.glyphs]}),ot(x.transition,C.transition)||M.push({command:Rt.setTransition,args:[C.transition]}),ot(x.light,C.light)||M.push({command:Rt.setLight,args:[C.light]}),ot(x.fog,C.fog)||M.push({command:Rt.setFog,args:[C.fog]}),ot(x.projection,C.projection)||M.push({command:Rt.setProjection,args:[C.projection]});const D={},O=[];!function(U,W,ne,K){let J;for(J in W=W||{},U=U||{})U.hasOwnProperty(J)&&(W.hasOwnProperty(J)||Xr(J,ne,K));for(J in W)W.hasOwnProperty(J)&&(U.hasOwnProperty(J)?ot(U[J],W[J])||("geojson"===U[J].type&&"geojson"===W[J].type&&ea(U,W,J)?ne.push({command:Rt.setGeoJSONSourceData,args:[J,W[J].data]}):yi(J,W,ne,K)):Re(J,W,ne))}(x.sources,C.sources,O,D);const z=[];x.layers&&x.layers.forEach(U=>{U.source&&D[U.source]?M.push({command:Rt.removeLayer,args:[U.id]}):z.push(U)});let F=x.terrain;F&&D[F.source]&&(M.push({command:Rt.setTerrain,args:[void 0]}),F=void 0),M=M.concat(O),ot(F,C.terrain)||M.push({command:Rt.setTerrain,args:[C.terrain]}),function(U,W,ne){W=W||[];const K=(U=U||[]).map(xo),J=W.map(xo),te=U.reduce(Tu,{}),X=W.reduce(Tu,{}),re=K.slice(),ie=Object.create(null);let xe,ge,pe,ve,_e,Ce,Se;for(xe=0,ge=0;xe<K.length;xe++)pe=K[xe],X.hasOwnProperty(pe)?ge++:(ne.push({command:Rt.removeLayer,args:[pe]}),re.splice(re.indexOf(pe,ge),1));for(xe=0,ge=0;xe<J.length;xe++)pe=J[J.length-1-xe],re[re.length-1-xe]!==pe&&(te.hasOwnProperty(pe)?(ne.push({command:Rt.removeLayer,args:[pe]}),re.splice(re.lastIndexOf(pe,re.length-ge),1)):ge++,Ce=re[re.length-xe],ne.push({command:Rt.addLayer,args:[X[pe],Ce]}),re.splice(re.length-xe,0,pe),ie[pe]=!0);for(xe=0;xe<J.length;xe++)if(pe=J[xe],ve=te[pe],_e=X[pe],!ie[pe]&&!ot(ve,_e))if(ot(ve.source,_e.source)&&ot(ve["source-layer"],_e["source-layer"])&&ot(ve.type,_e.type)){for(Se in Eu(ve.layout,_e.layout,ne,pe,null,Rt.setLayoutProperty),Eu(ve.paint,_e.paint,ne,pe,null,Rt.setPaintProperty),ot(ve.filter,_e.filter)||ne.push({command:Rt.setFilter,args:[pe,_e.filter]}),ot(ve.minzoom,_e.minzoom)&&ot(ve.maxzoom,_e.maxzoom)||ne.push({command:Rt.setLayerZoomRange,args:[pe,_e.minzoom,_e.maxzoom]}),ve)ve.hasOwnProperty(Se)&&"layout"!==Se&&"paint"!==Se&&"filter"!==Se&&"metadata"!==Se&&"minzoom"!==Se&&"maxzoom"!==Se&&(0===Se.indexOf("paint.")?Eu(ve[Se],_e[Se],ne,pe,Se.slice(6),Rt.setPaintProperty):ot(ve[Se],_e[Se])||ne.push({command:Rt.setLayerProperty,args:[pe,Se,_e[Se]]}));for(Se in _e)_e.hasOwnProperty(Se)&&!ve.hasOwnProperty(Se)&&"layout"!==Se&&"paint"!==Se&&"filter"!==Se&&"metadata"!==Se&&"minzoom"!==Se&&"maxzoom"!==Se&&(0===Se.indexOf("paint.")?Eu(ve[Se],_e[Se],ne,pe,Se.slice(6),Rt.setPaintProperty):ot(ve[Se],_e[Se])||ne.push({command:Rt.setLayerProperty,args:[pe,Se,_e[Se]]}))}else ne.push({command:Rt.removeLayer,args:[pe]}),Ce=re[re.lastIndexOf(pe)+1],ne.push({command:Rt.addLayer,args:[_e,Ce]})}(z,C.layers,M)}catch(D){console.warn("Unable to compute style diff:",D),M=[{command:Rt.setStyle,args:[C]}]}return M}(this.serialize(),a).filter(x=>!(x.command in Ud));if(0===d.length)return!1;const g=d.filter(x=>!(x.command in nn));if(g.length>0)throw new Error(`Unimplemented: ${g.map(x=>x.command).join(", ")}.`);return d.forEach(x=>{"setTransition"!==x.command&&"setProjection"!==x.command&&this[x.command].apply(this,x.args)}),this.stylesheet=a,this._updateMapProjection(),!0}addImage(a,d){return this.getImage(a)?this.fire(new p.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(a,d),this._afterImageUpdated(a),this)}updateImage(a,d){this.imageManager.updateImage(a,d)}getImage(a){return this.imageManager.getImage(a)}removeImage(a){return this.getImage(a)?(this.imageManager.removeImage(a),this._afterImageUpdated(a),this):this.fire(new p.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(a){this._availableImages=this.imageManager.listImages(),this._changedImages[a]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new p.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(a,d,g={}){if(this._checkLoaded(),void 0!==this.getSource(a))throw new Error("There is already a source with this ID");if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(p.validateSource,`sources.${a}`,d,null,g))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const x=Me(a,d,this.dispatcher,this);x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(a),source:x.serialize(),sourceId:a}));const C=M=>{const D=(M?"symbol:":"other:")+a,O=this._sourceCaches[D]=new p.SourceCache(D,x,M);(M?this._symbolSourceCaches:this._otherSourceCaches)[a]=O,O.style=this,O.onAdd(this.map)};C(!1),"vector"!==d.type&&"geojson"!==d.type||C(!0),x.onAdd&&x.onAdd(this.map),this._changed=!0}removeSource(a){this._checkLoaded();const d=this.getSource(a);if(!d)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===a)return this.fire(new p.ErrorEvent(new Error(`Source "${a}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.get().source===a)return this.fire(new p.ErrorEvent(new Error(`Source "${a}" cannot be removed while terrain is using it.`)));const g=this._getSourceCaches(a);for(const x of g)delete this._sourceCaches[x.id],delete this._updatedSources[x.id],x.fire(new p.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles();return delete this._otherSourceCaches[a],delete this._symbolSourceCaches[a],d.setEventedParent(null),d.onRemove&&d.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(a,d){this._checkLoaded(),this.getSource(a).setData(d),this._changed=!0}getSource(a){const d=this._getSourceCache(a);return d&&d.getSource()}addLayer(a,d,g={}){this._checkLoaded();const x=a.id;if(this.getLayer(x))return void this.fire(new p.ErrorEvent(new Error(`Layer with id "${x}" already exists on this map`)));let C;if("custom"===a.type){if(Pu(this,p.validateCustomStyleLayer(a)))return;C=p.createStyleLayer(a)}else{if("object"==typeof a.source&&(this.addSource(x,a.source),a=p.clone$1(a),a=p.extend(a,{source:x})),this._validate(p.validateLayer,`layers.${x}`,a,{arrayIndex:-1},g))return;C=p.createStyleLayer(a),this._validateLayer(C),C.setEventedParent(this,{layer:{id:x}}),this._serializedLayers[C.id]=C.serialize(),this._updateLayerCount(C,!0)}const M=d?this._order.indexOf(d):this._order.length;if(d&&-1===M)return void this.fire(new p.ErrorEvent(new Error(`Layer with id "${d}" does not exist on this map.`)));this._order.splice(M,0,x),this._layerOrderChanged=!0,this._layers[x]=C;const D=this._getLayerSourceCache(C);if(this._removedLayers[x]&&C.source&&D&&"custom"!==C.type){const O=this._removedLayers[x];delete this._removedLayers[x],O.type!==C.type?this._updatedSources[C.source]="clear":(this._updatedSources[C.source]="reload",D.pause())}this._updateLayer(C),C.onAdd&&C.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(a,d){if(this._checkLoaded(),this._changed=!0,!this._layers[a])return void this.fire(new p.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be moved.`)));if(a===d)return;const g=this._order.indexOf(a);this._order.splice(g,1);const x=d?this._order.indexOf(d):this._order.length;d&&-1===x?this.fire(new p.ErrorEvent(new Error(`Layer with id "${d}" does not exist on this map.`))):(this._order.splice(x,0,a),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(a){this._checkLoaded();const d=this._layers[a];if(!d)return void this.fire(new p.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be removed.`)));d.setEventedParent(null),this._updateLayerCount(d,!1);const g=this._order.indexOf(a);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[a]=d,delete this._layers[a],delete this._serializedLayers[a],delete this._updatedLayers[a],delete this._updatedPaintProps[a],d.onRemove&&d.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(a){return this._layers[a]}hasLayer(a){return a in this._layers}hasLayerType(a){for(const d in this._layers)if(this._layers[d].type===a)return!0;return!1}setLayerZoomRange(a,d,g){this._checkLoaded();const x=this.getLayer(a);x?x.minzoom===d&&x.maxzoom===g||(null!=d&&(x.minzoom=d),null!=g&&(x.maxzoom=g),this._updateLayer(x)):this.fire(new p.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(a,d,g={}){this._checkLoaded();const x=this.getLayer(a);if(x){if(!ot(x.filter,d))return null==d?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(p.validateFilter,`layers.${x.id}.filter`,d,{layerType:x.type},g)||(x.filter=p.clone$1(d),this._updateLayer(x)))}else this.fire(new p.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be filtered.`)))}getFilter(a){const d=this.getLayer(a);return d&&p.clone$1(d.filter)}setLayoutProperty(a,d,g,x={}){this._checkLoaded();const C=this.getLayer(a);C?ot(C.getLayoutProperty(d),g)||(C.setLayoutProperty(d,g,x),this._updateLayer(C)):this.fire(new p.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(a,d){const g=this.getLayer(a);if(g)return g.getLayoutProperty(d);this.fire(new p.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style.`)))}setPaintProperty(a,d,g,x={}){this._checkLoaded();const C=this.getLayer(a);C?ot(C.getPaintProperty(d),g)||(C.setPaintProperty(d,g,x)&&this._updateLayer(C),this._changed=!0,this._updatedPaintProps[a]=!0):this.fire(new p.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(a,d){const g=this.getLayer(a);return g&&g.getPaintProperty(d)}setFeatureState(a,d){this._checkLoaded();const g=a.source,x=a.sourceLayer,C=this.getSource(g);if(!C)return void this.fire(new p.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const M=C.type;if("geojson"===M&&x)return void this.fire(new p.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===M&&!x)return void this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===a.id&&this.fire(new p.ErrorEvent(new Error("The feature id parameter must be provided.")));const D=this._getSourceCaches(g);for(const O of D)O.setFeatureState(x,a.id,d)}removeFeatureState(a,d){this._checkLoaded();const g=a.source,x=this.getSource(g);if(!x)return void this.fire(new p.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const C=x.type,M="vector"===C?a.sourceLayer:void 0;if("vector"===C&&!M)return void this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(d&&"string"!=typeof a.id&&"number"!=typeof a.id)return void this.fire(new p.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const D=this._getSourceCaches(g);for(const O of D)O.removeFeatureState(M,a.id,d)}getFeatureState(a){this._checkLoaded();const d=a.source,g=a.sourceLayer,x=this.getSource(d);if(x){if("vector"!==x.type||g)return void 0===a.id&&this.fire(new p.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(d)[0].getFeatureState(g,a.id);this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new p.ErrorEvent(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return p.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const a={};for(const d in this._sourceCaches){const g=this._sourceCaches[d].getSource();a[g.id]||(a[g.id]=g.serialize())}return p.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:a,layers:this._serializeLayers(this._order)},d=>void 0!==d)}_updateLayer(a){this._updatedLayers[a.id]=!0;const d=this._getLayerSourceCache(a);a.source&&!this._updatedSources[a.source]&&d&&"raster"!==d.getSource().type&&(this._updatedSources[a.source]="reload",d.pause()),this._changed=!0,a.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(a){const d=M=>"fill-extrusion"===this._layers[M].type,g={},x=[];for(let M=this._order.length-1;M>=0;M--){const D=this._order[M];if(d(D)){g[D]=M;for(const O of a){const z=O[D];if(z)for(const F of z)x.push(F)}}}x.sort((M,D)=>D.intersectionZ-M.intersectionZ);const C=[];for(let M=this._order.length-1;M>=0;M--){const D=this._order[M];if(d(D))for(let O=x.length-1;O>=0;O--){const z=x[O].feature;if(g[z.layer.id]<M)break;C.push(z),x.pop()}else for(const O of a){const z=O[D];if(z)for(const F of z)C.push(F.feature)}}return C}queryRenderedFeatures(a,d,g){d&&d.filter&&this._validate(p.validateFilter,"queryRenderedFeatures.filter",d.filter,null,d);const x={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new p.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const O of d.layers){const z=this._layers[O];if(!z)return this.fire(new p.ErrorEvent(new Error(`The layer '${O}' does not exist in the map's style and cannot be queried for features.`))),[];x[z.source]=!0}}const C=[];d.availableImages=this._availableImages;const M=d&&d.layers?d.layers.some(O=>{const z=this.getLayer(O);return z&&z.is3D()}):this.has3DLayers(),D=bi.createFromScreenPoints(a,g);for(const O in this._sourceCaches){const z=this._sourceCaches[O].getSource().id;d.layers&&!x[z]||C.push(st(this._sourceCaches[O],this._layers,this._serializedLayers,D,d,g,M,!!this.map._showQueryGeometry))}return this.placement&&C.push(function(O,z,F,U,W,ne,K){const J={},te=ne.queryRenderedSymbols(U),X=[];for(const re of Object.keys(te).map(Number))X.push(K[re]);X.sort(St);for(const re of X){const ie=re.featureIndex.lookupSymbolFeatures(te[re.bucketInstanceId],z,re.bucketIndex,re.sourceLayerIndex,W.filter,W.layers,W.availableImages,O);for(const xe in ie){const ge=J[xe]=J[xe]||[],pe=ie[xe];pe.sort((ve,_e)=>{const Ce=re.featureSortOrder;if(Ce){const Se=Ce.indexOf(ve.featureIndex);return Ce.indexOf(_e.featureIndex)-Se}return _e.featureIndex-ve.featureIndex});for(const ve of pe)ge.push(ve)}}for(const re in J)J[re].forEach(ie=>{const xe=ie.feature,ge=F(O[re]).getFeatureState(xe.layer["source-layer"],xe.id);xe.source=xe.layer.source,xe.layer["source-layer"]&&(xe.sourceLayer=xe.layer["source-layer"]),xe.state=ge});return J}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),D.screenGeometry,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(C)}querySourceFeatures(a,d){d&&d.filter&&this._validate(p.validateFilter,"querySourceFeatures.filter",d.filter,null,d);const g=this._getSourceCaches(a);let x=[];for(const C of g)x=x.concat(Xe(C,d));return x}addSourceType(a,d,g){return eo.getSourceType(a)?g(new Error(`A source type called "${a}" already exists.`)):(eo.setSourceType(a,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:d.workerSourceURL},g):g(null,null))}getLight(){return this.light.getLight()}setLight(a,d={}){this._checkLoaded();const g=this.light.getLight();let x=!1;for(const M in a)if(!ot(a[M],g[M])){x=!0;break}if(!x)return;const C=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(a,d),this.light.updateTransitions(C)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(a,d=1){if(this._checkLoaded(),!a)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(1===d){if("object"==typeof a.source){const g="terrain-dem-src";this.addSource(g,a.source),a=p.clone$1(a),a=p.extend(a,{source:g})}if(this._validate(p.validateTerrain,"terrain",a))return}if(!this.terrain||this.terrain&&d!==this.terrain.drapeRenderMode)this._createTerrain(a,d);else{const g=this.terrain,x=g.get();for(const C of Object.keys(p.spec.terrain))!a.hasOwnProperty(C)&&p.spec.terrain[C].default&&(a[C]=p.spec.terrain[C].default);for(const C in a)if(!ot(a[C],x[C])){g.set(a),this.stylesheet.terrain=a;const M=this._setTransitionParameters({duration:0});g.updateTransitions(M);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(a){const d=this.fog=new vi(a,this.map.transform);this.stylesheet.fog=a;const g=this._setTransitionParameters({duration:0});d.updateTransitions(g)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const a of this.map._markers)a._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(a){if(this._checkLoaded(),!a)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const d=this.fog,g=d.get();0===Object.keys(a).length&&d.set(a);for(const x in a)if(!ot(a[x],g[x])){d.set(a),this.stylesheet.fog=a;const C=this._setTransitionParameters({duration:0});d.updateTransitions(C);break}}else this._createFog(a);this._markersNeedUpdate=!0}_setTransitionParameters(a){return{now:p.exported.now(),transition:p.extend(a,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const a=this._order.filter(g=>this.isLayerDraped(this._layers[g])),d=this._order.filter(g=>!this.isLayerDraped(this._layers[g]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...a),this._drapedFirstOrder.push(...d)}_createTerrain(a,d){const g=this.terrain=new yo(a,d);this.stylesheet.terrain=a,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const x=this._setTransitionParameters({duration:0});g.updateTransitions(x)}_force3DLayerUpdate(){for(const a in this._layers){const d=this._layers[a];"fill-extrusion"===d.type&&this._updateLayer(d)}}_forceSymbolLayerUpdate(){for(const a in this._layers){const d=this._layers[a];"symbol"===d.type&&this._updateLayer(d)}}_validate(a,d,g,x,C={}){return(!C||!1!==C.validate)&&Pu(this,a.call(p.validateStyle,p.extend({key:d,style:this.serialize(),value:g,styleSpec:p.spec},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),p.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this._sourceCaches)this._sourceCaches[a].clearTiles(),this._sourceCaches[a].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(a){const d=this._getSourceCaches(a);for(const g of d)g.clearTiles()}_reloadSource(a){const d=this._getSourceCaches(a);for(const g of d)g.resume(),g.reload()}_updateSources(a){for(const d in this._sourceCaches)this._sourceCaches[d].update(a)}_generateCollisionBoxes(){for(const a in this._sourceCaches){const d=this._sourceCaches[a];d.resume(),d.reload()}}_updatePlacement(a,d,g,x,C=!1){let M=!1,D=!1;const O={};for(const z of this._order){const F=this._layers[z];if("symbol"!==F.type)continue;if(!O[F.source]){const W=this._getLayerSourceCache(F);if(!W)continue;O[F.source]=W.getRenderableIds(!0).map(ne=>W.getTileByID(ne)).sort((ne,K)=>K.tileID.overscaledZ-ne.tileID.overscaledZ||(ne.tileID.isLessThan(K.tileID)?-1:1))}const U=this.crossTileSymbolIndex.addLayer(F,O[F.source],a.center.lng,a.projection);M=M||U}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),C=C||this._layerOrderChanged||0===g,this._layerOrderChanged&&this.fire(new p.Event("neworder")),(C||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(p.exported.now(),a.zoom))&&(this.pauseablePlacement=new na(a,this._order,C,d,g,x,this.placement,this.fog&&a.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,O),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(p.exported.now()),D=!0),M&&this.pauseablePlacement.placement.setStale()),D||M)for(const z of this._order){const F=this._layers[z];"symbol"===F.type&&this.placement.updateLayerOpacities(F,O[F.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(p.exported.now())}_releaseSymbolFadeTiles(){for(const a in this._sourceCaches)this._sourceCaches[a].releaseSymbolFadeTiles()}getImages(a,d,g){this.imageManager.getImages(d.icons,g),this._updateTilesForChangedImages();const x=C=>{C&&C.setDependencies(d.tileID.key,d.type,d.icons)};x(this._otherSourceCaches[d.source]),x(this._symbolSourceCaches[d.source])}getGlyphs(a,d,g){this.glyphManager.getGlyphs(d.stacks,g)}getResource(a,d,g){return p.makeRequest(d,g)}_getSourceCache(a){return this._otherSourceCaches[a]}_getLayerSourceCache(a){return"symbol"===a.type?this._symbolSourceCaches[a.source]:this._otherSourceCaches[a.source]}_getSourceCaches(a){const d=[];return this._otherSourceCaches[a]&&d.push(this._otherSourceCaches[a]),this._symbolSourceCaches[a]&&d.push(this._symbolSourceCaches[a]),d}_isSourceCacheLoaded(a){const d=this._getSourceCaches(a);return 0===d.length?(this.fire(new p.ErrorEvent(new Error(`There is no source with ID '${a}'`))),!1):d.every(g=>g.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}eo.getSourceType=function(f){return we[f]},eo.setSourceType=function(f,a){we[f]=a},eo.registerForPluginStateChange=p.registerForPluginStateChange;var Yh="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",ls="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",to="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {return currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",Xh="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",nc="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let no={},Pa={};const ra=[];wl(Yh,ra),wl(to,ra),wl(Xh,ra),wl(nc,ra),no=fn("",to),Pa=fn(nc,Xh);const ic=fn("\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),$d=Yh,Vn="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var Gd={background:fn("uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:fn("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:fn("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);vec4 world_center=vec4(pos,1);\n#else \nmat3 surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nvec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:fn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:fn("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\nvec3 pos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:fn("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:fn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:fn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:fn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:fn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:fn("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:fn("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:fn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:fn("uniform lowp vec3 u_lightpos;varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;varying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\nvoid main() {vec4 color=v_color;\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(v_normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying highp vec3 v_normal;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;vec3 pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_normal=normal;v_depth=gl_Position.w;\n#endif\nfloat colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);directional*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\nv_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:fn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);\n#else\nvec3 p=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);directional*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\nv_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:fn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:fn("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:fn("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\n#ifdef RENDER_LINE_GRADIENT\nhighp vec4 out_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nvec4 out_color=color;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);}}\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:fn("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:fn("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:fn("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nvec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);vec4 offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\nvec4 offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:fn("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nvec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);vec4 offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\nvec4 offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:fn("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nvec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:fn("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:fn("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:fn("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",ls),skyboxGradient:fn("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",ls),skyboxCapture:fn("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:fn("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);vec4 color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\nvec4 color=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idy=u_grid_matrix[1][2];float S=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=a_pos[0]*S;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;\n#ifdef GLOBE_POLES\nvec3 up_vector=normalize(globe_pos)*u_tile_up_scale;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:fn("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);\n#ifdef PROJECTION_GLOBE_VIEW\nfloat globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));float horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nfloat horizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function wl(f,a){const d=f.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let g of d)if(g=g.trim(),"#"===g[0]&&g.includes("if")&&!g.includes("endif")){g=g.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=g.split(" ");for(const C of x)a.includes(C)||a.push(C)}}function fn(f,a){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=a.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),x={},C=[...ra];return wl(f,C),wl(a,C),{fragmentSource:f=f.replace(d,(M,D,O,z,F)=>(x[F]=!0,"define"===D?`\n#ifndef HAS_UNIFORM_u_${F}\nvarying ${O} ${z} ${F};\n#else\nuniform ${O} ${z} u_${F};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${F}\n    ${O} ${z} ${F} = u_${F};\n#endif\n`)),vertexSource:a=a.replace(d,(M,D,O,z,F)=>{const U="float"===z?"vec2":"vec4",W=F.match(/color/)?"color":U;return x[F]?"define"===D?`\n#ifndef HAS_UNIFORM_u_${F}\nuniform lowp float u_${F}_t;\nattribute ${O} ${U} a_${F};\nvarying ${O} ${z} ${F};\n#else\nuniform ${O} ${z} u_${F};\n#endif\n`:"vec4"===W?`\n#ifndef HAS_UNIFORM_u_${F}\n    ${F} = a_${F};\n#else\n    ${O} ${z} ${F} = u_${F};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${F}\n    ${F} = unpack_mix_${W}(a_${F}, u_${F}_t);\n#else\n    ${O} ${z} ${F} = u_${F};\n#endif\n`:"define"===D?`\n#ifndef HAS_UNIFORM_u_${F}\nuniform lowp float u_${F}_t;\nattribute ${O} ${U} a_${F};\n#else\nuniform ${O} ${z} u_${F};\n#endif\n`:"vec4"===W?`\n#ifndef HAS_UNIFORM_u_${F}\n    ${O} ${z} ${F} = a_${F};\n#else\n    ${O} ${z} ${F} = u_${F};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${F}\n    ${O} ${z} ${F} = unpack_mix_${W}(a_${F}, u_${F}_t);\n#else\n    ${O} ${z} ${F} = u_${F};\n#endif\n`}),staticAttributes:g,usedDefines:C}}class Wn{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(a,d,g,x,C,M,D){this.context=a;let O=this.boundPaintVertexBuffers.length!==x.length;for(let F=0;!O&&F<x.length;F++)this.boundPaintVertexBuffers[F]!==x[F]&&(O=!0);let z=this.boundDynamicVertexBuffers.length!==D.length;for(let F=0;!z&&F<D.length;F++)this.boundDynamicVertexBuffers[F]!==D[F]&&(z=!0);if(!a.extVertexArrayObject||!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==g||O||z||this.boundIndexBuffer!==C||this.boundVertexOffset!==M)this.freshBind(d,g,x,C,M,D);else{a.bindVertexArrayOES.set(this.vao);for(const F of D)F&&F.bind();C&&C.dynamicDraw&&C.bind()}}freshBind(a,d,g,x,C,M){let D;const O=a.numAttributes,z=this.context,F=z.gl;if(z.extVertexArrayObject)this.vao&&this.destroy(),this.vao=z.extVertexArrayObject.createVertexArrayOES(),z.bindVertexArrayOES.set(this.vao),D=0,this.boundProgram=a,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=x,this.boundVertexOffset=C,this.boundDynamicVertexBuffers=M;else{D=z.currentNumAttributes||0;for(let U=O;U<D;U++)F.disableVertexAttribArray(U)}d.enableAttributes(F,a),d.bind(),d.setVertexAttribPointers(F,a,C);for(const U of g)U.enableAttributes(F,a),U.bind(),U.setVertexAttribPointers(F,a,C);for(const U of M)U&&(U.enableAttributes(F,a),U.bind(),U.setVertexAttribPointers(F,a,C));x&&x.bind(),z.currentNumAttributes=O}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Cl(f,a){const d=Math.pow(2,a.canonical.z),g=a.canonical.y;return[new p.MercatorCoordinate(0,g/d).toLngLat().lat,new p.MercatorCoordinate(0,(g+1)/d).toLngLat().lat]}function rc(f,a,d,g,x,C,M){const D=f.context,O=D.gl,z=d.fbo;if(!z)return;f.prepareDrawTile();const F=f.useProgram("hillshade");D.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,z.colorAttachment.get());const U=((J,te,X,re)=>{const ie=X.paint.get("hillshade-shadow-color"),xe=X.paint.get("hillshade-highlight-color"),ge=X.paint.get("hillshade-accent-color");let pe=X.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===X.paint.get("hillshade-illumination-anchor")&&(pe-=J.transform.angle);const ve=!J.options.moving;return{u_matrix:re||J.transform.calculateProjMatrix(te.tileID.toUnwrapped(),ve),u_image:0,u_latrange:Cl(0,te.tileID),u_light:[X.paint.get("hillshade-exaggeration"),pe],u_shadow:ie,u_highlight:xe,u_accent:ge}})(f,d,g,f.terrain?a.projMatrix:null);f.prepareDrawProgram(D,F,a.toUnwrapped());const{tileBoundsBuffer:W,tileBoundsIndexBuffer:ne,tileBoundsSegments:K}=f.getTileBoundsBuffers(d);F.draw(D,O.TRIANGLES,x,C,M,p.CullFaceMode.disabled,U,g.id,W,ne,K)}function _n(f,a,d){if(!a.needsDEMTextureUpload)return;const g=f.context,x=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||f.getTileTexture(d.stride);const C=d.getPixels();a.demTexture?a.demTexture.update(C,{premultiply:!1}):a.demTexture=new p.Texture(g,C,x.RGBA,{premultiply:!1}),a.needsDEMTextureUpload=!1}function Oa(f,a,d,g,x,C){const M=f.context,D=M.gl;if(!a.dem)return;const O=a.dem;if(M.activeTexture.set(D.TEXTURE1),_n(f,a,O),!a.demTexture)return;a.demTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE);const z=O.dim;M.activeTexture.set(D.TEXTURE0);let F=a.fbo;if(!F){const K=new p.Texture(M,{width:z,height:z,data:null},D.RGBA);K.bind(D.LINEAR,D.CLAMP_TO_EDGE),F=a.fbo=M.createFramebuffer(z,z,!0),F.colorAttachment.set(K.texture)}M.bindFramebuffer.set(F.framebuffer),M.viewport.set([0,0,z,z]);const{tileBoundsBuffer:U,tileBoundsIndexBuffer:W,tileBoundsSegments:ne}=f.getMercatorTileBoundsBuffers();f.useProgram("hillshadePrepare").draw(M,D.TRIANGLES,g,x,C,p.CullFaceMode.disabled,((K,J)=>{const te=J.stride,X=p.create();return p.ortho(X,0,p.EXTENT,-p.EXTENT,0,0,1),p.translate(X,X,[0,-p.EXTENT,0]),{u_matrix:X,u_image:1,u_dimension:[te,te],u_zoom:K.overscaledZ,u_unpack:J.unpackVector}})(a.tileID,O),d.id,U,W,ne),a.needsHillshadePrepare=!1}const io=f=>({u_matrix:new p.UniformMatrix4f(f),u_image0:new p.Uniform1i(f),u_skirt_height:new p.Uniform1f(f)}),ka=(f,a)=>({u_matrix:f,u_image0:0,u_skirt_height:a}),Hd=(f,a,d,g,x,C,M,D,O,z,F,U,W,ne)=>({u_proj_matrix:Float32Array.from(f),u_globe_matrix:a,u_normalize_matrix:Float32Array.from(g),u_merc_matrix:d,u_zoom_transition:x,u_merc_center:C,u_image0:0,u_frustum_tl:M,u_frustum_tr:D,u_frustum_br:O,u_frustum_bl:z,u_globe_pos:F,u_globe_radius:U,u_viewport:W,u_grid_matrix:ne?Float32Array.from(ne):new Float32Array(9)});function ti(f,a){return null!=f&&null!=a&&!(!f.hasData()||!a.hasData())&&null!=f.demTexture&&null!=a.demTexture&&f.tileID.key!==a.tileID.key}const oa=new class{constructor(){this.operations={}}newMorphing(f,a,d,g,x){if(f in this.operations){const C=this.operations[f];C.to.tileID.key!==d.tileID.key&&(C.queued=d)}else this.operations[f]={startTime:g,phase:0,duration:x,from:a,to:d,queued:null}}getMorphValuesForProxy(f){if(!(f in this.operations))return null;const a=this.operations[f];return{from:a.from,to:a.to,phase:a.phase}}update(f){for(const a in this.operations){const d=this.operations[a];for(d.phase=(f-d.startTime)/d.duration;d.phase>=1||!this._validOp(d);)if(!this._nextOp(d,f)){delete this.operations[a];break}}}_nextOp(f,a){return!!f.queued&&(f.from=f.to,f.to=f.queued,f.queued=null,f.phase=0,f.startTime=a,!0)}_validOp(f){return f.from.hasData()&&f.to.hasData()}},Al={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Qh(f,a){const d=1<<f.z;return!a&&(0===f.x||f.x===d-1)||0===f.y||f.y===d-1}const Ou=f=>({u_matrix:f});function hr(f,a,d,g,x){if(x>0){const C=p.exported.now(),M=(C-f.timeAdded)/x,D=a?(C-a.timeAdded)/x:-1,O=d.getSource(),z=g.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),F=!a||Math.abs(a.tileID.overscaledZ-z)>Math.abs(f.tileID.overscaledZ-z),U=F&&f.refreshedUponExpiration?1:p.clamp(F?M:1-D,0,1);return f.refreshedUponExpiration&&M>=1&&(f.refreshedUponExpiration=!1),a?{opacity:1,mix:1-U}:{opacity:U,mix:0}}return{opacity:1,mix:0}}class qd extends p.SourceCache{constructor(a){const d={type:"raster-dem",maxzoom:a.transform.maxZoom},g=new ur(Ln(),null),x=Me("mock-dem",d,g,a.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(a,d){a.state="loaded",d(null)}}class ku extends p.SourceCache{constructor(a){const d=Me("proxy",{type:"geojson",maxzoom:a.transform.maxZoom},new ur(Ln(),null),a.style);super("proxy",d,!1),d.setEventedParent(this),this.map=this.getSource().map=a,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(a,d,g){if(a.freezeTileCoverage)return;this.transform=a;const x=a.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((C,M)=>{if(C[M.key]="",!this._tiles[M.key]){const D=new p.Tile(M,this._source.tileSize*M.overscaleFactor(),a.tileZoom);D.state="loaded",this._tiles[M.key]=D}return C},{});for(const C in this._tiles)C in x||(this.freeFBO(C),this._tiles[C].unloadVectorData(),delete this._tiles[C])}freeFBO(a){const d=this.proxyCachedFBO[a];if(void 0!==d){const g=Object.values(d);this.renderCachePool.push(...g),delete this.proxyCachedFBO[a]}}deallocRenderCache(){this.renderCache.forEach(a=>a.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class zi extends p.OverscaledTileID{constructor(a,d,g){super(a.overscaledZ,a.wrap,a.canonical.z,a.canonical.x,a.canonical.y),this.proxyTileKey=d,this.projMatrix=g}}class Er extends p.Elevation{constructor(a,d){super(),this.painter=a,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[g,x,C]=function(O){const z=new p.StructArrayLayout4i8,F=new p.StructArrayLayout3ui6,U=131;z.reserve(17161),F.reserve(33800);const W=p.EXTENT/128,ne=p.EXTENT+W/2,K=ne+W;for(let te=-W;te<K;te+=W)for(let X=-W;X<K;X+=W){const re=X<0||X>ne||te<0||te>ne?24575:0,ie=p.clamp(Math.round(X),0,p.EXTENT),xe=p.clamp(Math.round(te),0,p.EXTENT);z.emplaceBack(ie+re,xe,ie,xe)}const J=(te,X)=>{const re=X*U+te;F.emplaceBack(re+1,re,re+U),F.emplaceBack(re+U,re+U+1,re+1)};for(let te=1;te<129;te++)for(let X=1;X<129;X++)J(X,te);return[0,129].forEach(te=>{for(let X=0;X<130;X++)J(X,te),J(te,X)}),[z,F,32768]}(),M=a.context;this.gridBuffer=M.createVertexBuffer(g,p.boundsAttributes.members),this.gridIndexBuffer=M.createIndexBuffer(x),this.gridSegments=p.SegmentVector.simpleSegment(0,0,g.length,x.length),this.gridNoSkirtSegments=p.SegmentVector.simpleSegment(0,0,g.length,C),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ku(d.map),this.orthoMatrix=p.create(),p.ortho(this.orthoMatrix,0,p.EXTENT,0,p.EXTENT,0,1);const D=M.gl;this._overlapStencilMode=new p.StencilMode({func:D.GEQUAL,mask:255},0,255,D.KEEP,D.KEEP,D.REPLACE),this._previousZoom=a.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=d,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new qd(d.map)}set style(a){a.on("data",this._onStyleDataEvent.bind(this)),a.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=a,this._checkRenderCacheEfficiency()}update(a,d,g){if(a&&a.terrain){this._style!==a&&(this.style=a),this.enabled=!0;const x=a.terrain.properties;this.sourceCache=0===a.terrain.drapeRenderMode?this._mockSourceCache:a._getSourceCache(x.get("source")),this._exaggeration=x.get("exaggeration");const C=()=>{this.sourceCache.used&&p.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const M=this.getScaledDemTileSize();this.sourceCache.update(d,M,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,C(),this._initializing=!0),C(),d.updateElevation(!g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(d),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(a){this._findCoveringTileCache[a]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const a=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==a.efficiency&&p.warnOnce(`Terrain render cache efficiency is not optimal (${a.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${a.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(a){a.coord&&"source"===a.dataType?this._clearRenderCacheForTile(a.sourceCacheId,a.coord):"style"===a.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const a in this._style._sourceCaches)this._style._sourceCaches[a].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(a=>a.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const a=2*this.proxySourceCache.getSource().tileSize;return[a,a]}set useVertexMorphing(a){this._useVertexMorphing=a}updateTileBinding(a){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const d=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=0===g._centerAltitude&&-1===this.getAtPointOrZero(p.MercatorCoordinate.fromLngLat(g.center),-1),this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=d.getIds().map(O=>{const z=d.getTileByID(O).tileID;return z.projMatrix=g.calculateProjMatrix(z.toUnwrapped()),z});(function(O,z){const F=z.transform.pointCoordinate(z.transform.getCameraPoint()),U=new p.pointGeometry(F.x,F.y);O.sort((W,ne)=>{if(ne.overscaledZ-W.overscaledZ)return ne.overscaledZ-W.overscaledZ;const K=new p.pointGeometry(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),J=new p.pointGeometry(ne.canonical.x+(1<<ne.canonical.z)*ne.wrap,ne.canonical.y),te=U.mult(1<<W.canonical.z);return te.x-=.5,te.y-=.5,te.distSqr(K)-te.distSqr(J)})})(x,this.painter),this._previousZoom=g.zoom;const C=this.proxyToSource||{};this.proxyToSource={},x.forEach(O=>{this.proxyToSource[O.key]={}}),this.terrainTileForTile={};const M=this._style._sourceCaches;for(const O in M){const z=M[O];if(!z.used||(z!==this.sourceCache&&this.resetTileLookupCache(z.id),this._setupProxiedCoordsForOrtho(z,a[O],C),z.usedForTerrain))continue;const F=a[O];z.getSource().reparseOverscaled&&this._assignTerrainTiles(F)}this.proxiedCoords[d.id]=x.map(O=>new zi(O,O.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(C),this.renderingToTexture=!1,this._updateTimestamp=p.exported.now();const D={};this._visibleDemTiles=[];for(const O of this.proxyCoords){const z=this.terrainTileForTile[O.key];if(!z)continue;const F=z.tileID.key;F in D||(this._visibleDemTiles.push(z),D[F]=F)}}_assignTerrainTiles(a){this._initializing||a.forEach(d=>{if(this.terrainTileForTile[d.key])return;const g=this._findTileCoveringTileID(d,this.sourceCache);g&&(this.terrainTileForTile[d.key]=g)})}_prepareDEMTextures(){const a=this.painter.context,d=a.gl;for(const g in this.terrainTileForTile){const x=this.terrainTileForTile[g],C=x.dem;!C||x.demTexture&&!x.needsDEMTextureUpload||(a.activeTexture.set(d.TEXTURE1),_n(this.painter,x,C))}}_prepareDemTileUniforms(a,d,g,x){if(!d||null==d.demTexture)return!1;const C=a.tileID.canonical,M=Math.pow(2,d.tileID.canonical.z-C.z),D=x||"";return g[`u_dem_tl${D}`]=[C.x*M%1,C.y*M%1],g[`u_dem_scale${D}`]=M,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const a=this.painter.context,d=a.gl;if(!this._emptyDepthBufferTexture){const g=new p.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new p.Texture(a,g,d.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let a=0;const d=this._visibleDemTiles.reduce((g,x)=>{if(!x.dem)return g;const C=x.dem.tree.minimums[0];return C>0&&a++,g+C},0);return a?d/a:0}_updateEmptyDEMTexture(){const a=this.painter.context,d=a.gl;a.activeTexture.set(d.TEXTURE2);const g=this._getLoadedAreaMinimum(),x=new p.RGBAImage({width:1,height:1},new Uint8Array(p.DEMData.pack(g,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let C=this._emptyDEMTexture;return C?C.update(x,{premultiply:!1}):C=this._emptyDEMTexture=new p.Texture(a,x,d.RGBA,{premultiply:!1}),C}setupElevationDraw(a,d,g){const x=this.painter.context,C=x.gl,M=(D=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:p.DEMData.getUnpackVector(D),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var D;M.u_dem_size=this.sourceCache.getSource().tileSize,M.u_exaggeration=this.exaggeration();const O=this.painter.transform,z=O.projection,F=a.tileID.canonical;M.u_tile_tl_up=z.upVector(F,0,0),M.u_tile_tr_up=z.upVector(F,p.EXTENT,0),M.u_tile_br_up=z.upVector(F,p.EXTENT,p.EXTENT),M.u_tile_bl_up=z.upVector(F,0,p.EXTENT),M.u_tile_up_scale=g&&g.useDenormalizedUpVectorScale?p.GLOBE_METERS_TO_ECEF:z.upVectorScale(F,O.center.lat,O.worldSize).metersToTile;let U=null,W=null,ne=1;if(g&&g.morphing&&this._useVertexMorphing){const K=g.morphing.srcDemTile,J=g.morphing.dstDemTile;ne=g.morphing.phase,K&&J&&(this._prepareDemTileUniforms(a,K,M,"_prev")&&(W=K),this._prepareDemTileUniforms(a,J,M)&&(U=J))}if(W&&U?(x.activeTexture.set(C.TEXTURE2),U.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST),x.activeTexture.set(C.TEXTURE4),W.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST),M.u_dem_lerp=ne):(U=this.terrainTileForTile[a.tileID.key],x.activeTexture.set(C.TEXTURE2),(this._prepareDemTileUniforms(a,U,M)?U.demTexture:this.emptyDEMTexture).bind(C.NEAREST,C.CLAMP_TO_EDGE)),x.activeTexture.set(C.TEXTURE3),g&&g.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE),this._depthFBO&&(M.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE),M.u_depth_size_inv=[1,1]),g&&g.useMeterToDem&&U){const K=(1<<U.tileID.canonical.z)*p.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;M.u_meter_to_dem=K}g&&g.labelPlaneMatrixInv&&(M.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),d.setTerrainUniformValues(x,M)}renderToBackBuffer(a){const d=this.painter,g=this.painter.context;0!==a.length&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,d.width,d.height]),d.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,C,M,D,O){if("globe"===x.transform.projection.name)!function(z,F,U,W,ne){const K=z.context,J=K.gl;let te,X;const re=z.options.showTerrainWireframe?2:0,ie=z.transform,xe=p.globeUseCustomAntiAliasing(z,K,ie),ge=(at,ke)=>{if(X===at)return;const et=[Al[at],"PROJECTION_GLOBE_VIEW"];xe&&et.push("CUSTOM_ANTIALIASING"),ke&&et.push(Al[re]),te=z.useProgram("globeRaster",null,et),X=at},pe=z.colorModeForRenderPass(),ve=new p.DepthMode(J.LEQUAL,p.DepthMode.ReadWrite,z.depthRangeFor3D);oa.update(ne);const _e=p.calculateGlobeMercatorMatrix(ie),Ce=[p.mercatorXfromLng(ie.center.lng),p.mercatorYfromLat(ie.center.lat)],Se=re?[!1,!0]:[!1],Je=z.globeSharedBuffers,Ee=[ie.width*p.exported.devicePixelRatio,ie.height*p.exported.devicePixelRatio],je=Float32Array.from(ie.globeMatrix),Ge={useDenormalizedUpVectorScale:!0};if(Se.forEach(at=>{X=-1;const ke=at?J.LINES:J.TRIANGLES;for(const et of W){const He=U.getTile(et),ht=p.StencilMode.disabled,lt=F.prevTerrainTileForTile[et.key],wt=F.terrainTileForTile[et.key];ti(lt,wt)&&oa.newMorphing(et.key,lt,wt,ne,250),K.activeTexture.set(J.TEXTURE0),He.texture.bind(J.LINEAR,J.CLAMP_TO_EDGE);const Lt=oa.getMorphValuesForProxy(et.key),jt=Lt?1:0;Lt&&p.extend$1(Ge,{morphing:{srcDemTile:Lt.from,dstDemTile:Lt.to,phase:p.easeCubicInOut(Lt.phase)}});const un=p.tileCornersToBounds(et.canonical),Et=p.getLatitudinalLod(un.getCenter().lat),Wt=p.getGridMatrix(et.canonical,un,Et),pn=p.globeNormalizeECEF(p.globeTileBounds(et.canonical)),Kn=Hd(ie.projMatrix,je,_e,pn,p.globeToMercatorTransition(ie.zoom),Ce,ie.frustumCorners.TL,ie.frustumCorners.TR,ie.frustumCorners.BR,ie.frustumCorners.BL,ie.globeCenterInViewSpace,ie.globeRadius,Ee,Wt);if(ge(jt,at),F.setupElevationDraw(He,te,Ge),z.prepareDrawProgram(K,te,et.toUnwrapped()),Je){const[di,Dn,Bi]=at?Je.getWirefameBuffers(z.context,Et):Je.getGridBuffers(Et);te.draw(K,ke,ve,ht,pe,p.CullFaceMode.backCCW,Kn,"globe_raster",di,Dn,Bi)}}}),Je){const at=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];xe&&at.push("CUSTOM_ANTIALIASING"),te=z.useProgram("globeRaster",null,at);for(const ke of W){const{x:et,y:He,z:ht}=ke.canonical,lt=0===He,wt=He===(1<<ht)-1,[Lt,jt,un,Et]=Je.getPoleBuffers(ht);if(Et&&(lt||wt)){const Wt=U.getTile(ke);K.activeTexture.set(J.TEXTURE0),Wt.texture.bind(J.LINEAR,J.CLAMP_TO_EDGE);let pn=p.globePoleMatrixForTile(ht,et,ie);const Kn=p.globeNormalizeECEF(p.globeTileBounds(ke.canonical)),di=(Dn,Bi)=>Dn.draw(K,J.TRIANGLES,ve,p.StencilMode.disabled,pe,p.CullFaceMode.disabled,Hd(ie.projMatrix,pn,pn,Kn,0,Ce,ie.frustumCorners.TL,ie.frustumCorners.TR,ie.frustumCorners.BR,ie.frustumCorners.BL,ie.globeCenterInViewSpace,ie.globeRadius,Ee),"globe_pole_raster",Bi,un,Et);F.setupElevationDraw(Wt,te,Ge),z.prepareDrawProgram(K,te,ke.toUnwrapped()),lt&&di(te,Lt),wt&&(pn=p.scale(p.create(),pn,[1,-1,1]),di(te,jt))}}}}(x,C,M,D,O);else{const z=x.context,F=z.gl;let U,W;const ne=x.options.showTerrainWireframe?2:0,K=(ie,xe)=>{if(W===ie)return;const ge=[Al[ie]];xe&&ge.push(Al[ne]),U=x.useProgram("terrainRaster",null,ge),W=ie},J=x.colorModeForRenderPass(),te=new p.DepthMode(F.LEQUAL,p.DepthMode.ReadWrite,x.depthRangeFor3D);oa.update(O);const X=x.transform,re=6*Math.pow(1.5,22-X.zoom)*C.exaggeration();(ne?[!1,!0]:[!1]).forEach(ie=>{W=-1;const xe=ie?F.LINES:F.TRIANGLES,[ge,pe]=ie?C.getWirefameBuffer():[C.gridIndexBuffer,C.gridSegments];for(const ve of D){const _e=M.getTile(ve),Ce=p.StencilMode.disabled,Se=C.prevTerrainTileForTile[ve.key],Je=C.terrainTileForTile[ve.key];ti(Se,Je)&&oa.newMorphing(ve.key,Se,Je,O,250),z.activeTexture.set(F.TEXTURE0),_e.texture.bind(F.LINEAR,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST);const Ee=oa.getMorphValuesForProxy(ve.key),je=Ee?1:0;let Ge;Ee&&(Ge={morphing:{srcDemTile:Ee.from,dstDemTile:Ee.to,phase:p.easeCubicInOut(Ee.phase)}});const at=ka(ve.projMatrix,Qh(ve.canonical,X.renderWorldCopies)?re/10:re);K(je,ie),C.setupElevationDraw(_e,U,Ge),x.prepareDrawProgram(z,U,ve.toUnwrapped()),U.draw(z,xe,te,Ce,J,p.CullFaceMode.backCCW,at,"terrain_raster",C.gridBuffer,ge,pe)}})}}(d,this,this.proxySourceCache,a,this._updateTimestamp),this.renderingToTexture=!0,d.gpuTimingDeferredRenderEnd(),a.splice(0,a.length))}renderBatch(a){if(0===this._drapedRenderBatches.length)return a+1;this.renderingToTexture=!0;const d=this.painter,g=this.painter.context,x=this.proxySourceCache,C=this.proxiedCoords[x.id],M=this._drapedRenderBatches.shift(),D=[],O=d.style.order;let z=0;for(const F of C){const U=x.getTileByID(F.proxyTileKey),W=x.proxyCachedFBO[F.key]?x.proxyCachedFBO[F.key][a]:void 0,ne=void 0!==W?x.renderCache[W]:this.pool[z++],K=void 0!==W;if(U.texture=ne.tex,K&&!ne.dirty){D.push(U.tileID);continue}let J;g.bindFramebuffer.set(ne.fb.framebuffer),this.renderedToTile=!1,ne.dirty&&(g.clear({color:p.Color.transparent,stencil:0}),ne.dirty=!1);for(let te=M.start;te<=M.end;++te){const X=d.style._layers[O[te]];if(X.isHidden(d.transform.zoom))continue;const re=d.style._getLayerSourceCache(X),ie=re?this.proxyToSource[F.key][re.id]:[F];if(!ie)continue;const xe=ie;g.viewport.set([0,0,ne.fb.width,ne.fb.height]),J!==(re?re.id:null)&&(this._setupStencil(ne,ie,X,re),J=re?re.id:null),d.renderLayer(d,re,X,xe)}this.renderedToTile?(ne.dirty=!0,D.push(U.tileID)):K||--z,5===z&&(z=0,this.renderToBackBuffer(D))}return this.renderToBackBuffer(D),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,d.width,d.height]),M.end+1}postRender(){}renderCacheEfficiency(a){const d=a.order.length;if(0===d)return{efficiency:100};let g,x=0,C=0,M=!1;for(let D=0;D<d;++D){const O=a._layers[a.order[D]];this._style.isLayerDraped(O)?(M&&++x,++C):M||(M=!0,g=O.id)}return 0===C?{efficiency:100}:{efficiency:100*(1-x/C),firstUndrapedLayer:g}}getMinElevationBelowMSL(){let a=0;return this._visibleDemTiles.filter(d=>d.dem).forEach(d=>{a=Math.min(a,d.dem.tree.minimums[0])}),0===a?a:(a-30)*this._exaggeration}raycast(a,d,g){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(C=>C.dem).map(C=>{const M=C.tileID,D=1<<M.overscaledZ,{x:O,y:z}=M.canonical,F=O/D,U=(O+1)/D,W=z/D,ne=(z+1)/D;return{minx:F,miny:W,maxx:U,maxy:ne,t:C.dem.tree.raycastRoot(F,W,U,ne,a,d,g),tile:C}});x.sort((C,M)=>(null!==C.t?C.t:Number.MAX_VALUE)-(null!==M.t?M.t:Number.MAX_VALUE));for(const C of x){if(null==C.t)return null;const M=C.tile.dem.tree.raycast(C.minx,C.miny,C.maxx,C.maxy,a,d,g);if(null!=M)return M}return null}_createFBO(){const a=this.painter.context,d=a.gl,g=this.drapeBufferSize;a.activeTexture.set(d.TEXTURE0);const x=new p.Texture(a,{width:g[0],height:g[1],data:null},d.RGBA);x.bind(d.LINEAR,d.CLAMP_TO_EDGE);const C=a.createFramebuffer(g[0],g[1],!1);return C.colorAttachment.set(x.texture),C.depthAttachment=new V(a,C.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=a.createRenderbuffer(a.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,C.depthAttachment.set(this._sharedDepthStencil),a.clear({stencil:0})):C.depthAttachment.set(this._sharedDepthStencil),a.extTextureFilterAnisotropic&&!a.extTextureFilterAnisotropicForceOff&&d.texParameterf(d.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax),{fb:C,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const a in this._style._sourceCaches)if(this._style._sourceCaches[a].hasTransition())return!0;return this._style.order.some(a=>{const d=this._style._layers[a],g=d.isHidden(this.painter.transform.zoom),x=d.getCrossfadeParameters(),C=!!x&&1!==x.t,M=d.hasTransition();return"custom"!==d.type&&!g&&(C||M)})}_clearRasterFadeFromRenderCache(){let a=!1;for(const d in this._style._sourceCaches)if(this._style._sourceCaches[d]._source instanceof ue){a=!0;break}if(a)for(let d=0;d<this._style.order.length;++d){const g=this._style._layers[this._style.order[d]],x=g.isHidden(this.painter.transform.zoom),C=this._style._getLayerSourceCache(g);if("raster"!==g.type||x||!C)continue;const M=g.paint.get("raster-fade-duration");for(const D of this.proxyCoords){const O=this.proxyToSource[D.key][C.id];if(O)for(const z of O){const F=hr(C.getTile(z),C.findLoadedParent(z,0),C,this.painter.transform,M);(1!==F.opacity||0!==F.mix)&&this._clearRenderCacheForTile(C.id,z)}}}}_setupDrapedRenderBatches(){const a=this._style.order,d=a.length;if(0===d)return;const g=[];let x,C=0,M=this._style._layers[a[C]];for(;!this._style.isLayerDraped(M)&&M.isHidden(this.painter.transform.zoom)&&++C<d;)M=this._style._layers[a[C]];for(;C<d;++C){const D=this._style._layers[a[C]];D.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(D)?void 0===x&&(x=C):void 0!==x&&(g.push({start:x,end:C-1}),x=void 0))}void 0!==x&&g.push({start:x,end:C-1}),this._drapedRenderBatches=g}_setupRenderCache(a){const d=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,d.renderCache.length>d.renderCachePool.length){const M=Object.values(d.proxyCachedFBO);d.proxyCachedFBO={};for(let D=0;D<M.length;++D){const O=Object.values(M[D]);d.renderCachePool.push(...O)}}return}this._clearRasterFadeFromRenderCache();const g=this.proxyCoords,x=this._tilesDirty;for(let M=g.length-1;M>=0;M--){const D=g[M];if(d.getTileByID(D.key),void 0!==d.proxyCachedFBO[D.key]){const O=a[D.key],z=this.proxyToSource[D.key];let F=0;for(const U in z){const W=z[U],ne=O[U];if(!ne||ne.length!==W.length||W.some((K,J)=>K!==ne[J]||x[U]&&x[U].hasOwnProperty(K.key))){F=-1;break}++F}for(const U in d.proxyCachedFBO[D.key])d.renderCache[d.proxyCachedFBO[D.key][U]].dirty=F<0||F!==Object.values(O).length}}const C=[...this._drapedRenderBatches];C.sort((M,D)=>D.end-D.start-(M.end-M.start));for(const M of C)for(const D of g){if(d.proxyCachedFBO[D.key])continue;let O=d.renderCachePool.pop();void 0===O&&d.renderCache.length<50&&(O=d.renderCache.length,d.renderCache.push(this._createFBO())),void 0!==O&&(d.proxyCachedFBO[D.key]={},d.proxyCachedFBO[D.key][M.start]=O,d.renderCache[O].dirty=!0)}this._tilesDirty={}}_setupStencil(a,d,g,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const C=this.painter.context,M=C.gl;if(d.length<=1)return void(this._overlapStencilType=!1);let D;if(g.isTileClipped())D=d.length,this._overlapStencilMode.test={func:M.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(d[0].overscaledZ>d[d.length-1].overscaledZ))return void(this._overlapStencilType=!1);D=1,this._overlapStencilMode.test={func:M.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+D>255&&(C.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=D,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(d,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(a){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[a.key]),this._overlapStencilMode):p.StencilMode.disabled}_renderTileClippingMasks(a,d){const g=this.painter,x=this.painter.context,C=x.gl;g._tileClippingMaskIDs={},x.setColorMode(p.ColorMode.disabled),x.setDepthMode(p.DepthMode.disabled);const M=g.useProgram("clippingMask");for(const D of a){const O=g._tileClippingMaskIDs[D.key]=--d;M.draw(x,C.TRIANGLES,p.DepthMode.disabled,new p.StencilMode({func:C.ALWAYS,mask:0},O,255,C.KEEP,C.KEEP,C.REPLACE),p.ColorMode.disabled,p.CullFaceMode.disabled,Ou(D.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(a){const d=this.painter.transform;if(a.x<0||a.x>d.width||a.y<0||a.y>d.height)return null;const g=[a.x,a.y,1,1];p.transformMat4$1(g,g,d.pixelMatrixInverse),p.scale$1(g,g,1/g[3]),g[0]/=d.worldSize,g[1]/=d.worldSize;const x=d._camera.position,C=p.mercatorZfromAltitude(1,d.center.lat),M=[x[0],x[1],x[2]/C,0],D=p.subtract([],g.slice(0,3),M);p.normalize(D,D);const O=this.raycast(M,D,this._exaggeration);return null!==O&&O?(p.scaleAndAdd(M,M,D,O),M[3]=M[2],M[2]*=C,M):null}drawDepth(){const a=this.painter,d=a.context,g=this.proxySourceCache,x=Math.ceil(a.width),C=Math.ceil(a.height);if(!this._depthFBO||this._depthFBO.width===x&&this._depthFBO.height===C||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const M=d.gl,D=d.createFramebuffer(x,C,!0);d.activeTexture.set(M.TEXTURE0);const O=new p.Texture(d,{width:x,height:C,data:null},M.RGBA);O.bind(M.NEAREST,M.CLAMP_TO_EDGE),D.colorAttachment.set(O.texture);const z=d.createRenderbuffer(d.gl.DEPTH_COMPONENT16,x,C);D.depthAttachment.set(z),this._depthFBO=D,this._depthTexture=O}d.bindFramebuffer.set(this._depthFBO.framebuffer),d.viewport.set([0,0,x,C]),function(M,D,O,z){if("globe"===M.transform.projection.name)return;const F=M.context,U=F.gl;F.clear({depth:1});const W=M.useProgram("terrainDepth"),ne=new p.DepthMode(U.LESS,p.DepthMode.ReadWrite,M.depthRangeFor3D);for(const K of z){const J=O.getTile(K),te=ka(K.projMatrix,0);D.setupElevationDraw(J,W),W.draw(F,U.TRIANGLES,ne,p.StencilMode.disabled,p.ColorMode.unblended,p.CullFaceMode.backCCW,te,"terrain_depth",D.gridBuffer,D.gridIndexBuffer,D.gridNoSkirtSegments)}}(a,this,g,this.proxyCoords)}_setupProxiedCoordsForOrtho(a,d,g){if(a.getSource()instanceof Ae)return this._setupProxiedCoordsForImageSource(a,d,g);this._findCoveringTileCache[a.id]=this._findCoveringTileCache[a.id]||{};const x=this.proxiedCoords[a.id]=[],C=this.proxyCoords;for(let D=0;D<C.length;D++){const O=C[D],z=this._findTileCoveringTileID(O,a);if(z){const F=this._createProxiedId(O,z,g[O.key]&&g[O.key][a.id]);x.push(F),this.proxyToSource[O.key][a.id]=[F]}}let M=!1;for(let D=0;D<d.length;D++){const O=a.getTile(d[D]);if(!O||!O.hasData())continue;const z=this._findTileCoveringTileID(O.tileID,this.proxySourceCache);if(z&&z.tileID.canonical.z!==O.tileID.canonical.z){const F=this.proxyToSource[z.tileID.key][a.id],U=this._createProxiedId(z.tileID,O,g[z.tileID.key]&&g[z.tileID.key][a.id]);F?F.splice(F.length-1,0,U):this.proxyToSource[z.tileID.key][a.id]=[U],x.push(U),M=!0}}this._sourceTilesOverlap[a.id]=M}_setupProxiedCoordsForImageSource(a,d,g){if(!a.getSource().loaded())return;const x=this.proxiedCoords[a.id]=[],C=this.proxyCoords,M=a.getSource(),D=new p.pointGeometry(M.tileID.x,M.tileID.y)._div(1<<M.tileID.z),O=M.coordinates.map(p.MercatorCoordinate.fromLngLat).reduce((F,U)=>(F.min.x=Math.min(F.min.x,U.x-D.x),F.min.y=Math.min(F.min.y,U.y-D.y),F.max.x=Math.max(F.max.x,U.x-D.x),F.max.y=Math.max(F.max.y,U.y-D.y),F),{min:new p.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new p.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),z=(F,U)=>{const W=F.wrap+F.canonical.x/(1<<F.canonical.z),ne=F.canonical.y/(1<<F.canonical.z),K=p.EXTENT/(1<<F.canonical.z),J=U.wrap+U.canonical.x/(1<<U.canonical.z),te=U.canonical.y/(1<<U.canonical.z);return W+K<J+O.min.x||W>J+O.max.x||ne+K<te+O.min.y||ne>te+O.max.y};for(let F=0;F<C.length;F++){const U=C[F];for(let W=0;W<d.length;W++){const ne=a.getTile(d[W]);if(!ne||!ne.hasData()||z(U,ne.tileID))continue;const K=this._createProxiedId(U,ne,g[U.key]&&g[U.key][a.id]),J=this.proxyToSource[U.key][a.id];J?J.push(K):this.proxyToSource[U.key][a.id]=[K],x.push(K)}}}_createProxiedId(a,d,g){let x=this.orthoMatrix;if(g){const C=g.find(M=>M.key===d.tileID.key);if(C)return C}if(d.tileID.key!==a.key){const C=a.canonical.z-d.tileID.canonical.z;let M,D,O;x=p.create();const z=d.tileID.wrap-a.wrap<<a.overscaledZ;C>0?(M=p.EXTENT>>C,D=M*((d.tileID.canonical.x<<C)-a.canonical.x+z),O=M*((d.tileID.canonical.y<<C)-a.canonical.y)):(M=p.EXTENT<<-C,D=p.EXTENT*(d.tileID.canonical.x-(a.canonical.x+z<<-C)),O=p.EXTENT*(d.tileID.canonical.y-(a.canonical.y<<-C))),p.ortho(x,0,M,0,M,0,1),p.translate(x,x,[D,O,0])}return new zi(d.tileID,a.key,x)}_findTileCoveringTileID(a,d){let g=d.getTile(a);if(g&&g.hasData())return g;const x=this._findCoveringTileCache[d.id],C=x[a.key];if(g=C?d.getTileByID(C):null,g&&g.hasData()||null===C)return g;let M=g?g.tileID:a,D=M.overscaledZ;const O=d.getSource().minzoom,z=[];if(!C){const U=d.getSource().maxzoom;if(a.canonical.z>=U){const W=a.canonical.z-U;d.getSource().reparseOverscaled?(D=Math.max(a.canonical.z+2,d.transform.tileZoom),M=new p.OverscaledTileID(D,a.wrap,U,a.canonical.x>>W,a.canonical.y>>W)):0!==W&&(D=U,M=new p.OverscaledTileID(D,a.wrap,U,a.canonical.x>>W,a.canonical.y>>W))}M.key!==a.key&&(z.push(M.key),g=d.getTile(M))}const F=U=>{z.forEach(W=>{x[W]=U}),z.length=0};for(D-=1;D>=O&&(!g||!g.hasData());D--){g&&F(g.tileID.key);const U=M.calculateScaledKey(D);if(g=d.getTileByID(U),g&&g.hasData())break;const W=x[U];if(null===W)break;void 0===W?z.push(U):g=d.getTileByID(W)}return F(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(a){return this.enabled?this._findTileCoveringTileID(a,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(a,d){let g=this._tilesDirty[a];g||(g=this._tilesDirty[a]={}),g[d.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const a=function(d){let g=0;const x=new p.StructArrayLayout2ui4,C=131;for(let M=1;M<129;M++){for(let D=1;D<129;D++)g=M*C+D,x.emplaceBack(g,g+1),x.emplaceBack(g,g+C),x.emplaceBack(g+1,g+C),128===M&&x.emplaceBack(g+C,g+C+1);x.emplaceBack(g+1,g+1+C)}return x}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(a),this.wireframeSegments=p.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,a.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Wi{static cacheKey(a,d,g,x){let C=`${d}${x?x.cacheKey:""}`;for(const M of g)a.usedDefines.includes(M)&&(C+=`/${M}`);return C}constructor(a,d,g,x,C,M){const D=a.gl;this.program=D.createProgram();const O=function(te){const X=[];for(let re=0;re<te.length;re++){if(null===te[re])continue;const ie=te[re].split(" ");X.push(ie.pop())}return X}(g.staticAttributes),z=x?x.getBinderAttributes():[],F=O.concat(z);let U=x?x.defines():[];U=U.concat(M.map(te=>`#define ${te}`));const W=U.concat(a.extStandardDerivatives?"#extension GL_OES_standard_derivatives : enable\n".concat(Vn):Vn,Vn,$d,ic.fragmentSource,Pa.fragmentSource,g.fragmentSource).join("\n"),ne=U.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",$d,ic.vertexSource,Pa.vertexSource,no.vertexSource,g.vertexSource).join("\n"),K=D.createShader(D.FRAGMENT_SHADER);if(D.isContextLost())return void(this.failedToCreate=!0);D.shaderSource(K,W),D.compileShader(K),D.attachShader(this.program,K);const J=D.createShader(D.VERTEX_SHADER);if(D.isContextLost())this.failedToCreate=!0;else{D.shaderSource(J,ne),D.compileShader(J),D.attachShader(this.program,J),this.attributes={},this.numAttributes=F.length;for(let te=0;te<this.numAttributes;te++)F[te]&&(D.bindAttribLocation(this.program,te,F[te]),this.attributes[F[te]]=te);D.linkProgram(this.program),D.deleteShader(J),D.deleteShader(K),this.fixedUniforms=C(a),this.binderUniforms=x?x.getUniforms(a):[],-1!==M.indexOf("TERRAIN")&&(this.terrainUniforms={u_dem:new p.Uniform1i(te=a),u_dem_prev:new p.Uniform1i(te),u_dem_unpack:new p.Uniform4f(te),u_dem_tl:new p.Uniform2f(te),u_dem_scale:new p.Uniform1f(te),u_dem_tl_prev:new p.Uniform2f(te),u_dem_scale_prev:new p.Uniform1f(te),u_dem_size:new p.Uniform1f(te),u_dem_lerp:new p.Uniform1f(te),u_exaggeration:new p.Uniform1f(te),u_depth:new p.Uniform1i(te),u_depth_size_inv:new p.Uniform2f(te),u_meter_to_dem:new p.Uniform1f(te),u_label_plane_matrix_inv:new p.UniformMatrix4f(te),u_tile_tl_up:new p.Uniform3f(te),u_tile_tr_up:new p.Uniform3f(te),u_tile_br_up:new p.Uniform3f(te),u_tile_bl_up:new p.Uniform3f(te),u_tile_up_scale:new p.Uniform1f(te)}),-1!==M.indexOf("FOG")&&(this.fogUniforms=(te=>({u_fog_matrix:new p.UniformMatrix4f(te),u_fog_range:new p.Uniform2f(te),u_fog_color:new p.Uniform4f(te),u_fog_horizon_blend:new p.Uniform1f(te),u_fog_temporal_offset:new p.Uniform1f(te),u_frustum_tl:new p.Uniform3f(te),u_frustum_tr:new p.Uniform3f(te),u_frustum_br:new p.Uniform3f(te),u_frustum_bl:new p.Uniform3f(te),u_globe_pos:new p.Uniform3f(te),u_globe_radius:new p.Uniform1f(te),u_globe_transition:new p.Uniform1f(te),u_is_globe:new p.Uniform1i(te),u_viewport:new p.Uniform2f(te)}))(a))}var te}setTerrainUniformValues(a,d){if(!this.terrainUniforms)return;const g=this.terrainUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const x in d)g[x].set(this.program,x,d[x])}}setFogUniformValues(a,d){if(!this.fogUniforms)return;const g=this.fogUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const x in d)g[x].set(this.program,x,d[x])}}draw(a,d,g,x,C,M,D,O,z,F,U,W,ne,K,J){const te=a.gl;if(this.failedToCreate)return;a.program.set(this.program),a.setDepthMode(g),a.setStencilMode(x),a.setColorMode(C),a.setCullFace(M);for(const re of Object.keys(this.fixedUniforms))this.fixedUniforms[re].set(this.program,re,D[re]);K&&K.setUniforms(this.program,a,this.binderUniforms,W,{zoom:ne});const X={[te.LINES]:2,[te.TRIANGLES]:3,[te.LINE_STRIP]:1}[d];for(const re of U.get()){const ie=re.vaos||(re.vaos={});(ie[O]||(ie[O]=new Wn)).bind(a,this,z,K?K.getPaintVertexBuffers():[],F,re.vertexOffset,J||[]),te.drawElements(d,re.primitiveLength*X,te.UNSIGNED_SHORT,re.primitiveOffset*X*2)}}}function Ps(f,a,d){const g=1/As(d,1,a.transform.tileZoom),x=Math.pow(2,d.tileID.overscaledZ),C=d.tileSize*Math.pow(2,a.transform.tileZoom)/x,M=C*(d.tileID.canonical.x+d.tileID.wrap*x),D=C*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[g,f.fromScale,f.toScale],u_fade:f.t,u_pixel_coord_upper:[M>>16,D>>16],u_pixel_coord_lower:[65535&M,65535&D]}}const Lo=p.create(),nr=(f,a,d,g,x,C,M,D,O,z,F)=>{const U=a.style.light,W=U.properties.get("position"),ne=[W.x,W.y,W.z],K=p.create$1();"viewport"===U.properties.get("anchor")&&(p.fromRotation(K,-a.transform.angle),p.transformMat3(ne,ne,K));const J=U.properties.get("color"),te=a.transform,X={u_matrix:f,u_lightpos:ne,u_lightintensity:U.properties.get("intensity"),u_lightcolor:[J.r,J.g,J.b],u_vertical_gradient:+d,u_opacity:g,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Lo,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:x,u_edge_radius:C};return"globe"===te.projection.name&&(X.u_tile_id=[M.canonical.x,M.canonical.y,1<<M.canonical.z],X.u_zoom_transition=O,X.u_inv_rot_matrix=F,X.u_merc_center=z,X.u_up_dir=te.projection.upVector(new p.CanonicalTileID(0,0,0),z[0]*p.EXTENT,z[1]*p.EXTENT),X.u_height_lift=D),X},oc=(f,a,d,g,x,C,M,D,O,z,F,U,W)=>{const ne=nr(f,a,d,g,x,C,M,z,F,U,W),K={u_height_factor:-Math.pow(2,M.overscaledZ)/O.tileSize/8};return p.extend(ne,Ps(D,a,O),K)},Ra=f=>({u_matrix:f}),sa=(f,a,d,g)=>p.extend(Ra(f),Ps(d,a,g)),ro=(f,a)=>({u_matrix:f,u_world:a}),Os=(f,a,d,g,x)=>p.extend(sa(f,a,d,g),{u_world:x}),ir=p.create(),Zd=(f,a,d,g,x,C)=>{const M=f.transform,D="globe"===M.projection.name;let O;if("map"===C.paint.get("circle-pitch-alignment"))if(D){const F=p.globePixelsToTileUnits(M.zoom,a.canonical)*M._pixelsPerMercatorPixel;O=Float32Array.from([F,0,0,F])}else O=M.calculatePixelsToTileUnitsMatrix(d);else O=new Float32Array([M.pixelsToGLUnits[0],0,0,M.pixelsToGLUnits[1]]);const z={u_camera_to_center_distance:M.cameraToCenterDistance,u_matrix:f.translatePosMatrix(a.projMatrix,d,C.paint.get("circle-translate"),C.paint.get("circle-translate-anchor")),u_device_pixel_ratio:p.exported.devicePixelRatio,u_extrude_scale:O,u_inv_rot_matrix:ir,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(D){z.u_inv_rot_matrix=g,z.u_merc_center=x,z.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],z.u_zoom_transition=p.globeToMercatorTransition(M.zoom);const F=x[0]*p.EXTENT,U=x[1]*p.EXTENT;z.u_up_dir=M.projection.upVector(new p.CanonicalTileID(0,0,0),F,U)}return z},oo=f=>{const a=[];return"map"===f.paint.get("circle-pitch-alignment")&&a.push("PITCH_WITH_MAP"),"map"===f.paint.get("circle-pitch-scale")&&a.push("SCALE_WITH_MAP"),a},At=(f,a,d,g)=>{const x=p.EXTENT/d.tileSize;return{u_matrix:f,u_camera_to_center_distance:a.getCameraToCenterDistance(g),u_extrude_scale:[a.pixelsToGLUnits[0]/x,a.pixelsToGLUnits[1]/x]}},yn=(f,a,d=1)=>({u_matrix:f,u_color:a,u_overlay:0,u_overlay_scale:d}),ui=p.create(),so=(f,a,d,g,x,C,M)=>{const D=f.transform,O="globe"===D.projection.name,z=O?p.globePixelsToTileUnits(D.zoom,a.canonical)*D._pixelsPerMercatorPixel:As(d,1,C),F={u_matrix:a.projMatrix,u_extrude_scale:z,u_intensity:M,u_inv_rot_matrix:ui,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(O){F.u_inv_rot_matrix=g,F.u_merc_center=x,F.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],F.u_zoom_transition=p.globeToMercatorTransition(D.zoom);const U=x[0]*p.EXTENT,W=x[1]*p.EXTENT;F.u_up_dir=D.projection.upVector(new p.CanonicalTileID(0,0,0),U,W)}return F},cs=(f,a,d,g,x,C,M,D)=>{const O=f.transform,z=O.calculatePixelsToTileUnitsMatrix(a),F={u_matrix:Ci(f,a,d,x),u_pixels_to_tile_units:z,u_device_pixel_ratio:M,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:C,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0,u_trim_offset:D};if(aa(d)){const U=us(a,f.transform);F.u_texsize=a.lineAtlasTexture.size,F.u_scale=[U,g.fromScale,g.toScale],F.u_mix=g.t}return F},Yi=(f,a,d,g,x,C)=>{const M=f.transform,D=us(a,M);return{u_matrix:Ci(f,a,d,x),u_texsize:a.imageAtlasTexture.size,u_pixels_to_tile_units:M.calculatePixelsToTileUnitsMatrix(a),u_device_pixel_ratio:C,u_image:0,u_scale:[D,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function us(f,a){return 1/As(f,1,a.tileZoom)}function Ci(f,a,d,g){return f.translatePosMatrix(g||a.tileID.projMatrix,a,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}function aa(f){const a=f.paint.get("line-dasharray").value;return a.value||"constant"!==a.kind}const El=(f,a,d,g,x,C)=>{return{u_matrix:f,u_tl_parent:a,u_scale_parent:d,u_fade_t:g.mix,u_opacity:g.opacity*x.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:x.paint.get("raster-brightness-min"),u_brightness_high:x.paint.get("raster-brightness-max"),u_saturation_factor:(D=x.paint.get("raster-saturation"),D>0?1-1/(1.001-D):-D),u_contrast_factor:(M=x.paint.get("raster-contrast"),M>0?1/(1-M):1+M),u_spin_weights:an(x.paint.get("raster-hue-rotate")),u_perspective_transform:C};var M,D};function an(f){f*=Math.PI/180;const a=Math.sin(f),d=Math.cos(f);return[(2*d+1)/3,(-Math.sqrt(3)*a-d+1)/3,(Math.sqrt(3)*a-d+1)/3]}const sc=p.create(),la=(f,a,d,g,x,C,M,D,O,z,F,U,W,ne,K,J)=>{const te=x.transform,X={u_is_size_zoom_constant:+("constant"===f||"source"===f),u_is_size_feature_constant:+("constant"===f||"camera"===f),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:te.cameraToCenterDistance,u_rotate_symbol:+d,u_aspect_ratio:te.width/te.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:C,u_label_plane_matrix:M,u_coord_matrix:D,u_is_text:+O,u_pitch_with_map:+g,u_texsize:z,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:sc,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:sc,u_up_vector:[0,-1,0]};return"globe"===J.name&&(X.u_tile_id=[F.canonical.x,F.canonical.y,1<<F.canonical.z],X.u_zoom_transition=U,X.u_inv_rot_matrix=ne,X.u_merc_center=W,X.u_camera_forward=te._camera.forward(),X.u_ecef_origin=p.globeECEFOrigin(te.globeMatrix,F.toUnwrapped()),X.u_tile_matrix=Float32Array.from(te.globeMatrix),X.u_up_vector=K),X},ac=(f,a,d,g,x,C,M,D,O,z,F,U,W,ne,K,J,te)=>p.extend(la(f,a,d,g,x,C,M,D,O,z,U,W,ne,K,J,te),{u_gamma_scale:g?x.transform.cameraToCenterDistance*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:p.exported.devicePixelRatio,u_is_halo:+F}),zo=(f,a,d,g,x,C,M,D,O,z,F,U,W,ne,K,J)=>p.extend(ac(f,a,d,g,x,C,M,D,!0,O,!0,F,U,W,ne,K,J),{u_texsize_icon:z,u_texture_icon:1}),zr=(f,a,d)=>({u_matrix:f,u_opacity:a,u_color:d}),lc=(f,a,d,g,x,C)=>p.extend(function(M,D,O,z){const F=O.imageManager.getPattern(M.from.toString()),U=O.imageManager.getPattern(M.to.toString()),{width:W,height:ne}=O.imageManager.getPixelSize(),K=Math.pow(2,z.tileID.overscaledZ),J=z.tileSize*Math.pow(2,O.transform.tileZoom)/K,te=J*(z.tileID.canonical.x+z.tileID.wrap*K),X=J*z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:F.tl,u_pattern_br_a:F.br,u_pattern_tl_b:U.tl,u_pattern_br_b:U.br,u_texsize:[W,ne],u_mix:D.t,u_pattern_size_a:F.displaySize,u_pattern_size_b:U.displaySize,u_scale_a:D.fromScale,u_scale_b:D.toScale,u_tile_units_to_pixels:1/As(z,1,O.transform.tileZoom),u_pixel_coord_upper:[te>>16,X>>16],u_pixel_coord_lower:[65535&te,65535&X]}}(g,C,d,x),{u_matrix:f,u_opacity:a}),Tl={fillExtrusion:f=>({u_matrix:new p.UniformMatrix4f(f),u_lightpos:new p.Uniform3f(f),u_lightintensity:new p.Uniform1f(f),u_lightcolor:new p.Uniform3f(f),u_vertical_gradient:new p.Uniform1f(f),u_opacity:new p.Uniform1f(f),u_edge_radius:new p.Uniform1f(f),u_ao:new p.Uniform2f(f),u_tile_id:new p.Uniform3f(f),u_zoom_transition:new p.Uniform1f(f),u_inv_rot_matrix:new p.UniformMatrix4f(f),u_merc_center:new p.Uniform2f(f),u_up_dir:new p.Uniform3f(f),u_height_lift:new p.Uniform1f(f)}),fillExtrusionPattern:f=>({u_matrix:new p.UniformMatrix4f(f),u_lightpos:new p.Uniform3f(f),u_lightintensity:new p.Uniform1f(f),u_lightcolor:new p.Uniform3f(f),u_vertical_gradient:new p.Uniform1f(f),u_height_factor:new p.Uniform1f(f),u_edge_radius:new p.Uniform1f(f),u_ao:new p.Uniform2f(f),u_tile_id:new p.Uniform3f(f),u_zoom_transition:new p.Uniform1f(f),u_inv_rot_matrix:new p.UniformMatrix4f(f),u_merc_center:new p.Uniform2f(f),u_up_dir:new p.Uniform3f(f),u_height_lift:new p.Uniform1f(f),u_image:new p.Uniform1i(f),u_texsize:new p.Uniform2f(f),u_pixel_coord_upper:new p.Uniform2f(f),u_pixel_coord_lower:new p.Uniform2f(f),u_scale:new p.Uniform3f(f),u_fade:new p.Uniform1f(f),u_opacity:new p.Uniform1f(f)}),fill:f=>({u_matrix:new p.UniformMatrix4f(f)}),fillPattern:f=>({u_matrix:new p.UniformMatrix4f(f),u_image:new p.Uniform1i(f),u_texsize:new p.Uniform2f(f),u_pixel_coord_upper:new p.Uniform2f(f),u_pixel_coord_lower:new p.Uniform2f(f),u_scale:new p.Uniform3f(f),u_fade:new p.Uniform1f(f)}),fillOutline:f=>({u_matrix:new p.UniformMatrix4f(f),u_world:new p.Uniform2f(f)}),fillOutlinePattern:f=>({u_matrix:new p.UniformMatrix4f(f),u_world:new p.Uniform2f(f),u_image:new p.Uniform1i(f),u_texsize:new p.Uniform2f(f),u_pixel_coord_upper:new p.Uniform2f(f),u_pixel_coord_lower:new p.Uniform2f(f),u_scale:new p.Uniform3f(f),u_fade:new p.Uniform1f(f)}),circle:f=>({u_camera_to_center_distance:new p.Uniform1f(f),u_extrude_scale:new p.UniformMatrix2f(f),u_device_pixel_ratio:new p.Uniform1f(f),u_matrix:new p.UniformMatrix4f(f),u_inv_rot_matrix:new p.UniformMatrix4f(f),u_merc_center:new p.Uniform2f(f),u_tile_id:new p.Uniform3f(f),u_zoom_transition:new p.Uniform1f(f),u_up_dir:new p.Uniform3f(f)}),collisionBox:f=>({u_matrix:new p.UniformMatrix4f(f),u_camera_to_center_distance:new p.Uniform1f(f),u_extrude_scale:new p.Uniform2f(f)}),collisionCircle:f=>({u_matrix:new p.UniformMatrix4f(f),u_inv_matrix:new p.UniformMatrix4f(f),u_camera_to_center_distance:new p.Uniform1f(f),u_viewport_size:new p.Uniform2f(f)}),debug:f=>({u_color:new p.UniformColor(f),u_matrix:new p.UniformMatrix4f(f),u_overlay:new p.Uniform1i(f),u_overlay_scale:new p.Uniform1f(f)}),clippingMask:f=>({u_matrix:new p.UniformMatrix4f(f)}),heatmap:f=>({u_extrude_scale:new p.Uniform1f(f),u_intensity:new p.Uniform1f(f),u_matrix:new p.UniformMatrix4f(f),u_inv_rot_matrix:new p.UniformMatrix4f(f),u_merc_center:new p.Uniform2f(f),u_tile_id:new p.Uniform3f(f),u_zoom_transition:new p.Uniform1f(f),u_up_dir:new p.Uniform3f(f)}),heatmapTexture:f=>({u_image:new p.Uniform1i(f),u_color_ramp:new p.Uniform1i(f),u_opacity:new p.Uniform1f(f)}),hillshade:f=>({u_matrix:new p.UniformMatrix4f(f),u_image:new p.Uniform1i(f),u_latrange:new p.Uniform2f(f),u_light:new p.Uniform2f(f),u_shadow:new p.UniformColor(f),u_highlight:new p.UniformColor(f),u_accent:new p.UniformColor(f)}),hillshadePrepare:f=>({u_matrix:new p.UniformMatrix4f(f),u_image:new p.Uniform1i(f),u_dimension:new p.Uniform2f(f),u_zoom:new p.Uniform1f(f),u_unpack:new p.Uniform4f(f)}),line:f=>({u_matrix:new p.UniformMatrix4f(f),u_pixels_to_tile_units:new p.UniformMatrix2f(f),u_device_pixel_ratio:new p.Uniform1f(f),u_units_to_pixels:new p.Uniform2f(f),u_dash_image:new p.Uniform1i(f),u_gradient_image:new p.Uniform1i(f),u_image_height:new p.Uniform1f(f),u_texsize:new p.Uniform2f(f),u_scale:new p.Uniform3f(f),u_mix:new p.Uniform1f(f),u_alpha_discard_threshold:new p.Uniform1f(f),u_trim_offset:new p.Uniform2f(f)}),linePattern:f=>({u_matrix:new p.UniformMatrix4f(f),u_texsize:new p.Uniform2f(f),u_pixels_to_tile_units:new p.UniformMatrix2f(f),u_device_pixel_ratio:new p.Uniform1f(f),u_image:new p.Uniform1i(f),u_units_to_pixels:new p.Uniform2f(f),u_scale:new p.Uniform3f(f),u_fade:new p.Uniform1f(f),u_alpha_discard_threshold:new p.Uniform1f(f)}),raster:f=>({u_matrix:new p.UniformMatrix4f(f),u_tl_parent:new p.Uniform2f(f),u_scale_parent:new p.Uniform1f(f),u_fade_t:new p.Uniform1f(f),u_opacity:new p.Uniform1f(f),u_image0:new p.Uniform1i(f),u_image1:new p.Uniform1i(f),u_brightness_low:new p.Uniform1f(f),u_brightness_high:new p.Uniform1f(f),u_saturation_factor:new p.Uniform1f(f),u_contrast_factor:new p.Uniform1f(f),u_spin_weights:new p.Uniform3f(f),u_perspective_transform:new p.Uniform2f(f)}),symbolIcon:f=>({u_is_size_zoom_constant:new p.Uniform1i(f),u_is_size_feature_constant:new p.Uniform1i(f),u_size_t:new p.Uniform1f(f),u_size:new p.Uniform1f(f),u_camera_to_center_distance:new p.Uniform1f(f),u_rotate_symbol:new p.Uniform1i(f),u_aspect_ratio:new p.Uniform1f(f),u_fade_change:new p.Uniform1f(f),u_matrix:new p.UniformMatrix4f(f),u_label_plane_matrix:new p.UniformMatrix4f(f),u_coord_matrix:new p.UniformMatrix4f(f),u_is_text:new p.Uniform1i(f),u_pitch_with_map:new p.Uniform1i(f),u_texsize:new p.Uniform2f(f),u_tile_id:new p.Uniform3f(f),u_zoom_transition:new p.Uniform1f(f),u_inv_rot_matrix:new p.UniformMatrix4f(f),u_merc_center:new p.Uniform2f(f),u_camera_forward:new p.Uniform3f(f),u_tile_matrix:new p.UniformMatrix4f(f),u_up_vector:new p.Uniform3f(f),u_ecef_origin:new p.Uniform3f(f),u_texture:new p.Uniform1i(f)}),symbolSDF:f=>({u_is_size_zoom_constant:new p.Uniform1i(f),u_is_size_feature_constant:new p.Uniform1i(f),u_size_t:new p.Uniform1f(f),u_size:new p.Uniform1f(f),u_camera_to_center_distance:new p.Uniform1f(f),u_rotate_symbol:new p.Uniform1i(f),u_aspect_ratio:new p.Uniform1f(f),u_fade_change:new p.Uniform1f(f),u_matrix:new p.UniformMatrix4f(f),u_label_plane_matrix:new p.UniformMatrix4f(f),u_coord_matrix:new p.UniformMatrix4f(f),u_is_text:new p.Uniform1i(f),u_pitch_with_map:new p.Uniform1i(f),u_texsize:new p.Uniform2f(f),u_texture:new p.Uniform1i(f),u_gamma_scale:new p.Uniform1f(f),u_device_pixel_ratio:new p.Uniform1f(f),u_tile_id:new p.Uniform3f(f),u_zoom_transition:new p.Uniform1f(f),u_inv_rot_matrix:new p.UniformMatrix4f(f),u_merc_center:new p.Uniform2f(f),u_camera_forward:new p.Uniform3f(f),u_tile_matrix:new p.UniformMatrix4f(f),u_up_vector:new p.Uniform3f(f),u_ecef_origin:new p.Uniform3f(f),u_is_halo:new p.Uniform1i(f)}),symbolTextAndIcon:f=>({u_is_size_zoom_constant:new p.Uniform1i(f),u_is_size_feature_constant:new p.Uniform1i(f),u_size_t:new p.Uniform1f(f),u_size:new p.Uniform1f(f),u_camera_to_center_distance:new p.Uniform1f(f),u_rotate_symbol:new p.Uniform1i(f),u_aspect_ratio:new p.Uniform1f(f),u_fade_change:new p.Uniform1f(f),u_matrix:new p.UniformMatrix4f(f),u_label_plane_matrix:new p.UniformMatrix4f(f),u_coord_matrix:new p.UniformMatrix4f(f),u_is_text:new p.Uniform1i(f),u_pitch_with_map:new p.Uniform1i(f),u_texsize:new p.Uniform2f(f),u_texsize_icon:new p.Uniform2f(f),u_texture:new p.Uniform1i(f),u_texture_icon:new p.Uniform1i(f),u_gamma_scale:new p.Uniform1f(f),u_device_pixel_ratio:new p.Uniform1f(f),u_is_halo:new p.Uniform1i(f)}),background:f=>({u_matrix:new p.UniformMatrix4f(f),u_opacity:new p.Uniform1f(f),u_color:new p.UniformColor(f)}),backgroundPattern:f=>({u_matrix:new p.UniformMatrix4f(f),u_opacity:new p.Uniform1f(f),u_image:new p.Uniform1i(f),u_pattern_tl_a:new p.Uniform2f(f),u_pattern_br_a:new p.Uniform2f(f),u_pattern_tl_b:new p.Uniform2f(f),u_pattern_br_b:new p.Uniform2f(f),u_texsize:new p.Uniform2f(f),u_mix:new p.Uniform1f(f),u_pattern_size_a:new p.Uniform2f(f),u_pattern_size_b:new p.Uniform2f(f),u_scale_a:new p.Uniform1f(f),u_scale_b:new p.Uniform1f(f),u_pixel_coord_upper:new p.Uniform2f(f),u_pixel_coord_lower:new p.Uniform2f(f),u_tile_units_to_pixels:new p.Uniform1f(f)}),terrainRaster:io,terrainDepth:io,skybox:f=>({u_matrix:new p.UniformMatrix4f(f),u_sun_direction:new p.Uniform3f(f),u_cubemap:new p.Uniform1i(f),u_opacity:new p.Uniform1f(f),u_temporal_offset:new p.Uniform1f(f)}),skyboxGradient:f=>({u_matrix:new p.UniformMatrix4f(f),u_color_ramp:new p.Uniform1i(f),u_center_direction:new p.Uniform3f(f),u_radius:new p.Uniform1f(f),u_opacity:new p.Uniform1f(f),u_temporal_offset:new p.Uniform1f(f)}),skyboxCapture:f=>({u_matrix_3f:new p.UniformMatrix3f(f),u_sun_direction:new p.Uniform3f(f),u_sun_intensity:new p.Uniform1f(f),u_color_tint_r:new p.Uniform4f(f),u_color_tint_m:new p.Uniform4f(f),u_luminance:new p.Uniform1f(f)}),globeRaster:f=>({u_proj_matrix:new p.UniformMatrix4f(f),u_globe_matrix:new p.UniformMatrix4f(f),u_normalize_matrix:new p.UniformMatrix4f(f),u_merc_matrix:new p.UniformMatrix4f(f),u_zoom_transition:new p.Uniform1f(f),u_merc_center:new p.Uniform2f(f),u_image0:new p.Uniform1i(f),u_grid_matrix:new p.UniformMatrix3f(f),u_frustum_tl:new p.Uniform3f(f),u_frustum_tr:new p.Uniform3f(f),u_frustum_br:new p.Uniform3f(f),u_frustum_bl:new p.Uniform3f(f),u_globe_pos:new p.Uniform3f(f),u_globe_radius:new p.Uniform1f(f),u_viewport:new p.Uniform2f(f)}),globeAtmosphere:f=>({u_frustum_tl:new p.Uniform3f(f),u_frustum_tr:new p.Uniform3f(f),u_frustum_br:new p.Uniform3f(f),u_frustum_bl:new p.Uniform3f(f),u_horizon:new p.Uniform1f(f),u_transition:new p.Uniform1f(f),u_fadeout_range:new p.Uniform1f(f),u_color:new p.Uniform4f(f),u_high_color:new p.Uniform4f(f),u_space_color:new p.Uniform4f(f),u_star_intensity:new p.Uniform1f(f),u_star_density:new p.Uniform1f(f),u_star_size:new p.Uniform1f(f),u_temporal_offset:new p.Uniform1f(f),u_horizon_angle:new p.Uniform1f(f),u_rotation_matrix:new p.UniformMatrix4f(f)})};let Fr;function ri(f,a,d,g,x,C,M){const D=f.context,O=D.gl,z=f.transform,F=f.useProgram("collisionBox"),U=[];let W=0,ne=0;for(let xe=0;xe<g.length;xe++){const ge=g[xe],pe=a.getTile(ge),ve=pe.getBucket(d);if(!ve)continue;const _e=Kr(ge,ve,z);let Ce=_e;0===x[0]&&0===x[1]||(Ce=f.translatePosMatrix(_e,pe,x,C));const Se=M?ve.textCollisionBox:ve.iconCollisionBox,Je=ve.collisionCircleArray;if(Je.length>0){const Ee=p.create(),je=Ce;p.mul(Ee,ve.placementInvProjMatrix,z.glCoordMatrix),p.mul(Ee,Ee,ve.placementViewportMatrix),U.push({circleArray:Je,circleOffset:ne,transform:je,invTransform:Ee,projection:ve.getProjection()}),W+=Je.length/4,ne=W}Se&&(f.terrain&&f.terrain.setupElevationDraw(pe,F),F.draw(D,O.LINES,p.DepthMode.disabled,p.StencilMode.disabled,f.colorModeForRenderPass(),p.CullFaceMode.disabled,At(Ce,z,pe,ve.getProjection()),d.id,Se.layoutVertexBuffer,Se.indexBuffer,Se.segments,null,z.zoom,null,[Se.collisionVertexBuffer,Se.collisionVertexBufferExt]))}if(!M||!U.length)return;const K=f.useProgram("collisionCircle"),J=new p.StructArrayLayout2f1f2i16;J.resize(4*W),J._trim();let te=0;for(const xe of U)for(let ge=0;ge<xe.circleArray.length/4;ge++){const pe=4*ge,ve=xe.circleArray[pe+0],_e=xe.circleArray[pe+1],Ce=xe.circleArray[pe+2],Se=xe.circleArray[pe+3];J.emplace(te++,ve,_e,Ce,Se,0),J.emplace(te++,ve,_e,Ce,Se,1),J.emplace(te++,ve,_e,Ce,Se,2),J.emplace(te++,ve,_e,Ce,Se,3)}(!Fr||Fr.length<2*W)&&(Fr=function(xe){const ge=2*xe,pe=new p.StructArrayLayout3ui6;pe.resize(ge),pe._trim();for(let ve=0;ve<ge;ve++){const _e=6*ve;pe.uint16[_e+0]=4*ve+0,pe.uint16[_e+1]=4*ve+1,pe.uint16[_e+2]=4*ve+2,pe.uint16[_e+3]=4*ve+2,pe.uint16[_e+4]=4*ve+3,pe.uint16[_e+5]=4*ve+0}return pe}(W));const X=D.createIndexBuffer(Fr,!0),re=D.createVertexBuffer(J,p.collisionCircleLayout.members,!0);for(const xe of U){const ge={u_matrix:xe.transform,u_inv_matrix:xe.invTransform,u_camera_to_center_distance:(ie=z).getCameraToCenterDistance(xe.projection),u_viewport_size:[ie.width,ie.height]};K.draw(D,O.TRIANGLES,p.DepthMode.disabled,p.StencilMode.disabled,f.colorModeForRenderPass(),p.CullFaceMode.disabled,ge,d.id,re,X,p.SegmentVector.simpleSegment(0,2*xe.circleOffset,xe.circleArray.length,xe.circleArray.length/2),null,z.zoom)}var ie;re.destroy(),X.destroy()}const Kh=p.create();function Wd(f,a,d,g,x,C){const{horizontalAlign:M,verticalAlign:D}=p.getAnchorAlignment(f),O=-(M-.5)*a,z=-(D-.5)*d,F=p.evaluateVariableOffset(f,g);return new p.pointGeometry((O/x+F[0])*C,(z/x+F[1])*C)}function bo(f,a,d,g,x,C,M,D,O,z,F){const U=f.text.placedSymbolArray,W=f.text.dynamicLayoutVertexArray,ne=f.icon.dynamicLayoutVertexArray,K={},J=Lr(D,f.getProjection(),C),te=C.elevation,X=f.getProjection().upVectorScale(D.canonical,C.center.lat,C.worldSize);W.clear();for(let re=0;re<U.length;re++){const ie=U.get(re),xe=f.allowVerticalPlacement&&!ie.placedOrientation,ge=ie.hidden||!ie.crossTileID||xe?null:g[ie.crossTileID];if(ge){const pe=new p.pointGeometry(ie.tileAnchorX,ie.tileAnchorY),ve=f.getProjection().upVector(D.canonical,pe.x,pe.y),_e=te?te.getAtTileOffset(D,pe.x,pe.y):0,Ce=Ct([ie.projectedAnchorX+_e*ve[0]*X.metersToTile,ie.projectedAnchorY+_e*ve[1]*X.metersToTile,ie.projectedAnchorZ+_e*ve[2]*X.metersToTile],d?J:M),Se=Da(C.getCameraToCenterDistance(f.getProjection()),Ce.signedDistanceFromCamera);let Je=x.evaluateSizeForFeature(f.textSizeData,z,ie)*Se/p.ONE_EM;d&&(Je*=f.tilePixelRatio/O);const{width:Ee,height:je,anchor:Ge,textOffset:at,textScale:ke}=ge,et=Wd(Ge,Ee,je,at,ke,Je);let He;if(d){const lt=pe.add(et),{x:wt,y:Lt,z:jt}=f.getProjection().projectTilePoint(lt.x,lt.y,D.canonical);He=Ct([wt+_e*ve[0]*X.metersToTile,Lt+_e*ve[1]*X.metersToTile,jt+_e*ve[2]*X.metersToTile],M).point}else{const lt=a?et.rotate(-C.angle):et;He=[Ce.point[0]+lt.x,Ce.point[1]+lt.y,0]}const ht=f.allowVerticalPlacement&&ie.placedOrientation===p.WritingMode.vertical?Math.PI/2:0;for(let lt=0;lt<ie.numGlyphs;lt++)p.addDynamicAttributes(W,He[0],He[1],He[2],ht);F&&ie.associatedIconIndex>=0&&(K[ie.associatedIconIndex]={shiftedAnchor:He,angle:ht})}else ta(ie.numGlyphs,W)}if(F){ne.clear();const re=f.icon.placedSymbolArray;for(let ie=0;ie<re.length;ie++){const xe=re.get(ie);if(xe.hidden)ta(xe.numGlyphs,ne);else{const ge=K[ie];if(ge)for(let pe=0;pe<xe.numGlyphs;pe++)p.addDynamicAttributes(ne,ge.shiftedAnchor[0],ge.shiftedAnchor[1],ge.shiftedAnchor[2],ge.angle);else ta(xe.numGlyphs,ne)}}f.icon.dynamicLayoutVertexBuffer.updateData(ne)}f.text.dynamicLayoutVertexBuffer.updateData(W)}function wo(f,a,d){return d.iconsInText&&a?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function cc(f,a,d,g,x,C,M,D,O,z,F,U){const W=f.context,ne=W.gl,K=f.transform,J="map"===D,te="map"===O,X=J&&"point"!==d.layout.get("symbol-placement"),re=J&&!te&&!X,ie=void 0!==d.layout.get("symbol-sort-key").constantOr(1);let xe=!1;const ge=f.depthModeForSublayer(0,p.DepthMode.ReadOnly),pe=[p.mercatorXfromLng(K.center.lng),p.mercatorYfromLat(K.center.lat)],ve=d.layout.get("text-variable-anchor"),_e="globe"===K.projection.name,Ce=[],Se=[0,-1,0];let Je=Se;!_e&&!K.mercatorFromTransition||J||(Je=function(Ee){const je=Ee._camera.getWorldToCamera(Ee.worldSize,1),Ge=p.multiply([],je,Ee.globeMatrix);p.invert(Ge,Ge);const at=[0,0,0],ke=[0,1,0,0];return p.transformMat4$1(ke,ke,Ge),at[0]=ke[0],at[1]=ke[1],at[2]=ke[2],p.normalize(at,at),at}(K));for(const Ee of g){const je=a.getTile(Ee),Ge=je.getBucket(d);if(!Ge||"mercator"===Ge.projection.name&&_e)continue;const at=x?Ge.text:Ge.icon;if(!at||Ge.fullyClipped||!at.segments.get().length)continue;const ke=at.programConfigurations.get(d.id),et=x||Ge.sdfIcons,He=x?Ge.textSizeData:Ge.iconSizeData,ht=te||0!==K.pitch,lt=p.evaluateSizeForZoom(He,K.zoom);let wt,Lt,jt,un,Et=[0,0],Wt=null;if(x){if(Lt=je.glyphAtlasTexture,jt=ne.LINEAR,wt=je.glyphAtlasTexture.size,Ge.iconsInText){Et=je.imageAtlasTexture.size,Wt=je.imageAtlasTexture;const rr="composite"===He.kind||"camera"===He.kind;un=ht||f.options.rotating||f.options.zooming||rr?ne.LINEAR:ne.NEAREST}}else{const rr=1!==d.layout.get("icon-size").constantOr(0)||Ge.iconsNeedLinear;Lt=je.imageAtlasTexture,jt=et||f.options.rotating||f.options.zooming||rr||ht?ne.LINEAR:ne.NEAREST,wt=je.imageAtlasTexture.size}const pn="globe"===Ge.projection.name,Kn=pn?Je:Se,di=pn?p.globeToMercatorTransition(K.zoom):0,Dn=Lr(Ee,Ge.getProjection(),K),Bi=K.calculatePixelsToTileUnitsMatrix(je),$o=cn(Dn,je.tileID.canonical,te,J,K,Ge.getProjection(),Bi),hs=f.terrain&&te&&X?p.invert(p.create(),$o):Kh,ni=wn(Dn,je.tileID.canonical,te,J,K,Ge.getProjection(),Bi),si=ve&&Ge.hasTextData(),on="none"!==d.layout.get("icon-text-fit")&&si&&Ge.hasIconData();if(X){const rr=K.elevation,Go=rr?rr.getAtTileOffsetFunc(Ee,K.center.lat,K.worldSize,Ge.getProjection()):ps=>[0,0,0],lo=rn(Dn,je.tileID.canonical,te,J,K,Ge.getProjection(),Bi);Ia(Ge,Dn,f,x,lo,ni,te,z,Go,Ee)}const Pi=X||x&&ve||on,fr=f.translatePosMatrix(Dn,je,C,M),Fn=Pi?Kh:$o,Ni=f.translatePosMatrix(ni,je,C,M,!0),$a=Ge.getProjection().createInversionMatrix(K,Ee.canonical),mr=[];f.terrain&&te&&mr.push("PITCH_WITH_MAP_TERRAIN"),pn&&mr.push("PROJECTION_GLOBE_VIEW"),Pi&&mr.push("PROJECTED_POS_ON_VIEWPORT");const da=et&&0!==d.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1);let Ao;Ao=et?Ge.iconsInText?zo(He.kind,lt,re,te,f,fr,Fn,Ni,wt,Et,Ee,di,pe,$a,Kn,Ge.getProjection()):ac(He.kind,lt,re,te,f,fr,Fn,Ni,x,wt,!0,Ee,di,pe,$a,Kn,Ge.getProjection()):la(He.kind,lt,re,te,f,fr,Fn,Ni,x,wt,Ee,di,pe,$a,Kn,Ge.getProjection());const Ga={program:f.useProgram(wo(et,x,Ge),ke,mr),buffers:at,uniformValues:Ao,atlasTexture:Lt,atlasTextureIcon:Wt,atlasInterpolation:jt,atlasInterpolationIcon:un,isSDF:et,hasHalo:da,tile:je,labelPlaneMatrixInv:hs};if(ie&&Ge.canOverlap){xe=!0;const rr=at.segments.get();for(const Go of rr)Ce.push({segments:new p.SegmentVector([Go]),sortKey:Go.sortKey,state:Ga})}else Ce.push({segments:at.segments,sortKey:0,state:Ga})}xe&&Ce.sort((Ee,je)=>Ee.sortKey-je.sortKey);for(const Ee of Ce){const je=Ee.state;if(f.terrain&&f.terrain.setupElevationDraw(je.tile,je.program,{useDepthForOcclusion:!_e,labelPlaneMatrixInv:je.labelPlaneMatrixInv}),W.activeTexture.set(ne.TEXTURE0),je.atlasTexture.bind(je.atlasInterpolation,ne.CLAMP_TO_EDGE),je.atlasTextureIcon&&(W.activeTexture.set(ne.TEXTURE1),je.atlasTextureIcon&&je.atlasTextureIcon.bind(je.atlasInterpolationIcon,ne.CLAMP_TO_EDGE)),je.isSDF){const Ge=je.uniformValues;je.hasHalo&&(Ge.u_is_halo=1,Ml(je.buffers,Ee.segments,d,f,je.program,ge,F,U,Ge)),Ge.u_is_halo=0}Ml(je.buffers,Ee.segments,d,f,je.program,ge,F,U,je.uniformValues)}}function Ml(f,a,d,g,x,C,M,D,O){const z=g.context,F=[f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer,f.globeExtVertexBuffer];x.draw(z,z.gl.TRIANGLES,C,M,D,p.CullFaceMode.disabled,O,d.id,f.layoutVertexBuffer,f.indexBuffer,a,d.paint,g.transform.zoom,f.programConfigurations.get(d.id),F)}function La(f,a,d,g,x,C,M){const D=f.context.gl,O=d.paint.get("fill-pattern"),z=O&&O.constantOr(1),F=d.getCrossfadeParameters();let U,W,ne,K,J;M?(W=z&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",U=D.LINES):(W=z?"fillPattern":"fill",U=D.TRIANGLES);for(const te of g){const X=a.getTile(te);if(z&&!X.patternsLoaded())continue;const re=X.getBucket(d);if(!re)continue;f.prepareDrawTile();const ie=re.programConfigurations.get(d.id),xe=f.useProgram(W,ie);z&&(f.context.activeTexture.set(D.TEXTURE0),X.imageAtlasTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),ie.updatePaintBuffers(F));const ge=O.constantOr(null);if(ge&&X.imageAtlas){const ve=X.imageAtlas,_e=ve.patternPositions[ge.to.toString()],Ce=ve.patternPositions[ge.from.toString()];_e&&Ce&&ie.setConstantPatternPositions(_e,Ce)}const pe=f.translatePosMatrix(te.projMatrix,X,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(M){K=re.indexBuffer2,J=re.segments2;const ve=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[D.drawingBufferWidth,D.drawingBufferHeight];ne="fillOutlinePattern"===W&&z?Os(pe,f,F,X,ve):ro(pe,ve)}else K=re.indexBuffer,J=re.segments,ne=z?sa(pe,f,F,X):Ra(pe);f.prepareDrawProgram(f.context,xe,te.toUnwrapped()),xe.draw(f.context,U,x,f.stencilModeForClipping(te),C,p.CullFaceMode.disabled,ne,d.id,re.layoutVertexBuffer,K,J,d.paint,f.transform.zoom,ie)}}function $i(f,a,d,g,x,C,M){const D=f.context,O=D.gl,z=f.transform,F=d.paint.get("fill-extrusion-pattern"),U=F.constantOr(1),W=d.getCrossfadeParameters(),ne=d.paint.get("fill-extrusion-opacity"),K=[d.paint.get("fill-extrusion-ambient-occlusion-intensity"),d.paint.get("fill-extrusion-ambient-occlusion-radius")],J=d.layout.get("fill-extrusion-edge-radius"),te="globe"===z.projection.name?p.fillExtrusionHeightLift():0,X="globe"===z.projection.name,re=X?p.globeToMercatorTransition(z.zoom):0,ie=[p.mercatorXfromLng(z.center.lng),p.mercatorYfromLat(z.center.lat)],xe=[];X&&(xe.push("PROJECTION_GLOBE_VIEW"),f.style.terrainSetForDrapingOnly()&&xe.push("TERRAIN")),K[0]>0&&xe.push("FAUX_AO");for(const ge of g){const pe=a.getTile(ge),ve=pe.getBucket(d);if(!ve||ve.projection.name!==z.projection.name)continue;const _e=ve.programConfigurations.get(d.id),Ce=f.useProgram(U?"fillExtrusionPattern":"fillExtrusion",_e,xe);if(f.terrain){const ke=f.terrain;if(f.style.terrainSetForDrapingOnly())ke.setupElevationDraw(pe,Ce,{useMeterToDem:!0});else{if(!ve.enableTerrain)continue;if(ke.setupElevationDraw(pe,Ce,{useMeterToDem:!0}),uc(D,a,ge,ve,d,ke),!ve.centroidVertexBuffer){const et=Ce.attributes.a_centroid_pos;void 0!==et&&O.vertexAttrib2f(et,0,0)}}}U&&(f.context.activeTexture.set(O.TEXTURE0),pe.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),_e.updatePaintBuffers(W));const Se=F.constantOr(null);if(Se&&pe.imageAtlas){const ke=pe.imageAtlas,et=ke.patternPositions[Se.to.toString()],He=ke.patternPositions[Se.from.toString()];et&&He&&_e.setConstantPatternPositions(et,He)}const Je=f.translatePosMatrix(ge.projMatrix,pe,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Ee=z.projection.createInversionMatrix(z,ge.canonical),je=d.paint.get("fill-extrusion-vertical-gradient"),Ge=U?oc(Je,f,je,ne,K,J,ge,W,pe,te,re,ie,Ee):nr(Je,f,je,ne,K,J,ge,te,re,ie,Ee);f.prepareDrawProgram(D,Ce,ge.toUnwrapped());const at=[];f.terrain&&at.push(ve.centroidVertexBuffer),X&&at.push(ve.layoutVertexExtBuffer),Ce.draw(D,D.gl.TRIANGLES,x,C,M,p.CullFaceMode.backCCW,Ge,d.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,d.paint,f.transform.zoom,_e,at)}}function uc(f,a,d,g,x,C){const M=[X=>{let re=X.canonical.x-1,ie=X.wrap;return re<0&&(re=(1<<X.canonical.z)-1,ie--),new p.OverscaledTileID(X.overscaledZ,ie,X.canonical.z,re,X.canonical.y)},X=>{let re=X.canonical.x+1,ie=X.wrap;return re===1<<X.canonical.z&&(re=0,ie++),new p.OverscaledTileID(X.overscaledZ,ie,X.canonical.z,re,X.canonical.y)},X=>new p.OverscaledTileID(X.overscaledZ,X.wrap,X.canonical.z,X.canonical.x,(0===X.canonical.y?1<<X.canonical.z:X.canonical.y)-1),X=>new p.OverscaledTileID(X.overscaledZ,X.wrap,X.canonical.z,X.canonical.x,X.canonical.y===(1<<X.canonical.z)-1?0:X.canonical.y+1)],D=X=>{const re=a.getSource().minzoom,ie=ge=>{const pe=a.getTileByID(ge);if(pe&&pe.hasData())return pe.getBucket(x)},xe=[0,-1,1];for(const ge of xe){if(X.overscaledZ+ge<re)continue;const pe=ie(X.calculateScaledKey(X.overscaledZ+ge));if(pe)return pe}},O=[0,0,0],z=(X,re)=>(O[0]=Math.min(X.min.y,re.min.y),O[1]=Math.max(X.max.y,re.max.y),O[2]=p.EXTENT-re.min.x>X.max.x?re.min.x-p.EXTENT:X.max.x,O),F=(X,re)=>(O[0]=Math.min(X.min.x,re.min.x),O[1]=Math.max(X.max.x,re.max.x),O[2]=p.EXTENT-re.min.y>X.max.y?re.min.y-p.EXTENT:X.max.y,O),U=[(X,re)=>z(X,re),(X,re)=>z(re,X),(X,re)=>F(X,re),(X,re)=>F(re,X)],W=new p.pointGeometry(0,0);let ne,K,J;const te=(X,re,ie,xe,ge)=>{const pe=[[xe?ie:X,xe?X:ie,0],[xe?ie:re,xe?re:ie,0]],ve=ge<0?p.EXTENT+ge:ge,_e=[xe?ve:(X+re)/2,xe?(X+re)/2:ve,0];return 0===ie&&ge<0||0!==ie&&ge>0?C.getForTilePoints(J,[_e],!0,K):pe.push(_e),C.getForTilePoints(d,pe,!0,ne),Math.max(pe[0][2],pe[1][2],_e[2])/C.exaggeration()};for(let X=0;X<4;X++){const re=(X<2?1:5)-X,ie=g.borders[X];if(0===ie.length)continue;const xe=J=M[X](d),ge=D(xe);if(!(ge&&ge instanceof p.FillExtrusionBucket&&ge.enableTerrain)||g.borderDoneWithNeighborZ[X]===ge.canonical.z&&ge.borderDoneWithNeighborZ[re]===g.canonical.z||(K=C.findDEMTileFor(xe),!K||!K.dem))continue;if(!ne){const Ce=C.findDEMTileFor(d);if(!Ce||!Ce.dem)return;ne=Ce}const pe=ge.borders[re];let ve=0;const _e=ge.borderDoneWithNeighborZ[re]!==g.canonical.z;if(g.canonical.z===ge.canonical.z){for(let Ce=0;Ce<ie.length;Ce++){const Se=g.featuresOnBorder[ie[Ce]],Je=Se.borders[X];let Ee;for(;ve<pe.length&&(Ee=ge.featuresOnBorder[pe[ve]],!(Ee.borders[re][1]>Je[0]+3));)_e&&ge.encodeCentroid(void 0,Ee,!1),ve++;if(Ee&&ve<pe.length){const je=ve;let Ge=0;for(;!(Ee.borders[re][0]>Je[1]-3)&&(Ge++,++ve!==pe.length);)Ee=ge.featuresOnBorder[pe[ve]];if(Ee=ge.featuresOnBorder[pe[je]],Se.intersectsCount()>1||Ee.intersectsCount()>1||1!==Ge){1!==Ge&&(ve=je),g.encodeCentroid(void 0,Se,!1),_e&&ge.encodeCentroid(void 0,Ee,!1);continue}const at=U[X](Se,Ee),ke=X%2?p.EXTENT-1:0;W.x=te(at[0],Math.min(p.EXTENT-1,at[1]),ke,X<2,at[2]),W.y=0,g.encodeCentroid(W,Se,!1),_e&&ge.encodeCentroid(W,Ee,!1)}else g.encodeCentroid(void 0,Se,!1)}g.borderDoneWithNeighborZ[X]=ge.canonical.z,g.needsCentroidUpdate=!0,_e&&(ge.borderDoneWithNeighborZ[re]=g.canonical.z,ge.needsCentroidUpdate=!0)}else{for(const Ce of ie)g.encodeCentroid(void 0,g.featuresOnBorder[Ce],!1);if(_e){for(const Ce of pe)ge.encodeCentroid(void 0,ge.featuresOnBorder[Ce],!1);ge.borderDoneWithNeighborZ[re]=g.canonical.z,ge.needsCentroidUpdate=!0}g.borderDoneWithNeighborZ[X]=ge.canonical.z,g.needsCentroidUpdate=!0}}(g.needsCentroidUpdate||!g.centroidVertexBuffer&&0!==g.centroidVertexArray.length)&&g.uploadCentroid(f)}const Gf=new p.Color(1,0,0,1),Sl=new p.Color(0,1,0,1),Dl=new p.Color(0,0,1,1),Hf=new p.Color(1,0,1,1),Jh=new p.Color(0,1,1,1);function On(f,a,d){const g=f.context,x=f.transform,C=g.gl,M="globe"===x.projection.name,D=M?["PROJECTION_GLOBE_VIEW"]:null;let O=d.projMatrix;if(M&&p.globeToMercatorTransition(x.zoom)>0){const Se=p.transitionTileAABBinECEF(d.canonical,x),Je=p.globeDenormalizeECEF(Se);O=p.multiply(new Float32Array(16),x.globeMatrix,Je),p.multiply(O,x.projMatrix,O)}const z=f.useProgram("debug",null,D),F=a.getTileByID(d.key);f.terrain&&f.terrain.setupElevationDraw(F,z);const U=p.DepthMode.disabled,W=p.StencilMode.disabled,ne=f.colorModeForRenderPass(),K="$debug";g.activeTexture.set(C.TEXTURE0),f.emptyTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),M?F._makeGlobeTileDebugBuffers(f.context,x):F._makeDebugTileBoundsBuffers(f.context,x.projection);const J=F._tileDebugBuffer||f.debugBuffer,te=F._tileDebugIndexBuffer||f.debugIndexBuffer,X=F._tileDebugSegments||f.debugSegments;z.draw(g,C.LINE_STRIP,U,W,ne,p.CullFaceMode.disabled,yn(O,p.Color.red),K,J,te,X,null,null,null,[F._globeTileDebugBorderBuffer]);const re=F.latestRawTileData,ie=Math.floor((re&&re.byteLength||0)/1024),xe=a.getTile(d).tileSize,ge=512/Math.min(xe,512)*(d.overscaledZ/x.zoom)*.5;let pe=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(pe+=` => ${d.overscaledZ}`),pe+=` ${ie}kb`,function(Se,Je){Se.initDebugOverlayCanvas();const Ee=Se.debugOverlayCanvas,je=Se.context.gl,Ge=Se.debugOverlayCanvas.getContext("2d");Ge.clearRect(0,0,Ee.width,Ee.height),Ge.shadowColor="white",Ge.shadowBlur=2,Ge.lineWidth=1.5,Ge.strokeStyle="white",Ge.textBaseline="top",Ge.font="bold 36px Open Sans, sans-serif",Ge.fillText(Je,5,5),Ge.strokeText(Je,5,5),Se.debugOverlayTexture.update(Ee),Se.debugOverlayTexture.bind(je.LINEAR,je.CLAMP_TO_EDGE)}(f,pe);const ve=F._tileDebugTextBuffer||f.debugBuffer,_e=F._tileDebugTextIndexBuffer||f.quadTriangleIndexBuffer,Ce=F._tileDebugTextSegments||f.debugSegments;z.draw(g,C.TRIANGLES,U,W,p.ColorMode.alphaBlended,p.CullFaceMode.disabled,yn(O,p.Color.transparent,ge),K,ve,_e,Ce,null,null,null,[F._globeTileDebugTextBuffer])}function Ru(f,a,d,g){Lu(f,0,a+d/2,f.transform.width,d,g)}function qf(f,a,d,g){Lu(f,a-d/2,0,d,f.transform.height,g)}function Lu(f,a,d,g,x,C){const M=f.context,D=M.gl;D.enable(D.SCISSOR_TEST),D.scissor(a*p.exported.devicePixelRatio,d*p.exported.devicePixelRatio,g*p.exported.devicePixelRatio,x*p.exported.devicePixelRatio),M.clear({color:C}),D.disable(D.SCISSOR_TEST)}const zu=p.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Xg}=zu;function za(f,a,d,g){f.emplaceBack(a,d,g)}class ep{constructor(a){this.vertexArray=new p.StructArrayLayout3f12,this.indices=new p.StructArrayLayout3ui6,za(this.vertexArray,-1,-1,1),za(this.vertexArray,1,-1,1),za(this.vertexArray,-1,1,1),za(this.vertexArray,1,1,1),za(this.vertexArray,-1,-1,-1),za(this.vertexArray,1,-1,-1),za(this.vertexArray,-1,1,-1),za(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=a.createVertexBuffer(this.vertexArray,Xg),this.indexBuffer=a.createIndexBuffer(this.indices),this.segment=p.SegmentVector.simpleSegment(0,0,36,12)}}function dc(f,a,d,g,x,C){const M=f.gl,D=a.paint.get("sky-atmosphere-color"),O=a.paint.get("sky-atmosphere-halo-color"),z=a.paint.get("sky-atmosphere-sun-intensity"),F={u_matrix_3f:p.fromMat4(p.create$1(),g),u_sun_direction:x,u_sun_intensity:z,u_color_tint_r:[(K=D).r,K.g,K.b,K.a],u_color_tint_m:[(J=O).r,J.g,J.b,J.a],u_luminance:5e-5};var K,J;M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_CUBE_MAP_POSITIVE_X+C,a.skyboxTexture,0),d.draw(f,M.TRIANGLES,p.DepthMode.disabled,p.StencilMode.disabled,p.ColorMode.unblended,p.CullFaceMode.frontCW,F,"skyboxCapture",a.skyboxGeometry.vertexBuffer,a.skyboxGeometry.indexBuffer,a.skyboxGeometry.segment)}const tp=p.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Yd{constructor(a){const d=new p.StructArrayLayout5f20;d.emplaceBack(-1,1,1,0,0),d.emplaceBack(1,1,1,1,0),d.emplaceBack(1,-1,1,1,1),d.emplaceBack(-1,-1,1,0,1);const g=new p.StructArrayLayout3ui6;g.emplaceBack(0,1,2),g.emplaceBack(2,3,0),this.vertexBuffer=a.createVertexBuffer(d,tp.members),this.indexBuffer=a.createIndexBuffer(g),this.segments=p.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const hc={symbol:function(f,a,d,g,x){if("translucent"!==f.renderPass)return;const C=p.StencilMode.disabled,M=f.colorModeForRenderPass();d.layout.get("text-variable-anchor")&&function(D,O,z,F,U,W,ne){const K=O.transform,J="map"===U,te="map"===W;for(const X of D){const re=F.getTile(X),ie=re.getBucket(z);if(!ie||!ie.text||!ie.text.segments.get().length)continue;const xe=p.evaluateSizeForZoom(ie.textSizeData,K.zoom),ge=Lr(X,ie.getProjection(),K),pe=K.calculatePixelsToTileUnitsMatrix(re),ve=cn(ge,re.tileID.canonical,te,J,K,ie.getProjection(),pe),_e="none"!==z.layout.get("icon-text-fit")&&ie.hasIconData();if(xe){const Ce=Math.pow(2,K.zoom-re.tileID.overscaledZ);bo(ie,J,te,ne,p.symbolSize,K,ve,X,Ce,xe,_e)}}}(g,f,d,a,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),x),0!==d.paint.get("icon-opacity").constantOr(1)&&cc(f,a,d,g,!1,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),d.layout.get("icon-rotation-alignment"),d.layout.get("icon-pitch-alignment"),d.layout.get("icon-keep-upright"),C,M),0!==d.paint.get("text-opacity").constantOr(1)&&cc(f,a,d,g,!0,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),d.layout.get("text-keep-upright"),C,M),a.map.showCollisionBoxes&&(ri(f,a,d,g,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),ri(f,a,d,g,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))},circle:function(f,a,d,g){if("translucent"!==f.renderPass)return;const x=d.paint.get("circle-opacity"),C=d.paint.get("circle-stroke-width"),M=d.paint.get("circle-stroke-opacity"),D=void 0!==d.layout.get("circle-sort-key").constantOr(1);if(0===x.constantOr(1)&&(0===C.constantOr(1)||0===M.constantOr(1)))return;const O=f.context,z=O.gl,F=f.transform,U=f.depthModeForSublayer(0,p.DepthMode.ReadOnly),W=p.StencilMode.disabled,ne=f.colorModeForRenderPass(),K="globe"===F.projection.name,J=[p.mercatorXfromLng(F.center.lng),p.mercatorYfromLat(F.center.lat)],te=[];for(let re=0;re<g.length;re++){const ie=g[re],xe=a.getTile(ie),ge=xe.getBucket(d);if(!ge||ge.projection.name!==F.projection.name)continue;const pe=ge.programConfigurations.get(d.id),ve=oo(d);K&&ve.push("PROJECTION_GLOBE_VIEW");const _e=f.useProgram("circle",pe,ve),Ce=ge.layoutVertexBuffer,Se=ge.globeExtVertexBuffer,Je=ge.indexBuffer,Ee=F.projection.createInversionMatrix(F,ie.canonical),je={programConfiguration:pe,program:_e,layoutVertexBuffer:Ce,globeExtVertexBuffer:Se,indexBuffer:Je,uniformValues:Zd(f,ie,xe,Ee,J,d),tile:xe};if(D){const Ge=ge.segments.get();for(const at of Ge)te.push({segments:new p.SegmentVector([at]),sortKey:at.sortKey,state:je})}else te.push({segments:ge.segments,sortKey:0,state:je})}D&&te.sort((re,ie)=>re.sortKey-ie.sortKey);const X={useDepthForOcclusion:!K};for(const re of te){const{programConfiguration:ie,program:xe,layoutVertexBuffer:ge,globeExtVertexBuffer:pe,indexBuffer:ve,uniformValues:_e,tile:Ce}=re.state,Se=re.segments;f.terrain&&f.terrain.setupElevationDraw(Ce,xe,X),f.prepareDrawProgram(O,xe,Ce.tileID.toUnwrapped()),xe.draw(O,z.TRIANGLES,U,W,ne,p.CullFaceMode.disabled,_e,d.id,ge,ve,Se,d.paint,F.zoom,ie,[pe])}},heatmap:function(f,a,d,g){if(0!==d.paint.get("heatmap-opacity"))if("offscreen"===f.renderPass){const x=f.context,C=x.gl,M=p.StencilMode.disabled,D=new p.ColorMode([C.ONE,C.ONE],p.Color.transparent,[!0,!0,!0,!0]);(function(ne,K,J,te){const X=ne.gl,re=K.width*te,ie=K.height*te;ne.activeTexture.set(X.TEXTURE1),ne.viewport.set([0,0,re,ie]);let xe=J.heatmapFbo;if(!xe||xe&&(xe.width!==re||xe.height!==ie)){xe&&xe.destroy();const ge=X.createTexture();X.bindTexture(X.TEXTURE_2D,ge),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MAG_FILTER,X.LINEAR),xe=J.heatmapFbo=ne.createFramebuffer(re,ie,!1),function(pe,ve,_e,Ce,Se,Je){const Ee=pe.gl;Ee.texImage2D(Ee.TEXTURE_2D,0,Ee.RGBA,Se,Je,0,Ee.RGBA,pe.extRenderToTextureHalfFloat?pe.extTextureHalfFloat.HALF_FLOAT_OES:Ee.UNSIGNED_BYTE,null),Ce.colorAttachment.set(_e)}(ne,0,ge,xe,re,ie)}else X.bindTexture(X.TEXTURE_2D,xe.colorAttachment.get()),ne.bindFramebuffer.set(xe.framebuffer)})(x,f,d,"globe"===f.transform.projection.name?.5:.25),x.clear({color:p.Color.transparent});const O=f.transform,z="globe"===O.projection.name,F=z?["PROJECTION_GLOBE_VIEW"]:null,U=z?p.CullFaceMode.frontCCW:p.CullFaceMode.disabled,W=[p.mercatorXfromLng(O.center.lng),p.mercatorYfromLat(O.center.lat)];for(let ne=0;ne<g.length;ne++){const K=g[ne];if(a.hasRenderableParent(K))continue;const J=a.getTile(K),te=J.getBucket(d);if(!te||te.projection.name!==O.projection.name)continue;const X=te.programConfigurations.get(d.id),re=f.useProgram("heatmap",X,F),{zoom:ie}=f.transform;f.terrain&&f.terrain.setupElevationDraw(J,re),f.prepareDrawProgram(x,re,K.toUnwrapped());const xe=O.projection.createInversionMatrix(O,K.canonical);re.draw(x,C.TRIANGLES,p.DepthMode.disabled,M,D,U,so(f,K,J,xe,W,ie,d.paint.get("heatmap-intensity")),d.id,te.layoutVertexBuffer,te.indexBuffer,te.segments,d.paint,f.transform.zoom,X,z?[te.globeExtVertexBuffer]:null)}x.viewport.set([0,0,f.width,f.height])}else"translucent"===f.renderPass&&(f.context.setColorMode(f.colorModeForRenderPass()),function(x,C){const M=x.context,D=M.gl,O=C.heatmapFbo;if(!O)return;M.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,O.colorAttachment.get()),M.activeTexture.set(D.TEXTURE1);let z=C.colorRampTexture;z||(z=C.colorRampTexture=new p.Texture(M,C.colorRamp,D.RGBA)),z.bind(D.LINEAR,D.CLAMP_TO_EDGE),x.useProgram("heatmapTexture").draw(M,D.TRIANGLES,p.DepthMode.disabled,p.StencilMode.disabled,x.colorModeForRenderPass(),p.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:C.paint.get("heatmap-opacity")},C.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,C.paint,x.transform.zoom)}(f,d))},line:function(f,a,d,g){if("translucent"!==f.renderPass)return;const x=d.paint.get("line-opacity"),C=d.paint.get("line-width");if(0===x.constantOr(1)||0===C.constantOr(1))return;const M=f.depthModeForSublayer(0,p.DepthMode.ReadOnly),D=f.colorModeForRenderPass(),O=f.terrain&&f.terrain.renderingToTexture?1:p.exported.devicePixelRatio,z=d.paint.get("line-dasharray"),F=z.constantOr(1),U=d.layout.get("line-cap"),W=d.paint.get("line-pattern"),ne=W.constantOr(1),K=d.paint.get("line-gradient"),J=d.getCrossfadeParameters(),te=ne?"linePattern":"line",X=f.context,re=X.gl,ie=(ge=>{const pe=[];aa(ge)&&pe.push("RENDER_LINE_DASH"),ge.paint.get("line-gradient")&&pe.push("RENDER_LINE_GRADIENT");const ve=ge.paint.get("line-trim-offset");0===ve[0]&&0===ve[1]||pe.push("RENDER_LINE_TRIM_OFFSET");const _e=ge.paint.get("line-pattern").constantOr(1),Ce=1!==ge.paint.get("line-opacity").constantOr(1);return!_e&&Ce&&pe.push("RENDER_LINE_ALPHA_DISCARD"),pe})(d);let xe=ie.includes("RENDER_LINE_ALPHA_DISCARD");f.terrain&&f.terrain.clipOrMaskOverlapStencilType()&&(xe=!1);for(const ge of g){const pe=a.getTile(ge);if(ne&&!pe.patternsLoaded())continue;const ve=pe.getBucket(d);if(!ve)continue;f.prepareDrawTile();const _e=ve.programConfigurations.get(d.id),Ce=f.useProgram(te,_e,ie),Se=W.constantOr(null);if(Se&&pe.imageAtlas){const He=pe.imageAtlas,ht=He.patternPositions[Se.to.toString()],lt=He.patternPositions[Se.from.toString()];ht&&lt&&_e.setConstantPatternPositions(ht,lt)}const Je=z.constantOr(null),Ee=U.constantOr(null);if(!ne&&Je&&Ee&&pe.lineAtlas){const He=pe.lineAtlas,ht=He.getDash(Je.to,Ee),lt=He.getDash(Je.from,Ee);ht&&lt&&_e.setConstantPatternPositions(ht,lt)}let[je,Ge]=d.paint.get("line-trim-offset");("round"===Ee||"square"===Ee)&&je!==Ge&&(0===je&&(je-=1),1===Ge&&(Ge+=1));const at=f.terrain?ge.projMatrix:null,ke=ne?Yi(f,pe,d,J,at,O):cs(f,pe,d,J,at,ve.lineClipsArray.length,O,[je,Ge]);if(K){const He=ve.gradients[d.id];let ht=He.texture;if(d.gradientVersion!==He.version){let lt=256;if(d.stepInterpolant){const wt=a.getSource().maxzoom,Lt=ge.canonical.z===wt?Math.ceil(1<<f.transform.maxZoom-ge.canonical.z):1;lt=p.clamp(p.nextPowerOfTwo(ve.maxLineLength/p.EXTENT*1024*Lt),256,X.maxTextureSize)}He.gradient=p.renderColorRamp({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:lt,image:He.gradient||void 0,clips:ve.lineClipsArray}),He.texture?He.texture.update(He.gradient):He.texture=new p.Texture(X,He.gradient,re.RGBA),He.version=d.gradientVersion,ht=He.texture}X.activeTexture.set(re.TEXTURE1),ht.bind(d.stepInterpolant?re.NEAREST:re.LINEAR,re.CLAMP_TO_EDGE)}F&&(X.activeTexture.set(re.TEXTURE0),pe.lineAtlasTexture.bind(re.LINEAR,re.REPEAT),_e.updatePaintBuffers(J)),ne&&(X.activeTexture.set(re.TEXTURE0),pe.imageAtlasTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),_e.updatePaintBuffers(J)),f.prepareDrawProgram(X,Ce,ge.toUnwrapped());const et=He=>{Ce.draw(X,re.TRIANGLES,M,He,D,p.CullFaceMode.disabled,ke,d.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,d.paint,f.transform.zoom,_e,[ve.layoutVertexBuffer2])};if(xe){const He=f.stencilModeForClipping(ge).ref;0===He&&f.terrain&&X.clear({stencil:0});const ht={func:re.EQUAL,mask:255};ke.u_alpha_discard_threshold=.8,et(new p.StencilMode(ht,He,255,re.KEEP,re.KEEP,re.INVERT)),ke.u_alpha_discard_threshold=0,et(new p.StencilMode(ht,He,255,re.KEEP,re.KEEP,re.KEEP))}else et(f.stencilModeForClipping(ge))}xe&&(f.resetStencilClippingMasks(),f.terrain&&X.clear({stencil:0}))},fill:function(f,a,d,g){const x=d.paint.get("fill-color"),C=d.paint.get("fill-opacity");if(0===C.constantOr(1))return;const M=f.colorModeForRenderPass(),D=d.paint.get("fill-pattern"),O=f.opaquePassEnabledForLayer()&&!D.constantOr(1)&&1===x.constantOr(p.Color.transparent).a&&1===C.constantOr(0)?"opaque":"translucent";if(f.renderPass===O){const z=f.depthModeForSublayer(1,"opaque"===f.renderPass?p.DepthMode.ReadWrite:p.DepthMode.ReadOnly);La(f,a,d,g,z,M,!1)}if("translucent"===f.renderPass&&d.paint.get("fill-antialias")){const z=f.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,p.DepthMode.ReadOnly);La(f,a,d,g,z,M,!0)}},"fill-extrusion":function(f,a,d,g){const x=d.paint.get("fill-extrusion-opacity");if(0!==x&&"translucent"===f.renderPass){const C=new p.DepthMode(f.context.gl.LEQUAL,p.DepthMode.ReadWrite,f.depthRangeFor3D);if(1!==x||d.paint.get("fill-extrusion-pattern").constantOr(1))$i(f,a,d,g,C,p.StencilMode.disabled,p.ColorMode.disabled),$i(f,a,d,g,C,f.stencilModeFor3D(),f.colorModeForRenderPass()),f.resetStencilClippingMasks();else{const M=f.colorModeForRenderPass();$i(f,a,d,g,C,p.StencilMode.disabled,M)}}},hillshade:function(f,a,d,g){if("offscreen"!==f.renderPass&&"translucent"!==f.renderPass)return;const x=f.context,C=f.depthModeForSublayer(0,p.DepthMode.ReadOnly),M=f.colorModeForRenderPass(),D=f.terrain&&f.terrain.renderingToTexture,[O,z]="translucent"!==f.renderPass||D?[{},g]:f.stencilConfigForOverlap(g);for(const F of z){const U=a.getTile(F);if(U.needsHillshadePrepare&&"offscreen"===f.renderPass)Oa(f,U,d,C,p.StencilMode.disabled,M);else if("translucent"===f.renderPass){const W=D&&f.terrain?f.terrain.stencilModeForRTTOverlap(F):O[F.overscaledZ];rc(f,F,U,d,C,W,M)}}x.viewport.set([0,0,f.width,f.height]),f.resetStencilClippingMasks()},raster:function(f,a,d,g,x,C){if("translucent"!==f.renderPass||0===d.paint.get("raster-opacity")||!g.length)return;const M=f.context,D=M.gl,O=a.getSource(),z=f.useProgram("raster"),F=f.colorModeForRenderPass(),U=f.terrain&&f.terrain.renderingToTexture,[W,ne]=O instanceof Ae||U?[{},g]:f.stencilConfigForOverlap(g),K=ne[ne.length-1].overscaledZ,J=!f.options.moving;for(const te of ne){const X=U?p.DepthMode.disabled:f.depthModeForSublayer(te.overscaledZ-K,1===d.paint.get("raster-opacity")?p.DepthMode.ReadWrite:p.DepthMode.ReadOnly,D.LESS),re=te.toUnwrapped(),ie=a.getTile(te);if(U&&(!ie||!ie.hasData()))continue;const xe=U?te.projMatrix:f.transform.calculateProjMatrix(re,J),ge=f.terrain&&U?f.terrain.stencilModeForRTTOverlap(te):W[te.overscaledZ],pe=C?0:d.paint.get("raster-fade-duration");ie.registerFadeDuration(pe);const ve=a.findLoadedParent(te,0),_e=hr(ie,ve,a,f.transform,pe);let Ce,Se;f.terrain&&f.terrain.prepareDrawTile();const Je="nearest"===d.paint.get("raster-resampling")?D.NEAREST:D.LINEAR;M.activeTexture.set(D.TEXTURE0),ie.texture.bind(Je,D.CLAMP_TO_EDGE),M.activeTexture.set(D.TEXTURE1),ve?(ve.texture.bind(Je,D.CLAMP_TO_EDGE),Ce=Math.pow(2,ve.tileID.overscaledZ-ie.tileID.overscaledZ),Se=[ie.tileID.canonical.x*Ce%1,ie.tileID.canonical.y*Ce%1]):ie.texture.bind(Je,D.CLAMP_TO_EDGE);const Ee=El(xe,Se||[0,0],Ce||1,_e,d,O instanceof Ae?O.perspectiveTransform:[0,0]);if(f.prepareDrawProgram(M,z,re),O instanceof Ae)O.boundsBuffer&&O.boundsSegments&&z.draw(M,D.TRIANGLES,X,p.StencilMode.disabled,F,p.CullFaceMode.disabled,Ee,d.id,O.boundsBuffer,f.quadTriangleIndexBuffer,O.boundsSegments);else{const{tileBoundsBuffer:je,tileBoundsIndexBuffer:Ge,tileBoundsSegments:at}=f.getTileBoundsBuffers(ie);z.draw(M,D.TRIANGLES,X,ge,F,p.CullFaceMode.disabled,Ee,d.id,je,Ge,at)}}f.resetStencilClippingMasks()},background:function(f,a,d,g){const x=d.paint.get("background-color"),C=d.paint.get("background-opacity");if(0===C)return;const M=f.context,D=M.gl,O=f.transform,z=O.tileSize,F=d.paint.get("background-pattern");if(f.isPatternMissing(F))return;const U=!F&&1===x.a&&1===C&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==U)return;const W=p.StencilMode.disabled,ne=f.depthModeForSublayer(0,"opaque"===U?p.DepthMode.ReadWrite:p.DepthMode.ReadOnly),K=f.colorModeForRenderPass(),J=f.useProgram(F?"backgroundPattern":"background");let te,X=g;X||(te=f.getBackgroundTiles(),X=Object.values(te).map(ie=>ie.tileID)),F&&(M.activeTexture.set(D.TEXTURE0),f.imageManager.bind(f.context));const re=d.getCrossfadeParameters();for(const ie of X){const xe=ie.toUnwrapped(),ge=g?ie.projMatrix:f.transform.calculateProjMatrix(xe);f.prepareDrawTile();const pe=a?a.getTile(ie):te?te[ie.key]:new p.Tile(ie,z,O.zoom,f),ve=F?lc(ge,C,f,F,{tileID:ie,tileSize:z},re):zr(ge,C,x);f.prepareDrawProgram(M,J,xe);const{tileBoundsBuffer:_e,tileBoundsIndexBuffer:Ce,tileBoundsSegments:Se}=f.getTileBoundsBuffers(pe);J.draw(M,D.TRIANGLES,ne,W,K,p.CullFaceMode.disabled,ve,d.id,_e,Ce,Se)}},sky:function(f,a,d){const g=f.transform,x="mercator"===g.projection.name||"globe"===g.projection.name?1:p.smoothstep(7,8,g.zoom),C=d.paint.get("sky-opacity")*x;if(0===C)return;const M=f.context,D=d.paint.get("sky-type"),O=new p.DepthMode(M.gl.LEQUAL,p.DepthMode.ReadOnly,[0,1]),z=f.frameCounter/1e3%1;"atmosphere"===D?"offscreen"===f.renderPass?d.needsSkyboxCapture(f)&&(function(F,U,W,ne){const K=F.context,J=K.gl;let te=U.skyboxFbo;if(!te){te=U.skyboxFbo=K.createFramebuffer(32,32,!1),U.skyboxGeometry=new ep(K),U.skyboxTexture=K.gl.createTexture(),J.bindTexture(J.TEXTURE_CUBE_MAP,U.skyboxTexture),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_WRAP_S,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_WRAP_T,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_MIN_FILTER,J.LINEAR),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_MAG_FILTER,J.LINEAR);for(let xe=0;xe<6;++xe)J.texImage2D(J.TEXTURE_CUBE_MAP_POSITIVE_X+xe,0,J.RGBA,32,32,0,J.RGBA,J.UNSIGNED_BYTE,null)}K.bindFramebuffer.set(te.framebuffer),K.viewport.set([0,0,32,32]);const X=U.getCenter(F,!0),re=F.useProgram("skyboxCapture"),ie=new Float64Array(16);p.identity(ie),p.rotateY(ie,ie,.5*-Math.PI),dc(K,U,re,ie,X,0),p.identity(ie),p.rotateY(ie,ie,.5*Math.PI),dc(K,U,re,ie,X,1),p.identity(ie),p.rotateX(ie,ie,.5*-Math.PI),dc(K,U,re,ie,X,2),p.identity(ie),p.rotateX(ie,ie,.5*Math.PI),dc(K,U,re,ie,X,3),p.identity(ie),dc(K,U,re,ie,X,4),p.identity(ie),p.rotateY(ie,ie,Math.PI),dc(K,U,re,ie,X,5),K.viewport.set([0,0,F.width,F.height])}(f,d),d.markSkyboxValid(f)):"sky"===f.renderPass&&function(F,U,W,ne,K){const J=F.context,te=J.gl,X=F.transform,re=F.useProgram("skybox");J.activeTexture.set(te.TEXTURE0),te.bindTexture(te.TEXTURE_CUBE_MAP,U.skyboxTexture);const ie={u_matrix:X.skyboxMatrix,u_sun_direction:U.getCenter(F,!1),u_cubemap:0,u_opacity:ne,u_temporal_offset:K};F.prepareDrawProgram(J,re),re.draw(J,te.TRIANGLES,W,p.StencilMode.disabled,F.colorModeForRenderPass(),p.CullFaceMode.backCW,ie,"skybox",U.skyboxGeometry.vertexBuffer,U.skyboxGeometry.indexBuffer,U.skyboxGeometry.segment)}(f,d,O,C,z):"gradient"===D&&"sky"===f.renderPass&&function(F,U,W,ne,K){const J=F.context,te=J.gl,X=F.transform,re=F.useProgram("skyboxGradient");U.skyboxGeometry||(U.skyboxGeometry=new ep(J)),J.activeTexture.set(te.TEXTURE0);let ie=U.colorRampTexture;ie||(ie=U.colorRampTexture=new p.Texture(J,U.colorRamp,te.RGBA)),ie.bind(te.LINEAR,te.CLAMP_TO_EDGE);const xe=(ge=X.skyboxMatrix,pe=U.getCenter(F,!1),ve=U.paint.get("sky-gradient-radius"),_e=ne,Ce=K,{u_matrix:ge,u_color_ramp:0,u_center_direction:pe,u_radius:p.degToRad(ve),u_opacity:_e,u_temporal_offset:Ce});var ge,pe,ve,_e,Ce;F.prepareDrawProgram(J,re),re.draw(J,te.TRIANGLES,W,p.StencilMode.disabled,F.colorModeForRenderPass(),p.CullFaceMode.backCW,xe,"skyboxGradient",U.skyboxGeometry.vertexBuffer,U.skyboxGeometry.indexBuffer,U.skyboxGeometry.segment)}(f,d,O,C,z)},debug:function(f,a,d){for(let g=0;g<d.length;g++)On(f,a,d[g])},custom:function(f,a,d){const g=f.context,x=d.implementation;if(f.transform.projection.unsupportedLayers&&f.transform.projection.unsupportedLayers.includes("custom"))p.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if("offscreen"===f.renderPass){const C=x.prerender;C&&(f.setCustomLayerDefaults(),g.setColorMode(f.colorModeForRenderPass()),C.call(x,g.gl,f.transform.customLayerMatrix()),g.setDirty(),f.setBaseState())}else if("translucent"===f.renderPass){f.setCustomLayerDefaults(),g.setColorMode(f.colorModeForRenderPass()),g.setStencilMode(p.StencilMode.disabled);const C="3d"===x.renderingMode?new p.DepthMode(f.context.gl.LEQUAL,p.DepthMode.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,p.DepthMode.ReadOnly);g.setDepthMode(C),x.render(g.gl,f.transform.customLayerMatrix()),g.setDirty(),f.setBaseState(),g.bindFramebuffer.set(null)}}};class Fu{constructor(a,d){this.context=new oe(a),this.transform=d,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=p.SourceCache.maxUnderzooming+p.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new tc,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(a,d){const g=!!a&&!!a.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Er(this,a));const x=this._terrain;this.transform.elevation=g?x:null,x.update(a,this.transform,d)}_updateFog(a){const d=a.fog;if(!d||"globe"===this.transform.projection.name||d.getOpacity(this.transform.pitch)<1||d.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[g,x]=d.getFovAdjustedRange(this.transform._fov);if(g>x)return void(this.transform.fogCullDistSq=null);const C=g+.78*(x-g);this.transform.fogCullDistSq=C*C}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(a,d){if(this.width=a*p.exported.devicePixelRatio,this.height=d*p.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style.order)this.style._layers[g].resize()}setup(){const a=this.context,d=new p.StructArrayLayout2i4;d.emplaceBack(0,0),d.emplaceBack(p.EXTENT,0),d.emplaceBack(0,p.EXTENT),d.emplaceBack(p.EXTENT,p.EXTENT),this.tileExtentBuffer=a.createVertexBuffer(d,p.posAttributes.members),this.tileExtentSegments=p.SegmentVector.simpleSegment(0,0,4,2);const g=new p.StructArrayLayout2i4;g.emplaceBack(0,0),g.emplaceBack(p.EXTENT,0),g.emplaceBack(0,p.EXTENT),g.emplaceBack(p.EXTENT,p.EXTENT),this.debugBuffer=a.createVertexBuffer(g,p.posAttributes.members),this.debugSegments=p.SegmentVector.simpleSegment(0,0,4,5);const x=new p.StructArrayLayout2i4;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=a.createVertexBuffer(x,p.posAttributes.members),this.viewportSegments=p.SegmentVector.simpleSegment(0,0,4,2);const C=new p.StructArrayLayout4i8;C.emplaceBack(0,0,0,0),C.emplaceBack(p.EXTENT,0,p.EXTENT,0),C.emplaceBack(0,p.EXTENT,0,p.EXTENT),C.emplaceBack(p.EXTENT,p.EXTENT,p.EXTENT,p.EXTENT),this.mercatorBoundsBuffer=a.createVertexBuffer(C,p.boundsAttributes.members),this.mercatorBoundsSegments=p.SegmentVector.simpleSegment(0,0,4,2);const M=new p.StructArrayLayout3ui6;M.emplaceBack(0,1,2),M.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=a.createIndexBuffer(M);const D=new p.StructArrayLayout1ui2;for(const z of[0,1,3,2,0])D.emplaceBack(z);this.debugIndexBuffer=a.createIndexBuffer(D),this.emptyTexture=new p.Texture(a,new p.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),a.gl.RGBA),this.identityMat=p.create();const O=this.context.gl;this.stencilClearMode=new p.StencilMode({func:O.ALWAYS,mask:0},0,255,O.ZERO,O.ZERO,O.ZERO),this.loadTimeStamps.push(p.window.performance.now()),this.atmosphereBuffer=new Yd(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(a){return a._makeTileBoundsBuffers(this.context,this.transform.projection),a._tileBoundsBuffer?{tileBoundsBuffer:a._tileBoundsBuffer,tileBoundsIndexBuffer:a._tileBoundsIndexBuffer,tileBoundsSegments:a._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const a=this.context,d=a.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(a,d.TRIANGLES,p.DepthMode.disabled,this.stencilClearMode,p.ColorMode.disabled,p.CullFaceMode.disabled,Ou(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(a,d,g){if(!d||this.currentStencilSource===d.id||!a.isTileClipped()||!g||0===g.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let D=!1;for(const O of g)if(void 0===this._tileClippingMaskIDs[O.key]){D=!0;break}if(!D)return}this.currentStencilSource=d.id;const x=this.context,C=x.gl;this.nextStencilID+g.length>256&&this.clearStencil(),x.setColorMode(p.ColorMode.disabled),x.setDepthMode(p.DepthMode.disabled);const M=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const D of g){const O=d.getTile(D),z=this._tileClippingMaskIDs[D.key]=this.nextStencilID++,{tileBoundsBuffer:F,tileBoundsIndexBuffer:U,tileBoundsSegments:W}=this.getTileBoundsBuffers(O);M.draw(x,C.TRIANGLES,p.DepthMode.disabled,new p.StencilMode({func:C.ALWAYS,mask:0},z,255,C.KEEP,C.KEEP,C.REPLACE),p.ColorMode.disabled,p.CullFaceMode.disabled,Ou(D.projMatrix),"$clipping",F,U,W)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const a=this.nextStencilID++,d=this.context.gl;return new p.StencilMode({func:d.NOTEQUAL,mask:255},a,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(a){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(a);const d=this.context.gl;return new p.StencilMode({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(a){const d=this.context.gl,g=a.sort((M,D)=>D.overscaledZ-M.overscaledZ),x=g[g.length-1].overscaledZ,C=g[0].overscaledZ-x+1;if(C>1){this.currentStencilSource=void 0,this.nextStencilID+C>256&&this.clearStencil();const M={};for(let D=0;D<C;D++)M[D+x]=new p.StencilMode({func:d.GEQUAL,mask:255},D+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=C,[M,g]}return[{[x]:p.StencilMode.disabled},g]}colorModeForRenderPass(){const a=this.context.gl;return this._showOverdrawInspector?new p.ColorMode([a.CONSTANT_COLOR,a.ONE],new p.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?p.ColorMode.unblended:p.ColorMode.alphaBlended}depthModeForSublayer(a,d,g){if(!this.opaquePassEnabledForLayer())return p.DepthMode.disabled;const x=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new p.DepthMode(g||this.context.gl.LEQUAL,d,[x,x])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(a,d){this.style=a,this.options=d,this.lineAtlas=a.lineAtlas,this.imageManager=a.imageManager,this.glyphManager=a.glyphManager,this.symbolFadeChange=a.placement.symbolFadeChange(p.exported.now()),this.imageManager.beginFrame();const g=this.style.order,x=this.style._sourceCaches;for(const O in x){const z=x[O];z.used&&z.prepare(this.context)}const C={},M={},D={};for(const O in x){const z=x[O];C[O]=z.getVisibleCoordinates(),M[O]=C[O].slice().reverse(),D[O]=z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let O=0;O<g.length;O++)if(this.style._layers[g[O]].is3D()){this.opaquePassCutoff=O;break}if(this.terrain&&(this.terrain.updateTileBinding(D),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new p.GlobeSharedBuffers(this.context)),p.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const O of g){const z=this.style._layers[O],F=a._getLayerSourceCache(z);if(!z.hasOffscreenPass()||z.isHidden(this.transform.zoom))continue;const U=F?M[F.id]:void 0;("custom"===z.type||z.isSky()||U&&U.length)&&this.renderLayer(this,F,z,U)}if(this.depthRangeFor3D=[0,1-(a.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:d.showOverdrawInspector?p.Color.black:p.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){const O=this.style._layers[g[this.currentLayer]],z=a._getLayerSourceCache(O);if(O.isSky())continue;const F=z?M[z.id]:void 0;this._renderTileClippingMasks(O,z,F),this.renderLayer(this,z,O,F)}if(this.style.fog&&this.transform.projection.supportsFog&&function(O,z){const F=O.context,U=F.gl,W=O.transform,ne=new p.DepthMode(U.LEQUAL,p.DepthMode.ReadOnly,[0,1]),K=O.useProgram("globeAtmosphere",null,"globe"===W.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),J=p.globeToMercatorTransition(W.zoom),te=z.properties.get("color").toArray01(),X=z.properties.get("high-color").toArray01(),re=z.properties.get("space-color").toArray01PremultipliedAlpha(),ie=p.identity$1([]);p.rotateY$1(ie,ie,-p.degToRad(W._center.lng)),p.rotateX$1(ie,ie,p.degToRad(W._center.lat)),p.rotateZ$1(ie,ie,W.angle),p.rotateX$1(ie,ie,-W._pitch);const xe=p.fromQuat(new Float32Array(16),ie),ge=p.mapValue(z.properties.get("star-intensity"),0,1,0,.25),ve=p.mapValue(z.properties.get("horizon-blend"),0,1,5e-4,.25),_e=p.globeUseCustomAntiAliasing(O,F,W)&&5e-4===ve?W.worldSize/(2*Math.PI*1.025)-1:W.globeRadius,Ce=O.frameCounter/1e3%1,Se=p.length(W.globeCenterInViewSpace),Je=Math.sqrt(Math.pow(Se,2)-Math.pow(_e,2)),Ee=Math.acos(Je/Se),je={u_frustum_tl:W.frustumCorners.TL,u_frustum_tr:W.frustumCorners.TR,u_frustum_br:W.frustumCorners.BR,u_frustum_bl:W.frustumCorners.BL,u_horizon:W.frustumCorners.horizon,u_transition:J,u_fadeout_range:ve,u_color:te,u_high_color:X,u_space_color:re,u_star_intensity:ge,u_star_size:5*p.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Ce,u_horizon_angle:Ee,u_rotation_matrix:xe};O.prepareDrawProgram(F,K);const Ge=O.atmosphereBuffer;Ge&&K.draw(F,U.TRIANGLES,ne,p.StencilMode.disabled,p.ColorMode.alphaBlended,p.CullFaceMode.backCW,je,"skybox",Ge.vertexBuffer,Ge.indexBuffer,Ge.segments)}(this,this.style.fog),this.renderPass="sky",(p.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){const O=this.style._layers[g[this.currentLayer]],z=a._getLayerSourceCache(O);O.isSky()&&this.renderLayer(this,z,O,z?M[z.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;){const O=this.style._layers[g[this.currentLayer]],z=a._getLayerSourceCache(O);if(O.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(O)){if(O.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const F=z?("symbol"===O.type?D:M)[z.id]:void 0;this._renderTileClippingMasks(O,z,z?C[z.id]:void 0),this.renderLayer(this,z,O,F),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let O=null;p.values(this.style._layers).forEach(z=>{const F=a._getLayerSourceCache(z);F&&!z.isHidden(this.transform.zoom)&&(!O||O.getSource().maxzoom<F.getSource().maxzoom)&&(O=F)}),O&&this.options.showTileBoundaries&&hc.debug(this,O,O.getVisibleCoordinates())}this.options.showPadding&&function(O){const z=O.transform.padding;Ru(O,O.transform.height-(z.top||0),3,Gf),Ru(O,z.bottom||0,3,Sl),qf(O,z.left||0,3,Dl),qf(O,O.transform.width-(z.right||0),3,Hf);const F=O.transform.centerPoint;var U,W,ne,K;Lu(U=O,(W=F.x)-1,(ne=O.transform.height-F.y)-10,2,20,K=Jh),Lu(U,W-10,ne-1,20,2,K)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(p.window.performance.now()),this.saveCanvasCopy())}}renderLayer(a,d,g,x){g.isHidden(this.transform.zoom)||("background"===g.type||"sky"===g.type||"custom"===g.type||x&&x.length)&&(this.id=g.id,this.gpuTimingStart(g),a.transform.projection.unsupportedLayers&&a.transform.projection.unsupportedLayers.includes(g.type)||hc[g.type](a,d,g,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(a){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery;let g=this.gpuTimers[a.id];g||(g=this.gpuTimers[a.id]={calls:0,cpuTime:0,query:d.createQueryEXT()}),g.calls++,d.beginQueryEXT(d.TIME_ELAPSED_EXT,g.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const a=this.context.extTimerQuery,d=a.createQueryEXT();this.deferredRenderGpuTimeQueries.push(d),a.beginQueryEXT(a.TIME_ELAPSED_EXT,d)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const a=this.context.extTimerQuery;a.endQueryEXT(a.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const a=this.context.extTimerQuery;a.endQueryEXT(a.TIME_ELAPSED_EXT)}collectGpuTimers(){const a=this.gpuTimers;return this.gpuTimers={},a}collectDeferredRenderGpuQueries(){const a=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],a}queryGpuTimers(a){const d={};for(const g in a){const x=a[g],C=this.context.extTimerQuery,M=C.getQueryObjectEXT(x.query,C.QUERY_RESULT_EXT)/1e6;C.deleteQueryEXT(x.query),d[g]=M}return d}queryGpuTimeDeferredRender(a){if(!this.options.gpuTimingDeferredRender)return 0;const d=this.context.extTimerQuery;let g=0;for(const x of a)g+=d.getQueryObjectEXT(x,d.QUERY_RESULT_EXT)/1e6,d.deleteQueryEXT(x);return g}translatePosMatrix(a,d,g,x,C){if(!g[0]&&!g[1])return a;const M=C?"map"===x?this.transform.angle:0:"viewport"===x?-this.transform.angle:0;if(M){const z=Math.sin(M),F=Math.cos(M);g=[g[0]*F-g[1]*z,g[0]*z+g[1]*F]}const D=[C?g[0]:As(d,g[0],this.transform.zoom),C?g[1]:As(d,g[1],this.transform.zoom),0],O=new Float32Array(16);return p.translate(O,a,D),O}saveTileTexture(a){const d=this._tileTextures[a.size[0]];d?d.push(a):this._tileTextures[a.size[0]]=[a]}getTileTexture(a){const d=this._tileTextures[a];return d&&d.length>0?d.pop():null}isPatternMissing(a){if(!a)return!1;if(!a.from||!a.to)return!0;const d=this.imageManager.getPattern(a.from.toString()),g=this.imageManager.getPattern(a.to.toString());return!d||!g}currentGlobalDefines(){const a=this.terrain&&this.terrain.renderingToTexture,d=this.style&&this.style.fog,g=[];return this.terrain&&!this.terrain.renderingToTexture&&g.push("TERRAIN"),d&&!a&&0!==d.getOpacity(this.transform.pitch)&&g.push("FOG"),a&&g.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&g.push("OVERDRAW_INSPECTOR"),g}useProgram(a,d,g){this.cache=this.cache||{};const x=g||[],C=this.currentGlobalDefines().concat(x),M=Wi.cacheKey(Gd[a],a,C,d);return this.cache[M]||(this.cache[M]=new Wi(this.context,a,Gd[a],d,Tl[a],C)),this.cache[M]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=p.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new p.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(a,d,g){if(this.terrain&&this.terrain.renderingToTexture)return;const x=this.style.fog;if(x){const C=x.getOpacity(this.transform.pitch),M=((D,O,z,F,U,W,ne,K,J,te,X)=>{const re=D.transform,ie=O.properties.get("color").toArray01();ie[3]=F;const xe=D.frameCounter/1e3%1;return{u_fog_matrix:z?re.calculateFogTileMatrix(z):D.identityMat,u_fog_range:O.getFovAdjustedRange(re._fov),u_fog_color:ie,u_fog_horizon_blend:O.properties.get("horizon-blend"),u_fog_temporal_offset:xe,u_frustum_tl:U,u_frustum_tr:W,u_frustum_br:ne,u_frustum_bl:K,u_globe_pos:J,u_globe_radius:te,u_viewport:X,u_globe_transition:p.globeToMercatorTransition(re.zoom),u_is_globe:+("globe"===re.projection.name)}})(this,x,g,C,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*p.exported.devicePixelRatio,this.transform.height*p.exported.devicePixelRatio]);d.setFogUniformValues(a,M)}}setTileLoadedFlag(a){this.tileLoaded=a}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const a=this.context.gl,d=a.createTexture();return a.bindTexture(a.TEXTURE_2D,d),a.copyTexImage2D(a.TEXTURE_2D,0,a.RGBA,0,0,a.drawingBufferWidth,a.drawingBufferHeight,0),d}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const a=this.style&&this.style.fog;return!!a&&0!==a.getOpacity(this.transform.pitch)}getBackgroundTiles(){const a=this._backgroundTiles,d=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(const x of g)d[x.key]=a[x.key]||new p.Tile(x,512,this.transform.tileZoom,this);return d}clearBackgroundTiles(){this._backgroundTiles={}}}class Fa{constructor(a=0,d=0,g=0,x=0){if(isNaN(a)||a<0||isNaN(d)||d<0||isNaN(g)||g<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=d,this.left=g,this.right=x}interpolate(a,d,g){return null!=d.top&&null!=a.top&&(this.top=p.number(a.top,d.top,g)),null!=d.bottom&&null!=a.bottom&&(this.bottom=p.number(a.bottom,d.bottom,g)),null!=d.left&&null!=a.left&&(this.left=p.number(a.left,d.left,g)),null!=d.right&&null!=a.right&&(this.right=p.number(a.right,d.right,g)),this}getCenter(a,d){const g=p.clamp((this.left+a-this.right)/2,0,a),x=p.clamp((this.top+d-this.bottom)/2,0,d);return new p.pointGeometry(g,x)}equals(a){return this.top===a.top&&this.bottom===a.bottom&&this.left===a.left&&this.right===a.right}clone(){return new Fa(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function np(f,a){const d=p.getColumn(f,3);p.fromQuat(f,a),p.setColumn(f,3,d)}function pc(f,a){const d=p.identity$1([]);return p.rotateZ$1(d,d,-a),p.rotateX$1(d,d,-f),d}function fc(f,a){const d=[f[0],f[1],0],g=[a[0],a[1],0];if(p.length(d)>=1e-15){const M=p.normalize([],d);p.scale$2(g,M,p.dot(g,M)),a[0]=g[0],a[1]=g[1]}const x=p.cross([],a,f);if(p.len(x)<1e-15)return null;const C=Math.atan2(-x[1],x[0]);return pc(Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2]),C)}class mt{constructor(a,d){this.position=a,this.orientation=d}get position(){return this._position}set position(a){if(a){const d=a instanceof p.MercatorCoordinate?a:new p.MercatorCoordinate(a[0],a[1],a[2]);this._renderWorldCopies&&(d.x=p.wrap(d.x,0,1)),this._position=d}else this._position=null}lookAtPoint(a,d){if(this.orientation=null,!this.position)return;const g=this._elevation?this._elevation.getAtPointOrZero(p.MercatorCoordinate.fromLngLat(a)):0,x=this.position,C=p.MercatorCoordinate.fromLngLat(a,g),M=[C.x-x.x,C.y-x.y,C.z-x.z];d||(d=[0,0,1]),d[2]=Math.abs(d[2]),this.orientation=fc(M,d)}setPitchBearing(a,d){this.orientation=pc(p.degToRad(a),p.degToRad(-d))}}class ao{constructor(a,d){this._transform=p.identity([]),this.orientation=d,this.position=a}get mercatorPosition(){const a=this.position;return new p.MercatorCoordinate(a[0],a[1],a[2])}get position(){const a=p.getColumn(this._transform,3);return[a[0],a[1],a[2]]}set position(a){var d;a&&p.setColumn(this._transform,3,[(d=a)[0],d[1],d[2],1])}get orientation(){return this._orientation}set orientation(a){this._orientation=a||p.identity$1([]),a&&np(this._transform,this._orientation)}getPitchBearing(){const a=this.forward(),d=this.right();return{bearing:Math.atan2(-d[1],d[0]),pitch:Math.atan2(Math.sqrt(a[0]*a[0]+a[1]*a[1]),-a[2])}}setPitchBearing(a,d){this._orientation=pc(a,d),np(this._transform,this._orientation)}forward(){const a=p.getColumn(this._transform,2);return[-a[0],-a[1],-a[2]]}up(){const a=p.getColumn(this._transform,1);return[-a[0],-a[1],-a[2]]}right(){const a=p.getColumn(this._transform,0);return[a[0],a[1],a[2]]}getCameraToWorld(a,d){const g=new Float64Array(16);return p.invert(g,this.getWorldToCamera(a,d)),g}getWorldToCameraPosition(a,d,g){const x=this.position;p.scale$2(x,x,-a);const C=new Float64Array(16);return p.fromScaling(C,[g,g,g]),p.translate(C,C,x),C[10]*=d,C}getWorldToCamera(a,d){const g=new Float64Array(16),x=new Float64Array(4),C=this.position;return p.conjugate(x,this._orientation),p.scale$2(C,C,-a),p.fromQuat(g,x),p.translate(g,g,C),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=d,g[9]*=d,g[10]*=d,g[11]*=d,g}getCameraToClipPerspective(a,d,g,x){const C=new Float64Array(16);return p.perspective(C,a,d,g,x),C}getDistanceToElevation(a){const d=0===a?0:p.mercatorZfromAltitude(a,this.position[1]),g=this.forward();return(d-this.position[2])/g[2]}clone(){return new ao([...this.position],[...this.orientation])}}function ds(f,a){const d=mc(f.projection,f.zoom,f.width,f.height),g=function(C,M,D,O,z){const F=new p.LngLat(D.lng-180*Fo,D.lat),U=new p.LngLat(D.lng+180*Fo,D.lat),W=C.project(F.lng,F.lat),ne=C.project(U.lng,U.lat),K=-Math.atan2(ne.y-W.y,ne.x-W.x),J=p.MercatorCoordinate.fromLngLat(D);J.y=p.clamp(J.y,-.999975,.999975);const te=J.toLngLat(),X=C.project(te.lng,te.lat),re=p.MercatorCoordinate.fromLngLat(te);re.x+=Fo;const ie=re.toLngLat(),xe=C.project(ie.lng,ie.lat),ge=Il(xe.x-X.x,xe.y-X.y,K),pe=p.MercatorCoordinate.fromLngLat(te);pe.y+=Fo;const ve=pe.toLngLat(),_e=C.project(ve.lng,ve.lat),Ce=Il(_e.x-X.x,_e.y-X.y,K),Se=Math.abs(ge.x)/Math.abs(Ce.y),Je=p.identity([]);p.rotateZ(Je,Je,-K*(1-(z?0:O)));const Ee=p.identity([]);return p.scale(Ee,Ee,[1,1-(1-Se)*O,1]),Ee[4]=-Ce.x/Ce.y*O,p.rotateZ(Ee,Ee,K),p.multiply(Ee,Je,Ee),Ee}(f.projection,0,f.center,d,a),x=Bu(f);return p.scale(g,g,[x,x,1]),g}function Bu(f){const a=f.projection,d=mc(f.projection,f.zoom,f.width,f.height),g=Nu(a,f.center),x=Nu(a,p.LngLat.convert(a.center));return Math.pow(2,g*d+(1-d)*x)}function mc(f,a,d,g,x=1/0){const C=f.range;if(!C)return 0;const M=Math.min(x,Math.max(d,g)),D=Math.log(M/1024)/Math.LN2;return p.smoothstep(C[0]+D,C[1]+D,a)}const Fo=1/4e4;function Nu(f,a){const d=p.clamp(a.lat,-p.MAX_MERCATOR_LATITUDE,p.MAX_MERCATOR_LATITUDE),g=new p.LngLat(a.lng-180*Fo,d),x=new p.LngLat(a.lng+180*Fo,d),C=f.project(g.lng,d),M=f.project(x.lng,d),D=p.MercatorCoordinate.fromLngLat(g),O=p.MercatorCoordinate.fromLngLat(x),z=M.x-C.x,F=M.y-C.y,U=O.x-D.x,W=O.y-D.y,ne=Math.sqrt((U*U+W*W)/(z*z+F*F));return Math.log(ne)/Math.LN2}function Il(f,a,d){const g=Math.cos(d),x=Math.sin(d);return{x:f*g-a*x,y:f*x+a*g}}class gc{constructor(a,d,g,x,C,M,D){this.tileSize=512,this._renderWorldCopies=void 0===C||C,this._minZoom=a||0,this._maxZoom=d||22,this._minPitch=null==g?0:g,this._maxPitch=null==x?60:x,this.setProjection(M),this.setMaxBounds(D),this.width=0,this.height=0,this._center=new p.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Fa,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new ao,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const a=new gc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return a._elevation=this._elevation,a._centerAltitude=this._centerAltitude,a._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,a.tileSize=this.tileSize,a.width=this.width,a.height=this.height,a.cameraElevationReference=this.cameraElevationReference,a._center=this._center,a._setZoom(this.zoom),a._seaLevelZoom=this._seaLevelZoom,a.angle=this.angle,a._fov=this._fov,a._pitch=this._pitch,a._nearZ=this._nearZ,a._farZ=this._farZ,a._averageElevation=this._averageElevation,a._unmodified=this._unmodified,a._edgeInsets=this._edgeInsets.clone(),a._camera=this._camera.clone(),a._calcMatrices(),a.freezeTileCoverage=this.freezeTileCoverage,a.frustumCorners=this.frustumCorners,a}get elevation(){return this._elevation}set elevation(a){this._elevation!==a&&(this._elevation=a,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(a){const d=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||d)&&this._updateCameraOnTerrain(),(a||d)&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return p.pick(this.projection,["name","center","parallels"])}setProjection(a){this.projectionOptions=a||{name:"mercator"};const d=this.projection?this.getProjection():void 0;this.projection=p.getProjection(this.projectionOptions);const g=!ot(d,this.getProjection());return g&&this._calcMatrices(),this.mercatorFromTransition=!1,g}setMercatorFromTransition(){const a=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=p.getProjection({name:"mercator"});const d=a!==this.projection.name;return d&&this._calcMatrices(),d}get minZoom(){return this._minZoom}set minZoom(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))}get maxZoom(){return this._maxZoom}set maxZoom(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))}get minPitch(){return this._minPitch}set minPitch(a){this._minPitch!==a&&(this._minPitch=a,this.pitch=Math.max(this.pitch,a))}get maxPitch(){return this._maxPitch}set maxPitch(a){this._maxPitch!==a&&(this._maxPitch=a,this.pitch=Math.min(this.pitch,a))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(a){void 0===a?a=!0:null===a&&(a=!1),this._renderWorldCopies=a}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const a=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(a))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return p.mercatorZfromAltitude(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new p.pointGeometry(this.width,this.height)}get bearing(){return p.wrap(this.rotation,-180,180)}set bearing(a){this.rotation=a}get rotation(){return-this.angle/Math.PI*180}set rotation(a){const d=-a*Math.PI/180;var g,x,C,M,D,O,z,F,U,W;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=(g=new p.ARRAY_TYPE(4),p.ARRAY_TYPE!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g),x=this.rotationMatrix,M=this.angle,D=(C=this.rotationMatrix)[0],O=C[1],z=C[2],F=C[3],U=Math.sin(M),W=Math.cos(M),x[0]=D*W+z*U,x[1]=O*W+F*U,x[2]=D*-U+z*W,x[3]=O*-U+F*W)}get pitch(){return this._pitch/Math.PI*180}set pitch(a){const d=p.clamp(a,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=a/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(a){this._averageElevation=a,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(a){const d=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._setZoom(d),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(a){this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const a=this._elevation;this._centerAltitude=a.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=a.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const a=this._elevation,d=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop();let x=0,C=0;for(let M=0;M<d.length;M++){const D=new p.pointGeometry(d[M][0]*this.width,g+d[M][1]*(this.height-g)),O=a.pointCoordinate(D);if(!O)continue;const z=1/Math.hypot(O[0]-this._camera.position[0],O[1]-this._camera.position[1]);x+=O[3]*z,C+=z}return 0===C?NaN:x/C}get center(){return this._center}set center(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const a=this._seaLevelZoom,d=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*d,x=this._mercatorZfromZoom(a),C=this._mercatorZfromZoom(this._maxZoom),M=Math.max(x-g,C);this._setZoom(this._zoomFromMercatorZ(M))}get padding(){return this._edgeInsets.toJSON()}set padding(a){this._edgeInsets.equals(a)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,a,1),this._calcMatrices())}computeZoomRelativeTo(a){const d=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,a.toAltitude()));let g;g=a.z<this._camera.position[2]?[d.x,d.y,d.z]:[a.x,a.y,a.z];const x=p.length(p.sub([],this._camera.position,g));return p.clamp(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(a){if(!this.height||!a.position&&!a.orientation)return;this._updateCameraState();let d=!1;if(a.orientation&&!p.exactEquals(a.orientation,this._camera.orientation)&&(d=this._setCameraOrientation(a.orientation)),a.position){const g=[a.position.x,a.position.y,a.position.z];p.exactEquals$1(g,this._camera.position)||(this._setCameraPosition(g),d=!0)}d&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const a=this._camera.position,d=new mt;return d.position=new p.MercatorCoordinate(a[0],a[1],a[2]),d.orientation=this._camera.orientation,d._elevation=this.elevation,d._renderWorldCopies=this.renderWorldCopies,d}_setCameraOrientation(a){if(!p.length$1(a))return!1;p.normalize$1(a,a);const d=p.transformQuat([],[0,0,-1],a),g=p.transformQuat([],[0,-1,0],a);if(g[2]<0)return!1;const x=fc(d,g);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(a){const d=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;a[2]=p.clamp(a[2],x/g,x/d),this._camera.position=a}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(a){return this._edgeInsets.equals(a)}interpolatePadding(a,d,g){this._unmodified=!1,this._edgeInsets.interpolate(a,d,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(a){const d=(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(a){const d=[new p.UnwrappedTileID(0,a)];if(this.renderWorldCopies){const g=this.pointCoordinate(new p.pointGeometry(0,0)),x=this.pointCoordinate(new p.pointGeometry(this.width,0)),C=this.pointCoordinate(new p.pointGeometry(this.width,this.height)),M=this.pointCoordinate(new p.pointGeometry(0,this.height)),D=Math.floor(Math.min(g.x,x.x,C.x,M.x)),O=Math.floor(Math.max(g.x,x.x,C.x,M.x)),z=1;for(let F=D-z;F<=O+z;F++)0!==F&&d.push(new p.UnwrappedTileID(F,a))}return d}coveringTiles(a){let d=this.coveringZoomLevel(a);const g=d,x=this.elevation&&!a.isTerrainDEM,C="mercator"===this.projection.name;if(void 0!==a.minzoom&&d<a.minzoom)return[];void 0!==a.maxzoom&&d>a.maxzoom&&(d=a.maxzoom);const M=this.locationCoordinate(this.center),D=this.center.lat,O=1<<d,z=[O*M.x,O*M.y,0],F="globe"===this.projection.name,U=!F,W=p.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d,U),ne=F?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),K=O*p.mercatorZfromAltitude(1,this.center.lat),J=this._camera.position[2]/p.mercatorZfromAltitude(1,this.center.lat),te=[O*ne.x,O*ne.y,J*(U?1:K)],X=this.cameraToCenterDistance/a.tileSize*(a.roundZoom?1:.502),re=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?d:0,ie=a.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,xe=a.isTerrainDEM?-ie:this._elevation?this._elevation.getMinElevationBelowMSL():0,ge=this.projection.isReprojectedInTileSpace?Bu(this):1,pe=ke=>{const He=new p.MercatorCoordinate(ke.x+25e-6,ke.y,ke.z),ht=new p.MercatorCoordinate(ke.x,ke.y+25e-6,ke.z),lt=ke.toLngLat(),wt=He.toLngLat(),Lt=ht.toLngLat(),jt=this.locationCoordinate(lt),un=this.locationCoordinate(wt),Et=this.locationCoordinate(Lt),Wt=Math.hypot(un.x-jt.x,un.y-jt.y),pn=Math.hypot(Et.x-jt.x,Et.y-jt.y);return Math.sqrt(Wt*pn)*ge/25e-6},ve=ke=>{const et=ie,He=xe;return{aabb:p.tileAABB(this,O,0,0,0,ke,He,et,this.projection),zoom:0,x:0,y:0,minZ:He,maxZ:et,wrap:ke,fullyVisible:!1}},_e=[];let Ce=[];const Se=d,Je=a.reparseOverscaled?g:d,Ee=ke=>ke*ke,je=Ee((J-this._centerAltitude)*K),Ge=ke=>{if(!this._elevation||!ke.tileID||!C)return;const et=this._elevation.getMinMaxForTile(ke.tileID),He=ke.aabb;et?(He.min[2]=et.min,He.max[2]=et.max,He.center[2]=(He.min[2]+He.max[2])/2):(ke.shouldSplit=at(ke),ke.shouldSplit||(He.min[2]=He.max[2]=He.center[2]=this._centerAltitude))},at=ke=>{if(ke.zoom<re)return!0;if(ke.zoom===Se)return!1;if(null!=ke.shouldSplit)return ke.shouldSplit;const et=ke.aabb.distanceX(te),He=ke.aabb.distanceY(te);let ht=je,lt=1;if(F){ht=Ee(ke.aabb.distanceZ(te));const Lt=Math.pow(2,ke.zoom),jt=p.latFromMercatorY((ke.y+1)/Lt),un=p.latFromMercatorY(ke.y/Lt),Et=Math.min(Math.max(D,jt),un),Wt=p.circumferenceAtLatitude(Et)/p.circumferenceAtLatitude(D);if(lt=Et===D?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Wt/this._mercatorScaleRatio),this.zoom<=p.GLOBE_ZOOM_THRESHOLD_MIN&&ke.zoom===Se-1&&Wt>=.9)return!0}else if(x&&(ht=Ee(ke.aabb.distanceZ(te)*K)),this.projection.isReprojectedInTileSpace&&g<=5){const Lt=Math.pow(2,ke.zoom),jt=pe(new p.MercatorCoordinate((ke.x+.5)/Lt,(ke.y+.5)/Lt));lt=jt>.85?1:jt}const wt=et*et+He*He+ht;return wt<Ee((1<<Se-ke.zoom)*X*lt*((Lt,jt)=>{if(jt*Ee(.707)<Lt)return 1;const un=Math.sqrt(jt/Lt);return un/(1.4144271570014144+(Math.pow(1.1,un-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(ht,je),wt))};if(this.renderWorldCopies)for(let ke=1;ke<=3;ke++)_e.push(ve(-ke)),_e.push(ve(ke));for(_e.push(ve(0));_e.length>0;){const ke=_e.pop(),et=ke.x,He=ke.y;let ht=ke.fullyVisible;if(!ht){const lt=ke.aabb.intersects(W);if(0===lt)continue;ht=2===lt}if(ke.zoom!==Se&&at(ke))for(let lt=0;lt<4;lt++){const wt=(et<<1)+lt%2,Lt=(He<<1)+(lt>>1),jt={aabb:C?ke.aabb.quadrant(lt):p.tileAABB(this,O,ke.zoom+1,wt,Lt,ke.wrap,ke.minZ,ke.maxZ,this.projection),zoom:ke.zoom+1,x:wt,y:Lt,wrap:ke.wrap,fullyVisible:ht,tileID:void 0,shouldSplit:void 0,minZ:ke.minZ,maxZ:ke.maxZ};x&&!F&&(jt.tileID=new p.OverscaledTileID(ke.zoom+1===Se?Je:ke.zoom+1,ke.wrap,ke.zoom+1,wt,Lt),Ge(jt)),_e.push(jt)}else{const lt=ke.zoom===Se?Je:ke.zoom;if(a.minzoom&&a.minzoom>lt)continue;const wt=z[0]-(.5+et+(ke.wrap<<ke.zoom))*(1<<d-ke.zoom),Lt=z[1]-.5-He,jt=ke.tileID?ke.tileID:new p.OverscaledTileID(lt,ke.wrap,ke.zoom,et,He);Ce.push({tileID:jt,distanceSq:wt*wt+Lt*Lt})}}if(this.fogCullDistSq){const ke=this.fogCullDistSq,et=this.horizonLineFromTop();Ce=Ce.filter(He=>{const ht=[0,0,0,1],lt=[p.EXTENT,p.EXTENT,0,1],wt=this.calculateFogTileMatrix(He.tileID.toUnwrapped());p.transformMat4$1(ht,ht,wt),p.transformMat4$1(lt,lt,wt);const Lt=p.getAABBPointSquareDist(ht,lt);if(0===Lt)return!0;let jt=!1;const un=this._elevation;if(un&&Lt>ke&&0!==et){const Et=this.calculateProjMatrix(He.tileID.toUnwrapped());let Wt;a.isTerrainDEM||(Wt=un.getMinMaxForTile(He.tileID)),Wt||(Wt={min:xe,max:ie});const pn=p.furthestTileCorner(this.rotation),Kn=[pn[0]*p.EXTENT,pn[1]*p.EXTENT,Wt.max];p.transformMat4(Kn,Kn,Et),jt=(1-Kn[1])*this.height*.5<et}return Lt<ke||jt})}return Ce.sort((ke,et)=>ke.distanceSq-et.distanceSq).map(ke=>ke.tileID)}resize(a,d){this.width=a,this.height=d,this.pixelsToGLUnits=[2/a,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(a){return Math.pow(2,a)}scaleZoom(a){return Math.log(a)/Math.LN2}project(a){const d=p.clamp(a.lat,-p.MAX_MERCATOR_LATITUDE,p.MAX_MERCATOR_LATITUDE),g=this.projection.project(a.lng,d);return new p.pointGeometry(g.x*this.worldSize,g.y*this.worldSize)}unproject(a){return this.projection.unproject(a.x/this.worldSize,a.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(a,d){let g,x;const C=this.centerPoint;if("globe"===this.projection.name){const D=this.worldSize;g=(d.x-C.x)/D,x=(d.y-C.y)/D}else{const D=this.pointCoordinate(d),O=this.pointCoordinate(C);g=D.x-O.x,x=D.y-O.y}const M=this.locationCoordinate(a);this.setLocation(new p.MercatorCoordinate(M.x-g,M.y-x))}setLocation(a){this.center=this.coordinateLocation(a),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(a){return this.projection.locationPoint(this,a)}locationPoint3D(a){return this.projection.locationPoint(this,a,!0)}pointLocation(a){return this.coordinateLocation(this.pointCoordinate(a))}pointLocation3D(a){return this.coordinateLocation(this.pointCoordinate3D(a))}locationCoordinate(a,d){const g=d?p.mercatorZfromAltitude(d,a.lat):void 0,x=this.projection.project(a.lng,a.lat);return new p.MercatorCoordinate(x.x,x.y,g)}coordinateLocation(a){return this.projection.unproject(a.x,a.y)}pointRayIntersection(a,d){const g=null!=d?d:this._centerAltitude,x=[a.x,a.y,0,1],C=[a.x,a.y,1,1];p.transformMat4$1(x,x,this.pixelMatrixInverse),p.transformMat4$1(C,C,this.pixelMatrixInverse);const M=C[3];p.scale$1(x,x,1/x[3]),p.scale$1(C,C,1/M);const D=x[2],O=C[2];return{p0:x,p1:C,t:D===O?0:(g-D)/(O-D)}}screenPointToMercatorRay(a){const d=[a.x,a.y,0,1],g=[a.x,a.y,1,1];return p.transformMat4$1(d,d,this.pixelMatrixInverse),p.transformMat4$1(g,g,this.pixelMatrixInverse),p.scale$1(d,d,1/d[3]),p.scale$1(g,g,1/g[3]),d[2]=p.mercatorZfromAltitude(d[2],this._center.lat)*this.worldSize,g[2]=p.mercatorZfromAltitude(g[2],this._center.lat)*this.worldSize,p.scale$1(d,d,1/this.worldSize),p.scale$1(g,g,1/this.worldSize),new p.Ray([d[0],d[1],d[2]],p.normalize([],p.sub([],g,d)))}rayIntersectionCoordinate(a){const{p0:d,p1:g,t:x}=a,C=p.mercatorZfromAltitude(d[2],this._center.lat),M=p.mercatorZfromAltitude(g[2],this._center.lat);return new p.MercatorCoordinate(p.number(d[0],g[0],x)/this.worldSize,p.number(d[1],g[1],x)/this.worldSize,p.number(C,M,x))}pointCoordinate(a,d=this._centerAltitude){return this.projection.pointCoordinate(this,a.x,a.y,d)}pointCoordinate3D(a){if(!this.elevation)return this.pointCoordinate(a);let d=this.projection.pointCoordinate3D(this,a.x,a.y);if(d)return new p.MercatorCoordinate(d[0],d[1],d[2]);let g=0,x=this.horizonLineFromTop();if(a.y>x)return this.pointCoordinate(a);const C=.02*x,M=a.clone();for(let D=0;D<10&&x-g>C;D++){M.y=p.number(g,x,.66);const O=this.projection.pointCoordinate3D(this,M.x,M.y);O?(x=M.y,d=O):g=M.y}return d?new p.MercatorCoordinate(d[0],d[1],d[2]):this.pointCoordinate(a)}isPointAboveHorizon(a){return this.projection.isPointAboveHorizon(this,a)}_coordinatePoint(a,d){const g=d&&this.elevation?this.elevation.getAtPointOrZero(a,this._centerAltitude):this._centerAltitude,x=[a.x*this.worldSize,a.y*this.worldSize,g+a.toAltitude(),1];return p.transformMat4$1(x,x,this.pixelMatrix),x[3]>0?new p.pointGeometry(x[0]/x[3],x[1]/x[3]):new p.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(a,d){const g=new p.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),x=new p.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),C=new p.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),M=new p.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let D=this.pointCoordinate(g,a),O=this.pointCoordinate(x,a);const z=this.pointCoordinate(C,d),F=this.pointCoordinate(M,d),U=(W,ne)=>(ne.y-W.y)/(ne.x-W.x);return D.y>1&&O.y>=0?D=new p.MercatorCoordinate((1-F.y)/U(F,D)+F.x,1):D.y<0&&O.y<=1&&(D=new p.MercatorCoordinate(-F.y/U(F,D)+F.x,0)),O.y>1&&D.y>=0?O=new p.MercatorCoordinate((1-z.y)/U(z,O)+z.x,1):O.y<0&&D.y<=1&&(O=new p.MercatorCoordinate(-z.y/U(z,O)+z.x,0)),(new p.LngLatBounds).extend(this.coordinateLocation(D)).extend(this.coordinateLocation(O)).extend(this.coordinateLocation(F)).extend(this.coordinateLocation(z))}_getBounds3D(){const a=this.elevation;if(!a.visibleDemTiles.length)return this._getBounds(0,0);const d=a.visibleDemTiles.reduce((g,x)=>{if(x.dem){const C=x.dem.tree;g.min=Math.min(g.min,C.minimums[0]),g.max=Math.max(g.max,C.maximums[0])}return g},{min:Number.MAX_VALUE,max:0});return this._getBounds(d.min*a.exaggeration(),d.max*a.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(a=!0){const d=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,g=this.height/2-d*(1-this._horizonShift);return a?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(a){this.maxBounds=a,this.minLat=-p.MAX_MERCATOR_LATITUDE,this.maxLat=p.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,a&&(this.minLat=a.getSouth(),this.maxLat=a.getNorth(),this.minLng=a.getWest(),this.maxLng=a.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=p.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=p.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=p.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=p.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(a,d){return this.projection.createTileMatrix(this,d,a)}calculateDistanceTileData(a){const d=a.key,g=this._distanceTileDataCache;if(g[d])return g[d];const x=a.canonical,C=1/this.height,M=this.cameraWorldSize/this.zoomScale(x.z),D=(x.x+Math.pow(2,x.z)*a.wrap)*M,O=x.y*M,z=this.point,F=this.angle,U=Math.sin(-F),W=-Math.cos(-F);return g[d]={bearing:[U,W],center:[(z.x-D)*C,(z.y-O)*C],scale:M/p.EXTENT*C},g[d]}calculateFogTileMatrix(a){const d=a.key,g=this._fogTileMatrixCache;if(g[d])return g[d];const x=this.projection.createTileMatrix(this,this.cameraWorldSize,a);return p.multiply(x,this.worldToFogMatrix,x),g[d]=new Float32Array(x),g[d]}calculateProjMatrix(a,d=!1){const g=a.key,x=d?this._alignedProjMatrixCache:this._projMatrixCache;if(x[g])return x[g];const C=this.calculatePosMatrix(a,this.worldSize);return p.multiply(C,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:d?this.alignedProjMatrix:this.projMatrix,C),x[g]=new Float32Array(C),x[g]}calculatePixelsToTileUnitsMatrix(a){const d=a.tileID.key,g=this._pixelsToTileUnitsCache;if(g[d])return g[d];const x=function(C,M){const{scale:D}=C.tileTransform,O=D*p.EXTENT/(C.tileSize*Math.pow(2,M.zoom-C.tileID.overscaledZ+C.tileID.canonical.z));return z=new Float32Array(4),W=(F=M.inverseAdjustmentMatrix)[1],ne=F[2],K=F[3],te=(U=[O,O])[1],z[0]=F[0]*(J=U[0]),z[1]=W*J,z[2]=ne*te,z[3]=K*te,z;var z,F,U,W,ne,K,J,te}(a,this);return g[d]=x,g[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const a=this._elevation;this._updateCameraState();const d=p.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(d),x=this._camera.forward(),C=p.mercatorZfromAltitude(1,this._center.lat);g[2]/=C,x[2]/=C,p.normalize(x,x);const M=a.raycast(g,x,a.exaggeration());if(M){const D=p.scaleAndAdd([],g,x,M),O=new p.MercatorCoordinate(D[0],D[1],p.mercatorZfromAltitude(D[2],p.latFromMercatorY(D[1]))),z=(O.z+p.length([O.x-g[0],O.y-g[1],O.z-g[2]*C]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(z),this._centerAltitude=O.toAltitude(),this._center=this.coordinateLocation(O),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const a=this._elevation;this._updateCameraState();const d=p.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(d),x=a.getAtPointOrZero(new p.MercatorCoordinate(...g)),C=this._minimumHeightOverTerrain()*Math.cos(p.degToRad(this._maxPitch)),M=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*x;if(M<C){const D=this.locationCoordinate(this._center,this._centerAltitude),O=[D.x-g[0],D.y-g[1],D.z-g[2]],z=p.length(O);O[2]-=(C-M)/this._pixelsPerMercatorPixel;const F=p.length(O);if(0===F)return;p.scale$2(O,O,z/F*this._pixelsPerMercatorPixel),this._camera.position=[D.x-O[0],D.y-O[1],D.z*this._pixelsPerMercatorPixel-O[2]],this._camera.orientation=fc(O,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const a="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||a){const W=this.center;return W.lat=p.clamp(W.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!a)&&(W.lng=p.clamp(W.lng,this.minLng,this.maxLng)),this.center=W,void(this._constraining=!1)}const d=this._unmodified,{x:g,y:x}=this.point;let C=0,M=g,D=x;const O=this.width/2,z=this.height/2,F=this.worldMinY*this.scale,U=this.worldMaxY*this.scale;if(x-z<F&&(D=F+z),x+z>U&&(D=U-z),U-F<this.height&&(C=Math.max(C,this.height/(U-F)),D=(U+F)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const W=this.worldMinX*this.scale,ne=this.worldMaxX*this.scale,K=this.worldSize/2-(W+ne)/2;M=(g+K+this.worldSize)%this.worldSize-K,M-O<W&&(M=W+O),M+O>ne&&(M=ne-O),ne-W<this.width&&(C=Math.max(C,this.width/(ne-W)),M=(ne+W)/2)}M===g&&D===x||(this.center=this.unproject(new p.pointGeometry(M,D))),C&&(this.zoom+=this.scaleZoom(C)),this._constrainCameraAltitude(),this._unmodified=d,this._constraining=!1}_minZoomForBounds(){let a=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(a=Math.max(a,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),a}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const a=this.centerOffset,d=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=p.mercatorZfromAltitude(1,this.center.lat)/p.mercatorZfromAltitude(1,p.GLOBE_SCALE_MATCH_LATITUDE));const g=mc(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,g),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const x=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?d:1),C=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);C[8]=2*-a.x/this.width,C[9]=2*a.y/this.height;let M=p.mul([],C,x);if(this.projection.isReprojectedInTileSpace){const ge=this.locationCoordinate(this.center),pe=p.identity([]);p.translate(pe,pe,[ge.x*this.worldSize,ge.y*this.worldSize,0]),p.multiply(pe,pe,ds(this)),p.translate(pe,pe,[-ge.x*this.worldSize,-ge.y*this.worldSize,0]),p.multiply(M,M,pe),this.inverseAdjustmentMatrix=function(ve){const _e=ds(ve,!0);return Xs([],[_e[0],_e[1],_e[4],_e[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=p.scale([],M,[this.worldSize,this.worldSize,this.worldSize/d,1]),this.projMatrix=M,this.invProjMatrix=p.invert(new Float64Array(16),this.projMatrix);const D=p.invert([],C);this.frustumCorners=p.FrustumCorners.fromInvProjectionMatrix(D,this.horizonLineFromTop(),this.height);const O=new Float32Array(16);p.identity(O),p.scale(O,O,[1,-1,1]),p.rotateX(O,O,this._pitch),p.rotateZ(O,O,this.angle);const z=p.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),F=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;z[8]=2*-a.x/this.width,z[9]=2*(a.y+F)/this.height,this.skyboxMatrix=p.multiply(O,z,O);const U=this.point,W=U.x,ne=U.y,K=this.width%2/2,J=this.height%2/2,te=Math.cos(this.angle),X=Math.sin(this.angle),re=W-Math.round(W)+te*K+X*J,ie=ne-Math.round(ne)+te*J+X*K,xe=new Float64Array(M);if(p.translate(xe,xe,[re>.5?re-1:re,ie>.5?ie-1:ie,0]),this.alignedProjMatrix=xe,M=p.create(),p.scale(M,M,[this.width/2,-this.height/2,1]),p.translate(M,M,[1,-1,0]),this.labelPlaneMatrix=M,M=p.create(),p.scale(M,M,[1,-1,1]),p.translate(M,M,[-1,-1,0]),p.scale(M,M,[2/this.width,2/this.height,1]),this.glCoordMatrix=M,this.pixelMatrix=p.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},M=p.invert(new Float64Array(16),this.pixelMatrix),!M)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=M,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=p.calculateGlobeMatrix(this);const ge=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=p.transformMat4(ge,ge,x),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=M;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const a=this.cameraWorldSize,d=this.cameraPixelsPerMeter,g=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,C=[a,a,d];p.scale$2(C,C,x),p.scale$2(g,g,-1),p.multiply$2(g,g,C);const M=p.create();p.translate(M,M,g),p.scale(M,M,C),this.mercatorFogMatrix=M,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(a,d,x)}_computeCameraPosition(a){const d=(a=a||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),x=this.point,C=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*d-a/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-g[0]*C,x.y/this.worldSize-g[1]*C,a/this.worldSize*this._centerAltitude-g[2]*C]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(a){const d=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=a[2];let x=1;g>0&&(x=Math.min((d-this._camera.position[2])/g,1)),this._camera.position=p.scaleAndAdd([],this._camera.position,a,x),this._updateStateFromCamera(),this.projection.wrap&&(this.center=this.center.wrap())}_updateStateFromCamera(){const a=this._camera.position,d=this._camera.forward(),{pitch:g,bearing:x}=this._camera.getPitchBearing(),C=p.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,M=this._mercatorZfromZoom(this._maxZoom)*Math.cos(p.degToRad(this._maxPitch)),D=Math.max((a[2]-C)/Math.cos(g),M),O=this._zoomFromMercatorZ(D);p.scaleAndAdd(a,a,d,D),this._pitch=p.clamp(g,p.degToRad(this.minPitch),p.degToRad(this.maxPitch)),this.angle=p.wrap(x,-Math.PI,Math.PI),this._setZoom(p.clamp(O,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new p.MercatorCoordinate(a[0],a[1],a[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(a){return Math.pow(2,a)*this.tileSize}_mercatorZfromZoom(a){return this.cameraToCenterDistance/this._worldSizeFromZoom(a)}_minimumHeightOverTerrain(){const a=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(a)}_zoomFromMercatorZ(a){return this.scaleZoom(this.cameraToCenterDistance/(a*this.tileSize))}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(p.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(a,d){const g=Math.min(a.x,d.x),x=Math.max(a.x,d.x),C=Math.min(a.y,d.y),M=Math.max(a.y,d.y);if(C<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const D=[new p.pointGeometry(g,C),new p.pointGeometry(x,M),new p.pointGeometry(g,M),new p.pointGeometry(x,C)],O=this.renderWorldCopies?-3:0,z=this.renderWorldCopies?4:1;for(const F of D){const U=this.pointRayIntersection(F);if(U.t<0)return!0;const W=this.rayIntersectionCoordinate(U);if(W.x<O||W.y<0||W.x>z||W.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+p.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new p.pointGeometry(0,0),new p.pointGeometry(this.width,this.height))}zoomDeltaToMovement(a,d){const g=p.length(p.sub([],this._camera.position,a)),x=this._zoomFromMercatorZ(g)+d;return g-this._mercatorZfromZoom(x)}getCameraPoint(){if("globe"===this.projection.name){const a=function(d,g){const x=[d[0],d[1],d[2],1];p.transformMat4$1(x,x,g);const C=Math.max(x[3],1e-6);return[x[0]/C,x[1]/C,x[2]/C,C]}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new p.pointGeometry(a[0],a[1])}{const a=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new p.pointGeometry(0,a))}}getCameraToCenterDistance(a){const d=mc(a,this.zoom,this.width,this.height,1024),g=a.pixelSpaceConversion(this.center.lat,this.worldSize,d);return.5/Math.tan(.5*this._fov)*this.height*g}}function Ba(f,a){let d=!1,g=null;const x=()=>{g=null,d&&(f(),g=setTimeout(x,a),d=!1)};return()=>(d=!0,g||x(),g)}class ip{constructor(a){this._hashName=a&&encodeURIComponent(a),p.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Ba(this._updateHashUnthrottled.bind(this),300)}addTo(a){return this._map=a,p.window.addEventListener("hashchange",this._onHashChange,!1),a.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),p.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const a=this._map;if(!a)return"";const d=Br(a);if(this._hashName){const g=this._hashName;let x=!1;const C=p.window.location.hash.slice(1).split("&").map(M=>{const D=M.split("=")[0];return D===g?(x=!0,`${D}=${d}`):M}).filter(M=>M);return x||C.push(`${g}=${d}`),`#${C.join("&")}`}return`#${d}`}_getCurrentHash(){const a=p.window.location.hash.replace("#","");if(this._hashName){let d;return a.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(d=g)}),(d&&d[1]||"").split("/")}return a.split("/")}_onHashChange(){const a=this._map;if(!a)return!1;const d=this._getCurrentHash();if(d.length>=3&&!d.some(g=>isNaN(g))){const g=a.dragRotate.isEnabled()&&a.touchZoomRotate.isEnabled()?+(d[3]||0):a.getBearing();return a.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:g,pitch:+(d[4]||0)}),!0}return!1}_updateHashUnthrottled(){const a=p.window.location.href.replace(/(#.+)?$/,this.getHashString());p.window.history.replaceState(p.window.history.state,null,a)}}function Br(f,a){const d=f.getCenter(),g=Math.round(100*f.getZoom())/100,x=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),C=Math.pow(10,x),M=Math.round(d.lng*C)/C,D=Math.round(d.lat*C)/C,O=f.getBearing(),z=f.getPitch();let F=a?`/${M}/${D}/${g}`:`${g}/${D}/${M}`;return(O||z)&&(F+="/"+Math.round(10*O)/10),z&&(F+=`/${Math.round(z)}`),F}const Bo={linearity:.3,easing:p.bezier(0,0,.3,1)},Zf=p.extend({deceleration:2500,maxSpeed:1400},Bo),Xd=p.extend({deceleration:20,maxSpeed:1400},Bo),rp=p.extend({deceleration:1e3,maxSpeed:360},Bo),ju=p.extend({deceleration:1e3,maxSpeed:90},Bo);class _c{constructor(a){this._map=a,this.clear()}clear(){this._inertiaBuffer=[]}record(a){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:p.exported.now(),settings:a})}_drainInertiaBuffer(){const a=this._inertiaBuffer,d=p.exported.now();for(;a.length>0&&d-a[0].time>160;)a.shift()}_onMoveEnd(a){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,pan:new p.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:C}of this._inertiaBuffer)d.zoom+=C.zoomDelta||0,d.bearing+=C.bearingDelta||0,d.pitch+=C.pitchDelta||0,C.panDelta&&d.pan._add(C.panDelta),C.around&&(d.around=C.around),C.pinchAround&&(d.pinchAround=C.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(d.pan.mag()){const C=Na(d.pan.mag(),g,p.extend({},Zf,a||{}));x.offset=d.pan.mult(C.amount/d.pan.mag()),x.center=this._map.transform.center,yc(x,C)}if(d.zoom){const C=Na(d.zoom,g,Xd);x.zoom=this._map.transform.zoom+C.amount,yc(x,C)}if(d.bearing){const C=Na(d.bearing,g,rp);x.bearing=this._map.transform.bearing+p.clamp(C.amount,-179,179),yc(x,C)}if(d.pitch){const C=Na(d.pitch,g,ju);x.pitch=this._map.transform.pitch+C.amount,yc(x,C)}if(x.zoom||x.bearing){const C=void 0===d.pinchAround?d.around:d.pinchAround;x.around=C?this._map.unproject(C):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function yc(f,a){(!f.duration||f.duration<a.duration)&&(f.duration=a.duration,f.easing=a.easing)}function Na(f,a,d){const{maxSpeed:g,linearity:x,deceleration:C}=d,M=p.clamp(f*x/(a/1e3),-g,g),D=Math.abs(M)/(C*x);return{easing:d.easing,duration:1e3*D,amount:M*(D/2)}}class Tr extends p.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,d,g,x={}){const C=Zt(d.getCanvasContainer(),g),M=d.unproject(C);super(a,p.extend({point:C,lngLat:M,originalEvent:g},x)),this._defaultPrevented=!1,this.target=d}}class oi extends p.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,d,g){const x="touchend"===a?g.changedTouches:g.touches,C=es(d.getCanvasContainer(),x),M=C.map(O=>d.unproject(O)),D=C.reduce((O,z,F,U)=>O.add(z.div(U.length)),new p.pointGeometry(0,0));super(a,{points:C,point:D,lngLats:M,lngLat:d.unproject(D),originalEvent:g}),this._defaultPrevented=!1}}class Qd extends p.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,d,g){super(a,{originalEvent:g}),this._defaultPrevented=!1}}class op{constructor(a,d){this._map=a,this._clickTolerance=d.clickTolerance}reset(){this._mousedownPos=void 0}wheel(a){return this._firePreventable(new Qd(a.type,this._map,a))}mousedown(a,d){return this._mousedownPos=d,this._firePreventable(new Tr(a.type,this._map,a))}mouseup(a){this._map.fire(new Tr(a.type,this._map,a))}preclick(a){const d=p.extend({},a);d.type="preclick",this._map.fire(new Tr(d.type,this._map,d))}click(a,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||(this.preclick(a),this._map.fire(new Tr(a.type,this._map,a)))}dblclick(a){return this._firePreventable(new Tr(a.type,this._map,a))}mouseover(a){this._map.fire(new Tr(a.type,this._map,a))}mouseout(a){this._map.fire(new Tr(a.type,this._map,a))}touchstart(a){return this._firePreventable(new oi(a.type,this._map,a))}touchmove(a){this._map.fire(new oi(a.type,this._map,a))}touchend(a){this._map.fire(new oi(a.type,this._map,a))}touchcancel(a){this._map.fire(new oi(a.type,this._map,a))}_firePreventable(a){if(this._map.fire(a),a.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ii{constructor(a){this._map=a}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(a){this._map.fire(new Tr(a.type,this._map,a))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Tr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(a){this._delayContextMenu?this._contextMenuEvent=a:this._map.fire(new Tr(a.type,this._map,a)),this._map.listens("contextmenu")&&a.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class sp{constructor(a,d){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(a,d){this.isEnabled()&&a.shiftKey&&0===a.button&&(mu(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(a,d){if(!this._active)return;const g=d;if(this._lastPos.equals(g)||!this._box&&g.dist(this._startPos)<this._clickTolerance)return;const x=this._startPos;this._lastPos=g,this._box||(this._box=Qt("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",a));const C=Math.min(x.x,g.x),M=Math.max(x.x,g.x),D=Math.min(x.y,g.y),O=Math.max(x.y,g.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${C}px,${D}px)`,this._box.style.width=M-C+"px",this._box.style.height=O-D+"px")})}mouseupWindow(a,d){if(!this._active||0!==a.button)return;const g=this._startPos,x=d;if(this.reset(),_o(),g.x!==x.x||g.y!==x.y)return this._map.fire(new p.Event("boxzoomend",{originalEvent:a})),{cameraAnimation:C=>C.fitScreenCoordinates(g,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",a)}keydown(a){this._active&&27===a.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",a))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ql(),delete this._startPos,delete this._lastPos}_fireEvent(a,d){return this._map.fire(new p.Event(a,{originalEvent:d}))}}function Kd(f,a){const d={};for(let g=0;g<f.length;g++)d[f[g].identifier]=a[g];return d}class ks{constructor(a){this.reset(),this.numTouches=a.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(a,d,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=a.timeStamp),g.length===this.numTouches&&(this.centroid=function(x){const C=new p.pointGeometry(0,0);for(const M of x)C._add(M);return C.div(x.length)}(d),this.touches=Kd(g,d)))}touchmove(a,d,g){if(this.aborted||!this.centroid)return;const x=Kd(g,d);for(const C in this.touches){const M=this.touches[C],D=x[C];(!D||D.dist(M)>30)&&(this.aborted=!0)}}touchend(a,d,g){if((!this.centroid||a.timeStamp-this.startTime>500)&&(this.aborted=!0),0===g.length){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class Mr{constructor(a){this.singleTap=new ks(a),this.numTaps=a.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(a,d,g){this.singleTap.touchstart(a,d,g)}touchmove(a,d,g){this.singleTap.touchmove(a,d,g)}touchend(a,d,g){const x=this.singleTap.touchend(a,d,g);if(x){const C=a.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(x)<30;if(C&&M||this.reset(),this.count++,this.lastTime=a.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class ap{constructor(){this._zoomIn=new Mr({numTouches:1,numTaps:2}),this._zoomOut=new Mr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(a,d,g){this._zoomIn.touchstart(a,d,g),this._zoomOut.touchstart(a,d,g)}touchmove(a,d,g){this._zoomIn.touchmove(a,d,g),this._zoomOut.touchmove(a,d,g)}touchend(a,d,g){const x=this._zoomIn.touchend(a,d,g),C=this._zoomOut.touchend(a,d,g);return x?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()+1,around:M.unproject(x)},{originalEvent:a})}):C?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()-1,around:M.unproject(C)},{originalEvent:a})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Vu={0:1,2:2};class Rs{constructor(a){this.reset(),this._clickTolerance=a.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(a,d){return!1}_move(a,d){return{}}mousedown(a,d){if(this._lastPoint)return;const g=ts(a);this._correctButton(a,g)&&(this._lastPoint=d,this._eventButton=g)}mousemoveWindow(a,d){const g=this._lastPoint;if(g)if(a.preventDefault(),null!=this._eventButton&&function(x,C){const M=Vu[C];return void 0===x.buttons||(x.buttons&M)!==M}(a,this._eventButton))this.reset();else if(this._moved||!(d.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=d,this._move(g,d)}mouseupWindow(a){this._lastPoint&&ts(a)===this._eventButton&&(this._moved&&_o(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Nr extends Rs{mousedown(a,d){super.mousedown(a,d),this._lastPoint&&(this._active=!0)}_correctButton(a,d){return 0===d&&!a.ctrlKey}_move(a,d){return{around:d,panDelta:d.sub(a)}}}class Uu extends Rs{_correctButton(a,d){return 0===d&&a.ctrlKey||2===d}_move(a,d){const g=.8*(d.x-a.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(a){a.preventDefault()}}class Gi extends Rs{_correctButton(a,d){return 0===d&&a.ctrlKey||2===d}_move(a,d){const g=-.5*(d.y-a.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(a){a.preventDefault()}}class Wf{constructor(a,d){this._map=a,this._el=a.getCanvasContainer(),this._minTouches=1,this._clickTolerance=d.clickTolerance||1,this.reset(),p.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new p.pointGeometry(0,0)}touchstart(a,d,g){return this._calculateTransform(a,d,g)}touchmove(a,d,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===g.length&&!p.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return a.cancelable&&a.preventDefault(),this._calculateTransform(a,d,g)}}touchend(a,d,g){this._calculateTransform(a,d,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(a,d,g){g.length>0&&(this._active=!0);const x=Kd(g,d),C=new p.pointGeometry(0,0),M=new p.pointGeometry(0,0);let D=0;for(const z in x){const F=x[z],U=this._touches[z];U&&(C._add(F),M._add(F.sub(U)),D++,x[z]=F)}if(this._touches=x,D<this._minTouches||!M.mag())return;const O=M.div(D);return this._sum._add(O),this._sum.mag()<this._clickTolerance?void 0:{around:C.div(D),panDelta:O}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Qt("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class No{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(a){}_move(a,d,g){return{}}touchstart(a,d,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([d[0],d[1]]))}touchmove(a,d,g){const x=this._firstTwoTouches;if(!x)return;a.preventDefault();const[C,M]=x,D=vc(g,d,C),O=vc(g,d,M);if(!D||!O)return;const z=this._aroundCenter?null:D.add(O).div(2);return this._move([D,O],z,a)}touchend(a,d,g){if(!this._firstTwoTouches)return;const[x,C]=this._firstTwoTouches,M=vc(g,d,x),D=vc(g,d,C);M&&D||(this._active&&_o(),this.reset())}touchcancel(){this.reset()}enable(a){this._enabled=!0,this._aroundCenter=!!a&&"center"===a.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function vc(f,a,d){for(let g=0;g<f.length;g++)if(f[g].identifier===d)return a[g]}function $u(f,a){return Math.log(f/a)/Math.LN2}class Gt extends No{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(a){this._startDistance=this._distance=a[0].dist(a[1])}_move(a,d){const g=this._distance;if(this._distance=a[0].dist(a[1]),this._active||!(Math.abs($u(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:$u(this._distance,g),pinchAround:d}}}function Gu(f,a){return 180*f.angleWith(a)/Math.PI}class xc extends No{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(a){this._startVector=this._vector=a[0].sub(a[1]),this._minDiameter=a[0].dist(a[1])}_move(a,d){const g=this._vector;if(this._vector=a[0].sub(a[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Gu(this._vector,g),pinchAround:d}}_isBelowThreshold(a){this._minDiameter=Math.min(this._minDiameter,a.mag());const d=25/(Math.PI*this._minDiameter)*360,g=Gu(a,this._startVector);return Math.abs(g)<d}}function Co(f){return Math.abs(f.y)>Math.abs(f.x)}class Hu extends No{constructor(a){super(),this._map=a}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(a){this._lastPoints=a,Co(a[0].sub(a[1]))&&(this._valid=!1)}_move(a,d,g){const x=this._lastPoints;if(!x)return;const C=a[0].sub(x[0]),M=a[1].sub(x[1]);return this._map._cooperativeGestures&&g.touches.length<3||(this._valid=this.gestureBeginsVertically(C,M,g.timeStamp),!this._valid)?void 0:(this._lastPoints=a,this._active=!0,{pitchDelta:(C.y+M.y)/2*-.5})}gestureBeginsVertically(a,d,g){if(void 0!==this._valid)return this._valid;const x=a.mag()>=2,C=d.mag()>=2;if(!x&&!C)return;if(!x||!C)return null==this._firstMove&&(this._firstMove=g),g-this._firstMove<100&&void 0;const M=a.y>0==d.y>0;return Co(a)&&Co(d)&&M}}const vt={panStep:100,bearingStep:15,pitchStep:10};class Jd{constructor(){const a=vt;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(a){if(a.altKey||a.ctrlKey||a.metaKey)return;let d=0,g=0,x=0,C=0,M=0;switch(a.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:a.shiftKey?g=-1:(a.preventDefault(),C=-1);break;case 39:a.shiftKey?g=1:(a.preventDefault(),C=1);break;case 38:a.shiftKey?x=1:(a.preventDefault(),M=-1);break;case 40:a.shiftKey?x=-1:(a.preventDefault(),M=1);break;default:return}return this._rotationDisabled&&(g=0,x=0),{cameraAnimation:D=>{const O=D.getZoom();D.easeTo({duration:300,easeId:"keyboardHandler",easing:lp,zoom:d?Math.round(O)+d*(a.shiftKey?2:1):O,bearing:D.getBearing()+g*this._bearingStep,pitch:D.getPitch()+x*this._pitchStep,offset:[-C*this._panStep,-M*this._panStep],center:D.getCenter()},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function lp(f){return f*(2-f)}const Pl=4.000244140625;class it{constructor(a,d){this._map=a,this._el=a.getCanvasContainer(),this._handler=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,p.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(a){this._defaultZoomRate=a}setWheelZoomRate(a){this._wheelZoomRate=a}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!a&&"center"===a.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(a){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(a.ctrlKey||a.metaKey||this.isZooming()||p.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let d=a.deltaMode===p.window.WheelEvent.DOM_DELTA_LINE?40*a.deltaY:a.deltaY;const g=p.exported.now(),x=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,0!==d&&d%Pl==0?this._type="wheel":0!==d&&Math.abs(d)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,a)):this._type||(this._type=Math.abs(x*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),a.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=a,this._delta-=d,this._active||this._start(a)),a.preventDefault()}_onTimeout(a){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(a)}_start(a){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=Zt(this._el,a);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:d,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const a=this._map.transform,d=()=>a._terrainEnabled()&&this._aroundCoord?a.computeZoomRelativeTo(this._aroundCoord):a.zoom;if(0!==this._delta){const O="wheel"===this._type&&Math.abs(this._delta)>Pl?this._wheelZoomRate:this._defaultZoomRate;let z=2/(1+Math.exp(-Math.abs(this._delta*O)));this._delta<0&&0!==z&&(z=1/z);const F=d(),U=Math.pow(2,F),W="number"==typeof this._targetZoom?a.zoomScale(this._targetZoom):U;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(W*z))),"wheel"===this._type&&(this._startZoom=F,this._easing=this._smoothOutEasing(200)),this._delta=0}const g="number"==typeof this._targetZoom?this._targetZoom:d(),x=this._startZoom,C=this._easing;let M,D=!1;if("wheel"===this._type&&x&&C){const O=Math.min((p.exported.now()-this._lastWheelEventTime)/200,1),z=C(O);M=p.number(x,g,z),O<1?this._frameId||(this._frameId=!0):D=!0}else M=g,D=!0;return this._active=!0,D&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!D,zoomDelta:M-d(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(a){let d=p.ease;if(this._prevEase){const g=this._prevEase,x=(p.exported.now()-g.start)/g.duration,C=g.easing(x+.01)-g.easing(x),M=.27/Math.sqrt(C*C+1e-4)*.01,D=Math.sqrt(.0729-M*M);d=p.bezier(M,D,.25,1)}return this._prevEase={start:p.exported.now(),duration:a,easing:d},d}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Qt("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(p.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Tn{constructor(a,d){this._clickZoom=a,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class cp{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(a,d){return a.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(a.shiftKey?-1:1),around:g.unproject(d)},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fi{constructor(){this._tap=new Mr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(a,d,g){this._swipePoint||(this._tapTime&&a.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=d[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(a,d,g))}touchmove(a,d,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const x=d[0],C=x.y-this._swipePoint.y;return this._swipePoint=x,a.preventDefault(),this._active=!0,{zoomDelta:C/128}}}else this._tap.touchmove(a,d,g)}touchend(a,d,g){this._tapTime?this._swipePoint&&0===g.length&&this.reset():this._tap.touchend(a,d,g)&&(this._tapTime=a.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class eh{constructor(a,d,g){this._el=a,this._mousePan=d,this._touchPan=g}enable(a){this._inertiaOptions=a||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ol{constructor(a,d,g){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=d,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class jo{constructor(a,d,g,x){this._el=a,this._touchZoom=d,this._touchRotate=g,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(a){this._touchZoom.enable(a),this._rotationDisabled||this._touchRotate.enable(a),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ja=f=>f.zoom||f.drag||f.pitch||f.rotate;class kl extends p.Event{}class up{constructor(){this.constants=[1,1,.01],this.radius=0}setup(a,d){const g=p.sub([],d,a);this.radius=p.length(g[2]<0?p.div([],g,this.constants):[g[0],g[1],0])}projectRay(a){p.div(a,a,this.constants),p.normalize(a,a),p.mul$1(a,a,this.constants);const d=p.scale$2([],a,this.radius);if(d[2]>0){const g=p.scale$2([],[0,0,1],p.dot(d,[0,0,1])),x=p.scale$2([],p.normalize([],[d[0],d[1],0]),this.radius),C=p.add([],d,p.scale$2([],p.sub([],p.add([],x,g),d),2));d[0]=C[0],d[1]=C[1]}return d}}function Va(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class Yf{constructor(a,d){this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new _c(a),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new up,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(d),p.bindAll(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[p.window.document,"mousemove",{capture:!0}],[p.window.document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[p.window,"blur",void 0]];for(const[x,C,M]of this._listeners)x.addEventListener(C,x===p.window.document?this.handleWindowEvent:this.handleEvent,M)}destroy(){for(const[a,d,g]of this._listeners)a.removeEventListener(d,a===p.window.document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(a){const d=this._map,g=d.getCanvasContainer();this._add("mapEvent",new op(d,a));const x=d.boxZoom=new sp(d,a);this._add("boxZoom",x);const C=new ap,M=new cp;d.doubleClickZoom=new Tn(M,C),this._add("tapZoom",C),this._add("clickZoom",M);const D=new Fi;this._add("tapDragZoom",D);const O=d.touchPitch=new Hu(d);this._add("touchPitch",O);const z=new Uu(a),F=new Gi(a);d.dragRotate=new Ol(a,z,F),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",F,["mouseRotate"]);const U=new Nr(a),W=new Wf(d,a);d.dragPan=new eh(g,U,W),this._add("mousePan",U),this._add("touchPan",W,["touchZoom","touchRotate"]);const ne=new xc,K=new Gt;d.touchZoomRotate=new jo(g,K,ne,D),this._add("touchRotate",ne,["touchPan","touchZoom"]),this._add("touchZoom",K,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Ii(d));const J=d.scrollZoom=new it(d,this);this._add("scrollZoom",J,["mousePan"]);const te=d.keyboard=new Jd;this._add("keyboard",te);for(const X of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])a.interactive&&a[X]&&d[X].enable(a[X])}_add(a,d,g){this._handlers.push({handlerName:a,handler:d,allowed:g}),this._handlersById[a]=d}stop(a){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},a),this._changes=[]}}isActive(){for(const{handler:a}of this._handlers)if(a.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ja(this._eventsInProgress)||this.isZooming()}_blockedByActive(a,d,g){for(const x in a)if(x!==g&&(!d||d.indexOf(x)<0))return!0;return!1}handleWindowEvent(a){this.handleEvent(a,`${a.type}Window`)}_getMapTouches(a){const d=[];for(const g of a)this._el.contains(g.target)&&d.push(g);return d}handleEvent(a,d){this._updatingCamera=!0;const g="renderFrame"===a.type,x=g?void 0:a,C={needsRenderFrame:!1},M={},D={},O=a.touches?this._getMapTouches(a.touches):void 0,z=O?es(this._el,O):g?void 0:Zt(this._el,a);for(const{handlerName:W,handler:ne,allowed:K}of this._handlers){if(!ne.isEnabled())continue;let J;this._blockedByActive(D,K,W)?ne.reset():ne[d||a.type]&&(J=ne[d||a.type](a,z,O),this.mergeHandlerResult(C,M,J,W,x),J&&J.needsRenderFrame&&this._triggerRenderFrame()),(J||ne.isActive())&&(D[W]=ne)}const F={};for(const W in this._previousActiveHandlers)D[W]||(F[W]=x);this._previousActiveHandlers=D,(Object.keys(F).length||Va(C))&&(this._changes.push([C,M,F]),this._triggerRenderFrame()),(Object.keys(D).length||Va(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:U}=C;U&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],U(this._map))}mergeHandlerResult(a,d,g,x,C){if(!g)return;p.extend(a,g);const M={handlerName:x,originalEvent:g.originalEvent||C};void 0!==g.zoomDelta&&(d.zoom=M),void 0!==g.panDelta&&(d.drag=M),void 0!==g.pitchDelta&&(d.pitch=M),void 0!==g.bearingDelta&&(d.rotate=M)}_applyChanges(){const a={},d={},g={};for(const[x,C,M]of this._changes)x.panDelta&&(a.panDelta=(a.panDelta||new p.pointGeometry(0,0))._add(x.panDelta)),x.zoomDelta&&(a.zoomDelta=(a.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(a.bearingDelta=(a.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(a.pitchDelta=(a.pitchDelta||0)+x.pitchDelta),void 0!==x.around&&(a.around=x.around),void 0!==x.aroundCoord&&(a.aroundCoord=x.aroundCoord),void 0!==x.pinchAround&&(a.pinchAround=x.pinchAround),x.noInertia&&(a.noInertia=x.noInertia),p.extend(d,C),p.extend(g,M);this._updateMapTransform(a,d,g),this._changes=[]}_updateMapTransform(a,d,g){const x=this._map,C=x.transform,M=re=>[re.x,re.y,re.z];if((re=>{const ie=this._eventsInProgress.drag;return ie&&!this._handlersById[ie.handlerName].isActive()})()&&!Va(a)){const re=C.zoom;C.cameraElevationReference="sea",C.recenterOnTerrain(),C.cameraElevationReference="ground",re!==C.zoom&&this._map._update(!0)}if(!Va(a))return void this._fireEvents(d,g,!0);let{panDelta:D,zoomDelta:O,bearingDelta:z,pitchDelta:F,around:U,aroundCoord:W,pinchAround:ne}=a;void 0!==ne&&(U=ne),(re=>d.drag&&!this._eventsInProgress.drag)()&&U&&(this._dragOrigin=M(C.pointCoordinate3D(U)),this._trackingEllipsoid.setup(C._camera.position,this._dragOrigin)),C.cameraElevationReference="sea",x._stop(!0),U=U||x.transform.centerPoint,z&&(C.bearing+=z),F&&(C.pitch+=F),C._updateCameraState();const K=[0,0,0];if(D)if("mercator"===C.projection.name){const re=this._trackingEllipsoid.projectRay(C.screenPointToMercatorRay(U).dir),ie=this._trackingEllipsoid.projectRay(C.screenPointToMercatorRay(U.sub(D)).dir);K[0]=ie[0]-re[0],K[1]=ie[1]-re[1]}else{const re=C.pointCoordinate(U);if("globe"===C.projection.name){D=D.rotate(-C.angle);const ie=C._pixelsPerMercatorPixel/C.worldSize;K[0]=-D.x*p.mercatorScale(p.latFromMercatorY(re.y))*ie,K[1]=-D.y*p.mercatorScale(C.center.lat)*ie}else{const ie=C.pointCoordinate(U.sub(D));re&&ie&&(K[0]=ie.x-re.x,K[1]=ie.y-re.y)}}const J=C.zoom,te=[0,0,0];if(O){const re=M(W||C.pointCoordinate3D(U)),ie={dir:p.normalize([],p.sub([],re,C._camera.position))};if(ie.dir[2]<0){const xe=C.zoomDeltaToMovement(re,O);p.scale$2(te,ie.dir,xe)}}const X=p.add(K,K,te);C._translateCameraConstrained(X),O&&Math.abs(C.zoom-J)>1e-4&&C.recenterOnTerrain(),C.cameraElevationReference="ground",this._map._update(),a.noInertia||this._inertia.record(a),this._fireEvents(d,g,!0)}_fireEvents(a,d,g){const x=ja(this._eventsInProgress),C=ja(a),M={};for(const F in a){const{originalEvent:U}=a[F];this._eventsInProgress[F]||(M[`${F}start`]=U),this._eventsInProgress[F]=a[F]}!x&&C&&this._fireEvent("movestart",C.originalEvent);for(const F in M)this._fireEvent(F,M[F]);C&&this._fireEvent("move",C.originalEvent);for(const F in a){const{originalEvent:U}=a[F];this._fireEvent(F,U)}const D={};let O;for(const F in this._eventsInProgress){const{handlerName:U,originalEvent:W}=this._eventsInProgress[F];this._handlersById[U].isActive()||(delete this._eventsInProgress[F],O=d[U]||W,D[`${F}end`]=O)}for(const F in D)this._fireEvent(F,D[F]);const z=ja(this._eventsInProgress);if(g&&(x||C)&&!z){this._updatingCamera=!0;const F=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),U=W=>0!==W&&-this._bearingSnap<W&&W<this._bearingSnap;F?(U(F.bearing||this._map.getBearing())&&(F.bearing=0),this._map.easeTo(F,{originalEvent:O})):(this._map.fire(new p.Event("moveend",{originalEvent:O})),U(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(a,d){this._map.fire(new p.Event(a,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(a=>{this._frameId=void 0,this.handleEvent(new kl("renderFrame",{timeStamp:a})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Rl="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class pr extends p.Evented{constructor(a,d){super(),this._moving=!1,this._zooming=!1,this.transform=a,this._bearingSnap=d.bearingSnap,p.bindAll(["_renderFrameCallback"],this)}getCenter(){return new p.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(a,d){return this.jumpTo({center:a},d)}panBy(a,d,g){return a=p.pointGeometry.convert(a).mult(-1),this.panTo(this.transform.center,p.extend({offset:a},d),g)}panTo(a,d,g){return this.easeTo(p.extend({center:a},d),g)}getZoom(){return this.transform.zoom}setZoom(a,d){return this.jumpTo({zoom:a},d),this}zoomTo(a,d,g){return this.easeTo(p.extend({zoom:a},d),g)}zoomIn(a,d){return this.zoomTo(this.getZoom()+1,a,d),this}zoomOut(a,d){return this.zoomTo(this.getZoom()-1,a,d),this}getBearing(){return this.transform.bearing}setBearing(a,d){return this.jumpTo({bearing:a},d),this}getPadding(){return this.transform.padding}setPadding(a,d){return this.jumpTo({padding:a},d),this}rotateTo(a,d,g){return this.easeTo(p.extend({bearing:a},d),g)}resetNorth(a,d){return this.rotateTo(0,p.extend({duration:1e3},a),d),this}resetNorthPitch(a,d){return this.easeTo(p.extend({bearing:0,pitch:0,duration:1e3},a),d),this}snapToNorth(a,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,d):this}getPitch(){return this.transform.pitch}setPitch(a,d){return this.jumpTo({pitch:a},d),this}cameraForBounds(a,d){"globe"===this.transform.projection.name&&p.warnOnce('Globe projection does not support cameraForBounds API, this API may behave unexpectedly."'),a=p.LngLatBounds.convert(a);const g=d&&d.bearing||0;return this._cameraForBoxAndBearing(a.getNorthWest(),a.getSouthEast(),g,d)}_extendCameraOptions(a){const d={top:0,bottom:0,right:0,left:0};if("number"==typeof(a=p.extend({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},a)).padding){const g=a.padding;a.padding={top:g,bottom:g,right:g,left:g}}return a.padding=p.extend(d,a.padding),a}_cameraForBoxAndBearing(a,d,g,x){const C=this._extendCameraOptions(x),M=this.transform,D=M.padding,O=M.project(p.LngLat.convert(a)),z=M.project(p.LngLat.convert(d)),F=new p.pointGeometry(O.x,z.y),U=new p.pointGeometry(z.x,O.y),W=-p.degToRad(g),ne=O.rotate(W),K=z.rotate(W),J=F.rotate(W),te=U.rotate(W),X=new p.pointGeometry(Math.max(ne.x,K.x,J.x,te.x),Math.max(ne.y,K.y,J.y,te.y)),re=new p.pointGeometry(Math.min(ne.x,K.x,J.x,te.x),Math.min(ne.y,K.y,J.y,te.y)),ie=X.sub(re),xe=(M.width-((D.left||0)+(D.right||0)+C.padding.left+C.padding.right))/ie.x,ge=(M.height-((D.top||0)+(D.bottom||0)+C.padding.top+C.padding.bottom))/ie.y;if(ge<0||xe<0)return void p.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const pe=Math.min(M.scaleZoom(M.scale*Math.min(xe,ge)),C.maxZoom),ve="number"==typeof C.offset.x&&"number"==typeof C.offset.y?new p.pointGeometry(C.offset.x,C.offset.y):p.pointGeometry.convert(C.offset),_e=new p.pointGeometry((C.padding.left-C.padding.right)/2,(C.padding.top-C.padding.bottom)/2).rotate(g*Math.PI/180),Ce=ve.add(_e).mult(M.scale/M.zoomScale(pe));return{center:M.unproject(O.add(z).div(2).sub(Ce)),zoom:pe,bearing:g}}_cameraForBox(a,d,g,x,C){const M=this._extendCameraOptions(C);g=g||0,x=x||0,a=p.LngLat.convert(a),d=p.LngLat.convert(d);const D=this.transform.clone();D.padding=M.padding;const O=this.getFreeCameraOptions(),z=new p.LngLat(.5*(a.lng+d.lng),.5*(a.lat+d.lat)),F=.5*(g+x);if(D._camera.position[2]<p.mercatorZfromAltitude(F,z.lat))return void p.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");O.lookAtPoint(z),D.setFreeCameraOptions(O);const U=p.MercatorCoordinate.fromLngLat(a),W=p.MercatorCoordinate.fromLngLat(d),ne=D.pointRayIntersection(D.centerPoint,F),K=[(J=D.rayIntersectionCoordinate(ne)).x,J.y,J.z];var J;const te=D.screenPointToMercatorRay(D.centerPoint),X="globe"!==D.projection.name;let re,ie=0;do{const xe=Math.floor(D.zoom),ge=1<<xe,pe=Math.min(ge*U.x,ge*W.x),ve=Math.min(ge*U.y,ge*W.y),_e=Math.max(ge*U.x,ge*W.x),Ce=Math.max(ge*U.y,ge*W.y),Se=new p.Aabb([pe,ve,g],[_e,Ce,x]),Je=p.Frustum.fromInvProjectionMatrix(D.invProjMatrix,D.worldSize,xe,X);if(2!==Se.intersects(Je)){re&&(D._camera.position=p.scaleAndAdd([],D._camera.position,te.dir,-re),D._updateStateFromCamera());break}const Ee=p.sub([],D._camera.position,K);re=.5*p.length(Ee),D._camera.position=p.scaleAndAdd([],D._camera.position,te.dir,re);try{D._updateStateFromCamera()}catch(je){return void p.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++ie<10);return{center:D.center,zoom:D.zoom,bearing:D.bearing,pitch:D.pitch}}fitBounds(a,d,g){return"globe"===this.transform.projection.name&&p.warnOnce("Globe projection does not support fitBounds API, this API may behave unexpectedly."),this._fitInternal(this.cameraForBounds(a,d),d,g)}_raycastElevationBox(a,d){const g=this.transform.elevation;if(!g)return;const x=new p.pointGeometry(a.x,d.y),C=new p.pointGeometry(d.x,a.y),M=g.pointCoordinate(a);if(!M)return;const D=g.pointCoordinate(d);if(!D)return;const O=g.pointCoordinate(x);if(!O)return;const z=g.pointCoordinate(C);if(!z)return;const F=new p.MercatorCoordinate(M[0],M[1]).toLngLat(),U=new p.MercatorCoordinate(D[0],D[1]).toLngLat(),W=new p.MercatorCoordinate(O[0],O[1]).toLngLat(),ne=new p.MercatorCoordinate(z[0],z[1]).toLngLat(),K=Math.min(F.lng,Math.min(U.lng,Math.min(W.lng,ne.lng))),J=Math.min(F.lat,Math.min(U.lat,Math.min(W.lat,ne.lat))),te=Math.max(F.lng,Math.max(U.lng,Math.max(W.lng,ne.lng))),X=Math.max(F.lat,Math.max(U.lat,Math.max(W.lat,ne.lat))),re=Math.min(M[3],Math.min(D[3],Math.min(O[3],z[3]))),ie=Math.max(M[3],Math.max(D[3],Math.max(O[3],z[3])));return{minLngLat:new p.LngLat(K,J),maxLngLat:new p.LngLat(te,X),minAltitude:re,maxAltitude:ie}}fitScreenCoordinates(a,d,g,x,C){let M,D,O,z;"globe"===this.transform.projection.name&&p.warnOnce("Globe projection does not support fitScreenCoordinates API, this API may behave unexpectedly.");const F=p.pointGeometry.convert(a),U=p.pointGeometry.convert(d),W=this._raycastElevationBox(F,U);if(W)M=W.minLngLat,D=W.maxLngLat,O=W.minAltitude,z=W.maxAltitude;else{if(this.transform.anyCornerOffEdge(F,U))return this;M=this.transform.pointLocation(F),D=this.transform.pointLocation(U)}return this._fitInternal(0===this.transform.pitch?this._cameraForBoxAndBearing(this.transform.pointLocation(p.pointGeometry.convert(a)),this.transform.pointLocation(p.pointGeometry.convert(d)),g,x):this._cameraForBox(M,D,O,z,x),x,C)}_fitInternal(a,d,g){return a?(delete(d=p.extend(a,d)).padding,d.linear?this.easeTo(d,g):this.flyTo(d,g)):this}jumpTo(a,d){this.stop();const g=a.preloadOnly?this.transform.clone():this.transform;let x=!1,C=!1,M=!1;return"zoom"in a&&g.zoom!==+a.zoom&&(x=!0,g.zoom=+a.zoom),void 0!==a.center&&(g.center=p.LngLat.convert(a.center)),"bearing"in a&&g.bearing!==+a.bearing&&(C=!0,g.bearing=+a.bearing),"pitch"in a&&g.pitch!==+a.pitch&&(M=!0,g.pitch=+a.pitch),null==a.padding||g.isPaddingEqual(a.padding)||(g.padding=a.padding),a.preloadOnly?(this._preloadTiles(g),this):(this.fire(new p.Event("movestart",d)).fire(new p.Event("move",d)),x&&this.fire(new p.Event("zoomstart",d)).fire(new p.Event("zoom",d)).fire(new p.Event("zoomend",d)),C&&this.fire(new p.Event("rotatestart",d)).fire(new p.Event("rotate",d)).fire(new p.Event("rotateend",d)),M&&this.fire(new p.Event("pitchstart",d)).fire(new p.Event("pitch",d)).fire(new p.Event("pitchend",d)),this.fire(new p.Event("moveend",d)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||p.warnOnce(Rl),this.transform.getFreeCameraOptions()}setFreeCameraOptions(a,d){const g=this.transform;if(!g.projection.supportsFreeCamera)return p.warnOnce(Rl),this;this.stop();const x=g.zoom,C=g.pitch,M=g.bearing;g.setFreeCameraOptions(a);const D=x!==g.zoom,O=C!==g.pitch,z=M!==g.bearing;return this.fire(new p.Event("movestart",d)).fire(new p.Event("move",d)),D&&this.fire(new p.Event("zoomstart",d)).fire(new p.Event("zoom",d)).fire(new p.Event("zoomend",d)),z&&this.fire(new p.Event("rotatestart",d)).fire(new p.Event("rotate",d)).fire(new p.Event("rotateend",d)),O&&this.fire(new p.Event("pitchstart",d)).fire(new p.Event("pitch",d)).fire(new p.Event("pitchend",d)),this.fire(new p.Event("moveend",d)),this}easeTo(a,d){this._stop(!1,a.easeId),(!1===(a=p.extend({offset:[0,0],duration:500,easing:p.ease},a)).animate||!a.essential&&p.exported.prefersReducedMotion)&&(a.duration=0);const g=this.transform,x=this.getZoom(),C=this.getBearing(),M=this.getPitch(),D=this.getPadding(),O="zoom"in a?+a.zoom:x,z="bearing"in a?this._normalizeBearing(a.bearing,C):C,F="pitch"in a?+a.pitch:M,U="padding"in a?a.padding:g.padding,W=p.pointGeometry.convert(a.offset);let ne,K,J;if("globe"===g.projection.name){const Ce=p.MercatorCoordinate.fromLngLat(g.center),Se=W.rotate(-g.angle);Ce.x+=Se.x/g.worldSize,Ce.y+=Se.y/g.worldSize;const Je=Ce.toLngLat(),Ee=p.LngLat.convert(a.center||Je);this._normalizeCenter(Ee),ne=g.centerPoint.add(Se),K=new p.pointGeometry(Ce.x,Ce.y).mult(g.worldSize),J=new p.pointGeometry(p.mercatorXfromLng(Ee.lng),p.mercatorYfromLat(Ee.lat)).mult(g.worldSize).sub(K)}else{ne=g.centerPoint.add(W);const Ce=g.pointLocation(ne),Se=p.LngLat.convert(a.center||Ce);this._normalizeCenter(Se),K=g.project(Ce),J=g.project(Se).sub(K)}const te=g.zoomScale(O-x);let X,re;a.around&&(X=p.LngLat.convert(a.around),re=g.locationPoint(X));const ie=this._zooming||O!==x,xe=this._rotating||C!==z,ge=this._pitching||F!==M,pe=!g.isPaddingEqual(U),ve=Ce=>Se=>{if(ie&&(Ce.zoom=p.number(x,O,Se)),xe&&(Ce.bearing=p.number(C,z,Se)),ge&&(Ce.pitch=p.number(M,F,Se)),pe&&(Ce.interpolatePadding(D,U,Se),ne=Ce.centerPoint.add(W)),X)Ce.setLocationAtPoint(X,re);else{const Je=Ce.zoomScale(Ce.zoom-x),Ee=O>x?Math.min(2,te):Math.max(.5,te),je=Math.pow(Ee,1-Se),Ge=Ce.unproject(K.add(J.mult(Se*je)).mult(Je));Ce.setLocationAtPoint(Ce.renderWorldCopies?Ge.wrap():Ge,ne)}return a.preloadOnly||this._fireMoveEvents(d),Ce};if(a.preloadOnly){const Ce=this._emulate(ve,a.duration,g);return this._preloadTiles(Ce),this}const _e={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ie,this._rotating=xe,this._pitching=ge,this._padding=pe,this._easeId=a.easeId,this._prepareEase(d,a.noMoveStart,_e),this._ease(ve(g),Ce=>{g.recenterOnTerrain(),this._afterEase(d,Ce)},a),this}_prepareEase(a,d,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",d||g.moving||this.fire(new p.Event("movestart",a)),this._zooming&&!g.zooming&&this.fire(new p.Event("zoomstart",a)),this._rotating&&!g.rotating&&this.fire(new p.Event("rotatestart",a)),this._pitching&&!g.pitching&&this.fire(new p.Event("pitchstart",a))}_fireMoveEvents(a){this.fire(new p.Event("move",a)),this._zooming&&this.fire(new p.Event("zoom",a)),this._rotating&&this.fire(new p.Event("rotate",a)),this._pitching&&this.fire(new p.Event("pitch",a))}_afterEase(a,d){if(this._easeId&&d&&this._easeId===d)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const g=this._zooming,x=this._rotating,C=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new p.Event("zoomend",a)),x&&this.fire(new p.Event("rotateend",a)),C&&this.fire(new p.Event("pitchend",a)),this.fire(new p.Event("moveend",a))}flyTo(a,d){if(!a.essential&&p.exported.prefersReducedMotion){const ht=p.pick(a,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ht,d)}this.stop(),a=p.extend({offset:[0,0],speed:1.2,curve:1.42,easing:p.ease},a);const g=this.transform,x=this.getZoom(),C=this.getBearing(),M=this.getPitch(),D=this.getPadding(),O="zoom"in a?p.clamp(+a.zoom,g.minZoom,g.maxZoom):x,z="bearing"in a?this._normalizeBearing(a.bearing,C):C,F="pitch"in a?+a.pitch:M,U="padding"in a?a.padding:g.padding,W=g.zoomScale(O-x),ne=p.pointGeometry.convert(a.offset);let K=g.centerPoint.add(ne);const J=g.pointLocation(K),te=p.LngLat.convert(a.center||J);this._normalizeCenter(te);const X=g.project(J),re=g.project(te).sub(X);let ie=a.curve;const xe=Math.max(g.width,g.height),ge=xe/W,pe=re.mag();if("minZoom"in a){const ht=p.clamp(Math.min(a.minZoom,x,O),g.minZoom,g.maxZoom),lt=xe/g.zoomScale(ht-x);ie=Math.sqrt(lt/pe*2)}const ve=ie*ie;function _e(ht){const lt=(ge*ge-xe*xe+(ht?-1:1)*ve*ve*pe*pe)/(2*(ht?ge:xe)*ve*pe);return Math.log(Math.sqrt(lt*lt+1)-lt)}function Ce(ht){return(Math.exp(ht)-Math.exp(-ht))/2}function Se(ht){return(Math.exp(ht)+Math.exp(-ht))/2}const Je=_e(0);let Ee=function(ht){return Se(Je)/Se(Je+ie*ht)},je=function(ht){return xe*((Se(Je)*(Ce(lt=Je+ie*ht)/Se(lt))-Ce(Je))/ve)/pe;var lt},Ge=(_e(1)-Je)/ie;if(Math.abs(pe)<1e-6||!isFinite(Ge)){if(Math.abs(xe-ge)<1e-6)return this.easeTo(a,d);const ht=ge<xe?-1:1;Ge=Math.abs(Math.log(ge/xe))/ie,je=function(){return 0},Ee=function(lt){return Math.exp(ht*ie*lt)}}a.duration="duration"in a?+a.duration:1e3*Ge/("screenSpeed"in a?+a.screenSpeed/ie:+a.speed),a.maxDuration&&a.duration>a.maxDuration&&(a.duration=0);const at=C!==z,ke=F!==M,et=!g.isPaddingEqual(U),He=ht=>lt=>{const wt=lt*Ge,Lt=1/Ee(wt);ht.zoom=1===lt?O:x+ht.scaleZoom(Lt),at&&(ht.bearing=p.number(C,z,lt)),ke&&(ht.pitch=p.number(M,F,lt)),et&&(ht.interpolatePadding(D,U,lt),K=ht.centerPoint.add(ne));const jt=1===lt?te:ht.unproject(X.add(re.mult(je(wt))).mult(Lt));return ht.setLocationAtPoint(ht.renderWorldCopies?jt.wrap():jt,K),ht._updateCameraOnTerrain(),a.preloadOnly||this._fireMoveEvents(d),ht};if(a.preloadOnly){const ht=this._emulate(He,a.duration,g);return this._preloadTiles(ht),this}return this._zooming=!0,this._rotating=at,this._pitching=ke,this._padding=et,this._prepareEase(d,!1),this._ease(He(g),()=>this._afterEase(d),a),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(a,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const g=this._onEaseEnd;this._onEaseEnd=void 0,g.call(this,d)}if(!a){const g=this.handlers;g&&g.stop(!1)}return this}_ease(a,d,g){!1===g.animate||0===g.duration?(a(1),d()):(this._easeStart=p.exported.now(),this._easeOptions=g,this._onEaseFrame=a,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const a=Math.min((p.exported.now()-this._easeStart)/this._easeOptions.duration,1),d=this._onEaseFrame;d&&d(this._easeOptions.easing(a)),a<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(a,d){a=p.wrap(a,-180,180);const g=Math.abs(a-d);return Math.abs(a-360-d)<g&&(a-=360),Math.abs(a+360-d)<g&&(a+=360),a}_normalizeCenter(a){const d=this.transform;if(!d.renderWorldCopies||d.maxBounds)return;const g=a.lng-d.center.lng;a.lng+=g>180?-360:g<-180?360:0}_emulate(a,d,g){const x=Math.ceil(15*d/1e3),C=[],M=a(g.clone());for(let D=0;D<=x;D++){const O=M(D/x);C.push(O.clone())}return C}}class Vo{constructor(a={}){this.options=a,p.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(a){const d=this.options&&this.options.compact;return this._map=a,this._container=Qt("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Qt("button","mapboxgl-ctrl-attrib-button",this._container),Qt("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Qt("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),d&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===d&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(a,d){const g=this._map._getUIString(`AttributionControl.${d}`);a.setAttribute("aria-label",g),a.removeAttribute("title"),a.firstElementChild&&a.firstElementChild.setAttribute("title",g)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let a=this._editLink;a||(a=this._editLink=this._container.querySelector(".mapbox-improve-map"));const d=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||p.config.ACCESS_TOKEN}];if(a){const g=d.reduce((x,C,M)=>(C.value&&(x+=`${C.key}=${C.value}${M<d.length-1?"&":""}`),x),"?");a.href=`${p.config.FEEDBACK_URL}/${g}#${Br(this._map,!0)}`,a.rel="noopener nofollow",this._setElementTitle(a,"MapFeedback")}}_updateData(a){!a||"metadata"!==a.sourceDataType&&"visibility"!==a.sourceDataType&&"style"!==a.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let a=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const d=this._map.style._sourceCaches;for(const x in d){const C=d[x];if(C.used){const M=C.getSource();M.attribution&&a.indexOf(M.attribution)<0&&a.push(M.attribution)}}a.sort((x,C)=>x.length-C.length),a=a.filter((x,C)=>{for(let M=C+1;M<a.length;M++)if(a[M].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=[...this.options.customAttribution,...a]:a.unshift(this.options.customAttribution));const g=a.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,a.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class qu{constructor(){p.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(a){this._map=a,this._container=Qt("div","mapboxgl-ctrl");const d=Qt("a","mapboxgl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://www.mapbox.com/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(a){a&&"metadata"!==a.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const a=this._map.style._sourceCaches;if(0===Object.entries(a).length)return!0;for(const d in a){const g=a[d].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){const a=this._container.children;if(a.length){const d=a[0];this._map.getCanvasContainer().offsetWidth<250?d.classList.add("mapboxgl-compact"):d.classList.remove("mapboxgl-compact")}}}class ca{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(a){const d=++this._id;return this._queue.push({callback:a,id:d,cancelled:!1}),d}remove(a){const d=this._currentlyRunning,g=d?this._queue.concat(d):this._queue;for(const x of g)if(x.id===a)return void(x.cancelled=!0)}run(a=0){const d=this._currentlyRunning=this._queue;this._queue=[];for(const g of d)if(!g.cancelled&&(g.callback(a),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Uo(f,a,d){if(f=new p.LngLat(f.lng,f.lat),a){const g=new p.LngLat(f.lng-360,f.lat),x=new p.LngLat(f.lng+360,f.lat),C=360*Math.ceil(Math.abs(f.lng-d.center.lng)/360),M=d.locationPoint(f).distSqr(a),D=a.x<0||a.y<0||a.x>d.width||a.y>d.height;d.locationPoint(g).distSqr(a)<M&&(D||Math.abs(g.lng-d.center.lng)<C)?f=g:d.locationPoint(x).distSqr(a)<M&&(D||Math.abs(x.lng-d.center.lng)<C)&&(f=x)}for(;Math.abs(f.lng-d.center.lng)>180;){const g=d.locationPoint(f);if(g.x>=0&&g.y>=0&&g.x<=d.width&&g.y<=d.height)break;f.lng>d.center.lng?f.lng-=360:f.lng+=360}return f}const bc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class wc extends p.Evented{constructor(a,d){if(super(),(a instanceof p.window.HTMLElement||d)&&(a=p.extend({element:a},d)),p.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=a&&a.anchor||"center",this._color=a&&a.color||"#3FB1CE",this._scale=a&&a.scale||1,this._draggable=a&&a.draggable||!1,this._clickTolerance=a&&a.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=a&&a.rotation||0,this._rotationAlignment=a&&a.rotationAlignment||"auto",this._pitchAlignment=a&&a.pitchAlignment&&a.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),a&&a.element)this._element=a.element,this._offset=p.pointGeometry.convert(a&&a.offset||[0,0]);else{this._defaultMarker=!0,this._element=Qt("div");const x=41,C=27,M=Cr("svg",{display:"block",height:x*this._scale+"px",width:C*this._scale+"px",viewBox:`0 0 ${C} ${x}`},this._element),D=Cr("radialGradient",{id:"shadowGradient"},Cr("defs",{},M));Cr("stop",{offset:"10%","stop-opacity":.4},D),Cr("stop",{offset:"100%","stop-opacity":.05},D),Cr("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},M),Cr("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},M),Cr("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},M),Cr("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},M),this._offset=p.pointGeometry.convert(a&&a.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",x=>{x.preventDefault()}),this._element.addEventListener("mousedown",x=>{x.preventDefault()});const g=this._element.classList;for(const x in bc)g.remove(`mapboxgl-marker-anchor-${x}`);g.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(a){return a===this._map||(this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._updateMoving),a.on("moveend",this._update),a.on("remove",this._clearFadeTimer),a._addMarker(this),this.setDraggable(this._draggable),this._update(),a.on("click",this._onMapClick)),this}remove(){const a=this._map;return a&&(a.off("click",this._onMapClick),a.off("move",this._updateMoving),a.off("moveend",this._update),a.off("mousedown",this._addDragHandler),a.off("touchstart",this._addDragHandler),a.off("mouseup",this._onUp),a.off("touchend",this._onUp),a.off("mousemove",this._onMove),a.off("touchmove",this._onMove),a.off("remove",this._clearFadeTimer),a._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(a){return this._lngLat=p.LngLat.convert(a),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(a){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),a){if(!("offset"in a.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(24.6+x)],"bottom-right":[-x,-1*(24.6+x)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=a,a._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(a){const d=a.code,g=a.charCode||a.keyCode;"Space"!==d&&"Enter"!==d&&32!==g&&13!==g||this.togglePopup()}_onMapClick(a){const d=a.originalEvent.target,g=this._element;this._popup&&(d===g||g.contains(d))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const a=this._popup;return a?(a.isOpen()?(a.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(a.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const a=this._map;if(!a)return!1;const d=a.unproject(this._pos),g=a.getFreeCameraOptions();if(!g.position)return!1;const x=g.position.toLngLat();return x.distanceTo(d)<.9*x.distanceTo(this._lngLat)}_evaluateOpacity(){const a=this._map;if(!a)return;const d=this._pos;if(!d||d.x<0||d.x>a.transform.width||d.y<0||d.y>a.transform.height)return void this._clearFadeTimer();const g=a.unproject(d);let x;a._showingGlobe()&&p.isLngLatBehindGlobe(a.transform,this._lngLat)?x=0:(x=1-a._queryFogOpacity(g),a.transform._terrainEnabled()&&a.getTerrain()&&this._behindTerrain()&&(x*=.2)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const a=this._pos;if(!a||!this._map)return;const d=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${a.x}px,${a.y}px)\n            ${bc[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${d.x}px,${d.y}px)\n        `}_calculateXYTransform(){const a=this._pos,d=this._map,g=this.getPitchAlignment();if(!d||!a||"map"!==g)return"";if(!d._showingGlobe()){const O=d.getPitch();return O?`rotateX(${O}deg)`:""}const x=p.radToDeg(p.globeTiltAtLngLat(d.transform,this._lngLat)),C=a.sub(p.globeCenterToScreenPoint(d.transform)),M=Math.abs(C.x)+Math.abs(C.y);if(0===M)return"";const D=x/M;return`rotateX(${-C.y*D}deg) rotateY(${C.x*D}deg)`}_calculateZTransform(){const a=this._pos,d=this._map;if(!d||!a)return"";let g=0;const x=this.getRotationAlignment();if("map"===x)if(d._showingGlobe()){const C=d.project(new p.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),M=d.project(new p.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(C);g=p.radToDeg(Math.atan2(M.y,M.x))-90}else g=-d.getBearing();else if("horizon"===x){const C=p.smoothstep(4,6,d.getZoom()),M=p.globeCenterToScreenPoint(d.transform);M.y+=C*d.transform.height;const D=a.sub(M),O=p.radToDeg(Math.atan2(D.y,D.x));g=(O>90?O-270:O+90)*(1-C)}return g+=this._rotation,g?`rotateZ(${g}deg)`:""}_update(a){p.window.cancelAnimationFrame(this._updateFrameId);const d=this._map;d&&(d.transform.renderWorldCopies&&(this._lngLat=Uo(this._lngLat,this._pos,d.transform)),this._pos=d.project(this._lngLat),!0===a?this._updateFrameId=p.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),d._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(d._showingGlobe()||d.getTerrain()||d.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(a){return this._offset=p.pointGeometry.convert(a),this._update(),this}_onMove(a){const d=this._map;if(d){if(!this._isDragging){const g=this._clickTolerance||d._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=g}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=d.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new p.Event("dragstart"))),this.fire(new p.Event("drag")))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const a=this._map;a&&(a.off("mousemove",this._onMove),a.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new p.Event("dragend")),this._state="inactive"}_addDragHandler(a){const d=this._map;d&&this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos),this._pointerdownPos=a.point,this._state="pending",d.on("mousemove",this._onMove),d.on("touchmove",this._onMove),d.once("mouseup",this._onUp),d.once("touchend",this._onUp))}setDraggable(a){this._draggable=!!a;const d=this._map;return d&&(a?(d.on("mousedown",this._addDragHandler),d.on("touchstart",this._addDragHandler)):(d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(a){return this._rotation=a||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(a){return this._rotationAlignment=a||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(a){return this._pitchAlignment=a||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}}class dp{constructor(a){this.jumpTo(a)}getValue(a){if(a<=this._startTime)return this._start;if(a>=this._endTime)return this._end;const d=p.easeCubicInOut((a-this._startTime)/(this._endTime-this._startTime));return this._start*(1-d)+this._end*d}isEasing(a){return a>=this._startTime&&a<=this._endTime}jumpTo(a){this._startTime=-1/0,this._endTime=-1/0,this._start=a,this._end=a}easeTo(a,d,g){this._start=this.getValue(d),this._end=a,this._startTime=d,this._endTime=d+g}}const hp={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Zu={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function Ua(f){f.parentNode&&f.parentNode.removeChild(f)}const th={showCompass:!0,showZoom:!0,visualizePitch:!1};class Cc{constructor(a,d,g=!1){this._clickTolerance=10,this.element=d,this.mouseRotate=new Uu({clickTolerance:a.dragRotate._mouseRotate._clickTolerance}),this.map=a,g&&(this.mousePitch=new Gi({clickTolerance:a.dragRotate._mousePitch._clickTolerance})),p.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),d.addEventListener("mousedown",this.mousedown),d.addEventListener("touchstart",this.touchstart,{passive:!1}),d.addEventListener("touchmove",this.touchmove),d.addEventListener("touchend",this.touchend),d.addEventListener("touchcancel",this.reset)}down(a,d){this.mouseRotate.mousedown(a,d),this.mousePitch&&this.mousePitch.mousedown(a,d),mu()}move(a,d){const g=this.map,x=this.mouseRotate.mousemoveWindow(a,d),C=x&&x.bearingDelta;if(C&&g.setBearing(g.getBearing()+C),this.mousePitch){const M=this.mousePitch.mousemoveWindow(a,d),D=M&&M.pitchDelta;D&&g.setPitch(g.getPitch()+D)}}off(){const a=this.element;a.removeEventListener("mousedown",this.mousedown),a.removeEventListener("touchstart",this.touchstart,{passive:!1}),a.removeEventListener("touchmove",this.touchmove),a.removeEventListener("touchend",this.touchend),a.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ql(),p.window.removeEventListener("mousemove",this.mousemove),p.window.removeEventListener("mouseup",this.mouseup)}mousedown(a){this.down(p.extend({},a,{ctrlKey:!0,preventDefault:()=>a.preventDefault()}),Zt(this.element,a)),p.window.addEventListener("mousemove",this.mousemove),p.window.addEventListener("mouseup",this.mouseup)}mousemove(a){this.move(a,Zt(this.element,a))}mouseup(a){this.mouseRotate.mouseupWindow(a),this.mousePitch&&this.mousePitch.mouseupWindow(a),this.offTemp()}touchstart(a){1!==a.targetTouches.length?this.reset():(this._startPos=this._lastPos=es(this.element,a.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>a.preventDefault()},this._startPos))}touchmove(a){1!==a.targetTouches.length?this.reset():(this._lastPos=es(this.element,a.targetTouches)[0],this.move({preventDefault:()=>a.preventDefault()},this._lastPos))}touchend(a){0===a.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const pp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Wu={maxWidth:100,unit:"metric"};function Ll(f,a,d){const g=Ac(a),x=g/a,C={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[d];this._map._requestDomTask(()=>{this._container.style.width=f*x+"px",this._container.innerHTML=`${g}&nbsp;${C}`})}function Ac(f){const a=Math.pow(10,`${Math.floor(f)}`.length-1);let d=f/a;return d=d>=10?10:d>=5?5:d>=3?3:d>=2?2:d>=1?1:function(g){const x=Math.pow(10,Math.ceil(-Math.log(g)/Math.LN10));return Math.round(g*x)/x}(d),a*d}const fp={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},mp=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ec(f=new p.pointGeometry(0,0),a="bottom"){if("number"==typeof f){const d=Math.round(Math.sqrt(.5*Math.pow(f,2)));switch(a){case"top":return new p.pointGeometry(0,f);case"top-left":return new p.pointGeometry(d,d);case"top-right":return new p.pointGeometry(-d,d);case"bottom":return new p.pointGeometry(0,-f);case"bottom-left":return new p.pointGeometry(d,-d);case"bottom-right":return new p.pointGeometry(-d,-d);case"left":return new p.pointGeometry(f,0);case"right":return new p.pointGeometry(-f,0)}return new p.pointGeometry(0,0)}return f instanceof p.pointGeometry||Array.isArray(f)?p.pointGeometry.convert(f):p.pointGeometry.convert(f[a]||[0,0])}const ua={version:p.version,supported:Ws,setRTLTextPlugin:p.setRTLTextPlugin,getRTLTextPluginStatus:p.getRTLTextPluginStatus,Map:class extends pr{constructor(f){if(null!=(f=p.extend({},Zu,f)).minZoom&&null!=f.maxZoom&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=f.minPitch&&null!=f.maxPitch&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=f.minPitch&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=f.maxPitch&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(f.antialias&&p.isSafariWithAntialiasingBug(p.window)&&(f.antialias=!1,p.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new gc(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies),f),this._interactive=f.interactive,this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=f.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=f.collectResourceTiming,this._optimizeForTerrain=f.optimizeForTerrain,this._language="auto"===f.language?p.window.navigator.language:f.language,this._worldview=f.worldview,this._renderTaskQueue=new ca,this._domRenderTaskQueue=new ca,this._controls=[],this._markers=[],this._mapId=p.uniqueId(),this._locale=p.extend({},hp,f.locale),this._clickTolerance=f.clickTolerance,this._cooperativeGestures=f.cooperativeGestures,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new dp(0),this._useExplicitProjection=!1,this._requestManager=new p.RequestManager(f.transformRequest,f.accessToken,f.testMode),this._silenceAuthErrors=!!f.testMode,"string"==typeof f.container){if(this._container=p.window.document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof p.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(this._container.childNodes.length>0&&p.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),f.maxBounds&&this.setMaxBounds(f.maxBounds),p.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==p.window&&(p.window.addEventListener("online",this._onWindowOnline,!1),p.window.addEventListener("resize",this._onWindowResize,!1),p.window.addEventListener("orientationchange",this._onWindowResize,!1),p.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new Yf(this,f),this._localFontFamily=f.localFontFamily,this._localIdeographFontFamily=f.localIdeographFontFamily,f.style&&this.setStyle(f.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),f.projection&&this.setProjection(f.projection),this._hash=f.hash&&new ip("string"==typeof f.hash&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,p.extend({},f.fitBoundsOptions,{duration:0})))),this.resize(),f.attributionControl&&this.addControl(new Vo({customAttribution:f.customAttribution})),this._logoControl=new qu,this.addControl(this._logoControl,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update("style"===a.dataType),this.fire(new p.Event(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new p.Event(`${a.dataType}dataloading`,a))})}_getMapId(){return this._mapId}addControl(f,a){if(void 0===a&&(a=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new p.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=f.onAdd(this);this._controls.push(f);const g=this._controlPositions[a];return-1!==a.indexOf("bottom")?g.insertBefore(d,g.firstChild):g.appendChild(d),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new p.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const a=this._controls.indexOf(f);return a>-1&&this._controls.splice(a,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(f){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const a=!this._moving;return a&&this.fire(new p.Event("movestart",f)).fire(new p.Event("move",f)),this.fire(new p.Event("resize",f)),a&&this.fire(new p.Event("moveend",f)),this}getBounds(){return"globe"===this.transform.projection.name&&p.warnOnce('Globe projection does not support getBounds API, this API may behave unexpectedly."'),this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(f){return this.transform.setMaxBounds(p.LngLatBounds.convert(f)),this._update()}setMinZoom(f){if((f=null==f?-2:f)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f?this.setZoom(f):this.fire(new p.Event("zoomstart")).fire(new p.Event("zoom")).fire(new p.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=null==f?22:f)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f?this.setZoom(f):this.fire(new p.Event("zoomstart")).fire(new p.Event("zoom")).fire(new p.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=null==f?0:f)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f?this.setPitch(f):this.fire(new p.Event("pitchstart")).fire(new p.Event("pitch")).fire(new p.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=null==f?85:f)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f?this.setPitch(f):this.fire(new p.Event("pitchstart")).fire(new p.Event("pitch")).fire(new p.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this._update()}getLanguage(){return this._language}setLanguage(f){if(this._language="auto"===f?p.window.navigator.language:f,this.style)for(const a in this.style._sourceCaches){const d=this.style._sourceCaches[a]._source;d._setLanguage&&d._setLanguage(this._language)}for(const a of this._controls)a._setLanguage&&a._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(f){if(this._worldview=f,this.style)for(const a in this.style._sourceCaches){const d=this.style._sourceCaches[a]._source;d._setWorldview&&d._setWorldview(f)}return this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(f){return this._lazyInitEmptyStyle(),f?"string"==typeof f&&(f={name:f}):f=null,this._useExplicitProjection=!!f,this._prioritizeAndUpdateProjection(f,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const f=this.transform,a=f.projection.name;let d;"globe"===a&&f.zoom>=p.GLOBE_ZOOM_THRESHOLD_MAX?(f.setMercatorFromTransition(),d=!0):"mercator"===a&&f.zoom<p.GLOBE_ZOOM_THRESHOLD_MAX&&(f.setProjection({name:"globe"}),d=!0),d&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(f,a){return this._updateProjection(f||a||{name:"mercator"})}_updateProjection(f){let a;if(a="globe"===f.name&&this.transform.zoom>=p.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(f),this.style.applyProjectionUpdate(),a){this.painter.clearBackgroundTiles();for(const d in this.style._sourceCaches)this.style._sourceCaches[d].clearTiles();this._update(!0)}return this}project(f){return this.transform.locationPoint3D(p.LngLat.convert(f))}unproject(f){return this.transform.pointLocation3D(p.pointGeometry.convert(f))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_createDelegatedListener(f,a,d){if("mouseenter"===f||"mouseover"===f){let g=!1;const x=M=>{const D=a.filter(z=>this.getLayer(z)),O=D.length?this.queryRenderedFeatures(M.point,{layers:D}):[];O.length?g||(g=!0,d.call(this,new Tr(f,this,M.originalEvent,{features:O}))):g=!1},C=()=>{g=!1};return{layers:new Set(a),listener:d,delegates:{mousemove:x,mouseout:C}}}if("mouseleave"===f||"mouseout"===f){let g=!1;const x=M=>{const D=a.filter(O=>this.getLayer(O));(D.length?this.queryRenderedFeatures(M.point,{layers:D}):[]).length?g=!0:g&&(g=!1,d.call(this,new Tr(f,this,M.originalEvent)))},C=M=>{g&&(g=!1,d.call(this,new Tr(f,this,M.originalEvent)))};return{layers:new Set(a),listener:d,delegates:{mousemove:x,mouseout:C}}}{const g=x=>{const C=a.filter(D=>this.getLayer(D)),M=C.length?this.queryRenderedFeatures(x.point,{layers:C}):[];M.length&&(x.features=M,d.call(this,x),delete x.features)};return{layers:new Set(a),listener:d,delegates:{[f]:g}}}}on(f,a,d){if(void 0===d)return super.on(f,a);Array.isArray(a)||(a=[a]);const g=this._createDelegatedListener(f,a,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(g);for(const x in g.delegates)this.on(x,g.delegates[x]);return this}once(f,a,d){if(void 0===d)return super.once(f,a);Array.isArray(a)||(a=[a]);const g=this._createDelegatedListener(f,a,d);for(const x in g.delegates)this.once(x,g.delegates[x]);return this}off(f,a,d){if(void 0===d)return super.off(f,a);a=new Set(Array.isArray(a)?a:[a]);const g=(C,M)=>{if(C.size!==M.size)return!1;for(const D of C)if(!M.has(D))return!1;return!0},x=this._delegatedListeners?this._delegatedListeners[f]:void 0;return x&&(C=>{for(let M=0;M<C.length;M++){const D=C[M];if(D.listener===d&&g(D.layers,a)){for(const O in D.delegates)this.off(O,D.delegates[O]);return C.splice(M,1),this}}})(x),this}queryRenderedFeatures(f,a){return this.style?(void 0!==a||void 0===f||f instanceof p.pointGeometry||Array.isArray(f)||(a=f,f=void 0),this.style.queryRenderedFeatures(f=f||[[0,0],[this.transform.width,this.transform.height]],a=a||{},this.transform)):[]}querySourceFeatures(f,a){return this.style.querySourceFeatures(f,a)}queryTerrainElevation(f,a){const d=this.transform.elevation;return d?(a=p.extend({},{exaggerated:!0},a),d.getAtPoint(p.MercatorCoordinate.fromLngLat(f),null,a.exaggerated)):null}setStyle(f,a){return!1!==(a=p.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},a)).diff&&a.localIdeographFontFamily===this._localIdeographFontFamily&&a.localFontFamily===this._localFontFamily&&this.style&&f?(this._diffStyle(f,a),this):(this._localIdeographFontFamily=a.localIdeographFontFamily,this._localFontFamily=a.localFontFamily,this._updateStyle(f,a))}_getUIString(f){const a=this._locale[f];if(null==a)throw new Error(`Missing UI string '${f}'`);return a}_updateStyle(f,a){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),f&&(this.style=new eo(this,a||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof f?this.style.loadURL(f):this.style.loadJSON(f)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new eo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,a){if("string"==typeof f){const d=this._requestManager.normalizeStyleURL(f),g=this._requestManager.transformRequest(d,p.ResourceType.Style);p.getJSON(g,(x,C)=>{x?this.fire(new p.ErrorEvent(x)):C&&this._updateDiff(C,a)})}else"object"==typeof f&&this._updateDiff(f,a)}_updateDiff(f,a){try{this.style.setState(f)&&this._update(!0)}catch(d){p.warnOnce(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(f,a)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(p.warnOnce("There is no style added to the map."),!1)}addSource(f,a){return this._lazyInitEmptyStyle(),this.style.addSource(f,a),this._update(!0)}isSourceLoaded(f){return!!this.style&&this.style._isSourceCacheLoaded(f)}areTilesLoaded(){const f=this.style&&this.style._sourceCaches;for(const a in f){const d=f[a]._tiles;for(const g in d){const x=d[g];if("loaded"!==x.state&&"errored"!==x.state)return!1}}return!0}addSourceType(f,a,d){this._lazyInitEmptyStyle(),this.style.addSourceType(f,a,d)}removeSource(f){return this.style.removeSource(f),this._updateTerrain(),this._update(!0)}getSource(f){return this.style.getSource(f)}addImage(f,a,{pixelRatio:d=1,sdf:g=!1,stretchX:x,stretchY:C,content:M}={}){if(this._lazyInitEmptyStyle(),a instanceof p.window.HTMLImageElement||p.window.ImageBitmap&&a instanceof p.window.ImageBitmap){const{width:D,height:O,data:z}=p.exported.getImageData(a);this.style.addImage(f,{data:new p.RGBAImage({width:D,height:O},z),pixelRatio:d,stretchX:x,stretchY:C,content:M,sdf:g,version:0})}else if(void 0===a.width||void 0===a.height)this.fire(new p.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:D,height:O}=a,z=a;this.style.addImage(f,{data:new p.RGBAImage({width:D,height:O},new Uint8Array(z.data)),pixelRatio:d,stretchX:x,stretchY:C,content:M,sdf:g,version:0,userImage:z}),z.onAdd&&z.onAdd(this,f)}}updateImage(f,a){const d=this.style.getImage(f);if(!d)return void this.fire(new p.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=a instanceof p.window.HTMLImageElement||p.window.ImageBitmap&&a instanceof p.window.ImageBitmap?p.exported.getImageData(a):a,{width:x,height:C}=g;void 0!==x&&void 0!==C?x===d.data.width&&C===d.data.height?(d.data.replace(g.data,!(a instanceof p.window.HTMLImageElement||p.window.ImageBitmap&&a instanceof p.window.ImageBitmap)),this.style.updateImage(f,d)):this.fire(new p.ErrorEvent(new Error(`The width and height of the updated image (${x}, ${C})\n                must be that same as the previous version of the image\n                (${d.data.width}, ${d.data.height})`))):this.fire(new p.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new p.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f,a){p.getImage(this._requestManager.transformRequest(f,p.ResourceType.Image),(d,g)=>{a(d,g instanceof p.window.HTMLImageElement?p.exported.getImageData(g):g)})}listImages(){return this.style.listImages()}addLayer(f,a){return this._lazyInitEmptyStyle(),this.style.addLayer(f,a),this._update(!0)}moveLayer(f,a){return this.style.moveLayer(f,a),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}setLayerZoomRange(f,a,d){return this.style.setLayerZoomRange(f,a,d),this._update(!0)}setFilter(f,a,d={}){return this.style.setFilter(f,a,d),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,a,d,g={}){return this.style.setPaintProperty(f,a,d,g),this._update(!0)}getPaintProperty(f,a){return this.style.getPaintProperty(f,a)}setLayoutProperty(f,a,d,g={}){return this.style.setLayoutProperty(f,a,d,g),this._update(!0)}getLayoutProperty(f,a){return this.style.getLayoutProperty(f,a)}setLight(f,a={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,a),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(f){return this._lazyInitEmptyStyle(),!f&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(f),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(f){return this._lazyInitEmptyStyle(),this.style.setFog(f),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(f){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(p.LngLat.convert(f),this.transform):0}setFeatureState(f,a){return this.style.setFeatureState(f,a),this._update()}removeFeatureState(f,a){return this.style.removeFeatureState(f,a),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}_updateContainerDimensions(){if(!this._container)return;const f=this._container.getBoundingClientRect().width||400,a=this._container.getBoundingClientRect().height||300;let d,g,x,C=this._container;for(;C&&(!g||!x);){const M=p.window.getComputedStyle(C).transform;M&&"none"!==M&&(d=M.match(/matrix.*\((.+)\)/)[1].split(", "),d[0]&&"0"!==d[0]&&"1"!==d[0]&&(g=d[0]),d[3]&&"0"!==d[3]&&"1"!==d[3]&&(x=d[3])),C=C.parentElement}this._containerWidth=g?Math.abs(f/g):f,this._containerHeight=x?Math.abs(a/x):a}_detectMissingCSS(){"rgb(250, 128, 114)"!==p.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&p.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const f=this._container;f.classList.add("mapboxgl-map"),(this._missingCSSCanary=Qt("div","mapboxgl-canary",f)).style.visibility="hidden",this._detectMissingCSS();const a=this._canvasContainer=Qt("div","mapboxgl-canvas-container",f);this._interactive&&a.classList.add("mapboxgl-interactive"),this._canvas=Qt("canvas","mapboxgl-canvas",a),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const d=this._controlContainer=Qt("div","mapboxgl-control-container",f),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{g[x]=Qt("div",`mapboxgl-ctrl-${x}`,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,a){const d=p.exported.devicePixelRatio||1;this._canvas.width=d*Math.ceil(f),this._canvas.height=d*Math.ceil(a),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${a}px`}_addMarker(f){this._markers.push(f)}_removeMarker(f){const a=this._markers.indexOf(f);-1!==a&&this._markers.splice(a,1)}_setupPainter(){const f=p.extend({},Ws.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),a=this._canvas.getContext("webgl",f)||this._canvas.getContext("experimental-webgl",f);a?(p.storeAuthState(a,!0),this.painter=new Fu(a,this.transform),this.on("data",d=>{"source"===d.dataType&&this.painter.setTileLoadedFlag(!0)}),p.exported$1.testSupport(a)):this.fire(new p.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(f){f.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new p.Event("webglcontextlost",{originalEvent:f}))}_contextRestored(f){this._setupPainter(),this.resize(),this._update(),this.fire(new p.Event("webglcontextrestored",{originalEvent:f}))}_onMapScroll(f){if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_requestDomTask(f){!this.loaded()||this.loaded()&&!this.isMoving()?f():this._domRenderTaskQueue.add(f)}_render(f){let a;const d=this.painter.context.extTimerQuery,g=p.exported.now();if(this.listens("gpu-timing-frame")&&(a=d.createQueryEXT(),d.beginQueryEXT(d.TIME_ELAPSED_EXT,a)),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(f),this._domRenderTaskQueue.run(f),this._removed)return;this._updateProjectionTransition();let x=!1;const C=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,z=this.transform.pitch,F=p.exported.now();this.style.zoomHistory.update(O,F);const U=new p.EvaluationParameters(O,{now:F,fadeDuration:C,pitch:z,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),W=U.crossFadingFactor();1===W&&W===this._crossFadingFactor||(x=!0,this._crossFadingFactor=W),this.style.update(U)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let M=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),M=this._updateAverageElevation(g),this.style._updateSources(this.transform),this._forceMarkerUpdate()):M=this._updateAverageElevation(g),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,C,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:C,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new p.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new p.Event("load"))),this.style&&(this.style.hasTransitions()||x)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),a){const O=p.exported.now()-g;d.endQueryEXT(d.TIME_ELAPSED_EXT,a),setTimeout(()=>{const z=d.getQueryObjectEXT(a,d.QUERY_RESULT_EXT)/1e6;d.deleteQueryEXT(a),this.fire(new p.Event("gpu-timing-frame",{cpuTime:O,gpuTime:z})),p.window.performance.mark("frame-gpu",{startTime:g,detail:{gpuTime:z}})},50)}if(this.listens("gpu-timing-layer")){const O=this.painter.collectGpuTimers();setTimeout(()=>{const z=this.painter.queryGpuTimers(O);this.fire(new p.Event("gpu-timing-layer",{layerTimes:z}))},50)}if(this.listens("gpu-timing-deferred-render")){const O=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const z=this.painter.queryGpuTimeDeferredRender(O);this.fire(new p.Event("gpu-timing-deferred-render",{gpuTime:z}))},50)}const D=this._sourcesDirty||this._styleDirty||this._placementDirty||M;if(D||this._repaint)this.triggerRepaint();else{const O=!this.isMoving()&&this.loaded();if(O&&(M=this._updateAverageElevation(g,!0)),M)this.triggerRepaint();else if(this._triggerFrame(!1),O&&(this.fire(new p.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const z=this._calculateSpeedIndex();this.fire(new p.Event("speedindexcompleted",{speedIndex:z})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||D||(this._fullyLoaded=!0,this._authenticate())}_forceMarkerUpdate(){for(const f of this._markers)f._update()}_updateAverageElevation(f,a=!1){const d=g=>(this.transform.averageElevation=g,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&d(0);if((a||f-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(f)){const g=this.transform.averageElevation;let x=this.transform.sampleAverageElevation(),C=!1;this.transform.elevation&&(C=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(x)?x=0:this._averageElevationLastSampledAt=f;const M=Math.abs(g-x);if(M>1){if(this._isInitialLoad||C)return this._averageElevation.jumpTo(x),d(x);this._averageElevation.easeTo(x,f,300)}else if(M>1e-4)return this._averageElevation.jumpTo(x),d(x)}return!!this._averageElevation.isEasing(f)&&d(this._averageElevation.getValue(f))}_authenticate(){p.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,f=>{if(f&&(f.message===p.AUTH_ERR_MSG||401===f.status)){const a=this.painter.context.gl;p.storeAuthState(a,!1),this._logoControl instanceof qu&&this._logoControl._updateLogo(),a&&a.clear(a.DEPTH_BUFFER_BIT|a.COLOR_BUFFER_BIT|a.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new p.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),p.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const f=this.painter.canvasCopy(),a=this.painter.getCanvasCopiesAndTimestamps();a.timeStamps.push(performance.now());const d=this.painter.context.gl,g=d.createFramebuffer();function x(C){d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,C,0);const M=new Uint8Array(d.drawingBufferWidth*d.drawingBufferHeight*4);return d.readPixels(0,0,d.drawingBufferWidth,d.drawingBufferHeight,d.RGBA,d.UNSIGNED_BYTE,M),M}return d.bindFramebuffer(d.FRAMEBUFFER,g),this._canvasPixelComparison(x(f),a.canvasCopies.map(x),a.timeStamps)}_canvasPixelComparison(f,a,d){let g=d[1]-d[0];const x=f.length/4;for(let C=0;C<a.length;C++){const M=a[C];let D=0;for(let O=0;O<M.length;O+=4)M[O]===f[O]&&M[O+1]===f[O+1]&&M[O+2]===f[O+2]&&M[O+3]===f[O+3]&&(D+=1);g+=(d[C+2]-d[C+1])*(1-D/x)}return g}remove(){this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==p.window&&(p.window.removeEventListener("resize",this._onWindowResize,!1),p.window.removeEventListener("orientationchange",this._onWindowResize,!1),p.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),p.window.removeEventListener("online",this._onWindowOnline,!1));const f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),Ua(this._canvasContainer),Ua(this._controlContainer),Ua(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),p.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new p.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(f){this._renderNextFrame=this._renderNextFrame||f,this.style&&!this._frame&&(this._frame=p.exported.frame(a=>{const d=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,d&&this._render(a)}))}_preloadTiles(f){const a=this.style?Object.values(this.style._sourceCaches):[];return p.asyncAll(a,(d,g)=>d._preloadTiles(f,g),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(f){this._trackResize&&this.resize({originalEvent:f})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(f){this._showTerrainWireframe!==f&&(this._showTerrainWireframe=f,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(f){this._speedIndexTiming!==f&&(this._speedIndexTiming=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}_setCacheLimits(f,a){p.setCacheLimits(f,a)}get version(){return p.version}},NavigationControl:class{constructor(f){this.options=p.extend({},th,f),this._container=Qt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",a=>a.preventDefault()),this.options.showZoom&&(p.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",a=>{this._map&&this._map.zoomIn({},{originalEvent:a})}),Qt("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",a=>{this._map&&this._map.zoomOut({},{originalEvent:a})}),Qt("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(p.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",a=>{const d=this._map;d&&(this.options.visualizePitch?d.resetNorthPitch({},{originalEvent:a}):d.resetNorth({},{originalEvent:a}))}),this._compassIcon=Qt("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const f=this._map;if(!f)return;const a=f.getZoom(),d=a===f.getMaxZoom(),g=a===f.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){const f=this._map;if(!f)return;const a=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(f.transform.pitch*(Math.PI/180)),.5)}) rotateX(${f.transform.pitch}deg) rotateZ(${f.transform.angle*(180/Math.PI)}deg)`:`rotate(${f.transform.angle*(180/Math.PI)}deg)`;f._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=a)})}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),f.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&f.on("pitch",this._rotateCompassArrow),f.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Cc(f,this._compass,this.options.visualizePitch)),this._container}onRemove(){const f=this._map;f&&(this._container.remove(),this.options.showZoom&&f.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&f.off("pitch",this._rotateCompassArrow),f.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(f,a){const d=Qt("button",f,this._container);return d.type="button",d.addEventListener("click",a),d}_setButtonTitle(f,a){if(!this._map)return;const d=this._map._getUIString(`NavigationControl.${a}`);f.setAttribute("aria-label",d),f.firstElementChild&&f.firstElementChild.setAttribute("title",d)}},GeolocateControl:class extends p.Evented{constructor(f){super(),this.options=p.extend({geolocation:p.window.navigator.geolocation},pp,f),p.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Ba(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(f){return this._map=f,this._container=Qt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(f){void 0!==this._supportsGeolocation?f(this._supportsGeolocation):void 0!==p.window.navigator.permissions?p.window.navigator.permissions.query({name:"geolocation"}).then(a=>{this._supportsGeolocation="denied"!==a.state,f(this._supportsGeolocation)}):(this._supportsGeolocation=!!this.options.geolocation,f(this._supportsGeolocation))}_isOutOfMapMaxBounds(f){const a=this._map.getMaxBounds(),d=f.coords;return!!a&&(d.longitude<a.getWest()||d.longitude>a.getEast()||d.latitude<a.getSouth()||d.latitude>a.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new p.Event("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(f),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(f),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new p.Event("geolocate",f)),this._finish()}}_updateCamera(f){const a=new p.LngLat(f.coords.longitude,f.coords.latitude),d=f.coords.accuracy,g=this._map.getBearing(),x=p.extend({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(a.toBounds(d),x,{geolocateSource:!0})}_updateMarker(f){if(f){const a=new p.LngLat(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const f=this._map.transform,a=p.mercatorZfromAltitude(1,f._center.lat)*f.worldSize,d=Math.ceil(2*this._accuracy*a);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(f){if(this._map){if(this.options.trackUserLocation)if(1===f.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===f.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new p.Event("error",f)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(f){if(this._container.addEventListener("contextmenu",a=>a.preventDefault()),this._geolocateButton=Qt("button","mapboxgl-ctrl-geolocate",this._container),Qt("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===f){p.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Qt("div","mapboxgl-user-location"),this._dotElement.appendChild(Qt("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Qt("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new wc({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Qt("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new wc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||"ACTIVE_LOCK"!==this._watchState||a.originalEvent&&"resize"===a.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new p.Event("trackuserlocationend")))})}_onDeviceOrientation(f){this._userLocationDotMarker&&(f.webkitCompassHeading?this._heading=f.webkitCompassHeading:!0===f.absolute&&(this._heading=-1*f.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return p.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new p.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new p.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new p.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(f={maximumAge:6e5,timeout:0},this._noTimeout=!0):(f=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,f),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const f=()=>{p.window.addEventListener("ondeviceorientationabsolute"in p.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==p.window.DeviceMotionEvent&&"function"==typeof p.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(a=>{"granted"===a&&f()}).catch(console.error):f()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),p.window.removeEventListener("deviceorientation",this._onDeviceOrientation),p.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Vo,ScaleControl:class{constructor(f){this.options=p.extend({},Wu,f),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch(a){return!1}}()||(this._setScale=Ll.bind(this)),p.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const f=this.options.maxWidth||100,a=this._map,d=a._containerHeight/2,g=a._containerWidth/2-f/2,x=a.unproject([g,d]),C=a.unproject([g+f,d]),M=x.distanceTo(C);if("imperial"===this.options.unit){const D=3.2808*M;D>5280?this._setScale(f,D/5280,"mile"):this._setScale(f,D,"foot")}else"nautical"===this.options.unit?this._setScale(f,M/1852,"nautical-mile"):M>=1e3?this._setScale(f,M/1e3,"kilometer"):this._setScale(f,M,"meter")}_setScale(f,a,d){const g=Ac(a),x=g/a;this._map._requestDomTask(()=>{this._container.style.width=f*x+"px",this._container.innerHTML="nautical-mile"!==d?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:d}).format(g):`${g}&nbsp;nm`})}onAdd(f){return this._map=f,this._language=f.getLanguage(),this._container=Qt("div","mapboxgl-ctrl mapboxgl-ctrl-scale",f.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(f){this._language=f,this._update()}setUnit(f){this.options.unit=f,this._update()}},FullscreenControl:class{constructor(f){this._fullscreen=!1,f&&f.container&&(f.container instanceof p.window.HTMLElement?this._container=f.container:p.warnOnce("Full screen control 'container' must be a DOM element.")),p.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in p.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in p.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=Qt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",p.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,p.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!p.window.document.fullscreenEnabled&&!p.window.document.webkitFullscreenEnabled)}_setupUI(){const f=this._fullscreenButton=Qt("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Qt("span","mapboxgl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),p.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",f)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(p.window.document.fullscreenElement||p.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?p.window.document.exitFullscreen?p.window.document.exitFullscreen():p.window.document.webkitCancelFullScreen&&p.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends p.Evented{constructor(f){super(),this.options=p.extend(Object.create(fp),f),p.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(f&&f.className?f.className.trim().split(/\s+/):[])}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&f.on("preclick",this._onClose),this.options.closeOnMove&&f.on("move",this._onClose),f.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(f.on("mousemove",this._onMouseEvent),f.on("mouseup",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")):f.on("move",this._update),this.fire(new p.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const f=this._map;return f&&(f.off("move",this._update),f.off("move",this._onClose),f.off("preclick",this._onClose),f.off("click",this._onClose),f.off("remove",this.remove),f.off("mousemove",this._onMouseEvent),f.off("mouseup",this._onMouseEvent),f.off("drag",this._onMouseEvent),this._map=void 0),this.fire(new p.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(f){this._lngLat=p.LngLat.convert(f),this._pos=null,this._trackPointer=!1,this._update();const a=this._map;return a&&(a.on("move",this._update),a.off("mousemove",this._onMouseEvent),a._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const f=this._map;return f&&(f.off("move",this._update),f.on("mousemove",this._onMouseEvent),f.on("drag",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(p.window.document.createTextNode(f))}setHTML(f){const a=p.window.document.createDocumentFragment(),d=p.window.document.createElement("body");let g;for(d.innerHTML=f;g=d.firstChild,g;)a.appendChild(g);return this.setDOMContent(a)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){let a=this._content;if(a)for(;a.hasChildNodes();)a.firstChild&&a.removeChild(a.firstChild);else a=this._content=Qt("div","mapboxgl-popup-content",this._container||void 0);if(a.appendChild(f),this.options.closeButton){const d=this._closeButton=Qt("button","mapboxgl-popup-close-button",a);d.type="button",d.setAttribute("aria-label","Close popup"),d.setAttribute("aria-hidden","true"),d.innerHTML="&#215;",d.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(f){return this._classList.add(f),this._updateClassList(),this}removeClassName(f){return this._classList.delete(f),this._updateClassList(),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){let a;return this._classList.delete(f)?a=!1:(this._classList.add(f),a=!0),this._updateClassList(),a}_onMouseEvent(f){this._update(f.point)}_getAnchor(f){if(this.options.anchor)return this.options.anchor;const a=this._map,d=this._container,g=this._pos;if(!a||!d||!g)return"bottom";const x=d.offsetWidth,C=d.offsetHeight,M=g.x<x/2,D=g.x>a.transform.width-x/2;if(g.y+f<C)return M?"top-left":D?"top-right":"top";if(g.y>a.transform.height-C){if(M)return"bottom-left";if(D)return"bottom-right"}return M?"left":D?"right":"bottom"}_updateClassList(){const f=this._container;if(!f)return;const a=[...this._classList];a.push("mapboxgl-popup"),this._anchor&&a.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&a.push("mapboxgl-popup-track-pointer"),f.className=a.join(" ")}_update(f){const a=this._map,d=this._content;if(!a||!this._lngLat&&!this._trackPointer||!d)return;let g=this._container;if(g||(g=this._container=Qt("div","mapboxgl-popup",a.getContainer()),this._tip=Qt("div","mapboxgl-popup-tip",g),g.appendChild(d)),this.options.maxWidth&&g.style.maxWidth!==this.options.maxWidth&&(g.style.maxWidth=this.options.maxWidth),a.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Uo(this._lngLat,this._pos,a.transform)),!this._trackPointer||f){const x=this._pos=this._trackPointer&&f?f:a.project(this._lngLat),C=Ec(this.options.offset),M=this._anchor=this._getAnchor(C.y),D=Ec(this.options.offset,M),O=x.add(D).round();a._requestDomTask(()=>{this._container&&M&&(this._container.style.transform=`${bc[M]} translate(${O.x}px,${O.y}px)`)})}if(!this._marker&&a._showingGlobe()){const x=p.isLngLatBehindGlobe(a.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(mp);f&&f.focus()}_onClose(){this.remove()}_setOpacity(f){this._container&&(this._container.style.opacity=`${f}`),this._content&&(this._content.style.pointerEvents=f?"auto":"none")}},Marker:wc,Style:eo,LngLat:p.LngLat,LngLatBounds:p.LngLatBounds,Point:p.pointGeometry,MercatorCoordinate:p.MercatorCoordinate,FreeCameraOptions:mt,Evented:p.Evented,config:p.config,prewarm:function(){Ln().acquire(Pt)},clearPrewarmedResources:function(){const f=tn;f&&(f.isPreloaded()&&1===f.numActive()?(f.release(Pt),tn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return p.config.ACCESS_TOKEN},set accessToken(f){p.config.ACCESS_TOKEN=f},get baseApiUrl(){return p.config.API_URL},set baseApiUrl(f){p.config.API_URL=f},get workerCount(){return Nt.workerCount},set workerCount(f){Nt.workerCount=f},get maxParallelImageRequests(){return p.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(f){p.config.MAX_PARALLEL_IMAGE_REQUESTS=f},clearStorage(f){p.clearTileCache(f)},workerUrl:"",workerClass:null,setNow:p.exported.setNow,restoreNow:p.exported.restoreNow};return ua}),_i}()}},Nf=>{Nf(Nf.s=287)}]);